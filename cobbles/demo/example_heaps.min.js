(function(kh){function J(a,b){var c=Object.create(a),d;for(d in b)c[d]=b[d];b.toString!==Object.prototype.toString&&(c.toString=b.toString);return c}function z(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=kh.$haxeUID++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=b.bind(a),a.hx__closures__[b.__id__]=c);return c}var r={},m=function(){return ia.__string_rec(this,"")},K=K||{},s,uf=function(a,b){this.r=RegExp(a,b.split("u").join(""))};r.EReg=uf;uf.__name__=
"EReg";uf.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw new q("EReg::matched");},matchedPos:function(){if(null==this.r.m)throw new q("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(a,b,c){null==c&&(c=-1);if(this.r.global){this.r.lastIndex=b;this.r.m=this.r.exec(0>c?a:v.substr(a,0,b+c));if(b=null!=
this.r.m)this.r.s=a;return b}if(c=this.match(0>c?v.substr(a,b,null):v.substr(a,b,c)))this.r.s=a,this.r.m.index+=b;return c},__class__:uf};var v=function(){};r.HxOverrides=v;v.__name__="HxOverrides";v.dateStr=function(a){var b=a.getMonth()+1,c=a.getDate(),d=a.getHours(),e=a.getMinutes(),f=a.getSeconds();return a.getFullYear()+"-"+(10>b?"0"+b:""+b)+"-"+(10>c?"0"+c:""+c)+" "+(10>d?"0"+d:""+d)+":"+(10>e?"0"+e:""+e)+":"+(10>f?"0"+f:""+f)};v.strDate=function(a){switch(a.length){case 8:a=a.split(":");var b=
new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);return b;case 10:return a=a.split("-"),new Date(a[0],a[1]-1,a[2],0,0,0);case 19:return b=a.split(" "),a=b[0].split("-"),b=b[1].split(":"),new Date(a[0],a[1]-1,a[2],b[0],b[1],b[2]);default:throw new q("Invalid date format : "+a);}};v.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};v.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};v.remove=
function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};v.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var Li=function(){};r.Lambda=Li;Li.__name__="Lambda";Li.array=function(a){var b=[];for(a=a instanceof Array?v.iter(a):a.iterator();a.hasNext();){var c=a.next();b.push(c)}return b};Math.__name__="Math";var ua=function(){};r.Reflect=ua;ua.__name__="Reflect";ua.field=function(a,b){try{return a[b]}catch(c){return $.lastException=
c,null}};ua.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&("hx__closures__"!=d&&c.call(a,d))&&b.push(d)}return b};ua.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};ua.compare=function(a,b){return a==b?0:a>b?1:-1};ua.compareMethods=function(a,b){return a==b?!0:!ua.isFunction(a)||!ua.isFunction(b)?!1:a.scope==b.scope&&a.method==b.method?null!=a.method:!1};ua.isEnumValue=function(a){return null!=a?null!=a.__enum__:
!1};ua.deleteField=function(a,b){if(!Object.prototype.hasOwnProperty.call(a,b))return!1;delete a[b];return!0};var be=function(){};r.Safety=be;be.__name__="Safety";be.or=function(a,b){return null==a?b:a};be.orGet=function(a,b){return null==a?b():a};be.sure=function(a){if(null==a)throw new q(new lh("Null pointer in .sure() call"));return a};be.unsafe=function(a){return a};be.check=function(a,b){return null!=a?b(a):!1};be.let=function(a,b){return null==a?null:b(a)};be.run=function(a,b){null!=a&&b(a)};
be.apply=function(a,b){null!=a&&b(a);return a};var n=function(){};r.Std=n;n.__name__="Std";n.string=function(a){return ia.__string_rec(a,"")};n.parseInt=function(a){if(null!=a)for(var b=0,c=a.length;b<c;){var d=b++,e=a.charCodeAt(d);if(8>=e||14<=e&&32!=e&&45!=e)if(a=parseInt(a,"x"==a[d+1]||"X"==a[d+1]?16:10),isNaN(a))break;else return a}return null};n.random=function(a){return 0>=a?0:Math.floor(Math.random()*a)};var Ib=function(){this.b=""};r.StringBuf=Ib;Ib.__name__="StringBuf";Ib.prototype={__class__:Ib};
var Qa=function(){};r.StringTools=Qa;Qa.__name__="StringTools";Qa.htmlEscape=function(a,b){for(var c="",d=0;d<a.length;){var e=a,f=d++,g=e.charCodeAt(f);55296<=g&&56319>=g&&(g=g-55232<<10|e.charCodeAt(f+1)&1023);e=g;65536<=e&&++d;switch(e){case 34:c=b?c+"&quot;":c+String.fromCodePoint(e);break;case 38:c+="&amp;";break;case 39:c=b?c+"&#039;":c+String.fromCodePoint(e);break;case 60:c+="&lt;";break;case 62:c+="&gt;";break;default:c+=String.fromCodePoint(e)}}return c};Qa.startsWith=function(a,b){return a.length>=
b.length?0==a.lastIndexOf(b,0):!1};Qa.endsWith=function(a,b){var c=b.length,d=a.length;return d>=c?a.indexOf(b,d-c)==d-c:!1};Qa.isSpace=function(a,b){var c=v.cca(a,b);return 8<c&&14>c?!0:32==c};Qa.ltrim=function(a){for(var b=a.length,c=0;c<b&&Qa.isSpace(a,c);)++c;return 0<c?v.substr(a,c,b-c):a};Qa.rtrim=function(a){for(var b=a.length,c=0;c<b&&Qa.isSpace(a,b-c-1);)++c;return 0<c?v.substr(a,0,b-c):a};Qa.trim=function(a){return Qa.ltrim(Qa.rtrim(a))};Qa.hex=function(a,b){for(var c="";!(c="0123456789ABCDEF".charAt(a&
15)+c,a>>>=4,!(0<a)););if(null!=b)for(;c.length<b;)c="0"+c;return c};var Fa=function(){};r.Type=Fa;Fa.__name__="Type";Fa.createInstance=function(a,b){return new (Function.prototype.bind.apply(a,[null].concat(b)))};Fa.createEnum=function(a,b,c){var d=ua.field(a,b);if(null==d)throw new q("No such constructor "+b);if(ua.isFunction(d)){if(null==c)throw new q("Constructor "+b+" need parameters");return d.apply(a,c)}if(null!=c&&0!=c.length)throw new q("Constructor "+b+" does not need parameters");return d};
Fa.createEnumIndex=function(a,b,c){var d=a.__constructs__[b];if(null==d)throw new q(b+" is not a valid enum constructor index");return Fa.createEnum(a,d,c)};Fa.enumEq=function(a,b){if(a==b)return!0;try{var c=a.__enum__;if(null==c||c!=b.__enum__||a._hx_index!=b._hx_index)return!1;for(var d=K[c],e=d[d.__constructs__[a._hx_index]].__params__,c=0;c<e.length;){var f=e[c];++c;if(!Fa.enumEq(a[f],b[f]))return!1}}catch(g){return $.lastException=g,!1}return!0};Fa.enumParameters=function(a){var b=K[a.__enum__],
b=b[b.__constructs__[a._hx_index]].__params__;if(null!=b){for(var c=[],d=0;d<b.length;){var e=b[d];++d;c.push(a[e])}return c}return[]};var ka={};r["_Xml.XmlType_Impl_"]=ka;ka.__name__="_Xml.XmlType_Impl_";ka.toString=function(a){switch(a){case 0:return"Element";case 1:return"PCData";case 2:return"CData";case 3:return"Comment";case 4:return"DocType";case 5:return"ProcessingInstruction";case 6:return"Document"}};var I=function(a){this.nodeType=a;this.children=[];this.attributeMap=new ga};r.Xml=I;I.__name__=
"Xml";I.parse=function(a){return Ad.parse(a)};I.createElement=function(a){var b=new I(I.Element);if(b.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(b.nodeType));b.nodeName=a;return b};I.createPCData=function(a){var b=new I(I.PCData);if(b.nodeType==I.Document||b.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(b.nodeType));b.nodeValue=a;return b};I.createCData=function(a){var b=new I(I.CData);if(b.nodeType==I.Document||b.nodeType==
I.Element)throw new q("Bad node type, unexpected "+ka.toString(b.nodeType));b.nodeValue=a;return b};I.createComment=function(a){var b=new I(I.Comment);if(b.nodeType==I.Document||b.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(b.nodeType));b.nodeValue=a;return b};I.createDocType=function(a){var b=new I(I.DocType);if(b.nodeType==I.Document||b.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(b.nodeType));b.nodeValue=a;return b};I.createProcessingInstruction=
function(a){var b=new I(I.ProcessingInstruction);if(b.nodeType==I.Document||b.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(b.nodeType));b.nodeValue=a;return b};I.createDocument=function(){return new I(I.Document)};I.prototype={get:function(a){if(this.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(this.nodeType));var b=this.attributeMap;return null!=Q[a]?b.getReserved(a):b.h[a]},set:function(a,b){if(this.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+
ka.toString(this.nodeType));var c=this.attributeMap;null!=Q[a]?c.setReserved(a,b):c.h[a]=b},exists:function(a){if(this.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(this.nodeType));var b=this.attributeMap;return null!=Q[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},attributes:function(){if(this.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(this.nodeType));return this.attributeMap.keys()},elements:function(){if(this.nodeType!=
I.Document&&this.nodeType!=I.Element)throw new q("Bad node type, expected Element or Document but found "+ka.toString(this.nodeType));for(var a=[],b=0,c=this.children;b<c.length;){var d=c[b];++b;d.nodeType==I.Element&&a.push(d)}return v.iter(a)},elementsNamed:function(a){if(this.nodeType!=I.Document&&this.nodeType!=I.Element)throw new q("Bad node type, expected Element or Document but found "+ka.toString(this.nodeType));for(var b=[],c=0,d=this.children;c<d.length;){var e=d[c];++c;var f;if(e.nodeType==
I.Element){if(e.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(e.nodeType));f=e.nodeName==a}else f=!1;f&&b.push(e)}return v.iter(b)},firstElement:function(){if(this.nodeType!=I.Document&&this.nodeType!=I.Element)throw new q("Bad node type, expected Element or Document but found "+ka.toString(this.nodeType));for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;if(c.nodeType==I.Element)return c}return null},addChild:function(a){if(this.nodeType!=I.Document&&
this.nodeType!=I.Element)throw new q("Bad node type, expected Element or Document but found "+ka.toString(this.nodeType));null!=a.parent&&a.parent.removeChild(a);this.children.push(a);a.parent=this},removeChild:function(a){if(this.nodeType!=I.Document&&this.nodeType!=I.Element)throw new q("Bad node type, expected Element or Document but found "+ka.toString(this.nodeType));return v.remove(this.children,a)?(a.parent=null,!0):!1},toString:function(){return og.print(this)},__class__:I};var Mi=function(a,
b,c,d,e,f,g,h,k){this.type=a;this.textIndex=b;this.advanceX=c;this.advanceY=d;this.glyphID=e;this.glyphOffsetX=f;this.glyphOffsetY=g;this.inlineObject=h;this.customProperties=k};r["cobbles.AdvanceInfo"]=Mi;Mi.__name__="cobbles.AdvanceInfo";Mi.prototype={__class__:Mi};var pg=function(){};r["cobbles.Debug"]=pg;pg.__name__="cobbles.Debug";pg.warning=function(a,b){Fb.trace(a,b)};var ce=function(){};r["cobbles.Disposable"]=ce;ce.__name__="cobbles.Disposable";ce.__isInterface__=!0;ce.prototype={__class__:ce};
var nh=function(a){this.customPropertiesDirty=!1;this.currentCustomProperties=new ga;this.customPropertiesMap=new na;this.customPropertiesSequenceID=1;this.inlineObjectMap=new na;this.inlineObjectSequenceID=1;this.markupParser=new Ni;a=ia.__cast(a.coreLibrary,qg);this.coreEngine=new mh(a);this.init()};r["cobbles.Engine"]=nh;nh.__name__="cobbles.Engine";nh.__interfaces__=[ce];nh.prototype={init:function(){this.customPropertiesMap.h[this.customPropertiesSequenceID]=this.currentCustomProperties;this.coreEngine.set_customProperty(this.customPropertiesSequenceID)},
dispose:function(){this.coreEngine.dispose()},isDisposed:function(){return this.coreEngine.isDisposed()},get_lineLength:function(){return this.coreEngine.get_lineLength()},set_lineLength:function(a){return this.coreEngine.set_lineLength(a)},get_locale:function(){return this.coreEngine.get_locale()},set_locale:function(a){return this.coreEngine.set_locale(a)},get_textAlignment:function(){return this.coreEngine.get_textAlignment()},set_textAlignment:function(a){return this.coreEngine.set_textAlignment(a)},
get_language:function(){return this.coreEngine.get_language()},set_language:function(a){return this.coreEngine.set_language(a)},get_script:function(){return this.coreEngine.get_script()},set_script:function(a){return this.coreEngine.set_script(a)},get_scriptDirection:function(){return this.coreEngine.get_scriptDirection()},set_scriptDirection:function(a){return this.coreEngine.set_scriptDirection(a)},get_font:function(){return this.coreEngine.get_font()},set_font:function(a){return this.coreEngine.set_font(a)},
get_fontSize:function(){return this.coreEngine.get_fontSize()},set_fontSize:function(a){return this.coreEngine.set_fontSize(a)},get_outputInfo:function(){return this.coreEngine.get_outputInfo()},tiles:function(){return this.coreEngine.tiles()},advances:function(){for(var a=this.coreEngine.advances(),b=[],c=0;c<a.length;){var d=a[c];++c;b.push(new Mi(d.type,d.textIndex,d.advanceX,d.advanceY,d.glyphID,d.glyphOffsetX,d.glyphOffsetY,this.inlineObjectMap.h[d.inlineObject],this.customPropertiesMap.h[d.customProperty]))}return b},
addText:function(a){this.applyCustomProperties();this.coreEngine.addText(a)},addMarkup:function(a){this.markupParser.parse(new Oi(this),a)},addLineBreak:function(){this.applyCustomProperties();this.coreEngine.addText("\n")},addInlineObject:function(a){this.applyCustomProperties();this.inlineObjectMap.h[this.inlineObjectSequenceID]=a;this.coreEngine.addInlineObject(this.inlineObjectSequenceID,a.getWidth(),a.getHeight());this.inlineObjectSequenceID+=1},applyCustomProperties:function(){if(this.customPropertiesDirty){var a=
this.customPropertiesMap,b=this.customPropertiesSequenceID,c=this.currentCustomProperties.copy();a.h[b]=c;this.coreEngine.set_customProperty(this.customPropertiesSequenceID);this.customPropertiesSequenceID+=1}},setCustomProperty:function(a,b){var c=this.currentCustomProperties;null!=Q[a]?c.setReserved(a,b):c.h[a]=b;this.customPropertiesDirty=!0},getCustomProperty:function(a){var b=this.currentCustomProperties;return null!=Q[a]?b.getReserved(a):b.h[a]},removeCustomProperty:function(a){if(a=this.currentCustomProperties.remove(a))this.customPropertiesDirty=
!0;return a},clear:function(){this.coreEngine.clear();this.customPropertiesSequenceID=this.inlineObjectSequenceID=1;this.inlineObjectMap.h={};this.customPropertiesMap.h={}},clearTiles:function(){this.coreEngine.clearTiles()},layOut:function(){this.coreEngine.layOut()},tilesValid:function(){return this.coreEngine.tilesValid()},rasterize:function(){this.coreEngine.rasterize()},packTiles:function(a,b){return this.coreEngine.packTiles(a,b)},__class__:nh};var Pi=function(a,b,c,d,e,f,g,h,k){this.id=a;this.familyName=
b;this.styleName=c;this.unitsPerEM=d;this.ascender=e;this.descender=f;this.height=g;this.underlinePosition=h;this.underlineThickness=k};r["cobbles.FontInfo"]=Pi;Pi.__name__="cobbles.FontInfo";Pi.prototype={__class__:Pi};var Qi=function(a,b,c,d,e,f){this.id=a;this.image=b;this.imageWidth=c;this.imageHeight=d;this.imageOffsetX=e;this.imageOffsetY=f};r["cobbles.GlyphInfo"]=Qi;Qi.__name__="cobbles.GlyphInfo";Qi.prototype={__class__:Qi};var oh=function(){};r["cobbles.InlineObject"]=oh;oh.__name__="cobbles.InlineObject";
oh.__isInterface__=!0;oh.prototype={__class__:oh};var vf=function(a){this.coreLibrary=new qg(a)};r["cobbles.Library"]=vf;vf.__name__="cobbles.Library";vf.__interfaces__=[ce];vf.loadModule=function(a){null==a&&(a="CobbletextModule");return new Promise(function(b,c){ua.field(kh,a)().then(function(a){delete a.then;b(new vf(a))})})};vf.prototype={dispose:function(){this.coreLibrary.dispose()},isDisposed:function(){return this.coreLibrary.isDisposed()},get_fallbackFont:function(){return this.coreLibrary.get_fallbackFont()},
loadFont:function(a){return this.coreLibrary.loadFont(a)},loadFontBytes:function(a,b){null==b&&(b=0);return this.coreLibrary.loadFontBytes(a,b)},getFontInfo:function(a){return this.coreLibrary.getFontInfo(a)},getGlyphInfo:function(a){return this.coreLibrary.getGlyphInfo(a)},setFontAlternative:function(a,b){this.coreLibrary.setFontAlternative(a,b)},getFontAlternative:function(a){return this.coreLibrary.getFontAlternative(a)},__class__:vf};var Ri=function(){this.textWidth=this.textHeight=0};r["cobbles.OutputInfo"]=
Ri;Ri.__name__="cobbles.OutputInfo";Ri.prototype={__class__:Ri};var Si=function(a,b,c){this.glyphID=a;this.atlasX=b;this.atlasY=c};r["cobbles.TileInfo"]=Si;Si.__name__="cobbles.TileInfo";Si.prototype={__class__:Si};var Ti=function(a,b,c,d,e,f,g,h,k){this.type=a;this.textIndex=b;this.advanceX=c;this.advanceY=d;this.glyphID=e;this.glyphOffsetX=f;this.glyphOffsetY=g;this.inlineObject=h;this.customProperty=k};r["cobbles.core.AdvanceInfo"]=Ti;Ti.__name__="cobbles.core.AdvanceInfo";Ti.prototype={__class__:Ti};
var rg=function(){};r["cobbles.core.Engine"]=rg;rg.__name__="cobbles.core.Engine";rg.__isInterface__=!0;rg.__interfaces__=[ce];rg.prototype={__class__:rg};var mh=function(a){this._disposed=!1;this.library=a;this.jsEngine=new a.module.Engine(a.jsLibrary);this._outputInfo=new Ri};r["cobbles.core.EngineJS"]=mh;mh.__name__="cobbles.core.EngineJS";mh.__interfaces__=[rg];mh.prototype={dispose:function(){this.jsEngine.delete();this._disposed=!0},isDisposed:function(){return this._disposed},get_lineLength:function(){return this.jsEngine.lineLength},
set_lineLength:function(a){return this.jsEngine.lineLength=a},get_locale:function(){return this.jsEngine.locale},set_locale:function(a){return this.jsEngine.locale=a},get_textAlignment:function(){return ph.fromNative(this.jsEngine.textAlignment)},set_textAlignment:function(a){this.jsEngine.textAlignment=ph.toNative(this.library.module,a);return a},get_language:function(){return this.jsEngine.language},set_language:function(a){return this.jsEngine.language=a},get_script:function(){return this.jsEngine.script},
set_script:function(a){return this.jsEngine.script=a},get_scriptDirection:function(){return qh.fromNative(this.jsEngine.scriptDirection)},set_scriptDirection:function(a){this.jsEngine.scriptDirection=qh.toNative(this.library.module,a);return a},get_font:function(){return this.jsEngine.font},set_font:function(a){return this.jsEngine.font=a},get_fontSize:function(){return this.jsEngine.fontSize},set_fontSize:function(a){return this.jsEngine.fontSize=a},get_customProperty:function(){return this.jsEngine.customProperty},
set_customProperty:function(a){return this.jsEngine.customProperty=a},get_outputInfo:function(){return this._outputInfo},tiles:function(){for(var a=this.jsEngine.tiles(),b=[],c=0,d=a.size();c<d;){var e=c++,e=a.get(e);b.push(new Si(e.glyphID,e.atlasX,e.atlasY))}a.delete();return b},advances:function(){for(var a=this.jsEngine.advances(),b=[],c=0,d=a.size();c<d;){var e=c++,e=a.get(e);b.push(new Ti(wk.fromNative(e.type),e.textIndex,e.advanceX,e.advanceY,e.glyphID,e.glyphOffsetX,e.glyphOffsetY,e.inlineObject,
e.customProperty))}a.delete();return b},addText:function(a){this.jsEngine.addTextUTF8(a)},addInlineObject:function(a,b,c){this.jsEngine.addInlineObject(a,b,c)},clear:function(){this.jsEngine.clear()},clearTiles:function(){this.jsEngine.clearTiles()},layOut:function(){this.jsEngine.layOut();var a=this.jsEngine.outputInfo;this.get_outputInfo().textWidth=a.textWidth;this.get_outputInfo().textHeight=a.textHeight},tilesValid:function(){return this.jsEngine.tilesValid()},rasterize:function(){this.jsEngine.rasterize()},
packTiles:function(a,b){return this.jsEngine.packTiles(a,b)},__class__:mh};var sg=function(){};r["cobbles.core.Library"]=sg;sg.__name__="cobbles.core.Library";sg.__isInterface__=!0;sg.__interfaces__=[ce];sg.prototype={__class__:sg};var qg=function(a){this._disposed=!1;this.module=a;this.jsLibrary=new a.Library};r["cobbles.core.LibraryJS"]=qg;qg.__name__="cobbles.core.LibraryJS";qg.__interfaces__=[sg];qg.prototype={dispose:function(){this.jsLibrary.delete();this._disposed=!0},isDisposed:function(){return this._disposed},
get_fallbackFont:function(){return this.jsLibrary.fallbackFont()},loadFont:function(a){throw new q("not implemented");},loadFontBytes:function(a,b){null==b&&(b=0);return this.jsLibrary.loadFontBytes(a.b.bufferValue,b)},getFontInfo:function(a){a=this.jsLibrary.getFontInfo(a);return new Pi(a.id,a.familyName,a.styleName,a.unitsPerEM,a.ascender,a.descender,a.height,a.underlinePosition,a.underlineThickness)},getGlyphInfo:function(a){a=this.jsLibrary.getGlyphInfo(a);for(var b=new N(new ArrayBuffer(a.image.size())),
c=0,d=b.length;c<d;){var e=c++,f=a.image.get(e);b.b[e]=f}a.image.delete();return new Qi(a.id,b,a.imageWidth,a.imageHeight,a.imageOffsetX,a.imageOffsetY)},setFontAlternative:function(a,b){this.jsLibrary.setFontAlternative(a,b)},getFontAlternative:function(a){return this.jsLibrary.getFontAlternative(a)},__class__:qg};var xe=K["cobbles.example.heaps.DemoMode"]={__ename__:!0,__constructs__:["LeftText","CenterText","RightText","RightToLeftMode"],LeftText:{_hx_index:0,__enum__:"cobbles.example.heaps.DemoMode",
toString:m},CenterText:{_hx_index:1,__enum__:"cobbles.example.heaps.DemoMode",toString:m},RightText:{_hx_index:2,__enum__:"cobbles.example.heaps.DemoMode",toString:m},RightToLeftMode:{_hx_index:3,__enum__:"cobbles.example.heaps.DemoMode",toString:m}};xe.__empty_constructs__=[xe.LeftText,xe.CenterText,xe.RightText,xe.RightToLeftMode];var Ui=function(a,b){this.extraText="";this.demoMode=xe.LeftText;this.counter=0;this.fontKeys=[];this.library=b;this.engine=new nh(b);for(var c=0;c<a.length;){var d=a[c];
++c;Fb.trace("Load "+d.name,{fileName:"example/heaps/src/cobbles/example/heaps/DemoText.hx",lineNumber:37,className:"cobbles.example.heaps.DemoText",methodName:"new"});d=null!=d.data?b.loadFontBytes(d.data):b.loadFont(d.name);null==this.defaultFont&&(this.defaultFont=d);this.fontKeys.push(d)}c=0;for(d=this.fontKeys.length-1;c<d;){var e=c++;b.setFontAlternative(this.fontKeys[e],this.fontKeys[e+1])}this.engine.set_locale("en-US");this.engine.set_lineLength(0);this.engine.set_font(this.defaultFont);
this.engine.set_fontSize(24);this.engine.setCustomProperty("color",-1);c=new rh(512,512);this.renderer=new sh(b,this.engine,c);this.tileGroup=this.renderer.newTileGroup();this.texture=this.renderer.textureAtlas.texture};r["cobbles.example.heaps.DemoText"]=Ui;Ui.__name__="cobbles.example.heaps.DemoText";Ui.prototype={addDefaultText:function(){var a=v.dateStr(new Date);this.engine.addText(""+a+" "+this.counter);this.engine.addLineBreak();this.engine.addText("The quick brown fox jumps over the lazy dog. ");
this.engine.addMarkup("<span size='40pt' color='#ff3333'>Hel\u035clo<br/>wo\u030erld! \u064a\u0648\u0646\u064a\u0643\u0648\u062f</span>");this.engine.addText("\u6211\u80fd\u541e\u4e0b\u73bb\u7483\u800c\u4e0d\u4f24\u8eab\u4f53\u3002\u79c1\u306f\u30ac\u30e9\u30b9\u3092\u98df\u3079\u3089\u308c\u307e\u3059\u3002\u305d\u308c\u306f\u79c1\u3092\u50b7\u3064\u3051\u307e\u305b\u3093\u3002\ub098\ub294 \uc720\ub9ac\ub97c \uba39\uc744 \uc218 \uc788\uc5b4\uc694. \uadf8\ub798\ub3c4 \uc544\ud504\uc9c0 \uc54a\uc544\uc694. \u042f \u043c\u043e\u0433\u0443 \u0435\u0441\u0442\u044c \u0441\u0442\u0435\u043a\u043b\u043e, \u043e\u043d\u043e \u043c\u043d\u0435 \u043d\u0435 \u0432\u0440\u0435\u0434\u0438\u0442. T\u00f4i c\u00f3 th\u1ec3 \u0103n th\u1ee7y tinh m\u00e0 kh\u00f4ng h\u1ea1i g\u00ec. \u0623\u0646\u0627 \u0642\u0627\u062f\u0631 \u0639\u0644\u0649 \u0623\u0643\u0644 \u0627\u0644\u0632\u062c\u0627\u062c \u0648 \u0647\u0630\u0627 \u0644\u0627 \u064a\u0624\u0644\u0645\u0646\u064a. \u05d0\u05e0\u05d9 \u05d9\u05db\u05d5\u05dc \u05dc\u05d0\u05db\u05d5\u05dc \u05d6\u05db\u05d5\u05db\u05d9\u05ea \u05d5\u05d6\u05d4 \u05dc\u05d0 \u05de\u05d6\u05d9\u05e7 \u05dc\u05d9. ")},
setExtraText:function(a){this.extraText=a},update:function(){this.engine.clear();this.addDefaultText();this.engine.addText(this.extraText);this.engine.layOut();this.renderer.renderTileGroup(this.tileGroup);this.counter+=1},switchMode:function(){switch(this.demoMode._hx_index){case 0:this.engine.set_textAlignment(5);this.demoMode=xe.CenterText;break;case 1:this.engine.set_textAlignment(2);this.demoMode=xe.RightText;break;case 2:this.engine.set_textAlignment(2);this.engine.set_scriptDirection(2);this.demoMode=
xe.RightToLeftMode;break;case 3:this.engine.set_textAlignment(1),this.engine.set_scriptDirection(1),this.demoMode=xe.LeftText}},setWidth:function(a){this.engine.set_lineLength(a)},__class__:Ui};var wf=function(){};r["h3d.IDrawable"]=wf;wf.__name__="h3d.IDrawable";wf.__isInterface__=!0;wf.prototype={__class__:wf};var Lc=function(){var a=this,b=X.CURRENT;null!=b?(this.engine=b,b.onReady=z(this,this.setup),de.delay(z(this,this.setup),0)):U.start(function(){b=new X;a.engine=b;b.onReady=z(a,a.setup);b.init()})};
r["hxd.App"]=Lc;Lc.__name__="hxd.App";Lc.__interfaces__=[wf];Lc.staticHandler=function(){};Lc.prototype={onResize:function(){},setScene:function(a,b){null==b&&(b=!0);var c=a instanceof Mc?a:null,d=a instanceof ee?a:null;null!=c?(this.sevents.removeScene(this.s2d),this.sevents.addScene(a,0)):(null!=d&&this.sevents.removeScene(this.s3d),this.sevents.addScene(a));if(b)if(null!=c)this.s2d.dispose();else if(null!=d)this.s3d.dispose();else throw new q("Can't dispose previous scene");null!=c&&(this.s2d=
c);null!=d&&(this.s3d=d)},setCurrent:function(){var a=this;this.engine=X.CURRENT;this.isDisposed=!1;this.engine.onReady=Lc.staticHandler;this.engine.onResized=function(){null!=a.s2d&&(a.s2d.checkResize(),a.onResize())};U.setLoop(z(this,this.mainLoop))},setScene2D:function(a,b){null==b&&(b=!0);this.sevents.removeScene(this.s2d);this.sevents.addScene(a,0);b&&this.s2d.dispose();this.s2d=a},setScene3D:function(a,b){null==b&&(b=!0);this.sevents.removeScene(this.s3d);this.sevents.addScene(a);b&&this.s3d.dispose();
this.s3d=a},render:function(a){this.s3d.render(a);this.s2d.render(a)},setup:function(){var a=this,b=!1;this.engine.onReady=Lc.staticHandler;this.engine.onResized=function(){if(null!=a.s2d&&(a.s2d.checkResize(),b))a.onResize()};this.s3d=new ee;this.s2d=new Mc;this.sevents=new Vi;this.sevents.addScene(this.s2d);this.sevents.addScene(this.s3d);this.loadAssets(function(){b=!0;a.init();ea.skip();a.mainLoop();U.setLoop(z(a,a.mainLoop));y.initialize()})},dispose:function(){this.engine.onResized=Lc.staticHandler;
this.engine.onContextLost=Lc.staticHandler;this.isDisposed=!0;this.s2d.dispose();this.s3d.dispose();this.sevents.dispose()},loadAssets:function(a){a()},init:function(){},mainLoop:function(){ea.update();this.sevents.checkEvents();if(!this.isDisposed&&(this.update(ea.dt),!this.isDisposed)){var a=ea.dt;null!=this.s2d&&this.s2d.setElapsedTime(a);null!=this.s3d&&this.s3d.setElapsedTime(a);this.engine.render(this)}},update:function(a){},__class__:Lc};var xf=function(a){this.library=a;Lc.call(this)};r["cobbles.example.heaps.HeapsExample"]=
xf;xf.__name__="cobbles.example.heaps.HeapsExample";xf.main=function(){vf.loadModule().then(function(a){Fb.trace("Starting Heaps",{fileName:"example/heaps/src/cobbles/example/heaps/HeapsExample.hx",lineNumber:52,className:"cobbles.example.heaps.HeapsExample",methodName:"main"});return new xf(a)})};xf.__super__=Lc;xf.prototype=J(Lc.prototype,{init:function(){Lc.prototype.init.call(this);this.demoText=new Ui(this.loadedFonts,this.library);var a=new tg(fa.fromTexture(this.demoText.texture),this.s2d);
a.posChanged=!0;a.y=30;a.alpha=0.5;a=this.demoText.tileGroup;a.posChanged=!0;a.y=30;this.s2d.addChild(this.demoText.tileGroup);this.demoText.update();a=th.get();a=this.fpsText=new uh(a,this.s2d);a.posChanged=!0;a.scaleX*=2;a.posChanged=!0;a.scaleY*=2;db.getInstance().addResizeEvent(z(this,this.resizeCallback));db.getInstance().addEventTarget(z(this,this.eventCallback));this.demoText.setWidth(this.s2d.width)},loadAssets:function(a){var b=this,c=[];window.demoLoadAllFonts&&(c=["resource/fonts/noto/NotoSans-Regular.ttf",
"resource/fonts/noto/NotoSansArabic-Regular.ttf","resource/fonts/noto/NotoSansCJKsc-Regular.otf"]);c.push("resource/fonts/liberation/LiberationSerif-Regular.ttf");this.loadedFonts=[];var d=function(){if(0==c.length)a();else{var e=c.shift(),f=new Wi(e);f.onLoaded=function(a){Fb.trace("Loaded "+e+".",{fileName:"example/heaps/src/cobbles/example/heaps/HeapsExample.hx",lineNumber:96,className:"cobbles.example.heaps.HeapsExample",methodName:"loadAssets"});b.loadedFonts.push({name:e,data:a});d()};Fb.trace("Loading "+
e+"..",{fileName:"example/heaps/src/cobbles/example/heaps/HeapsExample.hx",lineNumber:101,className:"cobbles.example.heaps.HeapsExample",methodName:"loadAssets"});f.load()}};d()},update:function(a){this.demoText.update();this.fpsText.set_text("FPS "+(ea.fps()|0)+". WIP. Resize window. Click to change mode.")},resizeCallback:function(){this.demoText.setWidth(db.getInstance().get_width())},eventCallback:function(a){a.kind==la.EPush&&this.demoText.switchMode()},__class__:xf});var yf=function(){};r["cobbles.markup.ElementHandler"]=
yf;yf.__name__="cobbles.markup.ElementHandler";yf.__isInterface__=!0;yf.prototype={__class__:yf};var vh=function(){};r["cobbles.markup.BRHandler"]=vh;vh.__name__="cobbles.markup.BRHandler";vh.__interfaces__=[yf];vh.prototype={handleElementStart:function(a,b){a.addLineBreak()},handleElementEnd:function(a,b){},__class__:vh};var wh=function(a,b){null==b&&(b=0);null==a&&(a=0);this.width=a;this.height=b;this.properties=new ga};r["cobbles.markup.MarkupObject"]=wh;wh.__name__="cobbles.markup.MarkupObject";
wh.__interfaces__=[oh];wh.prototype={getWidth:function(){return this.width},getHeight:function(){return this.height},__class__:wh};var Ni=function(){this.textNodeHandler=new xh;var a=new ga,b=new vh;null!=Q.br?a.setReserved("br",b):a.h.br=b;b=new yh;null!=Q.object?a.setReserved("object",b):a.h.object=b;b=new zh;null!=Q.span?a.setReserved("span",b):a.h.span=b;this.elementHandlers=a};r["cobbles.markup.MarkupParser"]=Ni;Ni.__name__="cobbles.markup.MarkupParser";Ni.prototype={parse:function(a,b){var c=
I.parse(b);this.processNode(a,c)},processNode:function(a,b){switch(b.nodeType){case 0:this.processElement(a,b);break;case 1:case 2:this.handleTextNode(a,b);break;case 6:if(b.nodeType!=I.Document&&b.nodeType!=I.Element)throw new q("Bad node type, expected Element or Document but found "+ka.toString(b.nodeType));for(var c=v.iter(b.children);c.hasNext();){var d=c.next();this.processNode(a,d)}}},processElement:function(a,b){this.handleElementStart(a,b);if(b.nodeType!=I.Document&&b.nodeType!=I.Element)throw new q("Bad node type, expected Element or Document but found "+
ka.toString(b.nodeType));for(var c=v.iter(b.children);c.hasNext();){var d=c.next();this.processNode(a,d)}this.handleElementEnd(a,b)},handleTextNode:function(a,b){this.textNodeHandler.handleTextNode(a,b)},handleElementStart:function(a,b){var c=this.elementHandlers;if(b.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(b.nodeType));var d=b.nodeName,c=null!=Q[d]?c.getReserved(d):c.h[d];null!=c&&c.handleElementStart(a,b)},handleElementEnd:function(a,b){var c=this.elementHandlers;
if(b.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(b.nodeType));var d=b.nodeName,c=null!=Q[d]?c.getReserved(d):c.h[d];null!=c&&c.handleElementEnd(a,b)},__class__:Ni};var yh=function(){};r["cobbles.markup.ObjectHandler"]=yh;yh.__name__="cobbles.markup.ObjectHandler";yh.__interfaces__=[yf];yh.prototype={handleElementStart:function(a,b){for(var c=new wh,d=b.attributes();d.hasNext();){var e=d.next(),f=b.get(e),g=c.properties;null!=Q[e]?g.setReserved(e,f):g.h[e]=
f;if("width"==e)switch(g=fe.parseFontPoints(f),g._hx_index){case 0:c.width=Math.round(64*g.v)}if("height"==e)switch(e=fe.parseFontPoints(f),e._hx_index){case 0:c.height=Math.round(64*e.v)}}a.addInlineObject(c)},handleElementEnd:function(a,b){},processObject:function(a){return a},__class__:yh};var fe=function(){};r["cobbles.markup.ParseUtil"]=fe;fe.__name__="cobbles.markup.ParseUtil";fe.parseColor=function(a){if(Qa.startsWith(a,"#")&&7==a.length){if(a=n.parseInt("0x"+v.substr(a,1,null)),null!=a)return pd.Some(a|
-16777216)}else if(Qa.startsWith(a,"#")&&9==a.length&&(a=n.parseInt("0x"+v.substr(a,1,null)),null!=a))return pd.Some(a);return pd.None};fe.parseDirection=function(a){switch(a){case "ltr":return pd.Some(1);case "rtl":return pd.Some(2);default:return pd.None}};fe.parseFontPoints=function(a){parseFloat(v.substr(a,0,-2));return Qa.endsWith(a,"pt")&&(a=parseFloat(v.substr(a,0,-2)),!isNaN(a))?pd.Some(a):pd.None};var zh=function(){this.level=0;this.fontFaceMap=new ga;this.attributesApplied=[]};r["cobbles.markup.SpanHandler"]=
zh;zh.__name__="cobbles.markup.SpanHandler";zh.__interfaces__=[yf];zh.prototype={handleElementStart:function(a,b){this.attributesApplied.push([]);for(var c=b.attributes();c.hasNext();){var d=c.next();switch(d){case "color":this.processColor(a,b);break;case "dir":this.processDir(a,b);break;case "font-face":this.processFontFace(a,b);break;case "lang":this.processLang(a,b);break;case "script":this.processScript(a,b);break;case "size":this.processSize(a,b);break;default:Qa.startsWith(d,"data-")&&this.processData(a,
b,d)}}this.level+=1},handleElementEnd:function(a,b){this.level-=1;for(var c=0,d=this.attributesApplied[this.level];c<d.length;){var e=d[c];++c;switch(e){case "color":a.popColor();break;case "dir":a.popDirection();break;case "font-face":a.popFont();break;case "lang":a.popLanguage();break;case "script":a.popScript();break;case "size":a.popFontSize();break;default:Qa.startsWith(e,"data-")&&a.popData(v.substr(e,5,null))}}this.attributesApplied.pop()},processFontFace:function(a,b){var c=b.get("font-face"),
d=this.fontFaceMap,d=null!=Q[c]?d.getReserved(c):d.h[c];null!=d?(a.pushFont(d),this.attributesApplied[this.level].push("font-face")):pg.warning('Unknown font face name "'+c+'"',{fileName:"src/cobbles/markup/SpanHandler.hx",lineNumber:102,className:"cobbles.markup.SpanHandler",methodName:"processFontFace"})},processSize:function(a,b){var c=b.get("size"),d=fe.parseFontPoints(c);switch(d._hx_index){case 0:a.pushFontSize(d.v);this.attributesApplied[this.level].push("size");break;case 1:pg.warning('Invalid font size "'+
c+'"',{fileName:"src/cobbles/markup/SpanHandler.hx",lineNumber:114,className:"cobbles.markup.SpanHandler",methodName:"processSize"})}},processColor:function(a,b){var c=b.get("color"),d=fe.parseColor(c);switch(d._hx_index){case 0:a.pushColor(d.v);this.attributesApplied[this.level].push("color");break;case 1:pg.warning('Invalid color "'+c+'"',{fileName:"src/cobbles/markup/SpanHandler.hx",lineNumber:126,className:"cobbles.markup.SpanHandler",methodName:"processColor"})}},processDir:function(a,b){var c=
b.get("dir"),d=fe.parseDirection(c);switch(d._hx_index){case 0:a.pushDirection(d.v);this.attributesApplied[this.level].push("dir");break;case 1:pg.warning('Invalid direction "'+c+'"',{fileName:"src/cobbles/markup/SpanHandler.hx",lineNumber:138,className:"cobbles.markup.SpanHandler",methodName:"processDir"})}},processScript:function(a,b){a.pushLanguage(b.get("script"));this.attributesApplied[this.level].push("script")},processLang:function(a,b){a.pushLanguage(b.get("lang"));this.attributesApplied[this.level].push("lang")},
processData:function(a,b,c){var d=v.substr(c,5,null);a.pushData(d,b.get(c));this.attributesApplied[this.level].push(c)},__class__:zh};var Ah=function(){};r["cobbles.markup.TextNodeHandler"]=Ah;Ah.__name__="cobbles.markup.TextNodeHandler";Ah.__isInterface__=!0;Ah.prototype={__class__:Ah};var xh=function(){};r["cobbles.markup.StandardTextNodeHandler"]=xh;xh.__name__="cobbles.markup.StandardTextNodeHandler";xh.__interfaces__=[Ah];xh.prototype={handleTextNode:function(a,b){if(b.nodeType==I.Document||
b.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(b.nodeType));a.addText(b.nodeValue)},__class__:xh};var Oi=function(a){this.engine=a;this.fontKeyStack=[a.get_font()];this.fontSizeStack=[a.get_fontSize()];var b=a.getCustomProperty("color");this.colorStack=[null==b?-16777216:b];this.scriptDirectionStack=[a.get_scriptDirection()];this.languageStack=[a.get_language()];this.scriptStack=[a.get_script()];this.dataStackMap=new ga};r["cobbles.markup.TextContext"]=Oi;Oi.__name__="cobbles.markup.TextContext";
Oi.prototype={get_fontSize:function(){if(0!=this.fontSizeStack.length){var a=this.fontSizeStack;return a[a.length-1]}return this.engine.get_fontSize()},addText:function(a){this.engine.addText(a)},addLineBreak:function(){this.engine.addLineBreak()},addInlineObject:function(a){this.engine.addInlineObject(a)},pushFont:function(a){this.fontKeyStack.push(a);this.engine.set_font(a)},popFont:function(){this.fontKeyStack.pop();if(0!=this.fontKeyStack.length){var a=this.fontKeyStack;this.engine.set_font(a[a.length-
1])}},pushFontSize:function(a){this.fontSizeStack.push(a);this.engine.set_fontSize(a)},popFontSize:function(){this.fontSizeStack.pop();if(0!=this.fontSizeStack.length){var a=this.fontSizeStack;this.engine.set_fontSize(a[a.length-1])}},pushColor:function(a){this.colorStack.push(a);this.engine.setCustomProperty("color",a)},popColor:function(){this.colorStack.pop();if(0!=this.colorStack.length){var a=this.colorStack;this.engine.setCustomProperty("color",a[a.length-1])}},pushDirection:function(a){this.scriptDirectionStack.push(a);
this.engine.set_scriptDirection(a)},popDirection:function(){this.scriptDirectionStack.pop();if(0!=this.scriptDirectionStack.length){var a=this.scriptDirectionStack;this.engine.set_scriptDirection(a[a.length-1])}},pushLanguage:function(a){this.languageStack.push(a);this.engine.set_language(a)},popLanguage:function(){this.languageStack.pop();if(0!=this.languageStack.length){var a=this.languageStack;this.engine.set_language(a[a.length-1])}},pushScript:function(a){this.scriptStack.push(a);this.engine.set_script(a)},
popScript:function(){this.scriptStack.pop();if(0!=this.scriptStack.length){var a=this.scriptStack;this.engine.set_script(a[a.length-1])}},pushData:function(a,b){var c=this.dataStackMap,c=null!=Q[a]?c.getReserved(a):c.h[a];if(null==c){var c=[],d=this.dataStackMap;null!=Q[a]?d.setReserved(a,c):d.h[a]=c}c.push(b)},popData:function(a){var b=this.dataStackMap,b=null!=Q[a]?b.getReserved(a):b.h[a];null!=b&&(b.pop(),0==b.length&&this.dataStackMap.remove(a))},__class__:Oi};var wk=function(){};r["cobbles.native.AdvanceTypeHelper"]=
wk;wk.__name__="cobbles.native.AdvanceTypeHelper";wk.fromNative=function(a){switch(a.value){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:throw new q("shouldn't reach here");}};var qh=function(){};r["cobbles.native.ScriptDirectionHelper"]=qh;qh.__name__="cobbles.native.ScriptDirectionHelper";qh.fromNative=function(a){switch(a.value){case 0:return 0;case 1:return 1;case 2:return 2;default:throw new q("shouldn't reach here");}};qh.toNative=function(a,
b){switch(b){case 0:return a.ScriptDirection.NotSpecified;case 1:return a.ScriptDirection.LTR;case 2:return a.ScriptDirection.RTL}};var ph=function(){};r["cobbles.native.TextAlignmentHelper"]=ph;ph.__name__="cobbles.native.TextAlignmentHelper";ph.fromNative=function(a){switch(a.value){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:throw new q("shouldn't reach here");}};ph.toNative=function(a,b){switch(b){case 0:return a.TextAlignment.NotSpecified;
case 1:return a.TextAlignment.Start;case 2:return a.TextAlignment.End;case 3:return a.TextAlignment.Left;case 4:return a.TextAlignment.Right;case 5:return a.TextAlignment.Center}};var Bh=function(){};r["cobbles.render.Bitmap"]=Bh;Bh.__name__="cobbles.render.Bitmap";Bh.__isInterface__=!0;Bh.prototype={__class__:Bh};var zf=function(a,b){this.width=a;this.height=b};r["cobbles.render.BaseBitmap"]=zf;zf.__name__="cobbles.render.BaseBitmap";zf.__interfaces__=[Bh];zf.prototype={getWidth:function(){return this.width},
getHeight:function(){return this.height},drawBytes:function(a,b,c,d,e){for(var f=0;f<d;)for(var g=f++,h=0,k=c;h<k;){var l=h++,E=a+l,t=b+g;if(!(0>E||E>=this.width||0>t||t>=this.height)){var l=g*c+l,x=this.getValue(E,t),x=x+e.b[l];255<x&&(x=255);this.setValue(E,t,x)}}},drawDebugBox:function(a,b,c,d,e){0<c&&--c;0<d&&--d;this.drawLine(a,b,a+c,b);this.drawLine(a,b+d,a+c,b+d);this.drawLine(a,b,a,b+d);this.drawLine(a+c,b,a+c,b+d);e&&(this.drawLine(a,b,a+c,b+d),this.drawLine(a,b+d,a+c,b))},drawLine:function(a,
b,c,d,e){null==e&&(e=255);for(var f=Math.max(Math.abs(c-a),Math.abs(d-b))|0,g=0,h=f+1;g<h;){var k=g++,l=0!=f?k/f:0,k=Math.round(a+l*(c-a)),l=Math.round(b+l*(d-b));0>k||(k>=this.width||0>l||l>=this.height)||this.setValue(k,l,e)}},getValue:function(a,b){throw new q("Not implemented");},setValue:function(a,b,c){throw new q("Not implemented");},__class__:zf};var ug=function(a,b){this.penPixelX=this.penPixelY=0;this.library=a;this.engine=b};r["cobbles.render.BaseRenderer"]=ug;ug.__name__="cobbles.render.BaseRenderer";
ug.prototype={render:function(){this.penPixelX=this.penPixelY=0;this.checkTileValidity();this.processAdvances()},checkTileValidity:function(){this.engine.tilesValid()||(this.engine.rasterize(),this.saveGlyphImages())},saveGlyphImages:function(){this.prepareGlyphImageStorage();for(var a=this.engine.tiles(),b=0;b<a.length;){var c=a[b];++b;var d=this.library.getGlyphInfo(c.glyphID);this.saveGlyphImage(c,d)}this.renderGlyphImageStorage()},prepareGlyphImageStorage:function(){},renderGlyphImageStorage:function(){},
saveGlyphImage:function(a,b){},processAdvances:function(){for(var a=this.engine.advances(),b=0;b<a.length;){var c=a[b];++b;this.processAdvance(c)}},processAdvance:function(a){switch(a.type){case 1:this.renderGlyph(a);break;case 2:this.renderInlineObject(a)}this.penPixelX+=a.advanceX;this.penPixelY+=a.advanceY},renderGlyph:function(a){},renderInlineObject:function(a){},__class__:ug};var Ch=function(a,b){zf.call(this,a,b);this.pixels=Ba.alloc(a,b,ha.RGBA)};r["cobbles.render.heaps.PixelsBitmap"]=Ch;
Ch.__name__="cobbles.render.heaps.PixelsBitmap";Ch.__super__=zf;Ch.prototype=J(zf.prototype,{setValue:function(a,b,c){this.pixels.setPixel(a,b,16777215|c<<24)},getValue:function(a,b){return this.pixels.getPixel(a,b)>>24},__class__:Ch});var Xi=function(a,b,c,d,e,f){this.x=a;this.y=b;this.width=c;this.height=d;this.imageOffsetX=e;this.imageOffsetY=f};r["cobbles.render.heaps.AtlasGlyph"]=Xi;Xi.__name__="cobbles.render.heaps.AtlasGlyph";Xi.prototype={__class__:Xi};var rh=function(a,b){this.glyphMap=new na;
this.width=a;this.height=b;this.bitmap=new Ch(a,b);this.texture=new S(a,b,null,ha.RGBA)};r["cobbles.render.heaps.TextureAtlas"]=rh;rh.__name__="cobbles.render.heaps.TextureAtlas";rh.prototype={clearTexture:function(){this.bitmap.pixels.clear(0)},addGlyph:function(a,b){this.bitmap.drawBytes(a.atlasX,a.atlasY,b.imageWidth,b.imageHeight,b.image);var c=this.glyphMap,d=a.glyphID,e=new Xi(a.atlasX,a.atlasY,b.imageWidth,b.imageHeight,b.imageOffsetX,b.imageOffsetY);c.h[d]=e},uploadTexture:function(){this.texture.uploadPixels(this.bitmap.pixels)},
hasGlyph:function(a){return this.glyphMap.h.hasOwnProperty(a)},getGlyphTile:function(a){var b=fa.fromTexture(this.texture);a=this.glyphMap.h[a];if(null==a)return b.setPosition(0,0),b.setSize(1,1),new Dh(b,0,0);b.setPosition(a.x,a.y);b.setSize(a.width,a.height);return new Dh(b,a.imageOffsetX,a.imageOffsetY)},clearGlyphs:function(){this.glyphMap.h={}},__class__:rh};var Dh=function(a,b,c){this.tile=a;this.offsetX=b;this.offsetY=c};r["cobbles.render.heaps.GlyphTile"]=Dh;Dh.__name__="cobbles.render.heaps.GlyphTile";
Dh.prototype={__class__:Dh};var sh=function(a,b,c){this.hasOverflow=!1;ug.call(this,a,b);this.textureAtlas=null!=c?c:new rh(512,512)};r["cobbles.render.heaps.TileGroupRenderer"]=sh;sh.__name__="cobbles.render.heaps.TileGroupRenderer";sh.__super__=ug;sh.prototype=J(ug.prototype,{newTileGroup:function(){return new vg(fa.fromTexture(this.textureAtlas.texture))},renderTileGroup:function(a){this.tileGroup=a;a.clear();this.render()},prepareGlyphImageStorage:function(){this.textureAtlas.clearTexture();this.hasOverflow=
this.engine.packTiles(this.textureAtlas.width,this.textureAtlas.height)},renderGlyphImageStorage:function(){this.textureAtlas.uploadTexture()},saveGlyphImage:function(a,b){this.textureAtlas.addGlyph(a,b)},renderGlyph:function(a){var b=this.textureAtlas.getGlyphTile(a.glyphID),c=this.penPixelX+a.glyphOffsetX+b.offsetX,d=this.penPixelY+a.glyphOffsetY+b.offsetY;a=a.customProperties.get("color");a=null==a?-1:a;this.tileGroup.content.add(c,d,(a>>16&255)/255,(a>>8&255)/255,(a&255)/255,(a>>24&255)/255,b.tile)},
renderInlineObject:function(a){},__class__:sh});var xk=function(){};r["cobbles.util.ArrayTools"]=xk;xk.__name__="cobbles.util.ArrayTools";xk.isEmpty=function(a){return 0==a.length};xk.last=function(a){return a[a.length-1]};var Bd=K["format.gif.Block"]={__ename__:!0,__constructs__:["BFrame","BExtension","BEOF"],BFrame:(s=function(a){return{_hx_index:0,frame:a,__enum__:"format.gif.Block",toString:m}},s.__params__=["frame"],s),BExtension:(s=function(a){return{_hx_index:1,extension:a,__enum__:"format.gif.Block",
toString:m}},s.__params__=["extension"],s),BEOF:{_hx_index:2,__enum__:"format.gif.Block",toString:m}};Bd.__empty_constructs__=[Bd.BEOF];var wg=K["format.gif.Extension"]={__ename__:!0,__constructs__:["EGraphicControl","EComment","EText","EApplicationExtension","EUnknown"],EGraphicControl:(s=function(a){return{_hx_index:0,gce:a,__enum__:"format.gif.Extension",toString:m}},s.__params__=["gce"],s),EComment:(s=function(a){return{_hx_index:1,text:a,__enum__:"format.gif.Extension",toString:m}},s.__params__=
["text"],s),EText:(s=function(a){return{_hx_index:2,pte:a,__enum__:"format.gif.Extension",toString:m}},s.__params__=["pte"],s),EApplicationExtension:(s=function(a){return{_hx_index:3,ext:a,__enum__:"format.gif.Extension",toString:m}},s.__params__=["ext"],s),EUnknown:(s=function(a,b){return{_hx_index:4,id:a,data:b,__enum__:"format.gif.Extension",toString:m}},s.__params__=["id","data"],s)};wg.__empty_constructs__=[];var Qk=K["format.gif.ApplicationExtension"]={__ename__:!0,__constructs__:["AENetscapeLooping",
"AEUnknown"],AENetscapeLooping:(s=function(a){return{_hx_index:0,loops:a,__enum__:"format.gif.ApplicationExtension",toString:m}},s.__params__=["loops"],s),AEUnknown:(s=function(a,b,c){return{_hx_index:1,name:a,version:b,data:c,__enum__:"format.gif.ApplicationExtension",toString:m}},s.__params__=["name","version","data"],s)};Qk.__empty_constructs__=[];var xg=K["format.gif.Version"]={__ename__:!0,__constructs__:["GIF87a","GIF89a","Unknown"],GIF87a:{_hx_index:0,__enum__:"format.gif.Version",toString:m},
GIF89a:{_hx_index:1,__enum__:"format.gif.Version",toString:m},Unknown:(s=function(a){return{_hx_index:2,version:a,__enum__:"format.gif.Version",toString:m}},s.__params__=["version"],s)};xg.__empty_constructs__=[xg.GIF87a,xg.GIF89a];var Zc=K["format.gif.DisposalMethod"]={__ename__:!0,__constructs__:["UNSPECIFIED","NO_ACTION","FILL_BACKGROUND","RENDER_PREVIOUS","UNDEFINED"],UNSPECIFIED:{_hx_index:0,__enum__:"format.gif.DisposalMethod",toString:m},NO_ACTION:{_hx_index:1,__enum__:"format.gif.DisposalMethod",
toString:m},FILL_BACKGROUND:{_hx_index:2,__enum__:"format.gif.DisposalMethod",toString:m},RENDER_PREVIOUS:{_hx_index:3,__enum__:"format.gif.DisposalMethod",toString:m},UNDEFINED:(s=function(a){return{_hx_index:4,index:a,__enum__:"format.gif.DisposalMethod",toString:m}},s.__params__=["index"],s)};Zc.__empty_constructs__=[Zc.UNSPECIFIED,Zc.NO_ACTION,Zc.FILL_BACKGROUND,Zc.RENDER_PREVIOUS];var Yi=function(a){this.i=a;a.set_bigEndian(!1)};r["format.gif.Reader"]=Yi;Yi.__name__="format.gif.Reader";Yi.prototype=
{read:function(){if(71!=this.i.readByte())throw new q("Invalid header");if(73!=this.i.readByte())throw new q("Invalid header");if(70!=this.i.readByte())throw new q("Invalid header");var a=this.i.readString(3),b=xg.GIF89a;switch(a){case "87a":b=xg.GIF87a;break;case "89a":b=xg.GIF89a;break;default:b=xg.Unknown(a)}var a=this.i.readUInt16(),c=this.i.readUInt16(),d=this.i.readByte(),e=this.i.readByte(),f=this.i.readByte(),a={width:a,height:c,hasGlobalColorTable:128==(d&128),colorResolution:(d&112)>>>4,
sorted:8==(d&8),globalColorTableSize:2<<(d&7),backgroundColorIndex:e,pixelAspectRatio:0!=f?(f+15)/64:1},c=null;a.hasGlobalColorTable&&(c=this.readColorTable(a.globalColorTableSize));for(d=new Nc;!(e=this.readBlock(),d.add(e),e==Bd.BEOF););return{version:b,logicalScreenDescriptor:a,globalColorTable:c,blocks:d}},readBlock:function(){switch(this.i.readByte()){case 33:return this.readExtension();case 44:return this.readImage()}return Bd.BEOF},readImage:function(){var a=this.i.readUInt16(),b=this.i.readUInt16(),
c=this.i.readUInt16(),d=this.i.readUInt16(),e=this.i.readByte(),f=128==(e&128),g=64==(e&64),h=32==(e&32),e=2<<(e&7),k=null;f&&(k=this.readColorTable(e));return Bd.BFrame({x:a,y:b,width:c,height:d,localColorTable:f,interlaced:g,sorted:h,localColorTableSize:e,pixels:this.readPixels(c,d,g),colorTable:k})},readPixels:function(a,b,c){for(var d=this.i,e=a*b,f=new N(new ArrayBuffer(e)),g=d.readByte(),h=d.readByte()-1,k=d.readByte(),l=8,E=1<<g,t=E+1,x=g+1,C=1<<x,M=C-1,m=[],p=0;p<E;){var n=p++;m[n]=[n]}for(var p=
[],n=E+2,r,H=0,s=0;H<e;){for(r=s;l<x&&0!=h;)k|=d.readByte()<<l,l+=8,--h,0==h&&(h=d.readByte());s=k&M;k>>=x;l-=x;if(s==E)p=m.slice(),n=E+2,x=g+1,C=1<<x,M=C-1;else{if(s==t)break;if(s<n)r!=E&&(r=p[r].slice(),r.push(p[s][0]),p[n++]=r);else{if(s!=n)throw new q("Invalid LZW code. Excepted: "+n+", got: "+s);r=p[r].slice();r.push(r[0]);p[n++]=r}r=p[s];for(var u=0;u<r.length;){var A=r[u];++u;f.b[H++]=A}n==C&&12>x&&(++x,C=1<<x,M=C-1)}}for(;0<h;)d.readByte(),--h,0==h&&(h=d.readByte());for(;H<e;)f.b[H++]=0;c&&
(c=new N(new ArrayBuffer(e)),d=this.deinterlace(f,c,8,0,0,a,b),d=this.deinterlace(f,c,8,4,d,a,b),d=this.deinterlace(f,c,4,2,d,a,b),this.deinterlace(f,c,2,1,d,a,b),f=c);return f},deinterlace:function(a,b,c,d,e,f,g){for(;d<g;)b.blit(d*f,a,e,f),e+=f,d+=c;return e},readExtension:function(){var a=this.i.readByte();switch(a){case 1:if(12!=this.i.readByte())throw new q("Incorrect size of Plain Text Extension introducer block.");for(var a=this.i.readUInt16(),b=this.i.readUInt16(),c=this.i.readUInt16(),d=
this.i.readUInt16(),e=this.i.readByte(),f=this.i.readByte(),g=this.i.readByte(),h=this.i.readByte(),k=new pc,l=new N(new ArrayBuffer(255)),E=this.i.readByte();0!=E;)this.i.readBytes(l,0,E),k.writeBytes(l,0,E),E=this.i.readByte();k.flush();l=k.getBytes();k.close();return Bd.BExtension(wg.EText({textGridX:a,textGridY:b,textGridWidth:c,textGridHeight:d,charCellWidth:e,charCellHeight:f,textForegroundColorIndex:g,textBackgroundColorIndex:h,text:l.toString()}));case 249:if(4!=this.i.readByte())throw new q("Incorrect Graphic Control Extension block size!");
a=this.i.readByte();switch((a&28)>>2){case 0:b=Zc.UNSPECIFIED;break;case 1:b=Zc.NO_ACTION;break;case 2:b=Zc.FILL_BACKGROUND;break;case 3:b=Zc.RENDER_PREVIOUS;break;default:b=Zc.UNDEFINED((a&28)>>2)}a=Bd.BExtension(wg.EGraphicControl({disposalMethod:b,userInput:2==(a&2),hasTransparentColor:1==(a&1),delay:this.i.readUInt16(),transparentIndex:this.i.readByte()}));this.i.readByte();return a;case 254:a=new pc;b=new N(new ArrayBuffer(255));for(c=this.i.readByte();0!=c;)this.i.readBytes(b,0,c),a.writeBytes(b,
0,c),c=this.i.readByte();a.flush();b=a.getBytes();a.close();return Bd.BExtension(wg.EComment(b.toString()));case 255:return this.readApplicationExtension();default:b=new pc;c=new N(new ArrayBuffer(255));for(d=this.i.readByte();0!=d;)this.i.readBytes(c,0,d),b.writeBytes(c,0,d),d=this.i.readByte();b.flush();c=b.getBytes();b.close();return Bd.BExtension(wg.EUnknown(a,c))}},readApplicationExtension:function(){if(11!=this.i.readByte())throw new q("Incorrect size of Application Extension introducer block.");
for(var a=this.i.readString(8),b=this.i.readString(3),c=new pc,d=new N(new ArrayBuffer(255)),e=this.i.readByte();0!=e;)this.i.readBytes(d,0,e),c.writeBytes(d,0,e),e=this.i.readByte();c.flush();d=c.getBytes();c.close();c=d;return"NETSCAPE"==a&&"2.0"==b&&1==c.b[0]?Bd.BExtension(wg.EApplicationExtension(Qk.AENetscapeLooping(c.b[1]|c.b[2]<<8))):Bd.BExtension(wg.EApplicationExtension(Qk.AEUnknown(a,b,c)))},readBlocks:function(){for(var a=new pc,b=new N(new ArrayBuffer(255)),c=this.i.readByte();0!=c;)this.i.readBytes(b,
0,c),a.writeBytes(b,0,c),c=this.i.readByte();a.flush();b=a.getBytes();a.close();return b},readColorTable:function(a){a*=3;for(var b=new N(new ArrayBuffer(a)),c=0;c<a;){var d=this.i.readByte();b.b[c]=d;d=this.i.readByte();b.b[c+1]=d;d=this.i.readByte();b.b[c+2]=d;c+=3}return b},__class__:Yi};var Jb=function(){};r["format.gif.Tools"]=Jb;Jb.__name__="format.gif.Tools";Jb.framesCount=function(a){var b=0;for(a=a.blocks.h;null!=a;){var c=a.item;a=a.next;0==c._hx_index&&++b}return b};Jb.frame=function(a,
b){for(var c=0,d=a.blocks.h;null!=d;){var e=d.item,d=d.next;if(0==e._hx_index){e=e.frame;if(c==b)return e;++c}}return null};Jb.graphicControl=function(a,b){for(var c=0,d=null,e=a.blocks.h;null!=e;){var f=e.item,e=e.next;switch(f._hx_index){case 0:if(c==b)return d;d=null;++c;break;case 1:f=f.extension,0==f._hx_index&&(d=f.gce)}}return null};Jb.extractBGRA=function(a,b){for(var c=null,d=0,e=a.blocks.h;null!=e;){var f=e.item,e=e.next;switch(f._hx_index){case 0:f=f.frame;if(d==b){d=new N(new ArrayBuffer(4*
f.width*f.height));e=f.localColorTable?f.colorTable:a.globalColorTable;if(null==e)throw new q("Frame does not have a color table!");for(var c=null!=c&&c.hasTransparentColor?3*c.transparentIndex:-1,g=0,h=0,k=f.pixels.length;h<k;){var l=h++,l=3*f.pixels.b[l];d.b[g]=e.b[l+2];d.b[g+1]=e.b[l+1];d.b[g+2]=e.b[l];d.b[g+3]=c==l?0:255;g+=4}return d}++d;c=null;break;case 1:f=f.extension,0==f._hx_index&&(c=f.gce)}}return null};Jb.extractRGBA=function(a,b){for(var c=null,d=0,e=a.blocks.h;null!=e;){var f=e.item,
e=e.next;switch(f._hx_index){case 0:f=f.frame;if(d==b){d=new N(new ArrayBuffer(4*f.width*f.height));e=f.localColorTable?f.colorTable:a.globalColorTable;if(null==e)throw new q("Frame does not have a color table!");for(var c=null!=c&&c.hasTransparentColor?3*c.transparentIndex:-1,g=0,h=0,k=f.pixels.length;h<k;){var l=h++,l=3*f.pixels.b[l];d.b[g]=e.b[l];d.b[g+1]=e.b[l+1];d.b[g+2]=e.b[l+2];d.b[g+3]=c==l?0:255;g+=4}return d}++d;c=null;break;case 1:f=f.extension,0==f._hx_index&&(c=f.gce)}}return null};Jb.extractFullBGRA=
function(a,b){for(var c=null,d=0,e=new N(new ArrayBuffer(4*a.logicalScreenDescriptor.width*a.logicalScreenDescriptor.height)),f=a.blocks.h;null!=f;){var g=f.item,f=f.next;switch(g._hx_index){case 0:var g=g.frame,h=g.localColorTable?g.colorTable:a.globalColorTable;if(null==h)throw new q("Frame does not have a color table!");var k=null!=c&&c.hasTransparentColor?3*c.transparentIndex:-1,l=g.pixels,E=0,t=4*(g.y*a.logicalScreenDescriptor.width+g.x),x=4*(a.logicalScreenDescriptor.width-g.width)+4;switch((d!=
b&&null!=c?c.disposalMethod:Zc.NO_ACTION)._hx_index){case 2:h=0;for(l=l.length;h<l;)h++,e.b[t]=0,e.b[t+1]=0,e.b[t+2]=0,e.b[t+3]=0,++E==g.width?(E=0,t+=x):t+=4;break;case 3:break;default:for(var c=0,C=l.length;c<C;){var M=c++,M=3*l.b[M];k!=M&&(e.b[t]=h.b[M+2],e.b[t+1]=h.b[M+1],e.b[t+2]=h.b[M],e.b[t+3]=255);++E==g.width?(E=0,t+=x):t+=4}}if(d==b)return e;++d;c=null;break;case 1:g=g.extension,0==g._hx_index&&(c=g.gce)}}return e};Jb.extractFullRGBA=function(a,b){for(var c=null,d=0,e=new N(new ArrayBuffer(4*
a.logicalScreenDescriptor.width*a.logicalScreenDescriptor.height)),f=a.blocks.h;null!=f;){var g=f.item,f=f.next;switch(g._hx_index){case 0:var g=g.frame,h=g.localColorTable?g.colorTable:a.globalColorTable;if(null==h)throw new q("Frame does not have a color table!");var k=null!=c&&c.hasTransparentColor?3*c.transparentIndex:-1,l=g.pixels,E=0,t=4*(g.y*a.logicalScreenDescriptor.width+g.x),x=4*(a.logicalScreenDescriptor.width-g.width)+4;switch((d!=b&&null!=c?c.disposalMethod:Zc.NO_ACTION)._hx_index){case 2:h=
0;for(l=l.length;h<l;)h++,e.b[t]=0,e.b[t+1]=0,e.b[t+2]=0,e.b[t+3]=0,++E==g.width?(E=0,t+=x):t+=4;break;case 3:break;default:for(var c=0,C=l.length;c<C;){var M=c++,M=3*l.b[M];k!=M&&(e.b[t]=h.b[M],e.b[t+1]=h.b[M+1],e.b[t+2]=h.b[M+2],e.b[t+3]=255);++E==g.width?(E=0,t+=x):t+=4}}if(d==b)return e;++d;c=null;break;case 1:g=g.extension,0==g._hx_index&&(c=g.gce)}}return e};Jb.loopCount=function(a){for(a=a.blocks.h;null!=a;){var b=a.item;a=a.next;if(1==b._hx_index&&(b=b.extension,3==b._hx_index&&(b=b.ext,0==
b._hx_index)))return b.loops}return 1};Jb.log2=function(a){return Math.log(a)/Jb.LN2};var za=K["format.mp3.SamplingRate"]={__ename__:!0,__constructs__:"SR_8000 SR_11025 SR_12000 SR_22050 SR_24000 SR_32000 SR_44100 SR_48000 SR_Bad".split(" "),SR_8000:{_hx_index:0,__enum__:"format.mp3.SamplingRate",toString:m},SR_11025:{_hx_index:1,__enum__:"format.mp3.SamplingRate",toString:m},SR_12000:{_hx_index:2,__enum__:"format.mp3.SamplingRate",toString:m},SR_22050:{_hx_index:3,__enum__:"format.mp3.SamplingRate",
toString:m},SR_24000:{_hx_index:4,__enum__:"format.mp3.SamplingRate",toString:m},SR_32000:{_hx_index:5,__enum__:"format.mp3.SamplingRate",toString:m},SR_44100:{_hx_index:6,__enum__:"format.mp3.SamplingRate",toString:m},SR_48000:{_hx_index:7,__enum__:"format.mp3.SamplingRate",toString:m},SR_Bad:{_hx_index:8,__enum__:"format.mp3.SamplingRate",toString:m}};za.__empty_constructs__=[za.SR_8000,za.SR_11025,za.SR_12000,za.SR_22050,za.SR_24000,za.SR_32000,za.SR_44100,za.SR_48000,za.SR_Bad];var A=K["format.mp3.Bitrate"]=
{__ename__:!0,__constructs__:"BR_8 BR_16 BR_24 BR_32 BR_40 BR_48 BR_56 BR_64 BR_80 BR_96 BR_112 BR_128 BR_144 BR_160 BR_176 BR_192 BR_224 BR_256 BR_288 BR_320 BR_352 BR_384 BR_416 BR_448 BR_Free BR_Bad".split(" "),BR_8:{_hx_index:0,__enum__:"format.mp3.Bitrate",toString:m},BR_16:{_hx_index:1,__enum__:"format.mp3.Bitrate",toString:m},BR_24:{_hx_index:2,__enum__:"format.mp3.Bitrate",toString:m},BR_32:{_hx_index:3,__enum__:"format.mp3.Bitrate",toString:m},BR_40:{_hx_index:4,__enum__:"format.mp3.Bitrate",
toString:m},BR_48:{_hx_index:5,__enum__:"format.mp3.Bitrate",toString:m},BR_56:{_hx_index:6,__enum__:"format.mp3.Bitrate",toString:m},BR_64:{_hx_index:7,__enum__:"format.mp3.Bitrate",toString:m},BR_80:{_hx_index:8,__enum__:"format.mp3.Bitrate",toString:m},BR_96:{_hx_index:9,__enum__:"format.mp3.Bitrate",toString:m},BR_112:{_hx_index:10,__enum__:"format.mp3.Bitrate",toString:m},BR_128:{_hx_index:11,__enum__:"format.mp3.Bitrate",toString:m},BR_144:{_hx_index:12,__enum__:"format.mp3.Bitrate",toString:m},
BR_160:{_hx_index:13,__enum__:"format.mp3.Bitrate",toString:m},BR_176:{_hx_index:14,__enum__:"format.mp3.Bitrate",toString:m},BR_192:{_hx_index:15,__enum__:"format.mp3.Bitrate",toString:m},BR_224:{_hx_index:16,__enum__:"format.mp3.Bitrate",toString:m},BR_256:{_hx_index:17,__enum__:"format.mp3.Bitrate",toString:m},BR_288:{_hx_index:18,__enum__:"format.mp3.Bitrate",toString:m},BR_320:{_hx_index:19,__enum__:"format.mp3.Bitrate",toString:m},BR_352:{_hx_index:20,__enum__:"format.mp3.Bitrate",toString:m},
BR_384:{_hx_index:21,__enum__:"format.mp3.Bitrate",toString:m},BR_416:{_hx_index:22,__enum__:"format.mp3.Bitrate",toString:m},BR_448:{_hx_index:23,__enum__:"format.mp3.Bitrate",toString:m},BR_Free:{_hx_index:24,__enum__:"format.mp3.Bitrate",toString:m},BR_Bad:{_hx_index:25,__enum__:"format.mp3.Bitrate",toString:m}};A.__empty_constructs__=[A.BR_8,A.BR_16,A.BR_24,A.BR_32,A.BR_40,A.BR_48,A.BR_56,A.BR_64,A.BR_80,A.BR_96,A.BR_112,A.BR_128,A.BR_144,A.BR_160,A.BR_176,A.BR_192,A.BR_224,A.BR_256,A.BR_288,
A.BR_320,A.BR_352,A.BR_384,A.BR_416,A.BR_448,A.BR_Free,A.BR_Bad];var Ma=function(){};r["format.mp3.MPEG"]=Ma;Ma.__name__="format.mp3.MPEG";Ma.enum2Num=function(a){switch(a._hx_index){case 0:return 3;case 1:return 2;case 2:return 0;case 3:return Ma.Reserved}};Ma.num2Enum=function(a){switch(a){case 0:return ge.MPEG_V25;case 2:return ge.MPEG_V2;case 3:return ge.MPEG_V1;default:return ge.MPEG_Reserved}};Ma.srNum2Enum=function(a){switch(a){case 8E3:return za.SR_8000;case 11025:return za.SR_11025;case 12E3:return za.SR_12000;
case 22050:return za.SR_22050;case 24E3:return za.SR_24000;case 32E3:return za.SR_32000;case 44100:return za.SR_44100;case 48E3:return za.SR_48000;default:return za.SR_Bad}};Ma.srEnum2Num=function(a){switch(a._hx_index){case 0:return 8E3;case 1:return 11025;case 2:return 12E3;case 3:return 22050;case 4:return 24E3;case 5:return 32E3;case 6:return 44100;case 7:return 48E3;case 8:return-1}};Ma.getBitrateIdx=function(a,b,c){b=(b==ge.MPEG_V1?Ma.V1_Bitrates:Ma.V2_Bitrates)[ac.enum2Num(c)];if(b[0]==a)return 0;
if(b[1]==a)return 1;if(b[2]==a)return 2;if(b[3]==a)return 3;if(b[4]==a)return 4;if(b[5]==a)return 5;if(b[6]==a)return 6;if(b[7]==a)return 7;if(b[8]==a)return 8;if(b[9]==a)return 9;if(b[10]==a)return 10;if(b[11]==a)return 11;if(b[12]==a)return 12;if(b[13]==a)return 13;if(b[14]==a)return 14;if(b[15]==a)return 15;throw new q("Bitrate index not found");};Ma.getSamplingRateIdx=function(a,b){var c=Ma.SamplingRates[Ma.enum2Num(b)];if(c[0]==a)return 0;if(c[1]==a)return 1;if(c[2]==a)return 2;if(c[3]==a)return 3;
throw new q("Sampling rate index not found");};Ma.bitrateEnum2Num=function(a){switch(a._hx_index){case 0:return 8;case 1:return 16;case 2:return 24;case 3:return 32;case 4:return 40;case 5:return 48;case 6:return 56;case 7:return 64;case 8:return 80;case 9:return 96;case 10:return 112;case 11:return 128;case 12:return 144;case 13:return 160;case 14:return 176;case 15:return 192;case 16:return 224;case 17:return 256;case 18:return 288;case 19:return 320;case 20:return 352;case 21:return 384;case 22:return 416;
case 23:return 448;case 24:return 0;case 25:return-1}};Ma.bitrateNum2Enum=function(a){switch(a){case 0:return A.BR_Free;case 8:return A.BR_8;case 16:return A.BR_16;case 24:return A.BR_24;case 32:return A.BR_32;case 40:return A.BR_40;case 48:return A.BR_48;case 56:return A.BR_56;case 64:return A.BR_64;case 80:return A.BR_80;case 96:return A.BR_96;case 112:return A.BR_112;case 128:return A.BR_128;case 144:return A.BR_144;case 160:return A.BR_160;case 176:return A.BR_176;case 192:return A.BR_192;case 224:return A.BR_224;
case 256:return A.BR_256;case 288:return A.BR_288;case 320:return A.BR_320;case 352:return A.BR_352;case 384:return A.BR_384;case 416:return A.BR_416;case 448:return A.BR_448;default:return A.BR_Bad}};var ac=function(){};r["format.mp3.CLayer"]=ac;ac.__name__="format.mp3.CLayer";ac.enum2Num=function(a){switch(a._hx_index){case 0:return ac.LReserved;case 1:return ac.LLayer3;case 2:return ac.LLayer2;case 3:return ac.LLayer1}};ac.num2Enum=function(a){switch(a){case 1:return Cd.Layer3;case 2:return Cd.Layer2;
case 3:return Cd.Layer1;default:return Cd.LayerReserved}};var Fe=function(){};r["format.mp3.CChannelMode"]=Fe;Fe.__name__="format.mp3.CChannelMode";Fe.enum2Num=function(a){switch(a._hx_index){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3}};Fe.num2Enum=function(a){switch(a){case 0:return he.Stereo;case 1:return he.JointStereo;case 2:return he.DualChannel;case 3:return he.Mono;default:throw new q("assert");}};var Ge=function(){};r["format.mp3.CEmphasis"]=Ge;Ge.__name__="format.mp3.CEmphasis";
Ge.enum2Num=function(a){switch(a._hx_index){case 0:return 0;case 1:return 1;case 2:return 3;case 3:return 2}};Ge.num2Enum=function(a){switch(a){case 0:return He.NoEmphasis;case 1:return He.Ms50_15;case 2:return He.InvalidEmphasis;case 3:return He.CCIT_J17;default:throw new q("assert");}};var ge=K["format.mp3.MPEGVersion"]={__ename__:!0,__constructs__:["MPEG_V1","MPEG_V2","MPEG_V25","MPEG_Reserved"],MPEG_V1:{_hx_index:0,__enum__:"format.mp3.MPEGVersion",toString:m},MPEG_V2:{_hx_index:1,__enum__:"format.mp3.MPEGVersion",
toString:m},MPEG_V25:{_hx_index:2,__enum__:"format.mp3.MPEGVersion",toString:m},MPEG_Reserved:{_hx_index:3,__enum__:"format.mp3.MPEGVersion",toString:m}};ge.__empty_constructs__=[ge.MPEG_V1,ge.MPEG_V2,ge.MPEG_V25,ge.MPEG_Reserved];var Cd=K["format.mp3.Layer"]={__ename__:!0,__constructs__:["LayerReserved","Layer3","Layer2","Layer1"],LayerReserved:{_hx_index:0,__enum__:"format.mp3.Layer",toString:m},Layer3:{_hx_index:1,__enum__:"format.mp3.Layer",toString:m},Layer2:{_hx_index:2,__enum__:"format.mp3.Layer",
toString:m},Layer1:{_hx_index:3,__enum__:"format.mp3.Layer",toString:m}};Cd.__empty_constructs__=[Cd.LayerReserved,Cd.Layer3,Cd.Layer2,Cd.Layer1];var he=K["format.mp3.ChannelMode"]={__ename__:!0,__constructs__:["Stereo","JointStereo","DualChannel","Mono"],Stereo:{_hx_index:0,__enum__:"format.mp3.ChannelMode",toString:m},JointStereo:{_hx_index:1,__enum__:"format.mp3.ChannelMode",toString:m},DualChannel:{_hx_index:2,__enum__:"format.mp3.ChannelMode",toString:m},Mono:{_hx_index:3,__enum__:"format.mp3.ChannelMode",
toString:m}};he.__empty_constructs__=[he.Stereo,he.JointStereo,he.DualChannel,he.Mono];var He=K["format.mp3.Emphasis"]={__ename__:!0,__constructs__:["NoEmphasis","Ms50_15","CCIT_J17","InvalidEmphasis"],NoEmphasis:{_hx_index:0,__enum__:"format.mp3.Emphasis",toString:m},Ms50_15:{_hx_index:1,__enum__:"format.mp3.Emphasis",toString:m},CCIT_J17:{_hx_index:2,__enum__:"format.mp3.Emphasis",toString:m},InvalidEmphasis:{_hx_index:3,__enum__:"format.mp3.Emphasis",toString:m}};He.__empty_constructs__=[He.NoEmphasis,
He.Ms50_15,He.CCIT_J17,He.InvalidEmphasis];var Fh=K["format.mp3.FrameType"]={__ename__:!0,__constructs__:["FT_MP3","FT_NONE"],FT_MP3:{_hx_index:0,__enum__:"format.mp3.FrameType",toString:m},FT_NONE:{_hx_index:1,__enum__:"format.mp3.FrameType",toString:m}};Fh.__empty_constructs__=[Fh.FT_MP3,Fh.FT_NONE];var $i=function(a){this.i=a;a.set_bigEndian(!0);this.bits=new Zi(a);this.sampleSize=this.samples=0;this.any_read=!1};r["format.mp3.Reader"]=$i;$i.__name__="format.mp3.Reader";$i.prototype={skipID3v2:function(){this.id3v2_version=
this.i.readUInt16();this.id3v2_flags=this.i.readByte();var a=this.i.readByte()&127,a=a<<7|this.i.readByte()&127,a=a<<7|this.i.readByte()&127,a=a<<7|this.i.readByte()&127;this.id3v2_data=this.i.read(a)},seekFrame:function(){try{for(var a;;)if(a=this.i.readByte(),this.any_read||(this.any_read=!0,73==a&&(a=this.i.readByte(),68==a&&(a=this.i.readByte(),51==a&&this.skipID3v2()))),255==a&&(this.bits.nbits=0,a=this.bits.readBits(3),7==a))return Fh.FT_MP3}catch(b){$.lastException=b;if((b instanceof q?b.val:
b)instanceof qd)return Fh.FT_NONE;throw b;}},readFrames:function(){for(var a=[],b;;){b=this.seekFrame();if(b==Fh.FT_NONE)break;switch(b._hx_index){case 0:b=this.readFrame(),null!=b&&a.push(b)}}return a},readFrameHeader:function(){var a=this.bits.readBits(2),b=this.bits.readBits(2),c=!this.bits.readBit();if(a==Ma.Reserved||b==ac.LReserved)return null;var d=this.bits.readBits(4),d=kb.getBitrate(a,b,d),e=this.bits.readBits(2),e=kb.getSamplingRate(a,e),f=this.bits.readBit(),g=this.bits.readBit();if(d==
A.BR_Bad||d==A.BR_Free||e==za.SR_Bad)return null;var h=this.bits.readBits(2),k=this.bits.readBit(),l=this.bits.readBit(),E=this.bits.readBit(),t=this.bits.readBit(),x=this.bits.readBits(2),C=0;c&&(C=this.i.readUInt16());return{version:Ma.num2Enum(a),layer:ac.num2Enum(b),hasCrc:c,crc16:C,bitrate:d,samplingRate:e,isPadded:f,privateBit:g,channelMode:Fe.num2Enum(h),isIntensityStereo:k,isMSStereo:l,isCopyrighted:E,isOriginal:t,emphasis:Ge.num2Enum(x)}},readFrame:function(){var a=this.readFrameHeader();
if(null==a||kb.isInvalidFrameHeader(a))return null;try{var b=this.i.read(kb.getSampleDataSizeHdr(a));this.samples+=kb.getSampleCountHdr(a);this.sampleSize+=b.length;return{header:a,data:b}}catch(c){$.lastException=c;if((c instanceof q?c.val:c)instanceof qd)return null;throw c;}},read:function(){return{frames:this.readFrames(),sampleCount:this.samples,sampleSize:this.sampleSize,id3v2:null==this.id3v2_data?null:{versionBytes:this.id3v2_version,flagByte:this.id3v2_flags,data:this.id3v2_data}}},__class__:$i};
var kb=function(){};r["format.mp3.Tools"]=kb;kb.__name__="format.mp3.Tools";kb.getBitrate=function(a,b,c){return a==Ma.Reserved||b==ac.LReserved?A.BR_Bad:(3==a?Ma.V1_Bitrates:Ma.V2_Bitrates)[b][c]};kb.getSamplingRate=function(a,b){return Ma.SamplingRates[a][b]};kb.isInvalidFrameHeader=function(a){return a.version==ge.MPEG_Reserved||a.layer==Cd.LayerReserved||a.bitrate==A.BR_Bad||a.bitrate==A.BR_Free?!0:a.samplingRate==za.SR_Bad};kb.getSampleDataSize=function(a,b,c,d,e){return(1E3*(3==a?144:72)*b/
c|0)+(d?1:0)-(e?2:0)-4};kb.getSampleDataSizeHdr=function(a){return kb.getSampleDataSize(Ma.enum2Num(a.version),Ma.bitrateEnum2Num(a.bitrate),Ma.srEnum2Num(a.samplingRate),a.isPadded,a.hasCrc)};kb.getSampleCount=function(a){return 3==a?1152:576};kb.getSampleCountHdr=function(a){return kb.getSampleCount(Ma.enum2Num(a.version))};kb.getFrameInfo=function(a){return n.string(a.header.version)+", "+n.string(a.header.layer)+", "+n.string(a.header.channelMode)+", "+n.string(a.header.samplingRate)+" Hz, "+
n.string(a.header.bitrate)+" kbps Emphasis: "+n.string(a.header.emphasis)+", "+(a.header.hasCrc?"(CRC) ":"")+(a.header.isPadded?"(Padded) ":"")+(a.header.isIntensityStereo?"(Intensity Stereo) ":"")+(a.header.isMSStereo?"(MS Stereo) ":"")+(a.header.isCopyrighted?"(Copyrighted) ":"")+(a.header.isOriginal?"(Original) ":"")};var Dd=K["format.png.Color"]={__ename__:!0,__constructs__:["ColGrey","ColTrue","ColIndexed"],ColGrey:(s=function(a){return{_hx_index:0,alpha:a,__enum__:"format.png.Color",toString:m}},
s.__params__=["alpha"],s),ColTrue:(s=function(a){return{_hx_index:1,alpha:a,__enum__:"format.png.Color",toString:m}},s.__params__=["alpha"],s),ColIndexed:{_hx_index:2,__enum__:"format.png.Color",toString:m}};Dd.__empty_constructs__=[Dd.ColIndexed];var sa=K["format.png.Chunk"]={__ename__:!0,__constructs__:["CEnd","CHeader","CData","CPalette","CUnknown"],CEnd:{_hx_index:0,__enum__:"format.png.Chunk",toString:m},CHeader:(s=function(a){return{_hx_index:1,h:a,__enum__:"format.png.Chunk",toString:m}},s.__params__=
["h"],s),CData:(s=function(a){return{_hx_index:2,b:a,__enum__:"format.png.Chunk",toString:m}},s.__params__=["b"],s),CPalette:(s=function(a){return{_hx_index:3,b:a,__enum__:"format.png.Chunk",toString:m}},s.__params__=["b"],s),CUnknown:(s=function(a,b){return{_hx_index:4,id:a,data:b,__enum__:"format.png.Chunk",toString:m}},s.__params__=["id","data"],s)};sa.__empty_constructs__=[sa.CEnd];var aj=function(a){this.i=a;a.set_bigEndian(!0);this.checkCRC=!0};r["format.png.Reader"]=aj;aj.__name__="format.png.Reader";
aj.prototype={read:function(){if(137!=this.i.readByte())throw new q("Invalid header");if(80!=this.i.readByte())throw new q("Invalid header");if(78!=this.i.readByte())throw new q("Invalid header");if(71!=this.i.readByte())throw new q("Invalid header");if(13!=this.i.readByte())throw new q("Invalid header");if(10!=this.i.readByte())throw new q("Invalid header");if(26!=this.i.readByte())throw new q("Invalid header");if(10!=this.i.readByte())throw new q("Invalid header");for(var a=new Nc;;){var b=this.readChunk();
a.add(b);if(b==sa.CEnd)break}return a},readHeader:function(a){a.set_bigEndian(!0);var b=a.readInt32(),c=a.readInt32(),d=a.readByte(),e=a.readByte();switch(e){case 0:e=Dd.ColGrey(!1);break;case 2:e=Dd.ColTrue(!1);break;case 3:e=Dd.ColIndexed;break;case 4:e=Dd.ColGrey(!0);break;case 6:e=Dd.ColTrue(!0);break;default:throw new q("Unknown color model "+e+":"+d);}var f=a.readByte(),g=a.readByte();if(0!=f||0!=g)throw new q("Invalid header");a=a.readByte();if(0!=a&&1!=a)throw new q("Invalid header");return{width:b,
height:c,colbits:d,color:e,interlaced:1==a}},readChunk:function(){var a=this.i.readInt32(),b=this.i.readString(4),a=this.i.read(a),c=this.i.readInt32();if(this.checkCRC){for(var d=-1,e=(d^v.cca(b,0))&255,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,d=d>>>8^e>>>1^-(e&1)&-306674912,e=(d^v.cca(b,1))&255,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&
1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,d=d>>>8^e>>>1^-(e&1)&-306674912,e=(d^v.cca(b,2))&255,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,d=d>>>8^e>>>1^-(e&1)&-306674912,e=(d^v.cca(b,3))&255,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,
e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,d=d>>>8^e>>>1^-(e&1)&-306674912,e=a.b.bufferValue,f=0,g=a.length;f<g;)var h=f++,h=(d^e.bytes[h])&255,h=h>>>1^-(h&1)&-306674912,h=h>>>1^-(h&1)&-306674912,h=h>>>1^-(h&1)&-306674912,h=h>>>1^-(h&1)&-306674912,h=h>>>1^-(h&1)&-306674912,h=h>>>1^-(h&1)&-306674912,h=h>>>1^-(h&1)&-306674912,h=h>>>1^-(h&1)&-306674912,d=d>>>8^h;if((d^-1)!=c)throw new q("CRC check failure");}switch(b){case "IDAT":return sa.CData(a);case "IEND":return sa.CEnd;
case "IHDR":return sa.CHeader(this.readHeader(new Vb(a)));case "PLTE":return sa.CPalette(a);default:return sa.CUnknown(b,a)}},__class__:aj};var yc=function(){};r["format.png.Tools"]=yc;yc.__name__="format.png.Tools";yc.getHeader=function(a){for(a=a.h;null!=a;){var b=a.item;a=a.next;if(1==b._hx_index)return b.h}throw new q("Header not found");};yc.getPalette=function(a){for(a=a.h;null!=a;){var b=a.item;a=a.next;if(3==b._hx_index)return b.b}return null};yc.filter=function(a,b,c,d,e,f,g){null==g&&(g=
4);var h=0==c?0:a.b[f-d];a=0==b||0==c?0:a.b[f-d-g];d=e+h-a;b=d-e;0>b&&(b=-b);c=d-h;0>c&&(c=-c);d-=a;0>d&&(d=-d);return b<=c&&b<=d?e:c<=d?h:a};yc.reverseBytes=function(a){for(var b=0,c=0,d=a.length>>2;c<d;){c++;var e=a.b[b],f=a.b[b+1],g=a.b[b+2],h=a.b[b+3];a.b[b++]=h;a.b[b++]=g;a.b[b++]=f;a.b[b++]=e}};yc.extractGrey=function(a){var b=yc.getHeader(a),c=new N(new ArrayBuffer(b.width*b.height)),d=null,e=null;for(a=a.h;null!=a;){var f=a.item;a=a.next;2==f._hx_index&&(f=f.b,null!=e?e.add(f):null==d?d=f:
(e=new ie,e.add(d),e.add(f),d=null))}null!=e&&(d=e.getBytes());if(null==d)throw new q("Data not found");d=bj.run(d);a=e=0;f=b.color;if(0==f._hx_index){var g=f.alpha;if(8!=b.colbits)throw new q("Unsupported color mode");f=b.width;if(d.length<b.height*((g?2:1)*f+1))throw new q("Not enough data");for(var g=g?2:1,h=0,b=b.height;h<b;){var k=h++,l=d.b[e++];switch(l){case 0:k=0;for(l=f;k<l;){k++;var E=d.b[e],e=e+g;c.b[a++]=E}break;case 1:l=k=0;for(E=f;l<E;)l++,k+=d.b[e],e+=g,c.b[a++]=k;break;case 2:k=0==
k?0:f;l=0;for(E=f;l<E;){l++;var t=d.b[e]+c.b[a-k],e=e+g;c.b[a++]=t}break;case 3:l=0;k=0==k?0:f;E=0;for(t=f;E<t;)E++,l=d.b[e]+(l+c.b[a-k]>>1)&255,e+=g,c.b[a++]=l;break;case 4:for(var l=f,t=E=0,x=f;t<x;){var C=t++,M=1;null==M&&(M=4);var p=0==k?0:c.b[a-l],C=0==C||0==k?0:c.b[a-l-M],m=E+p-C,M=m-E;0>M&&(M=-M);var n=m-p;0>n&&(n=-n);m-=C;0>m&&(m=-m);E=(M<=n&&M<=m?E:n<=m?p:C)+d.b[e]&255;e+=g;c.b[a++]=E}break;default:throw new q("Invalid filter "+l);}}}else throw new q("Unsupported color mode");return c};yc.extract32=
function(a,b,c){for(var d=yc.getHeader(a),e=null==b?new N(new ArrayBuffer(4*d.width*d.height)):b,f=null,g=null,h=a.h;null!=h;){var k=h.item,h=h.next,l=k;if(2==l._hx_index){var E=l.b;null!=g?g.add(E):null==f?f=E:(g=new ie,g.add(f),g.add(E),f=null)}}null!=g&&(f=g.getBytes());if(null==f)throw new q("Data not found");var f=bj.run(f),t=0,x=0,C=0;c&&(C=8*-d.width,x=(d.height-1)*4*d.width);var M=c?-1:1,m=d.color;switch(m._hx_index){case 0:var p=m.alpha;if(8!=d.colbits)throw new q("Unsupported color mode");
var n=d.width;if(f.length<d.height*((p?2:1)*n+1))throw new q("Not enough data");var r=-1;if(!p)for(var s=a.h;null!=s;){var xc=s.item,s=s.next,u=xc;if(4==u._hx_index&&"tRNS"==u.id){var A=u.data;2<=A.length&&(r=A.b[1]);break}}for(var B=0,w=d.height;B<w;){var y=B++,v=f.b[t++];switch(v){case 0:if(p)for(var F=0,z=n;F<z;){F++;var G=f.b[t++];e.b[x++]=G;e.b[x++]=G;e.b[x++]=G;e.b[x++]=f.b[t++]}else for(var I=0,J=n;I<J;){I++;var L=f.b[t++];e.b[x++]=L;e.b[x++]=L;e.b[x++]=L;e.b[x++]=L==r?0:255}break;case 1:var K=
0,Q=0;if(p)for(var S=0,P=n;S<P;)S++,K+=f.b[t++],e.b[x++]=K,e.b[x++]=K,e.b[x++]=K,Q+=f.b[t++],e.b[x++]=Q;else for(var R=0,O=n;R<O;)R++,K+=f.b[t++],e.b[x++]=K,e.b[x++]=K,e.b[x++]=K,e.b[x++]=K==r?0:255;break;case 2:var V=0==y?0:4*n*M;if(p)for(var T=0,Y=n;T<Y;){T++;var W=f.b[t++]+e.b[x-V];e.b[x++]=W;e.b[x++]=W;e.b[x++]=W;e.b[x++]=f.b[t++]+e.b[x-V]}else for(var X=0,ea=n;X<ea;){X++;var aa=f.b[t++]+e.b[x-V];e.b[x++]=aa;e.b[x++]=aa;e.b[x++]=aa;e.b[x++]=aa==r?0:255}break;case 3:var Z=0,U=0,ja=0==y?0:4*n*M;
if(p)for(var ca=0,Gh=n;ca<Gh;)ca++,Z=f.b[t++]+(Z+e.b[x-ja]>>1)&255,e.b[x++]=Z,e.b[x++]=Z,e.b[x++]=Z,U=f.b[t++]+(U+e.b[x-ja]>>1)&255,e.b[x++]=U;else for(var ba=0,qa=n;ba<qa;)ba++,Z=f.b[t++]+(Z+e.b[x-ja]>>1)&255,e.b[x++]=Z,e.b[x++]=Z,e.b[x++]=Z,e.b[x++]=Z==r?0:255;break;case 4:var Ed=4*n*M,Xa=0,Ye=0;if(p)for(var Ke=0,ma=n;Ke<ma;){var ia=Ke++,Rk=0==y?0:e.b[x-Ed],$=0==ia||0==y?0:e.b[x-Ed-4],na=Xa+Rk-$,cj=na-Xa;0>cj&&(cj=-cj);var D=na-Rk;0>D&&(D=-D);var ka=na-$;0>ka&&(ka=-ka);var yk=t++,Xa=(cj<=D&&cj<=
ka?Xa:D<=ka?Rk:$)+f.b[yk]&255;e.b[x++]=Xa;e.b[x++]=Xa;e.b[x++]=Xa;var la=0==y?0:e.b[x-Ed],dd=0==ia||0==y?0:e.b[x-Ed-4],Pe=Ye+la-dd,zc=Pe-Ye;0>zc&&(zc=-zc);var wa=Pe-la;0>wa&&(wa=-wa);var Cb=Pe-dd;0>Cb&&(Cb=-Cb);var Ha=t++,Ye=(zc<=wa&&zc<=Cb?Ye:wa<=Cb?la:dd)+f.b[Ha]&255;e.b[x++]=Ye}else for(var Zk=0,yg=n;Zk<yg;){var ga=Zk++,da=0==y?0:e.b[x-Ed],Fd=0==ga||0==y?0:e.b[x-Ed-4],ya=Xa+da-Fd,Oa=ya-Xa;0>Oa&&(Oa=-Oa);var Ga=ya-da;0>Ga&&(Ga=-Ga);var dj=ya-Fd;0>dj&&(dj=-dj);var Af=t++,Xa=(Oa<=Ga&&Oa<=dj?Xa:Ga<=
dj?da:Fd)+f.b[Af]&255;e.b[x++]=Xa;e.b[x++]=Xa;e.b[x++]=Xa;e.b[x++]=Xa==r?0:255}break;default:throw new q("Invalid filter "+v);}x+=C}break;case 1:var Aa=m.alpha;if(8!=d.colbits)throw new q("Unsupported color mode");var fb=d.width;if(f.length<d.height*((Aa?4:3)*fb+1))throw new q("Not enough data");var Qe=-1,Ra=-1,Ac=-1;if(!Aa)for(var zk=a.h;null!=zk;){var bb=zk.item,zk=zk.next,Fa=bb;if(4==Fa._hx_index&&"tRNS"==Fa.id){var za=Fa.data;6<=za.length&&(Qe=za.b[1],Ra=za.b[3],Ac=za.b[5]);break}}for(var va=
0,oa=0,Va=0,$a=0,ta=0,Re=d.height;ta<Re;){var Wa=ta++,wb=f.b[t++];switch(wb){case 0:if(Aa)for(var Hh=0,xb=fb;Hh<xb;)Hh++,e.b[x++]=f.b[t+2],e.b[x++]=f.b[t+1],e.b[x++]=f.b[t],e.b[x++]=f.b[t+3],t+=4;else for(var Ea=0,Le=fb;Ea<Le;)Ea++,Va=f.b[t+2],e.b[x++]=Va,oa=f.b[t+1],e.b[x++]=oa,va=f.b[t],e.b[x++]=va,e.b[x++]=va==Qe&&oa==Ra&&Va==Ac?0:255,t+=3;break;case 1:va=oa=Va=$a=0;if(Aa)for(var ha=0,Ak=fb;ha<Ak;)ha++,Va+=f.b[t+2],e.b[x++]=Va,oa+=f.b[t+1],e.b[x++]=oa,va+=f.b[t],e.b[x++]=va,$a+=f.b[t+3],e.b[x++]=
$a,t+=4;else for(var $k=0,ra=fb;$k<ra;)$k++,Va+=f.b[t+2],e.b[x++]=Va,oa+=f.b[t+1],e.b[x++]=oa,va+=f.b[t],e.b[x++]=va,e.b[x++]=va==Qe&&oa==Ra&&Va==Ac?0:255,t+=3;break;case 2:var zg=0==Wa?0:4*fb*M;if(Aa)for(var Ma=0,xa=fb;Ma<xa;)Ma++,e.b[x]=f.b[t+2]+e.b[x-zg],++x,e.b[x]=f.b[t+1]+e.b[x-zg],++x,e.b[x]=f.b[t]+e.b[x-zg],++x,e.b[x]=f.b[t+3]+e.b[x-zg],++x,t+=4;else for(var ua=0,Ba=fb;ua<Ba;)ua++,Va=f.b[t+2]+e.b[x-zg],e.b[x]=Va,++x,oa=f.b[t+1]+e.b[x-zg],e.b[x]=oa,++x,va=f.b[t]+e.b[x-zg],e.b[x]=va,++x,e.b[x++]=
va==Qe&&oa==Ra&&Va==Ac?0:255,t+=3;break;case 3:var va=oa=Va=$a=0,pa=0==Wa?0:4*fb*M;if(Aa)for(var Zb=0,Kb=fb;Zb<Kb;)Zb++,Va=f.b[t+2]+(Va+e.b[x-pa]>>1)&255,e.b[x++]=Va,oa=f.b[t+1]+(oa+e.b[x-pa]>>1)&255,e.b[x++]=oa,va=f.b[t]+(va+e.b[x-pa]>>1)&255,e.b[x++]=va,$a=f.b[t+3]+($a+e.b[x-pa]>>1)&255,e.b[x++]=$a,t+=4;else for(var La=0,Lb=fb;La<Lb;)La++,Va=f.b[t+2]+(Va+e.b[x-pa]>>1)&255,e.b[x++]=Va,oa=f.b[t+1]+(oa+e.b[x-pa]>>1)&255,e.b[x++]=oa,va=f.b[t]+(va+e.b[x-pa]>>1)&255,e.b[x++]=va,e.b[x++]=va==Qe&&oa==Ra&&
Va==Ac?0:255,t+=3;break;case 4:var qb=4*fb*M,va=oa=Va=$a=0;if(Aa)for(var Qa=0,fa=fb;Qa<fa;){var Pa=Qa++,Sa=0==Wa?0:e.b[x-qb],Ya=0==Pa||0==Wa?0:e.b[x-qb-4],Ka=Va+Sa-Ya,Ca=Ka-Va;0>Ca&&(Ca=-Ca);var Da=Ka-Sa;0>Da&&(Da=-Da);var Bc=Ka-Ya;0>Bc&&(Bc=-Bc);Va=(Ca<=Da&&Ca<=Bc?Va:Da<=Bc?Sa:Ya)+f.b[t+2]&255;e.b[x++]=Va;var Za=0==Wa?0:e.b[x-qb],Ta=0==Pa||0==Wa?0:e.b[x-qb-4],Na=oa+Za-Ta,Wb=Na-oa;0>Wb&&(Wb=-Wb);var sa=Na-Za;0>sa&&(sa=-sa);var Ja=Na-Ta;0>Ja&&(Ja=-Ja);oa=(Wb<=sa&&Wb<=Ja?oa:sa<=Ja?Za:Ta)+f.b[t+1]&255;
e.b[x++]=oa;var ib=0==Wa?0:e.b[x-qb],Cc=0==Pa||0==Wa?0:e.b[x-qb-4],pb=va+ib-Cc,Ua=pb-va;0>Ua&&(Ua=-Ua);var hb=pb-ib;0>hb&&(hb=-hb);var yb=pb-Cc;0>yb&&(yb=-yb);va=(Ua<=hb&&Ua<=yb?va:hb<=yb?ib:Cc)+f.b[t]&255;e.b[x++]=va;var Eb=0==Wa?0:e.b[x-qb],ab=0==Pa||0==Wa?0:e.b[x-qb-4],jb=$a+Eb-ab,db=jb-$a;0>db&&(db=-db);var ob=jb-Eb;0>ob&&(ob=-ob);var Bb=jb-ab;0>Bb&&(Bb=-Bb);$a=(db<=ob&&db<=Bb?$a:ob<=Bb?Eb:ab)+f.b[t+3]&255;e.b[x++]=$a;t+=4}else for(var eb=0,Ob=fb;eb<Ob;){var rb=eb++,Db=0==Wa?0:e.b[x-qb],qc=0==
rb||0==Wa?0:e.b[x-qb-4],Mb=Va+Db-qc,Hb=Mb-Va;0>Hb&&(Hb=-Hb);var ed=Mb-Db;0>ed&&(ed=-ed);var sb=Mb-qc;0>sb&&(sb=-sb);Va=(Hb<=ed&&Hb<=sb?Va:ed<=sb?Db:qc)+f.b[t+2]&255;e.b[x++]=Va;var tb=0==Wa?0:e.b[x-qb],Gb=0==rb||0==Wa?0:e.b[x-qb-4],Rb=oa+tb-Gb,Ib=Rb-oa;0>Ib&&(Ib=-Ib);var Fb=Rb-tb;0>Fb&&(Fb=-Fb);var ub=Rb-Gb;0>ub&&(ub=-ub);oa=(Ib<=Fb&&Ib<=ub?oa:Fb<=ub?tb:Gb)+f.b[t+1]&255;e.b[x++]=oa;var zb=0==Wa?0:e.b[x-qb],Yb=0==rb||0==Wa?0:e.b[x-qb-4],Sb=va+zb-Yb,Tb=Sb-va;0>Tb&&(Tb=-Tb);var dc=Sb-zb;0>dc&&(dc=-dc);
var cb=Sb-Yb;0>cb&&(cb=-cb);va=(Tb<=dc&&Tb<=cb?va:dc<=cb?zb:Yb)+f.b[t]&255;e.b[x++]=va;e.b[x++]=va==Qe&&oa==Ra&&Va==Ac?0:255;t+=3}break;default:throw new q("Invalid filter "+wb);}x+=C}break;case 2:var lc=yc.getPalette(a);if(null==lc)throw new q("PNG Palette is missing");for(var jc=null,Oc=a.h;null!=Oc;){var Pc=Oc.item,Oc=Oc.next,Me=Pc;if(4==Me._hx_index&&"tRNS"==Me.id){jc=Me.data;break}}if(null!=jc&&jc.length<1<<d.colbits){var kb=new N(new ArrayBuffer(1<<d.colbits));kb.blit(0,jc,0,jc.length);kb.fill(jc.length,
kb.length-jc.length,255);jc=kb}var $c=d.width,rd=Math.ceil($c*d.colbits/8)+1;if(f.length<d.height*rd)throw new q("Not enough data");for(var id=d.width*d.colbits>>3,Vb=0,Ec=d.height;Vb<Ec;){var Ab=Vb++,Qb=f.b[t++];if(0==Qb)t+=id;else switch(Qb){case 1:for(var Ub=0,kc=0,ac=$c;kc<ac;)kc++,Ub+=f.b[t],f.b[t++]=Ub&255;break;case 2:for(var Pb=0==Ab?0:id+1,Gc=0,fc=$c;Gc<fc;)Gc++,f.b[t]+=f.b[t-Pb],++t;break;case 3:for(var Ia=0,rc=0==Ab?0:id+1,Jc=0,je=$c;Jc<je;)Jc++,Ia=f.b[t]+(Ia+f.b[t-rc]>>1)&255,f.b[t++]=
Ia;break;case 4:for(var Qc=id+1,Gd=0,cc=0,ke=$c;cc<ke;){var ec=cc++,Lc=f.b[t],Ne=1;null==Ne&&(Ne=4);var Nc=0==Ab?0:f.b[t-Qc],Jb=0==ec||0==Ab?0:f.b[t-Qc-Ne],Nb=Gd+Nc-Jb,Xb=Nb-Gd;0>Xb&&(Xb=-Xb);var vc=Nb-Nc;0>vc&&(vc=-vc);var $b=Nb-Jb;0>$b&&($b=-$b);Gd=(Xb<=vc&&Xb<=$b?Gd:vc<=$b?Nc:Jb)+Lc&255;f.b[t++]=Gd}break;default:throw new q("Invalid filter "+Qb);}}var ad=0;if(8==d.colbits)for(var Hc=0,nc=d.height;Hc<nc;){Hc++;++ad;for(var gb=0,jd=d.width;gb<jd;){gb++;var le=f.b[ad++];e.b[x++]=lc.b[3*le+2];e.b[x++]=
lc.b[3*le+1];e.b[x++]=lc.b[3*le];e.b[x++]=null!=jc?jc.b[le]:255}x+=C}else if(8>d.colbits)for(var kd=d.colbits,hc=(1<<kd)-1,Se=0,ye=d.height;Se<ye;){Se++;++ad;for(var Dc=0,sc=0,bd=0,ze=d.width;bd<ze;){bd++;sc<kd&&(Dc=Dc<<8|f.b[ad++],sc+=8);var bc=Dc>>>sc-kd&hc,sc=sc-kd;e.b[x++]=lc.b[3*bc+2];e.b[x++]=lc.b[3*bc+1];e.b[x++]=lc.b[3*bc];e.b[x++]=null!=jc?jc.b[bc]:255}x+=C}else throw new q(d.colbits+" indexed bits per pixel not supported");}return e};yc.buildGrey=function(a,b,c,d){null==d&&(d=9);for(var e=
new N(new ArrayBuffer(a*b+b)),f=0,g=0,h=0;h<b;){h++;for(var k=e.b[f++]=0,l=a;k<l;)k++,e.b[f++]=c.b[g++]}c=new Nc;c.add(sa.CHeader({width:a,height:b,colbits:8,color:Dd.ColGrey(!1),interlaced:!1}));c.add(sa.CData(Bf.run(e,d)));c.add(sa.CEnd);return c};yc.buildIndexed=function(a,b,c,d,e){null==e&&(e=9);for(var f=new N(new ArrayBuffer(a*b+b)),g=0,h=0,k=0;k<b;){k++;for(var l=f.b[g++]=0,E=a;l<E;)l++,f.b[g++]=c.b[h++]}c=new Nc;c.add(sa.CHeader({width:a,height:b,colbits:8,color:Dd.ColIndexed,interlaced:!1}));
c.add(sa.CPalette(d));c.add(sa.CData(Bf.run(f,e)));c.add(sa.CEnd);return c};yc.buildRGB=function(a,b,c,d){null==d&&(d=9);for(var e=new N(new ArrayBuffer(3*a*b+b)),f=0,g=0,h=0;h<b;){h++;for(var k=e.b[f++]=0,l=a;k<l;)k++,e.b[f++]=c.b[g+2],e.b[f++]=c.b[g+1],e.b[f++]=c.b[g],g+=3}c=new Nc;c.add(sa.CHeader({width:a,height:b,colbits:8,color:Dd.ColTrue(!1),interlaced:!1}));c.add(sa.CData(Bf.run(e,d)));c.add(sa.CEnd);return c};yc.build32ARGB=function(a,b,c,d){null==d&&(d=9);for(var e=new N(new ArrayBuffer(4*
a*b+b)),f=0,g=0,h=0;h<b;){h++;for(var k=e.b[f++]=0,l=a;k<l;)k++,e.b[f++]=c.b[g+1],e.b[f++]=c.b[g+2],e.b[f++]=c.b[g+3],e.b[f++]=c.b[g],g+=4}c=new Nc;c.add(sa.CHeader({width:a,height:b,colbits:8,color:Dd.ColTrue(!0),interlaced:!1}));c.add(sa.CData(Bf.run(e,d)));c.add(sa.CEnd);return c};yc.build32BGRA=function(a,b,c,d){null==d&&(d=9);for(var e=new N(new ArrayBuffer(4*a*b+b)),f=0,g=0,h=0;h<b;){h++;for(var k=e.b[f++]=0,l=a;k<l;)k++,e.b[f++]=c.b[g+2],e.b[f++]=c.b[g+1],e.b[f++]=c.b[g],e.b[f++]=c.b[g+3],
g+=4}c=new Nc;c.add(sa.CHeader({width:a,height:b,colbits:8,color:Dd.ColTrue(!0),interlaced:!1}));c.add(sa.CData(Bf.run(e,d)));c.add(sa.CEnd);return c};var ej=function(a){this.o=a;a.set_bigEndian(!0)};r["format.png.Writer"]=ej;ej.__name__="format.png.Writer";ej.prototype={write:function(a){this.o.writeByte(137);this.o.writeByte(80);this.o.writeByte(78);this.o.writeByte(71);this.o.writeByte(13);this.o.writeByte(10);this.o.writeByte(26);this.o.writeByte(10);for(a=a.h;null!=a;){var b=a.item;a=a.next;
switch(b._hx_index){case 0:this.writeChunk("IEND",new N(new ArrayBuffer(0)));break;case 1:var b=b.h,c=new pc;c.set_bigEndian(!0);c.writeInt32(b.width);c.writeInt32(b.height);c.writeByte(b.colbits);var d=b.color,e;switch(d._hx_index){case 0:e=d.alpha?4:0;break;case 1:e=d.alpha?6:2;break;case 2:e=3}c.writeByte(e);c.writeByte(0);c.writeByte(0);c.writeByte(b.interlaced?1:0);this.writeChunk("IHDR",c.getBytes());break;case 2:this.writeChunk("IDAT",b.b);break;case 3:this.writeChunk("PLTE",b.b);break;case 4:this.writeChunk(b.id,
b.data)}}},writeChunk:function(a,b){this.o.writeInt32(b.length);this.o.writeString(a);this.o.write(b);for(var c=-1,d=(c^v.cca(a,0))&255,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,c=c>>>8^d>>>1^-(d&1)&-306674912,d=(c^v.cca(a,1))&255,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,
d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,c=c>>>8^d>>>1^-(d&1)&-306674912,d=(c^v.cca(a,2))&255,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,c=c>>>8^d>>>1^-(d&1)&-306674912,d=(c^v.cca(a,3))&255,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>1^-(d&1)&-306674912,d=d>>>
1^-(d&1)&-306674912,c=c>>>8^d>>>1^-(d&1)&-306674912,d=b.b.bufferValue,e=0,f=b.length;e<f;)var g=e++,g=(c^d.bytes[g])&255,g=g>>>1^-(g&1)&-306674912,g=g>>>1^-(g&1)&-306674912,g=g>>>1^-(g&1)&-306674912,g=g>>>1^-(g&1)&-306674912,g=g>>>1^-(g&1)&-306674912,g=g>>>1^-(g&1)&-306674912,g=g>>>1^-(g&1)&-306674912,g=g>>>1^-(g&1)&-306674912,c=c>>>8^g;this.o.writeInt32(c^-1)},__class__:ej};var Ie=K["format.tga.ImageOrigin"]={__ename__:!0,__constructs__:["BottomLeft","BottomRight","TopLeft","TopRight"],BottomLeft:{_hx_index:0,
__enum__:"format.tga.ImageOrigin",toString:m},BottomRight:{_hx_index:1,__enum__:"format.tga.ImageOrigin",toString:m},TopLeft:{_hx_index:2,__enum__:"format.tga.ImageOrigin",toString:m},TopRight:{_hx_index:3,__enum__:"format.tga.ImageOrigin",toString:m}};Ie.__empty_constructs__=[Ie.BottomLeft,Ie.BottomRight,Ie.TopLeft,Ie.TopRight];var Ec=K["format.tga.ImageType"]={__ename__:!0,__constructs__:"NoImage UncompressedColorMapped UncompressedTrueColor UncompressedBlackAndWhite RunLengthColorMapped RunLengthTrueColor RunLengthBlackAndWhite Unknown".split(" "),
NoImage:{_hx_index:0,__enum__:"format.tga.ImageType",toString:m},UncompressedColorMapped:{_hx_index:1,__enum__:"format.tga.ImageType",toString:m},UncompressedTrueColor:{_hx_index:2,__enum__:"format.tga.ImageType",toString:m},UncompressedBlackAndWhite:{_hx_index:3,__enum__:"format.tga.ImageType",toString:m},RunLengthColorMapped:{_hx_index:4,__enum__:"format.tga.ImageType",toString:m},RunLengthTrueColor:{_hx_index:5,__enum__:"format.tga.ImageType",toString:m},RunLengthBlackAndWhite:{_hx_index:6,__enum__:"format.tga.ImageType",
toString:m},Unknown:(s=function(a){return{_hx_index:7,type:a,__enum__:"format.tga.ImageType",toString:m}},s.__params__=["type"],s)};Ec.__empty_constructs__=[Ec.NoImage,Ec.UncompressedColorMapped,Ec.UncompressedTrueColor,Ec.UncompressedBlackAndWhite,Ec.RunLengthColorMapped,Ec.RunLengthTrueColor,Ec.RunLengthBlackAndWhite];var fj=function(a){this.i=a;a.set_bigEndian(!1)};r["format.tga.Reader"]=fj;fj.__name__="format.tga.Reader";fj.prototype={read:function(){var a=this.i.readByte(),b=this.readHeader(),
a=0==a?"":this.i.readString(a),c=this.readColorMapData(b);return{header:b,imageId:a,colorMapData:c,imageData:this.readImageData(b,c),developerData:null}},readHeader:function(){var a=this.i.readByte(),b;b=this.i.readByte();switch(b){case 0:b=Ec.NoImage;break;case 1:b=Ec.UncompressedColorMapped;break;case 2:b=Ec.UncompressedTrueColor;break;case 3:b=Ec.UncompressedBlackAndWhite;break;case 9:b=Ec.RunLengthColorMapped;break;case 10:b=Ec.RunLengthTrueColor;break;case 11:b=Ec.RunLengthBlackAndWhite;break;
default:b=Ec.Unknown(b)}var c=this.i.readInt16(),d=this.i.readInt16(),e=this.i.readByte(),f=this.i.readInt16(),g=this.i.readInt16(),h=this.i.readInt16(),k=this.i.readInt16(),l=this.i.readByte(),E=this.i.readByte(),t;switch(E&48){case 16:t=Ie.BottomRight;break;case 32:t=Ie.TopLeft;break;case 48:t=Ie.TopRight;break;default:t=Ie.BottomLeft}return{colorMapType:a,imageType:b,colorMapFirstIndex:c,colorMapLength:d,colorMapEntrySize:e,xOrigin:f,yOrigin:g,width:h,height:k,bitsPerPixel:l,alphaChannelBits:E&
15,imageOrigin:t}},readColorMapData:function(a){return 0==a.colorMapType?null:this.readPixels(a.colorMapEntrySize,a.colorMapLength,a.alphaChannelBits,!1)},readImageData:function(a,b){switch(a.imageType._hx_index){case 0:return null;case 1:return this.readIndexes(a.bitsPerPixel,a.width*a.height,b,a.colorMapFirstIndex,!1);case 2:return this.readPixels(a.bitsPerPixel,a.width*a.height,a.alphaChannelBits,!1);case 3:return this.readMono(a.bitsPerPixel,a.width*a.height,a.alphaChannelBits,!1);case 4:return this.readIndexes(a.bitsPerPixel,
a.width*a.height,b,a.colorMapFirstIndex,!0);case 5:return this.readPixels(a.bitsPerPixel,a.width*a.height,a.alphaChannelBits,!0);case 6:return this.readMono(a.bitsPerPixel,a.width*a.height,a.alphaChannelBits,!0);default:throw new q("Unsupported image data type!");}},readPixels:function(a,b,c,d){var e=Array(b);c=0!=c;var f;switch(a){case 8:f=(s=this.i,z(s,s.readByte));a=z(this,this.parsePixel1);break;case 16:f=(s=this.i,z(s,s.readUInt16));a=z(this,this.parsePixel2);break;case 24:f=(s=this.i,z(s,s.readUInt24));
a=z(this,this.parsePixel3);break;case 32:f=(s=this.i,z(s,s.readInt32));a=z(this,this.parsePixel4);break;default:throw new q("Unsupported bits per pixels amount!");}if(d)for(var g=0;g<b;)if(d=this.i.readByte(),0!=(d&128)){d&=127;for(var h=a(f(),c);0<=d;)e[g++]=h,--d}else for(d&=127;0<=d;)e[g++]=a(f(),c),--d;else for(d=0;d<b;)g=d++,e[g]=a(f(),c);return e},readMono:function(a,b,c,d){var e=Array(b);c=0!=c;var f;switch(a){case 8:f=(s=this.i,z(s,s.readByte));a=z(this,this.parsePixel1);break;case 16:f=(s=
this.i,z(s,s.readUInt16));a=z(this,this.parsePixelGreyAlpha);break;default:throw new q("Unsupported bits per pixels amount!");}if(d)for(var g=0;g<b;)if(d=this.i.readByte(),0!=(d&128)){d&=127;for(var h=a(f(),c);0<=d;)e[g++]=h,--d}else for(d&=127;0<=d;)e[g++]=a(f(),c),--d;else for(d=0;d<b;)g=d++,e[g]=a(f(),c);return e},readIndexes:function(a,b,c,d,e){var f=Array(b);switch(a){case 8:a=(s=this.i,z(s,s.readByte));break;case 16:a=(s=this.i,z(s,s.readUInt16));break;case 24:a=(s=this.i,z(s,s.readUInt24));
break;case 32:a=(s=this.i,z(s,s.readInt32));break;default:throw new q("Unsupported bits per pixels amount!");}if(e){e=0;for(var g;e<b;)if(g=this.i.readByte(),0!=(g&128)){g&=127;for(var h=c[d+a()];0<=g;)f[e++]=h,--g}else for(g&=127;0<=g;)f[e++]=c[d+a()],--g}else for(e=0;e<b;)g=e++,f[g]=c[d+a()];return f},parsePixel1:function(a,b){return a<<16|a<<8|a},parsePixelGreyAlpha:function(a,b){return(b?(a&65280)<<16:0)|this.parsePixel1(a&255,!1)},parsePixel2:function(a,b){return(b?1==(a&32768)?-16777216:0:0)|
(255*(((a&31744)>>10)/31)|0)<<16|(255*(((a&992)>>5)/31)|0)<<8|255*((a&31)/31)|0},parsePixel3:function(a,b){return a},parsePixel4:function(a,b){return a},__class__:fj};var Zi=function(a){this.i=a;this.bits=this.nbits=0};r["format.tools.BitsInput"]=Zi;Zi.__name__="format.tools.BitsInput";Zi.prototype={readBits:function(a){if(this.nbits>=a){var b=this.nbits-a;a=this.bits>>>b&(1<<a)-1;this.nbits=b;return a}b=this.i.readByte();if(24<=this.nbits){if(31<a)throw new q("Bits error");a=8+this.nbits-a;var c=
this.bits&(1<<this.nbits)-1;this.bits=b;this.nbits=a;return c<<8-a|b<<a}this.bits=this.bits<<8|b;this.nbits+=8;return this.readBits(a)},readBit:function(){0==this.nbits&&(this.bits=this.i.readByte(),this.nbits=8);this.nbits--;return 1==(this.bits>>>this.nbits&1)},reset:function(){this.nbits=0},__class__:Zi};var Bf=function(){};r["format.tools.Deflate"]=Bf;Bf.__name__="format.tools.Deflate";Bf.run=function(a,b){null==b&&(b=9);return gj.run(a,b)};var bj=function(){};r["format.tools.Inflate"]=bj;bj.__name__=
"format.tools.Inflate";bj.run=function(a){return hj.run(a)};var Sk=K["format.wav.WAVEFormat"]={__ename__:!0,__constructs__:["WF_PCM"],WF_PCM:{_hx_index:0,__enum__:"format.wav.WAVEFormat",toString:m}};Sk.__empty_constructs__=[Sk.WF_PCM];var ij=function(a){this.i=a;a.set_bigEndian(!1)};r["format.wav.Reader"]=ij;ij.__name__="format.wav.Reader";ij.prototype={readInt:function(){return this.i.readInt32()},read:function(){if("RIFF"!=this.i.readString(4))throw new q("RIFF header expected");this.i.readInt32();
if("WAVE"!=this.i.readString(4))throw new q("WAVE signature not found");var a=this.i.readString(4);a:for(;"fmt "!=a;)switch(a){case "JUNK":a=this.i.readInt32();this.i.read(a);a=this.i.readString(4);break;case "bext":a=this.i.readInt32();this.i.read(a);a=this.i.readString(4);break;default:break a}if("fmt "!=a)throw new q("unsupported wave chunk "+a);var b=this.i.readInt32();switch(this.i.readUInt16()){case 1:case 3:a=Sk.WF_PCM;break;default:throw new q("only PCM (uncompressed) WAV files are supported");
}var c=this.i.readUInt16(),d=this.i.readInt32(),e=this.i.readInt32(),f=this.i.readUInt16(),g=this.i.readUInt16();16<b&&this.i.read(b-16);for(b=this.i.readString(4);"data"!=b;)this.i.read(this.i.readInt32()),b=this.i.readString(4);if("data"!=b)throw new q("expected data subchunk");var b=this.i.readInt32(),h;try{h=this.i.read(b)}catch(k){$.lastException=k;if((k instanceof q?k.val:k)instanceof qd)throw new q("Invalid chunk data length");throw k;}b=[];try{for(;;)if("cue "==this.i.readString(4)){this.i.readInt32();
for(var l=0,E=this.i.readInt32();l<E;){l++;var t=this.i.readInt32();this.i.readInt32();this.i.readString(4);this.i.readInt32();this.i.readInt32();var x=this.i.readInt32();b.push({id:t,sampleOffset:x})}}else this.i.read(this.i.readInt32())}catch(C){if($.lastException=C,!((C instanceof q?C.val:C)instanceof qd))throw C;}return{header:{format:a,channels:c,samplingRate:d,byteRate:e,blockAlign:f,bitsPerSample:g},data:h,cuePoints:b}},__class__:ij};var Ca=function(a){this.matA=this.alpha=1;this.matC=this.matB=
0;this.matD=1;this.absY=this.absX=0;this.posChanged=!0;this.x=0;this.posChanged=!0;this.y=0;this.posChanged=!0;this.scaleX=1;this.posChanged=!0;this.scaleY=1;this.posChanged=!0;this.rotation=0;this.blendMode=ra.Alpha;this.posChanged=null!=a;this.set_visible(!0);this.children=[];null!=a&&a.addChild(this)};r["h2d.Object"]=Ca;Ca.__name__="h2d.Object";Ca.prototype={getBounds:function(a,b){null==b?b=new ub:(b.xMin=1E20,b.yMin=1E20,b.xMax=-1E20,b.yMax=-1E20);null!=a&&a.syncPos();a!=this&&this.syncPos();
this.getBoundsRec(a,b,!1);if(b.xMax<=b.xMin||b.yMax<=b.yMin)this.addBounds(a,b,-1,-1,2,2),b.xMax=b.xMin=0.5*(b.xMax+b.xMin),b.yMax=b.yMin=0.5*(b.yMax+b.yMin);return b},getSize:function(a){null==a?a=new ub:(a.xMin=1E20,a.yMin=1E20,a.xMax=-1E20,a.yMax=-1E20);this.syncPos();this.getBoundsRec(this.parent,a,!0);if(a.xMax<=a.xMin||a.yMax<=a.yMin)this.addBounds(this.parent,a,-1,-1,2,2),a.xMax=a.xMin=0.5*(a.xMax+a.xMin),a.yMax=a.yMin=0.5*(a.yMax+a.yMin);var b=-this.x,c=-this.y;a.xMin+=b;a.xMax+=b;a.yMin+=
c;a.yMax+=c;return a},getAbsPos:function(){this.syncPos();var a=new Rc;a.a=this.matA;a.b=this.matB;a.c=this.matC;a.d=this.matD;a.x=this.absX;a.y=this.absY;return a},find:function(a){var b=a(this);if(null!=b)return b;for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d=d.find(a);if(null!=d)return d}return null},findAll:function(a,b){null==b&&(b=[]);var c=a(this);null!=c&&b.push(c);for(var c=0,d=this.children;c<d.length;){var e=d[c];++c;e.findAll(a,b)}return b},set_filter:function(a){null!=this.filter&&
this.allocated&&this.filter.unbind(this);this.filter=a;null!=a&&this.allocated&&a.bind(this);return a},getBoundsRec:function(a,b,c){if(this.posChanged){this.calcAbsPos();for(var d=0,e=this.children;d<e.length;){var f=e[d];++d;f.posChanged=!0}this.posChanged=!1}d=this.children.length;if(0==d)b.xMin=1E20,b.yMin=1E20,b.xMax=-1E20,b.yMax=-1E20;else if(1==d)d=this.children[0],d.visible?d.getBoundsRec(a,b,c):(b.xMin=1E20,b.yMin=1E20,b.xMax=-1E20,b.yMax=-1E20);else{for(var e=d=Infinity,g=f=-Infinity,h=0,
k=this.children;h<k.length;){var l=k[h];++h;l.visible&&(l.getBoundsRec(a,b,c),b.xMin<d&&(d=b.xMin),b.yMin<e&&(e=b.yMin),b.xMax>f&&(f=b.xMax),b.yMax>g&&(g=b.yMax))}b.xMin=d;b.yMin=e;b.xMax=f;b.yMax=g}},addBounds:function(a,b,c,d,e,f){if(!(0>=e||0>=f))if(null==a){var g=c*this.matA+d*this.matC+this.absX,h=c*this.matB+d*this.matD+this.absY;g<b.xMin&&(b.xMin=g);g>b.xMax&&(b.xMax=g);h<b.yMin&&(b.yMin=h);h>b.yMax&&(b.yMax=h);g=(c+e)*this.matA+d*this.matC+this.absX;h=(c+e)*this.matB+d*this.matD+this.absY;
g<b.xMin&&(b.xMin=g);g>b.xMax&&(b.xMax=g);h<b.yMin&&(b.yMin=h);h>b.yMax&&(b.yMax=h);g=c*this.matA+(d+f)*this.matC+this.absX;h=c*this.matB+(d+f)*this.matD+this.absY;g<b.xMin&&(b.xMin=g);g>b.xMax&&(b.xMax=g);h<b.yMin&&(b.yMin=h);h>b.yMax&&(b.yMax=h);g=(c+e)*this.matA+(d+f)*this.matC+this.absX;c=(c+e)*this.matB+(d+f)*this.matD+this.absY;g<b.xMin&&(b.xMin=g);g>b.xMax&&(b.xMax=g);c<b.yMin&&(b.yMin=c);c>b.yMax&&(b.yMax=c)}else if(a==this)b.xMin>c&&(b.xMin=c),b.yMin>d&&(b.yMin=d),b.xMax<c+e&&(b.xMax=c+e),
b.yMax<d+f&&(b.yMax=d+f);else if(g=a.matA*a.matD-a.matB*a.matC,0!=g){var k=1/g,h=a.matD*k,g=-a.matB*k,l=-a.matC*k,k=a.matA*k,E=this.absX-a.absX;a=this.absY-a.absY;var t=c*this.matA+d*this.matC+E,x=c*this.matB+d*this.matD+a,C=t*h+x*l,t=t*g+x*k;C<b.xMin&&(b.xMin=C);C>b.xMax&&(b.xMax=C);t<b.yMin&&(b.yMin=t);t>b.yMax&&(b.yMax=t);t=(c+e)*this.matA+d*this.matC+E;x=(c+e)*this.matB+d*this.matD+a;C=t*h+x*l;t=t*g+x*k;C<b.xMin&&(b.xMin=C);C>b.xMax&&(b.xMax=C);t<b.yMin&&(b.yMin=t);t>b.yMax&&(b.yMax=t);t=c*this.matA+
(d+f)*this.matC+E;x=c*this.matB+(d+f)*this.matD+a;C=t*h+x*l;t=t*g+x*k;C<b.xMin&&(b.xMin=C);C>b.xMax&&(b.xMax=C);t<b.yMin&&(b.yMin=t);t>b.yMax&&(b.yMax=t);t=(c+e)*this.matA+(d+f)*this.matC+E;x=(c+e)*this.matB+(d+f)*this.matD+a;c=t*h+x*l;d=t*g+x*k;c<b.xMin&&(b.xMin=c);c>b.xMax&&(b.xMax=c);d<b.yMin&&(b.yMin=d);d>b.yMax&&(b.yMax=d)}},getObjectsCount:function(){for(var a=0,b=0,c=this.children;b<c.length;){var d=c[b];++b;a+=d.getObjectsCount()+1}return a},localToGlobal:function(a){this.syncPos();null==
a&&(a=new ob);var b=a.x*this.matB+a.y*this.matD+this.absY;a.x=a.x*this.matA+a.y*this.matC+this.absX;a.y=b;return a},globalToLocal:function(a){this.syncPos();a.x-=this.absX;a.y-=this.absY;var b=1/(this.matA*this.matD-this.matB*this.matC),c=(-a.x*this.matB+a.y*this.matA)*b;a.x=(a.x*this.matD-a.y*this.matC)*b;a.y=c;return a},getScene:function(){for(var a=this;null!=a.parent;)a=a.parent;return a instanceof Mc?a:null},set_visible:function(a){if(this.visible==a)return a;this.visible=a;null!=this.parentContainer&&
this.parentContainer.contentChanged(this);return a},addChild:function(a){this.addChildAt(a,this.children.length)},addChildAt:function(a,b){0>b&&(b=0);b>this.children.length&&(b=this.children.length);for(var c=this;null!=c;){if(c==a)throw new q("Recursive addChild");c=c.parent}null!=a.parent&&(c=a.allocated,a.allocated=!1,a.parent.removeChild(a),a.allocated=c);this.children.splice(b,0,a);if(!this.allocated&&a.allocated)a.onRemove();a.parent=this;a.parentContainer=this.parentContainer;a.posChanged=
!0;if(this.allocated)if(a.allocated)a.onHierarchyMoved(!0);else a.onAdd();null!=this.parentContainer&&this.parentContainer.contentChanged(this)},onContentChanged:function(){null!=this.parentContainer&&this.parentContainer.contentChanged(this)},onHierarchyMoved:function(a){for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.onHierarchyMoved(a)}},onAdd:function(){this.allocated=!0;null!=this.filter&&this.filter.bind(this);for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.onAdd()}},onRemove:function(){this.allocated=
!1;null!=this.filter&&this.filter.unbind(this);for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.onRemove()}},getMatrix:function(a){a.a=this.matA;a.b=this.matB;a.c=this.matC;a.d=this.matD;a.x=this.absX;a.y=this.absY},removeChild:function(a){if(v.remove(this.children,a)){if(a.allocated)a.onRemove();a.parent=null;null!=a.parentContainer&&a.setParentContainer(null);a.posChanged=!0;null!=this.parentContainer&&this.parentContainer.contentChanged(this)}},setParentContainer:function(a){this.parentContainer=
a;for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.setParentContainer(a)}},removeChildren:function(){for(;0<this.children.length;)this.removeChild(this.children[0])},remove:function(){null!=this.parent&&this.parent.removeChild(this)},drawTo:function(a){var b=this.getScene(),c=null==b;null==b&&(b=new Mc);b.drawImplTo(this,[a]);c&&(b.dispose(),this.onRemove())},drawToTextures:function(a,b){var c=this.getScene(),d=null==c;null==c&&(c=new Mc);c.drawImplTo(this,a,b);d&&(c.dispose(),this.onRemove())},
draw:function(a){},sync:function(a){var b=this.posChanged;b&&(this.calcAbsPos(),this.posChanged=!1);this.lastFrame=a.frame;for(var c=0,d=this.children.length;c<d;){var e=this.children[c];if(null==e)break;e.lastFrame!=a.frame&&(b&&(e.posChanged=!0),e.sync(a));this.children[c]!=e?(c=0,d=this.children.length):++c}},syncPos:function(){null!=this.parent&&this.parent.syncPos();if(this.posChanged){this.calcAbsPos();for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.posChanged=!0}this.posChanged=!1}},
calcAbsPos:function(){if(null==this.parent){var a,b;0==this.rotation?(this.matA=this.scaleX,this.matC=this.matB=0,this.matD=this.scaleY):(a=Math.cos(this.rotation),b=Math.sin(this.rotation),this.matA=this.scaleX*a,this.matB=this.scaleX*b,this.matC=this.scaleY*-b,this.matD=this.scaleY*a);this.absX=this.x;this.absY=this.y}else{if(0==this.rotation)this.matA=this.scaleX*this.parent.matA,this.matB=this.scaleX*this.parent.matB,this.matC=this.scaleY*this.parent.matC,this.matD=this.scaleY*this.parent.matD;
else{var c=Math.cos(this.rotation),d=Math.sin(this.rotation);a=this.scaleX*c;b=this.scaleX*d;d=this.scaleY*-d;c*=this.scaleY;this.matA=a*this.parent.matA+b*this.parent.matC;this.matB=a*this.parent.matB+b*this.parent.matD;this.matC=d*this.parent.matA+c*this.parent.matC;this.matD=d*this.parent.matB+c*this.parent.matD}this.absX=this.x*this.parent.matA+this.y*this.parent.matC+this.parent.absX;this.absY=this.x*this.parent.matB+this.y*this.parent.matD+this.parent.absY}},emitTile:function(a,b){null==Ca.nullDrawable&&
(Ca.nullDrawable=new Sa(null));Ca.nullDrawable.absX=this.absX;Ca.nullDrawable.absY=this.absY;Ca.nullDrawable.matA=this.matA;Ca.nullDrawable.matB=this.matB;Ca.nullDrawable.matC=this.matC;Ca.nullDrawable.matD=this.matD;a.drawTile(Ca.nullDrawable,b)},clipBounds:function(a,b){var c=a.tmpBounds,d,e,f,g,h,k;null!=a.inFilter?(h=a.baseShader.filterMatrixA__,k=a.baseShader.filterMatrixB__,d=this.matA*h.x+this.matB*h.y,e=this.matA*k.x+this.matB*k.y,f=this.matC*h.x+this.matD*h.y,g=this.matC*k.x+this.matD*k.y,
h=this.absX*h.x+this.absY*h.y+h.z,k=this.absX*k.x+this.absY*k.y+k.z):(d=this.matA,e=this.matB,f=this.matC,g=this.matD,h=this.absX,k=this.absY);c.xMin=1E20;c.yMin=1E20;c.xMax=-1E20;c.yMax=-1E20;var l=b.xMin,E=b.yMin,t=l*d+E*f+h,l=l*e+E*g+k;t<c.xMin&&(c.xMin=t);t>c.xMax&&(c.xMax=t);l<c.yMin&&(c.yMin=l);l>c.yMax&&(c.yMax=l);l=b.xMax;E=b.yMin;t=l*d+E*f+h;l=l*e+E*g+k;t<c.xMin&&(c.xMin=t);t>c.xMax&&(c.xMax=t);l<c.yMin&&(c.yMin=l);l>c.yMax&&(c.yMax=l);l=b.xMin;E=b.yMax;t=l*d+E*f+h;l=l*e+E*g+k;t<c.xMin&&
(c.xMin=t);t>c.xMax&&(c.xMax=t);l<c.yMin&&(c.yMin=l);l>c.yMax&&(c.yMax=l);l=b.xMax;E=b.yMax;t=l*d+E*f+h;l=l*e+E*g+k;t<c.xMin&&(c.xMin=t);t>c.xMax&&(c.xMax=t);l<c.yMin&&(c.yMin=l);l>c.yMax&&(c.yMax=l);c.xMin<a.curX&&(c.xMin=a.curX);c.yMin<a.curY&&(c.yMin=a.curY);c.xMax>a.curX+a.curWidth&&(c.xMax=a.curX+a.curWidth);c.yMax>a.curY+a.curHeight&&(c.yMax=a.curY+a.curHeight);var t=1/(d*g-e*f),x=c.xMin,C=c.yMin,E=c.xMax,l=c.yMax;c.xMin=1E20;c.yMin=1E20;c.xMax=-1E20;c.yMax=-1E20;var M,p;M=x-h;p=C-k;var m=(M*
g-p*f)*t;M=(-M*e+p*d)*t;m<c.xMin&&(c.xMin=m);m>c.xMax&&(c.xMax=m);M<c.yMin&&(c.yMin=M);M>c.yMax&&(c.yMax=M);m=E-h;M=C-k;C=(m*g-M*f)*t;m=(-m*e+M*d)*t;C<c.xMin&&(c.xMin=C);C>c.xMax&&(c.xMax=C);m<c.yMin&&(c.yMin=m);m>c.yMax&&(c.yMax=m);C=x-h;m=l-k;x=(C*g-m*f)*t;C=(-C*e+m*d)*t;x<c.xMin&&(c.xMin=x);x>c.xMax&&(c.xMax=x);C<c.yMin&&(c.yMin=C);C>c.yMax&&(c.yMax=C);h=E-h;k=l-k;f=(h*g-k*f)*t;d=(-h*e+k*d)*t;f<c.xMin&&(c.xMin=f);f>c.xMax&&(c.xMax=f);d<c.yMin&&(c.yMin=d);d>c.yMax&&(c.yMax=d);d=b.xMin;e=c.xMin;
b.xMin=d<e?e:d;d=b.yMin;e=c.yMin;b.yMin=d<e?e:d;d=b.xMax;e=c.xMax;b.xMax=d>e?e:d;d=b.yMax;c=c.yMax;b.yMax=d>c?c:d},drawFilters:function(a){if(a.pushFilter(this)){var b=a.tmpBounds,c=new ub,d=-1;this.filter.sync(a,this);this.filter.autoBounds?d=this.filter.boundsExtend:(this.filter.getBounds(this,b),b.xMin<c.xMin&&(c.xMin=b.xMin),b.xMax>c.xMax&&(c.xMax=b.xMax),b.yMin<c.yMin&&(c.yMin=b.yMin),b.yMax>c.yMax&&(c.yMax=b.yMax));0<=d&&(this.getBounds(this,b),b.xMin-=d,b.yMin-=d,b.xMax+=d,b.yMax+=d,b.xMin<
c.xMin&&(c.xMin=b.xMin),b.xMax>c.xMax&&(c.xMax=b.xMax),b.yMin<c.yMin&&(c.yMin=b.yMin),b.yMax>c.yMax&&(c.yMax=b.yMax));this.clipBounds(a,c);var b=Math.floor(c.xMin+1E-10),d=Math.floor(c.yMin+1E-10),e=Math.ceil(c.xMax-b-1E-10),f=Math.ceil(c.yMax-d-1E-10);if(0>=e||0>=f||c.xMax<c.xMin)a.popFilter();else{var g=a.textures.allocTarget("filterTemp",e,f,!1);a.pushTarget(g,b,d,e,f);a.engine.clear(0);var c=a.globalAlpha,e=a.baseShader,h=e.filterMatrixA__,f=h.x,k=h.y,l=h.z,h=h.w;null==h&&(h=1);null==l&&(l=0);
null==k&&(k=0);null==f&&(f=0);var E=e.filterMatrixB__,t=E.x,x=E.y,C=E.z,E=E.w;null==E&&(E=1);null==C&&(C=0);null==x&&(x=0);null==t&&(t=0);var M=1/(this.matA*this.matD-this.matB*this.matC),m=this.matD*M,p=-this.matB*M,n=-this.matC*M,q=this.matA*M,M=-(this.absX*p+this.absY*q),r=e.filterMatrixA__,s=m,u=n,m=-(this.absX*m+this.absY*n);null==m&&(m=0);null==u&&(u=0);null==s&&(s=0);r.x=s;r.y=u;r.z=m;r.w=1;m=e.filterMatrixB__;null==M&&(M=0);null==q&&(q=0);null==p&&(p=0);m.x=p;m.y=q;m.z=M;m.w=1;a.globalAlpha=
1;this.draw(a);M=0;for(p=this.children;M<p.length;)q=p[M],++M,q.drawRec(a);g=fa.fromTexture(g);g.dx=b;g.dy=d;M=g;g=this.filter.draw(a,g);g!=M&&null!=g&&(g.dx+=b,g.dy+=d);b=e.filterMatrixA__;b.x=f;b.y=k;b.z=l;b.w=h;b=e.filterMatrixB__;b.x=t;b.y=x;b.z=C;b.w=E;a.popTarget();a.popFilter();a.globalAlpha=c;null!=g&&this.drawFiltered(a,g)}}},drawFiltered:function(a,b){var c=a.globalAlpha;a.currentBlend=null;a.inFilterBlend=this.blendMode;a.globalAlpha*=this.alpha;this.emitTile(a,b);a.globalAlpha=c;a.inFilterBlend=
null;a.currentBlend=null},drawRec:function(a){if(this.visible){if(this.posChanged){this.calcAbsPos();for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.posChanged=!0}this.posChanged=!1}if(null!=this.filter&&this.filter.get_enable())this.drawFilters(a);else{b=a.globalAlpha;a.globalAlpha*=this.alpha;if(a.front2back){c=this.children.length;for(d=0;d<c;){var e=d++;this.children[c-1-e].drawRec(a)}this.draw(a)}else{this.draw(a);c=0;for(d=this.children;c<d.length;)e=d[c],++c,e.drawRec(a)}a.globalAlpha=
b}}},set_x:function(a){this.posChanged=!0;return this.x=a},set_y:function(a){this.posChanged=!0;return this.y=a},set_scaleX:function(a){this.posChanged=!0;return this.scaleX=a},set_scaleY:function(a){this.posChanged=!0;return this.scaleY=a},set_rotation:function(a){this.posChanged=!0;return this.rotation=a},move:function(a,b){var c=this.x+a*Math.cos(this.rotation);this.posChanged=!0;this.x=c;c=this.y+b*Math.sin(this.rotation);this.posChanged=!0;this.y=c},setPosition:function(a,b){this.posChanged=
!0;this.x=a;this.posChanged=!0;this.y=b},rotate:function(a){this.posChanged=!0;this.rotation+=a},scale:function(a){this.posChanged=!0;this.scaleX*=a;this.posChanged=!0;this.scaleY*=a},setScale:function(a){this.posChanged=!0;this.scaleX=a;this.posChanged=!0;this.scaleY=a},getChildAt:function(a){return this.children[a]},getChildIndex:function(a){for(var b=0,c=this.children.length;b<c;){var d=b++;if(this.children[d]==a)return d}return-1},getObjectByName:function(a){if(this.name==a)return this;for(var b=
0,c=this.children;b<c.length;){var d=c[b];++b;d=d.getObjectByName(a);if(null!=d)return d}return null},get_numChildren:function(){return this.children.length},iterator:function(){return new Ih(this.children)},toString:function(){var a=ia.getClass(this).__name__;return null==this.name?a:this.name+"("+a+")"},contentChanged:function(a){},constraintSize:function(a,b){},__class__:Ca};var Sa=function(a){Ca.call(this,a);this.color=new B(1,1,1,1)};r["h2d.Drawable"]=Sa;Sa.__name__="h2d.Drawable";Sa.__super__=
Ca;Sa.prototype=J(Ca.prototype,{set_tileWrap:function(a){return this.tileWrap=a},get_colorAdd:function(){var a=this.getShader(Sc);return null==a?null:a.color__},set_colorAdd:function(a){var b=this.getShader(Sc);null==b?null!=a&&(b=this.addShader(new Sc),b.color__=a):null==a?this.removeShader(b):b.color__=a;return a},drawFiltered:function(a,b){var c=this.shaders;this.shaders=null;Ca.prototype.drawFiltered.call(this,a,b);this.shaders=c},set_colorKey:function(a){var b=this.getShader(Ae);if(null==b)null!=
a&&this.addShader(new Ae(-16777216|a));else if(null==a)this.removeShader(b);else{var b=b.colorKey__,c=-16777216|a;b.x=(c>>16&255)/255;b.y=(c>>8&255)/255;b.z=(c&255)/255;b.w=(c>>>24)/255}return this.colorKey=a},adjustColor:function(a){if(null==a)this.set_colorMatrix(null);else{var b=this.get_colorMatrix();null==b&&(b=new P,this.set_colorMatrix(b));b.identity();b.adjustColor(a)}},get_colorMatrix:function(){var a=this.getShader(Tc);return null==a?null:a.matrix__},set_colorMatrix:function(a){var b=this.getShader(Tc);
null==b?null!=a&&(b=this.addShader(new Tc),b.matrix__=a):null==a?this.removeShader(b):b.matrix__=a;return a},getDebugShaderCode:function(a){null==a&&(a=!0);var b=this.getScene().ctx,b=b.manager.compileShaders(new Gb(b.baseShader,this.shaders));return a?"// vertex:\n"+aa.shaderToString(b.vertex.data,!0)+"\n\nfragment:\n"+aa.shaderToString(b.fragment.data,!0):X.CURRENT.driver.getNativeShaderCode(b)},getShader:function(a){if(null!=this.shaders)for(var b=this.shaders;null!=b;){var c=b.s,b=b.next,c=ia.__downcastCheck(c,
a)?c:null;if(null!=c)return c}return null},getShaders:function(){return new Cf(this.shaders,null)},addShader:function(a){if(null==a)throw new q("Can't add null shader");this.shaders=Gb.addSort(a,this.shaders);return a},removeShader:function(a){for(var b=null,c=this.shaders;null!=c;){if(c.s==a)return null==b?this.shaders=c.next:b.next=c.next,!0;b=c;c=c.next}return!1},emitTile:function(a,b){null==b&&(b=new fa(null,0,0,5,5));a.drawTile(this,b)},__class__:Sa});var tg=function(a,b){Sa.call(this,b);this.set_tile(a)};
r["h2d.Bitmap"]=tg;tg.__name__="h2d.Bitmap";tg.__super__=Sa;tg.prototype=J(Sa.prototype,{set_tileWrap:function(a){if(a&&null!=this.tile&&0!=(this.tile.innerTex.flags&1<<V.IsNPOT._hx_index))throw new q("Cannot set tileWrap on a non power-of-two texture");return this.tileWrap=a},getBoundsRec:function(a,b,c){Sa.prototype.getBoundsRec.call(this,a,b,c);null!=this.tile&&(null==this.width&&null==this.height?this.addBounds(a,b,this.tile.dx,this.tile.dy,this.tile.width,this.tile.height):this.addBounds(a,b,
this.tile.dx,this.tile.dy,null!=this.width?this.width:this.tile.width*this.height/this.tile.height,null!=this.height?this.height:this.tile.height*this.width/this.tile.width))},set_width:function(a){if(this.width==a)return a;this.width=a;null!=this.parentContainer&&this.parentContainer.contentChanged(this);return a},set_height:function(a){if(this.height==a)return a;this.height=a;null!=this.parentContainer&&this.parentContainer.contentChanged(this);return a},set_tile:function(a){if(this.tile==a)return a;
this.tile=a;null!=this.parentContainer&&this.parentContainer.contentChanged(this);return a},draw:function(a){if(null==this.width&&null==this.height)this.emitTile(a,this.tile);else{null==this.tile&&this.set_tile(fa.fromColor(16711935));var b=this.tile.width,c=this.tile.height;this.tile.width=null!=this.width?this.width:b*this.height/c;this.tile.height=null!=this.height?this.height:c*this.width/b;this.emitTile(a,this.tile);this.tile.width=b;this.tile.height=c}},__class__:tg});var ra=K["h2d.BlendMode"]=
{__ename__:!0,__constructs__:"None Alpha Add AlphaAdd SoftAdd Multiply AlphaMultiply Erase Screen Sub Max Min".split(" "),None:{_hx_index:0,__enum__:"h2d.BlendMode",toString:m},Alpha:{_hx_index:1,__enum__:"h2d.BlendMode",toString:m},Add:{_hx_index:2,__enum__:"h2d.BlendMode",toString:m},AlphaAdd:{_hx_index:3,__enum__:"h2d.BlendMode",toString:m},SoftAdd:{_hx_index:4,__enum__:"h2d.BlendMode",toString:m},Multiply:{_hx_index:5,__enum__:"h2d.BlendMode",toString:m},AlphaMultiply:{_hx_index:6,__enum__:"h2d.BlendMode",
toString:m},Erase:{_hx_index:7,__enum__:"h2d.BlendMode",toString:m},Screen:{_hx_index:8,__enum__:"h2d.BlendMode",toString:m},Sub:{_hx_index:9,__enum__:"h2d.BlendMode",toString:m},Max:{_hx_index:10,__enum__:"h2d.BlendMode",toString:m},Min:{_hx_index:11,__enum__:"h2d.BlendMode",toString:m}};ra.__empty_constructs__=[ra.None,ra.Alpha,ra.Add,ra.AlphaAdd,ra.SoftAdd,ra.Multiply,ra.AlphaMultiply,ra.Erase,ra.Screen,ra.Sub,ra.Max,ra.Min];var Ag=function(a,b){this.prevChar=a;this.offset=b};r["h2d.Kerning"]=
Ag;Ag.__name__="h2d.Kerning";Ag.prototype={__class__:Ag};var sd=function(a,b){this.t=a;this.width=b};r["h2d.FontChar"]=sd;sd.__name__="h2d.FontChar";sd.prototype={addKerning:function(a,b){var c=new Ag(a,b);c.next=this.kerning;this.kerning=c},getKerningOffset:function(a){for(var b=this.kerning;null!=b;){if(b.prevChar==a)return b.offset;b=b.next}return 0},clone:function(){var a=new sd(this.t.clone(),this.width),b=this.kerning;if(null!=b){var c=new Ag(b.prevChar,b.offset);a.kerning=c;for(b=b.next;null!=
b;)var d=new Ag(b.prevChar,b.offset),c=c.next=d,b=b.next}return a},__class__:sd};var Bk=K["h2d.FontType"]={__ename__:!0,__constructs__:["BitmapFont","SignedDistanceField"],BitmapFont:{_hx_index:0,__enum__:"h2d.FontType",toString:m},SignedDistanceField:(s=function(a,b,c){return{_hx_index:1,channel:a,alphaCutoff:b,smoothing:c,__enum__:"h2d.FontType",toString:m}},s.__params__=["channel","alphaCutoff","smoothing"],s)};Bk.__empty_constructs__=[Bk.BitmapFont];var Bg=function(a,b,c){this.offsetX=this.offsetY=
0;this.name=a;this.initSize=this.size=b;this.glyphs=new na;this.defaultChar=this.nullChar=new sd(new fa(null,0,0,0,0),0);this.charset=Mb.getDefault();null!=a&&(this.tilePath=ta.withExtension(a,"png"));this.type=null==c?Bk.BitmapFont:c};r["h2d.Font"]=Bg;Bg.__name__="h2d.Font";Bg.prototype={getChar:function(a){var b=this.glyphs.h[a];null==b&&(b=this.charset.resolveChar(a,this.glyphs),null==b&&(b=13==a||10==a?this.nullChar:this.defaultChar));return b},setOffset:function(a,b){var c=a-this.offsetX,d=b-
this.offsetY;if(!(0==c&&0==d)){for(var e=this.glyphs.iterator();e.hasNext();){var f=e.next();f.t.dx+=c;f.t.dy+=d}this.offsetX+=c;this.offsetY+=d}},clone:function(){var a=new Bg(this.name,this.size);a.baseLine=this.baseLine;a.lineHeight=this.lineHeight;a.tile=this.tile.clone();a.charset=this.charset;a.defaultChar=this.defaultChar.clone();a.type=this.type;for(var b=this.glyphs.keys();b.hasNext();){var c=b.next(),d=this.glyphs.h[c],e=d.clone();d==this.defaultChar&&(a.defaultChar=e);a.glyphs.h[c]=e}return a},
resizeTo:function(a){for(var b=a/this.initSize,c=this.glyphs.iterator();c.hasNext();){var d=c.next();d.width*=b;d.t.scaleToSize(d.t.width*b,d.t.height*b);d.t.dx*=b;d.t.dy*=b;for(d=d.kerning;null!=d;)d.offset*=b,d=d.next}this.lineHeight*=b;this.baseLine*=b;this.size=a},hasChar:function(a){return null!=this.glyphs.h[a]},dispose:function(){this.tile.dispose()},__class__:Bg};var Cg=function(){};r["hxd.Interactive"]=Cg;Cg.__name__="hxd.Interactive";Cg.__isInterface__=!0;Cg.prototype={__class__:Cg};var Dg=
function(a,b,c,d){this.shapeX=this.shapeY=0;this.mouseDownButton=-1;this.cancelEvents=this.propagateEvents=!1;Sa.call(this,c);this.width=a;this.height=b;this.shape=d;this.set_cursor(Uc.Button)};r["h2d.Interactive"]=Dg;Dg.__name__="h2d.Interactive";Dg.__interfaces__=[Cg];Dg.__super__=Sa;Dg.prototype=J(Sa.prototype,{onAdd:function(){this.scene=this.getScene();null!=this.scene&&this.scene.addEventTarget(this);this.updateMask();Sa.prototype.onAdd.call(this)},draw:function(a){null!=this.backgroundColor&&
this.emitTile(a,fa.fromColor(this.backgroundColor,this.width|0,this.height|0,(this.backgroundColor>>>24)/255))},getBoundsRec:function(a,b,c){Sa.prototype.getBoundsRec.call(this,a,b,c);(null!=this.backgroundColor||c)&&this.addBounds(a,b,0,0,this.width|0,this.height|0)},onHierarchyMoved:function(a){Sa.prototype.onHierarchyMoved.call(this,a);null!=this.scene&&(this.scene.removeEventTarget(this),this.scene=this.getScene(),null!=this.scene&&this.scene.addEventTarget(this));a&&this.updateMask()},updateMask:function(){this.parentMask=
null;for(var a=this.parent;null!=a;){var b=a instanceof me?a:null;if(null!=b){this.parentMask=b;break}a=a.parent}},onRemove:function(){null!=this.scene&&(this.scene.removeEventTarget(this,!0),this.scene=null);Sa.prototype.onRemove.call(this)},checkBounds:function(a){switch(a.kind._hx_index){case 4:case 6:case 7:case 10:return!1;default:return!0}},preventClick:function(){this.mouseDownButton=-1},getInteractiveScene:function(){return this.scene},handleEvent:function(a){if(null!=this.parentMask&&this.checkBounds(a)){var b=
this.parentMask,c=new ob(a.relX,a.relY);this.localToGlobal(c);for(var d=c.x,e=c.y;null!=b;){c.x=d;c.y=e;var f=b.globalToLocal(c);if(0>f.x||0>f.y||f.x>b.width||f.y>b.height){a.cancel=!0;return}b=b.parentMask}}if(null==this.shape&&(this.isEllipse&&this.checkBounds(a))&&(c=0.5*this.width,b=0.5*this.height,c=(a.relX-c)/c,b=(a.relY-b)/b,1<c*c+b*b)){a.cancel=!0;return}this.propagateEvents&&(a.propagate=!0);this.cancelEvents&&(a.cancel=!0);switch(a.kind._hx_index){case 0:if(this.enableRightButton||0==a.button)this.mouseDownButton=
a.button,this.onPush(a);break;case 1:if(this.enableRightButton||0==a.button)if(this.onRelease(a),this.mouseDownButton==a.button)this.onClick(a);this.mouseDownButton=-1;break;case 2:this.onMove(a);break;case 3:this.onOver(a);break;case 4:this.onOut(a);break;case 5:this.onWheel(a);break;case 6:this.onFocus(a);break;case 7:this.onFocusLost(a);break;case 8:this.onKeyDown(a);break;case 9:this.onKeyUp(a);break;case 10:if(this.enableRightButton||0==a.button)if(this.onRelease(a),this.mouseDownButton==a.button)this.onReleaseOutside(a);
this.mouseDownButton=-1;break;case 11:this.onTextInput(a);break;case 12:this.onCheck(a)}},calcAbsPos:function(){Sa.prototype.calcAbsPos.call(this);this.invDet=1/(this.matA*this.matD-this.matB*this.matC)},set_cursor:function(a){this.cursor=a;null!=this.scene&&null!=this.scene.events&&this.scene.events.updateCursor(this);return a},eventToLocal:function(a){var b=a.relX-this.absX,c=a.relY-this.absY;a.relX=(b*this.matD-c*this.matC)*this.invDet;a.relY=(-b*this.matB+c*this.matA)*this.invDet},startDrag:function(a,
b){var c=this;this.scene.startDrag(function(b){var e=b.relX,f=b.relY;c.eventToLocal(b);a(b);b.relX=e;b.relY=f},b)},stopDrag:function(){this.scene.stopDrag()},focus:function(){null==this.scene||null==this.scene.events||this.scene.events.focus(this)},blur:function(){this.hasFocus()&&this.scene.events.blur()},isOver:function(){return null!=this.scene&&null!=this.scene.events?-1!=this.scene.events.overList.indexOf(this):!1},hasFocus:function(){return null!=this.scene&&null!=this.scene.events?this.scene.events.currentFocus==
this:!1},onOver:function(a){},onOut:function(a){},onPush:function(a){},onRelease:function(a){},onReleaseOutside:function(a){},onClick:function(a){},onMove:function(a){},onWheel:function(a){},onFocus:function(a){},onFocusLost:function(a){},onKeyUp:function(a){},onKeyDown:function(a){},onCheck:function(a){},onTextInput:function(a){},__class__:Dg});var Hd=function(a){Ca.call(this,a);this.layersIndexes=[];this.layerCount=0};r["h2d.Layers"]=Hd;Hd.__name__="h2d.Layers";Hd.__super__=Ca;Hd.prototype=J(Ca.prototype,
{addChild:function(a){this.addChildAt(a,0)},add:function(a,b){this.addChildAt(a,b)},addChildAt:function(a,b){if(a.parent==this){var c=a.allocated;a.allocated=!1;this.removeChild(a);a.allocated=c}for(;b>=this.layerCount;)this.layersIndexes[this.layerCount++]=this.children.length;Ca.prototype.addChildAt.call(this,a,this.layersIndexes[b]);for(var c=b,d=this.layerCount;c<d;){var e=c++;this.layersIndexes[e]++}},removeChild:function(a){for(var b=0,c=this.children.length;b<c;){var d=b++;if(this.children[d]==
a){this.children.splice(d,1);if(a.allocated)a.onRemove();a.parent=null;a.posChanged=!0;null!=a.parentContainer&&a.setParentContainer(null);for(a=this.layerCount-1;0<=a&&this.layersIndexes[a]>d;)this.layersIndexes[a]--,--a;null!=this.parentContainer&&this.parentContainer.contentChanged(this);break}}},under:function(a){for(var b=0,c=this.children.length;b<c;){var d=b++;if(this.children[d]==a){for(var c=b=0,e=this.layersIndexes;c<e.length;){var f=e[c];++c;if(f>d)break;else b=f}for(;d>b;)this.children[d]=
this.children[d-1],--d;this.children[b]=a;if(a.allocated)a.onHierarchyMoved(!1);break}}},over:function(a){for(var b=0,c=this.children.length;b<c;){var d=b++;if(this.children[d]==a){for(var c=0,e=this.layersIndexes;c<e.length;)if(b=e[c],++c,b>d){for(c=b-1;d<c;)e=d++,this.children[e]=this.children[e+1];this.children[b-1]=a;if(a.allocated)a.onHierarchyMoved(!1);break}break}}},getLayer:function(a){a=a>=this.layerCount?[]:this.children.slice(0==a?0:this.layersIndexes[a-1],this.layersIndexes[a]);return new Ih(a)},
getChildLayer:function(a){if(a.parent!=this)return-1;a=this.children.indexOf(a);for(var b=0,c=this.layerCount;b<c;){var d=b++;if(this.layersIndexes[d]>a)return d}return-1},drawLayer:function(a,b){if(!(b>=this.layerCount)){var c=a.globalAlpha;a.globalAlpha*=this.alpha;var d=0==b?0:this.layersIndexes[b-1],e=this.layersIndexes[b];if(a.front2back)for(;d<e;){var f=d++;this.children[e-1-f].drawRec(a)}else for(;d<e;)f=d++,this.children[f].drawRec(a);a.globalAlpha=c}},ysort:function(a){if(!(a>=this.layerCount)){var b=
0==a?0:this.layersIndexes[a-1];a=this.layersIndexes[a];if(b!=a)for(var c=b,d=this.children[c++].y;c<a;){var e=this.children[c];if(e.y<d){for(var f=c-1;f>=b;){var g=this.children[f];if(e.y>=g.y)break;this.children[f+1]=g;--f}this.children[f+1]=e;if(e.allocated)e.onHierarchyMoved(!1)}else d=e.y;++c}}},__class__:Hd});var me=function(a,b,c){this.scrollX=this.scrollY=0;Ca.call(this,c);this.width=a;this.height=b};r["h2d.Mask"]=me;me.__name__="h2d.Mask";me.maskWith=function(a,b,c,d,e,f){null==f&&(f=0);null==
e&&(e=0);e=b.absX+e;f=b.absY+f;var g=c*b.matA+d*b.matC+e;b=c*b.matB+d*b.matD+f;e>g&&(c=e,e=g,g=c);f>b&&(c=f,f=b,b=c);a.pushRenderZone(e,f,g-e,b-f)};me.unmask=function(a){a.popRenderZone()};me.__super__=Ca;me.prototype=J(Ca.prototype,{scrollTo:function(a,b){this.set_scrollX(a);this.set_scrollY(b)},scrollBy:function(a,b){this.set_scrollX(this.scrollX+a);this.set_scrollY(this.scrollY+b)},onHierarchyMoved:function(a){Ca.prototype.onHierarchyMoved.call(this,a);a&&this.updateMask()},onAdd:function(){Ca.prototype.onAdd.call(this);
this.updateMask()},updateMask:function(){this.parentMask=null;for(var a=this.parent;null!=a;){var b=a instanceof me?a:null;if(null!=b){this.parentMask=b;break}a=a.parent}},set_scrollX:function(a){if(null!=this.scrollBounds){var b=this.scrollBounds.xMin,c=this.scrollBounds.xMax-this.width;null==c&&(c=1);null==b&&(b=0);a=a<b?b:a>c?c:a}this.posChanged=!0;return this.scrollX=a},set_scrollY:function(a){if(null!=this.scrollBounds){var b=this.scrollBounds.yMin,c=this.scrollBounds.yMax-this.height;null==
c&&(c=1);null==b&&(b=0);a=a<b?b:a>c?c:a}this.posChanged=!0;return this.scrollY=a},calcAbsPos:function(){Ca.prototype.calcAbsPos.call(this);this.absX-=this.scrollX;this.absY-=this.scrollY},getBoundsRec:function(a,b,c){var d=b.xMin,e=b.yMin,f=b.xMax,g=b.yMax;b.xMin=1E20;b.yMin=1E20;b.xMax=-1E20;b.yMax=-1E20;if(this.posChanged){this.calcAbsPos();for(var h=0,k=this.children;h<k.length;){var l=k[h];++h;l.posChanged=!0}this.posChanged=!1}this.addBounds(a,b,this.scrollX,this.scrollY,this.width,this.height);
var h=b.xMin,k=b.yMin,l=b.xMax,E=b.yMax;b.xMin=d;b.xMax=f;b.yMin=e;b.yMax=g;Ca.prototype.getBoundsRec.call(this,a,b,c);b.xMin<h&&(b.xMin=d>h?h:d);b.yMin<k&&(b.yMin=e>k?k:e);b.xMax>l&&(b.xMax=f<l?l:f);b.yMax>E&&(b.yMax=g<E?E:g)},drawRec:function(a){me.maskWith(a,this,this.width,this.height,this.scrollX,this.scrollY);Ca.prototype.drawRec.call(this,a);me.unmask(a)},__class__:me});var Id=function(){this.engine=X.CURRENT;this.time=this.frame=0;this.elapsedTime=1/U.getDefaultFrameRate();this.textures=new jj(this)};
r["h3d.impl.RenderContext"]=Id;Id.__name__="h3d.impl.RenderContext";Id.prototype={dispose:function(){this.textures.dispose()},__class__:Id};var Eg=function(a){this.renderZoneIndex=0;this.renderZoneStack=[];this.tmpBounds=new ub;this.defaultSmooth=!1;this.globalAlpha=1;Id.call(this);this.scene=a;this.bufPos=0;this.manager=new td;this.pass=new O("",null);this.pass.depth(!0,Ab.Always);this.pass.set_culling(Nb.None);this.baseShader=new Df;this.baseShader.setPriority(100);this.baseShader.zValue__=0;this.baseShaderList=
new Gb(this.baseShader);this.targetsStack=[];this.targetsStackIndex=0;this.filterStack=[]};r["h2d.RenderContext"]=Eg;Eg.__name__="h2d.RenderContext";Eg.__super__=Id;Eg.prototype=J(Id.prototype,{dispose:function(){Id.prototype.dispose.call(this);null!=this.fixedBuffer&&this.fixedBuffer.dispose()},hasBuffering:function(){return!1},begin:function(){this.currentObj=this.texture=null;this.curY=this.curX=this.stride=this.bufPos=0;this.targetFlipY=this.engine.driver.hasFeature(Ja.BottomLeftCoords)?-1:1;
this.baseFlipY=null!=this.engine.getCurrentTarget()?this.targetFlipY:1;this.inFilter=null;this.curWidth=this.scene.width;this.curHeight=this.scene.height;this.manager.globals.set("time",this.time);this.manager.globals.set("global.time",this.time);var a=this.baseShader;a.constModified=!0;a.pixelAlign__=!1;var a=this.baseShader.halfPixelInverse__,b=0.5/this.engine.width,c=0.5/this.engine.height;null==c&&(c=0);null==b&&(b=0);a.x=b;a.y=c;a.z=0;a.w=1;var a=this.baseShader.viewport__,b=0.5*-this.scene.width-
this.scene.offsetX,c=0.5*-this.scene.height-this.scene.offsetY,d=2/this.scene.width*this.scene.ratioX,e=-2*this.baseFlipY/this.scene.height*this.scene.ratioY;null==e&&(e=1);null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);a.x=b;a.y=c;a.z=d;a.w=e;a=this.baseShader.filterMatrixA__;b=1;d=c=0;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);a.x=b;a.y=c;a.z=d;a.w=1;a=this.baseShader.filterMatrixB__;b=0;c=1;d=0;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);a.x=b;a.y=c;a.z=d;a.w=1;this.baseShaderList.next=null;this.initShaders(this.baseShaderList);
this.engine.selectMaterial(this.pass);this.textures.begin()},allocTarget:function(a,b){null==b&&(b=!1);var c=this.textures.allocTarget(a,this.scene.width,this.scene.height,!1);c.set_filter(b?Jd.Linear:Jd.Nearest);return c},clear:function(a){this.engine.clear(a)},initShaders:function(a){this.currentShaders=a;this.compiledShader=this.manager.compileShaders(a);if(null==this.buffers)this.buffers=new Fg(this.compiledShader);else{a=this.buffers;var b=this.compiledShader;a.vertex.grow(b.vertex);a.fragment.grow(b.fragment)}this.manager.fillGlobals(this.buffers,
this.compiledShader);this.engine.selectShader(this.compiledShader);this.engine.uploadShaderBuffers(this.buffers,0)},end:function(){this.currentObj=this.texture=null;this.baseShaderList.next=null;if(0!=this.targetsStackIndex)throw new q("Missing popTarget()");},pushFilter:function(a){if(0==this.filterStack.length&&null!=this.onEnterFilter&&!this.onEnterFilter(a))return!1;this.filterStack.push(a);this.inFilter=a;return!0},popFilter:function(){var a=this.filterStack.pop();if(0<this.filterStack.length)this.inFilter=
this.filterStack[this.filterStack.length-1];else if(this.inFilter=null,null!=this.onLeaveFilter)this.onLeaveFilter(a)},pushTarget:function(a,b,c,d,e){null==e&&(e=-1);null==d&&(d=-1);null==c&&(c=0);null==b&&(b=0);this.engine.pushTarget(a);this.initShaders(this.baseShaderList);0>d&&(d=null==a?this.scene.width:a.width);0>e&&(e=null==a?this.scene.height:a.height);var f=this.baseShader.halfPixelInverse__,g=0.5/(null==a?this.engine.width:a.width),h=0.5/(null==a?this.engine.height:a.height);null==h&&(h=
0);null==g&&(g=0);f.x=g;f.y=h;f.z=0;f.w=1;var f=this.baseShader.viewport__,g=0.5*-d-b,h=0.5*-e-c,k=2/d,l=-2*this.targetFlipY/e;null==l&&(l=1);null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);f.x=g;f.y=h;f.z=k;f.w=l;this.targetsStackIndex++;this.targetsStackIndex>this.targetsStack.length?this.targetsStack.push({t:a,x:b,y:c,w:d,h:e,hasRZ:this.hasRenderZone,rzX:this.renderX,rzY:this.renderY,rzW:this.renderW,rzH:this.renderH}):(f=this.targetsStack[this.targetsStackIndex-1],f.t=a,f.x=b,f.y=c,f.w=d,f.h=e,f.hasRZ=
this.hasRenderZone,f.rzX=this.renderX,f.rzY=this.renderY,f.rzW=this.renderW,f.rzH=this.renderH);this.curX=b;this.curY=c;this.curWidth=d;this.curHeight=e;this.currentBlend=null;this.hasRenderZone&&(this.hasRenderZone=!1,this.engine.setRenderZone())},pushTargets:function(a){this.pushTarget(a[0]);1<a.length&&(this.engine.popTarget(),this.engine.pushTargets(a))},popTarget:function(a){null==a&&(a=!0);if(0>=this.targetsStackIndex)throw new q("Too many popTarget()");var b=this.targetsStack[--this.targetsStackIndex];
this.engine.popTarget();if(a){var c=this.targetsStack[this.targetsStackIndex-1],d,e,f,g,h,k,l;null==c?(d=null,e=a=0,f=this.scene.width,c=this.scene.height,g=this.scene.ratioX,h=this.scene.ratioY,k=this.scene.offsetX,l=this.scene.offsetY):(d=c.t,a=c.x,e=c.y,f=c.w,c=c.h,h=g=1,l=k=0);this.initShaders(this.baseShaderList);var E=this.baseShader.halfPixelInverse__,t=0.5/(null==d?this.engine.width:d.width),x=0.5/(null==d?this.engine.height:d.height);null==x&&(x=0);null==t&&(t=0);E.x=t;E.y=x;E.z=0;E.w=1;
E=this.baseShader.viewport__;k=0.5*-f-a-k;l=0.5*-c-e-l;g*=2/f;d=-2*(null==d?this.baseFlipY:this.targetFlipY)/c*h;null==d&&(d=1);null==g&&(g=0);null==l&&(l=0);null==k&&(k=0);E.x=k;E.y=l;E.z=g;E.w=d;this.curX=a;this.curY=e;this.curWidth=f;this.curHeight=c}b.hasRZ&&this.setRZ(b.rzX,b.rzY,b.rzW,b.rzH)},pushRenderZone:function(a,b,c,d){var e=this.renderZoneStack[this.renderZoneIndex++];null==e?(e={hasRZ:this.hasRenderZone,x:this.renderX,y:this.renderY,w:this.renderW,h:this.renderH},this.renderZoneStack[this.renderZoneIndex-
1]=e):this.hasRenderZone?(e.hasRZ=!0,e.x=this.renderX,e.y=this.renderY,e.w=this.renderW,e.h=this.renderH):e.hasRZ=!1;this.setRZ(a,b,c,d)},popRenderZone:function(){if(0==this.renderZoneIndex)throw new q("Too many popRenderZone()");var a=this.renderZoneStack[--this.renderZoneIndex];a.hasRZ?this.setRZ(a.x,a.y,a.w,a.h):(this.hasRenderZone=!1,this.engine.setRenderZone())},setRZ:function(a,b,c,d){this.hasRenderZone=!0;this.renderX=a;this.renderY=b;this.renderW=c;this.renderH=d;var e=this.engine.width*this.scene.ratioX/
this.scene.width,f=this.engine.height*this.scene.ratioY/this.scene.height;if(null!=this.inFilter){var g=this.baseShader.filterMatrixA__,h=this.baseShader.filterMatrixB__;c=a+c;var k=b+d,l=a*g.x+b*g.y+g.z;d=a*h.x+b*h.y+h.z;g=c*g.x+k*g.y+g.z;h=c*h.x+k*h.y+h.z;a=l;b=d;c=g-l;d=h-d}this.engine.setRenderZone((a-this.curX+this.scene.viewportX)*e+1E-10|0,(b-this.curY+this.scene.viewportY)*f+1E-10|0,c*e+1E-10|0,d*f+1E-10|0)},clearRZ:function(){this.hasRenderZone=!1;this.engine.setRenderZone()},setRenderZone:function(a,
b,c,d){this.pushRenderZone(a,b,c,d)},clearRenderZone:function(){this.popRenderZone()},drawLayer:function(a){this.scene.drawLayer(this,a)},drawScene:function(){this.scene.drawRec(this)},flush:function(){},_flush:function(){if(0!=this.bufPos){this.beforeDraw();var a=this.bufPos/this.stride|0,b=new hb(a,this.stride,[ba.Quads,ba.Dynamic,ba.RawFormat]);b.uploadVector(this.buffer,0,a);a=this.engine;a.renderBuffer(b,a.mem.quadIndexes,2,0,-1);b.dispose();this.bufPos=0;this.texture=null}},beforeDraw:function(){null==
this.texture&&(this.texture=S.fromColor(16711935));this.baseShader.texture__=this.texture;this.texture.set_filter((null==this.currentObj.smooth?this.defaultSmooth:this.currentObj.smooth)?Jd.Linear:Jd.Nearest);this.texture.set_wrap(this.currentObj.tileWrap&&(null==this.currentObj.filter||null!=this.inFilter)?Ef.Repeat:Ef.Clamp);var a=this.currentObj.blendMode;this.inFilter==this.currentObj&&a==ra.Erase&&(a=ra.Add);null!=this.inFilterBlend&&(a=this.inFilterBlend);if(a!=this.currentBlend&&(this.currentBlend=
a,this.pass.setBlendMode(a),a==ra.Alpha||a==ra.Add))this.pass.set_blendAlphaSrc(Z.One),null!=this.inFilterBlend&&this.pass.set_blendSrc(Z.One);this.manager.fillParams(this.buffers,this.compiledShader,this.currentShaders);this.engine.selectMaterial(this.pass);this.engine.uploadShaderBuffers(this.buffers,1);this.engine.uploadShaderBuffers(this.buffers,2);this.engine.uploadShaderBuffers(this.buffers,3)},setupColor:function(a){if(this.inFilter==a){var b=this.baseShader.color__,c=a.color.x,d=a.color.y,
e=a.color.z;a=a.color.w;null==a&&(a=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);b.x=c;b.y=d;b.z=e;b.w=a}else null!=this.inFilterBlend?(a=this.baseShader.color__,e=d=c=b=this.globalAlpha,null==e&&(e=1),null==d&&(d=0),null==c&&(c=0),null==b&&(b=0),a.x=b,a.y=c,a.z=d,a.w=e):(b=this.baseShader.color__,c=a.color.x,d=a.color.y,e=a.color.z,a=a.color.w*this.globalAlpha,null==a&&(a=1),null==e&&(e=0),null==d&&(d=0),null==c&&(c=0),b.x=c,b.y=d,b.z=e,b.w=a)},beginDrawObject:function(a,b){if(!this.beginDraw(a,
b,!0))return!1;if(this.inFilter==a)var c=this.baseShader.color__,d=a.color.x,e=a.color.y,f=a.color.z,g=a.color.w;else null!=this.inFilterBlend?(c=this.baseShader.color__,g=f=e=d=this.globalAlpha):(c=this.baseShader.color__,d=a.color.x,e=a.color.y,f=a.color.z,g=a.color.w*this.globalAlpha);null==g&&(g=1);null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);c.x=d;c.y=e;c.z=f;c.w=g;c=this.baseShader.absoluteMatrixA__;d=a.matA;e=a.matC;f=a.absX;null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);c.x=d;c.y=e;c.z=f;c.w=
1;c=this.baseShader.absoluteMatrixB__;d=a.matB;e=a.matD;f=a.absY;null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);c.x=d;c.y=e;c.z=f;c.w=1;this.beforeDraw();return!0},beginDrawBatch:function(a,b){return this.beginDraw(a,b,!1)},drawTile:function(a,b){var c,d,e,f,g,h;if(null!=this.inFilter){var k=this.baseShader.filterMatrixA__,l=this.baseShader.filterMatrixB__;c=a.matA*k.x+a.matB*k.y;d=a.matA*l.x+a.matB*l.y;e=a.matC*k.x+a.matD*k.y;f=a.matC*l.x+a.matD*l.y;g=a.absX*k.x+a.absY*k.y+k.z;h=a.absX*l.x+a.absY*
l.y+l.z}else c=a.matA,d=a.matB,e=a.matC,f=a.matD,g=a.absX,h=a.absY;if(0==d&&0==e){var E=a.matA,t=0>E?-E:E,x=a.matD,C=0>x?-x:x,M=1.5*(b.width>b.height?b.width:b.height)*(t<C?C:t),m=g+(b.dx+0.5*b.width)*c-this.curX,p=h+(b.dy+0.5*b.height)*f-this.curY;if(m<-M||p<-M||m-M>this.curWidth||p-M>this.curHeight)return!1}else{var n=1E20,q=1E20,r=-1E20,s=-1E20,u=b.dx*c+b.dy*e,A=b.dx*d+b.dy*f;u<n&&(n=u);u>r&&(r=u);A<q&&(q=A);A>s&&(s=A);var B=b.width,y=(B+b.dx)*c+b.dy*e,w=(B+b.dx)*d+b.dy*f;y<n&&(n=y);y>r&&(r=y);
w<q&&(q=w);w>s&&(s=w);var v=b.height,F=b.dx*c+(v+b.dy)*e,z=b.dx*d+(v+b.dy)*f;F<n&&(n=F);F>r&&(r=F);z<q&&(q=z);z>s&&(s=z);var G=b.width,I=b.height,J=(G+b.dx)*c+(I+b.dy)*e,K=(G+b.dx)*d+(I+b.dy)*f;J<n&&(n=J);J>r&&(r=J);K<q&&(q=K);K>s&&(s=K);var L=g-this.curX,Q=h-this.curY;if(0>L+r||0>Q+s||L+n>this.curWidth||Q+q>this.curHeight)return!1}if(!this.beginDraw(a,b.innerTex,!0,!0))return!1;if(this.inFilter==a){var N=this.baseShader.color__,S=a.color.x,P=a.color.y,R=a.color.z,V=a.color.w;null==V&&(V=1);null==
R&&(R=0);null==P&&(P=0);null==S&&(S=0);N.x=S;N.y=P;N.z=R;N.w=V}else if(null!=this.inFilterBlend){var O=this.baseShader.color__,Z=this.globalAlpha,T=this.globalAlpha,W=this.globalAlpha,Y=this.globalAlpha;null==Y&&(Y=1);null==W&&(W=0);null==T&&(T=0);null==Z&&(Z=0);O.x=Z;O.y=T;O.z=W;O.w=Y}else{var aa=this.baseShader.color__,X=a.color.x,ea=a.color.y,U=a.color.z,ja=a.color.w*this.globalAlpha;null==ja&&(ja=1);null==U&&(U=0);null==ea&&(ea=0);null==X&&(X=0);aa.x=X;aa.y=ea;aa.z=U;aa.w=ja}var Gh=this.baseShader.absoluteMatrixA__,
ca=b.width*a.matA,$=b.height*a.matC,Ed=a.absX+b.dx*a.matA+b.dy*a.matC;null==Ed&&(Ed=0);null==$&&($=0);null==ca&&(ca=0);Gh.x=ca;Gh.y=$;Gh.z=Ed;Gh.w=1;var Xa=this.baseShader.absoluteMatrixB__,Ye=b.width*a.matB,Ke=b.height*a.matD,na=a.absY+b.dx*a.matB+b.dy*a.matD;null==na&&(na=0);null==Ke&&(Ke=0);null==Ye&&(Ye=0);Xa.x=Ye;Xa.y=Ke;Xa.z=na;Xa.w=1;var qa=this.baseShader.uvPos__,ia=b.u,ma=b.v,ka=b.u2-b.u,wa=b.v2-b.v;null==wa&&(wa=1);null==ka&&(ka=0);null==ma&&(ma=0);null==ia&&(ia=0);qa.x=ia;qa.y=ma;qa.z=
ka;qa.w=wa;this.beforeDraw();if(null==this.fixedBuffer||this.fixedBuffer.isDisposed()){this.fixedBuffer=new hb(4,8,[ba.Quads,ba.RawFormat]);var D=Ob._new(0);if(D.pos==D.array.length){var la=D.array.length<<1;128>la&&(la=128);var yk=new Float32Array(la);yk.set(D.array);D.array=yk}D.array[D.pos++]=0;if(D.pos==D.array.length){var Ha=D.array.length<<1;128>Ha&&(Ha=128);var dd=new Float32Array(Ha);dd.set(D.array);D.array=dd}D.array[D.pos++]=0;if(D.pos==D.array.length){var Pe=D.array.length<<1;128>Pe&&(Pe=
128);var zc=new Float32Array(Pe);zc.set(D.array);D.array=zc}D.array[D.pos++]=0;if(D.pos==D.array.length){var za=D.array.length<<1;128>za&&(za=128);var Cb=new Float32Array(za);Cb.set(D.array);D.array=Cb}D.array[D.pos++]=0;if(D.pos==D.array.length){var da=D.array.length<<1;128>da&&(da=128);var ya=new Float32Array(da);ya.set(D.array);D.array=ya}D.array[D.pos++]=1;if(D.pos==D.array.length){var yg=D.array.length<<1;128>yg&&(yg=128);var Fa=new Float32Array(yg);Fa.set(D.array);D.array=Fa}D.array[D.pos++]=
1;if(D.pos==D.array.length){var ga=D.array.length<<1;128>ga&&(ga=128);var Fd=new Float32Array(ga);Fd.set(D.array);D.array=Fd}D.array[D.pos++]=1;if(D.pos==D.array.length){var pa=D.array.length<<1;128>pa&&(pa=128);var Oa=new Float32Array(pa);Oa.set(D.array);D.array=Oa}D.array[D.pos++]=1;if(D.pos==D.array.length){var Ga=D.array.length<<1;128>Ga&&(Ga=128);var ta=new Float32Array(Ga);ta.set(D.array);D.array=ta}D.array[D.pos++]=0;if(D.pos==D.array.length){var Af=D.array.length<<1;128>Af&&(Af=128);var Aa=
new Float32Array(Af);Aa.set(D.array);D.array=Aa}D.array[D.pos++]=1;if(D.pos==D.array.length){var fb=D.array.length<<1;128>fb&&(fb=128);var Qe=new Float32Array(fb);Qe.set(D.array);D.array=Qe}D.array[D.pos++]=0;if(D.pos==D.array.length){var Ra=D.array.length<<1;128>Ra&&(Ra=128);var Ac=new Float32Array(Ra);Ac.set(D.array);D.array=Ac}D.array[D.pos++]=1;if(D.pos==D.array.length){var Ea=D.array.length<<1;128>Ea&&(Ea=128);var bb=new Float32Array(Ea);bb.set(D.array);D.array=bb}D.array[D.pos++]=1;if(D.pos==
D.array.length){var ha=D.array.length<<1;128>ha&&(ha=128);var Ma=new Float32Array(ha);Ma.set(D.array);D.array=Ma}D.array[D.pos++]=1;if(D.pos==D.array.length){var va=D.array.length<<1;128>va&&(va=128);var oa=new Float32Array(va);oa.set(D.array);D.array=oa}D.array[D.pos++]=1;if(D.pos==D.array.length){var Va=D.array.length<<1;128>Va&&(Va=128);var $a=new Float32Array(Va);$a.set(D.array);D.array=$a}D.array[D.pos++]=1;if(D.pos==D.array.length){var ra=D.array.length<<1;128>ra&&(ra=128);var Re=new Float32Array(ra);
Re.set(D.array);D.array=Re}D.array[D.pos++]=1;if(D.pos==D.array.length){var Wa=D.array.length<<1;128>Wa&&(Wa=128);var wb=new Float32Array(Wa);wb.set(D.array);D.array=wb}D.array[D.pos++]=0;if(D.pos==D.array.length){var Hh=D.array.length<<1;128>Hh&&(Hh=128);var xb=new Float32Array(Hh);xb.set(D.array);D.array=xb}D.array[D.pos++]=1;if(D.pos==D.array.length){var Pa=D.array.length<<1;128>Pa&&(Pa=128);var Le=new Float32Array(Pa);Le.set(D.array);D.array=Le}D.array[D.pos++]=0;if(D.pos==D.array.length){var ua=
D.array.length<<1;128>ua&&(ua=128);var Ak=new Float32Array(ua);Ak.set(D.array);D.array=Ak}D.array[D.pos++]=1;if(D.pos==D.array.length){var Ca=D.array.length<<1;128>Ca&&(Ca=128);var xa=new Float32Array(Ca);xa.set(D.array);D.array=xa}D.array[D.pos++]=1;if(D.pos==D.array.length){var La=D.array.length<<1;128>La&&(La=128);var Qa=new Float32Array(La);Qa.set(D.array);D.array=Qa}D.array[D.pos++]=1;if(D.pos==D.array.length){var Ba=D.array.length<<1;128>Ba&&(Ba=128);var Sa=new Float32Array(Ba);Sa.set(D.array);
D.array=Sa}D.array[D.pos++]=1;if(D.pos==D.array.length){var Ya=D.array.length<<1;128>Ya&&(Ya=128);var Ka=new Float32Array(Ya);Ka.set(D.array);D.array=Ka}D.array[D.pos++]=1;if(D.pos==D.array.length){var Zb=D.array.length<<1;128>Zb&&(Zb=128);var Kb=new Float32Array(Zb);Kb.set(D.array);D.array=Kb}D.array[D.pos++]=1;if(D.pos==D.array.length){var fa=D.array.length<<1;128>fa&&(fa=128);var Lb=new Float32Array(fa);Lb.set(D.array);D.array=Lb}D.array[D.pos++]=1;if(D.pos==D.array.length){var qb=D.array.length<<
1;128>qb&&(qb=128);var Da=new Float32Array(qb);Da.set(D.array);D.array=Da}D.array[D.pos++]=1;if(D.pos==D.array.length){var sa=D.array.length<<1;128>sa&&(sa=128);var Ja=new Float32Array(sa);Ja.set(D.array);D.array=Ja}D.array[D.pos++]=1;if(D.pos==D.array.length){var Ua=D.array.length<<1;128>Ua&&(Ua=128);var Za=new Float32Array(Ua);Za.set(D.array);D.array=Za}D.array[D.pos++]=1;if(D.pos==D.array.length){var yb=D.array.length<<1;128>yb&&(yb=128);var Ta=new Float32Array(yb);Ta.set(D.array);D.array=Ta}D.array[D.pos++]=
1;if(D.pos==D.array.length){var Na=D.array.length<<1;128>Na&&(Na=128);var Bc=new Float32Array(Na);Bc.set(D.array);D.array=Bc}D.array[D.pos++]=1;this.fixedBuffer.uploadVector(D,0,4)}var db=this.engine;db.renderBuffer(this.fixedBuffer,db.mem.quadIndexes,2,0,-1);return!0},beginDraw:function(a,b,c,d){null==d&&(d=!1);if(null!=this.onBeginDraw&&!this.onBeginDraw(a))return!1;for(var e=!1,f=!1,g=a.shaders,h=this.currentShaders.next;null!=g&&null!=h;){var k=g.s,l=h.s,g=g.next,h=h.next,E=l.instance;k!=l&&(f=
!0);k.updateConstants(this.manager.globals);k.instance!=E&&(e=!0)}if(null!=g||null!=h||this.baseShader.isRelative__!=c||this.baseShader.hasUVPos__!=d||this.baseShader.killAlpha__!=this.killAlpha)e=!0;if(e)e=this.baseShader,e.constModified=!0,e.hasUVPos__=d,d=this.baseShader,d.constModified=!0,d.isRelative__=c,c=this.baseShader,c.constModified=!0,c.killAlpha__=this.killAlpha,this.baseShader.updateConstants(this.manager.globals),this.baseShaderList.next=a.shaders,this.initShaders(this.baseShaderList);
else if(f){if(this.currentShaders!=this.baseShaderList)throw new q("!");this.currentShaders.next=a.shaders}this.texture=b;this.stride=8;this.currentObj=a;return!0},__class__:Eg});var ne=K["h2d.ScaleModeAlign"]={__ename__:!0,__constructs__:["Left","Right","Center","Top","Bottom"],Left:{_hx_index:0,__enum__:"h2d.ScaleModeAlign",toString:m},Right:{_hx_index:1,__enum__:"h2d.ScaleModeAlign",toString:m},Center:{_hx_index:2,__enum__:"h2d.ScaleModeAlign",toString:m},Top:{_hx_index:3,__enum__:"h2d.ScaleModeAlign",
toString:m},Bottom:{_hx_index:4,__enum__:"h2d.ScaleModeAlign",toString:m}};ne.__empty_constructs__=[ne.Left,ne.Right,ne.Center,ne.Top,ne.Bottom];var kj=K["h2d.ScaleMode"]={__ename__:!0,__constructs__:"Resize Stretch LetterBox Fixed Zoom AutoZoom".split(" "),Resize:{_hx_index:0,__enum__:"h2d.ScaleMode",toString:m},Stretch:(s=function(a,b){return{_hx_index:1,width:a,height:b,__enum__:"h2d.ScaleMode",toString:m}},s.__params__=["width","height"],s),LetterBox:(s=function(a,b,c,d,e){return{_hx_index:2,
width:a,height:b,integerScale:c,horizontalAlign:d,verticalAlign:e,__enum__:"h2d.ScaleMode",toString:m}},s.__params__=["width","height","integerScale","horizontalAlign","verticalAlign"],s),Fixed:(s=function(a,b,c,d,e){return{_hx_index:3,width:a,height:b,zoom:c,horizontalAlign:d,verticalAlign:e,__enum__:"h2d.ScaleMode",toString:m}},s.__params__=["width","height","zoom","horizontalAlign","verticalAlign"],s),Zoom:(s=function(a){return{_hx_index:4,level:a,__enum__:"h2d.ScaleMode",toString:m}},s.__params__=
["level"],s),AutoZoom:(s=function(a,b,c){return{_hx_index:5,minWidth:a,minHeight:b,integerScaling:c,__enum__:"h2d.ScaleMode",toString:m}},s.__params__=["minWidth","minHeight","integerScaling"],s)};kj.__empty_constructs__=[kj.Resize];var Gg=function(){};r["hxd.InteractiveScene"]=Gg;Gg.__name__="hxd.InteractiveScene";Gg.__isInterface__=!0;Gg.prototype={__class__:Gg};var Mc=function(){this.scaleMode=kj.Resize;Hd.call(this,null);var a=X.CURRENT;this.ctx=new Eg(this);this.width=a.width;this.height=a.height;
this.offsetY=this.offsetX=0;this.ratioY=this.ratioX=1;this.viewportY=this.viewportX=0;this.interactive=[];this.eventListeners=[];this.shapePoint=new ob;this.window=db.getInstance();this.posChanged=!0};r["h2d.Scene"]=Mc;Mc.__name__="h2d.Scene";Mc.__interfaces__=[Gg,wf];Mc.__super__=Hd;Mc.prototype=J(Hd.prototype,{get_defaultSmooth:function(){return this.ctx.defaultSmooth},set_defaultSmooth:function(a){return this.ctx.defaultSmooth=a},setEvents:function(a){this.events=a},get_zoom:function(){var a=this.scaleMode;
return 4==a._hx_index?a.level|0:0},set_zoom:function(a){this.set_scaleMode(kj.Zoom(a));return a},set_scaleMode:function(a){this.scaleMode=a;this.checkResize();return a},get_renderer:function(){return this.ctx},set_renderer:function(a){return this.ctx=a},setFixedSize:function(a,b){this.set_scaleMode(kj.Stretch(a,b))},checkResize:function(){var a=X.CURRENT,b=this.scaleMode;switch(b._hx_index){case 0:b=a.width;a=a.height;if(b!=this.width||a!=this.height)this.width=b,this.height=a,this.posChanged=!0;
this.ratioY=this.ratioX=1;this.viewportY=this.viewportX=this.offsetY=this.offsetX=0;break;case 1:a=b.height;b=b.width;if(b!=this.width||a!=this.height)this.width=b,this.height=a,this.posChanged=!0;this.ratioY=this.ratioX=1;this.viewportY=this.viewportX=this.offsetY=this.offsetX=0;break;case 2:var c=b.verticalAlign,d=b.horizontalAlign,e=b.integerScale,f=b.height,b=b.width;if(b!=this.width||f!=this.height)this.width=b,this.height=f,this.posChanged=!0;b=a.width/b;f=a.height/f;b=b>f?f:b;e&&(b|=0,0==b&&
(b=1));this.ratioX=this.width*b/a.width;this.ratioY=this.height*b/a.height;null==d&&(d=ne.Center);switch(d._hx_index){case 0:this.offsetX=(a.width-this.width*b)/(2*b);this.viewportX=0;break;case 1:this.offsetX=-((a.width-this.width*b)/(2*b));this.viewportX=(a.width-this.width*b)/b;break;default:this.offsetX=0.5*-((a.width-this.width*b)/2%1),this.viewportX=(a.width-this.width*b)/(2*b)}null==c&&(c=ne.Center);switch(c._hx_index){case 3:this.offsetY=(a.height-this.height*b)/(2*b);this.viewportY=0;break;
case 4:this.offsetY=-((a.height-this.height*b)/(2*b));this.viewportY=(a.height-this.height*b)/b;break;default:this.offsetY=0.5*-((a.height-this.height*b)/2%1),this.viewportY=(a.height-this.height*b)/(2*b)}break;case 3:d=b.verticalAlign;e=b.horizontalAlign;c=b.zoom;f=b.height;b=b.width;if(b!=this.width||f!=this.height)this.width=b,this.height=f,this.posChanged=!0;this.ratioX=this.width*c/a.width;this.ratioY=this.height*c/a.height;b=e;null==b&&(b=ne.Center);switch(b._hx_index){case 0:this.offsetX=(a.width-
this.width*c)/(2*c);this.viewportX=0;break;case 1:this.offsetX=-((a.width-this.width*c)/(2*c));this.viewportX=(a.width-this.width*c)/c;break;default:this.offsetX=0.5*-((a.width-this.width*c)/2%1),this.viewportX=(a.width-this.width*c)/(2*c)}null==d&&(d=ne.Center);switch(d._hx_index){case 3:this.offsetY=(a.height-this.height*c)/(2*c);this.viewportY=0;break;case 4:this.offsetY=-((a.height-this.height*c)/(2*c));this.viewportY=(a.height-this.height*c)/c;break;default:this.offsetY=0.5*-((a.height-this.height*
c)/2%1),this.viewportY=(a.height-this.height*c)/(2*c)}break;case 4:b=b.level;c=Math.ceil(a.width/b);d=Math.ceil(a.height/b);if(c!=this.width||d!=this.height)this.width=c,this.height=d,this.posChanged=!0;this.ratioX=this.width*b/a.width;this.ratioY=this.height*b/a.height;this.viewportY=this.viewportX=this.offsetY=this.offsetX=0;break;case 5:c=a.width/b.minWidth;d=a.height/b.minHeight;c=c>d?d:c;b.integerScaling&&(c|=0,0==c&&(c=1));b=Math.ceil(a.width/c);d=Math.ceil(a.height/c);if(b!=this.width||d!=
this.height)this.width=b,this.height=d,this.posChanged=!0;this.ratioX=this.width*c/a.width;this.ratioY=this.height*c/a.height;this.viewportY=this.viewportX=this.offsetY=this.offsetX=0}},screenXToViewport:function(a){return a*this.width/(this.window.get_width()*this.ratioX)-this.viewportX},screenYToViewport:function(a){return a*this.height/(this.window.get_height()*this.ratioY)-this.viewportY},get_mouseX:function(){this.syncPos();var a=this.window.get_mouseX()*this.width/(this.window.get_width()*this.ratioX)-
this.viewportX-this.absX;if(0==this.matC)return a/this.matA;var b=this.window.get_mouseY()*this.height/(this.window.get_height()*this.ratioY)-this.viewportY-this.absY;return(a*this.matD-b*this.matC)/(this.matA*this.matD-this.matB*this.matC)},get_mouseY:function(){this.syncPos();var a=this.window.get_mouseY()*this.height/(this.window.get_height()*this.ratioY)-this.viewportY-this.absY;if(0==this.matB)return a/this.matD;var b=this.window.get_mouseX()*this.width/(this.window.get_width()*this.ratioX)-
this.viewportX-this.absX;return(a*this.matA-b*this.matB)/(this.matA*this.matD-this.matB*this.matC)},dispatchListeners:function(a){this.screenToViewport(a);for(var b=0,c=this.eventListeners;b<c.length;){var d=c[b];++b;d(a);if(!a.propagate)break}},isInteractiveVisible:function(a){for(;a!=this;){if(null==a||!a.visible)return!1;a=a.parent}return!0},getInteractive:function(a,b){for(var c=this.shapePoint,d=0,e=this.interactive;d<e.length;){var f=e[d];++d;f.posChanged&&f.syncPos();var g=a-f.absX,h=b-f.absY,
k=(g*f.matD-h*f.matC)*f.invDet,g=(h*f.matA-g*f.matB)*f.invDet;if(null!=f.shape){if(c.x=k+f.shapeX,c.y=g+f.shapeY,!f.shape.contains(c))continue}else if(0>g||0>k||k>=f.width||g>=f.height)continue;k=!0;for(g=f;null!=g;){if(!g.visible){k=!1;break}g=g.parent}if(k)return f}return null},screenToViewport:function(a){a.relX=a.relX*this.width/(this.window.get_width()*this.ratioX)-this.viewportX;a.relY=a.relY*this.height/(this.window.get_height()*this.ratioY)-this.viewportY},dispatchEvent:function(a,b){this.screenToViewport(a);
var c=a.relX-b.absX,d=a.relY-b.absY,e=(d*b.matA-c*b.matB)*b.invDet;a.relX=(c*b.matD-d*b.matC)*b.invDet;a.relY=e;b.handleEvent(a)},handleEvent:function(a,b){this.screenToViewport(a);for(var c=a.relX,d=a.relY,e=null==b?0:this.interactive.indexOf(b)+1,f=this.shapePoint,g=this.interactive.length;e<g;){var h=e++,h=this.interactive[h];if(null==h)break;if(0!=h.invDet){var k=c-h.absX,l=d-h.absY,E=(k*h.matD-l*h.matC)*h.invDet,k=(l*h.matA-k*h.matB)*h.invDet;if(null!=h.shape){if(f.x=E+h.shapeX,f.y=k+h.shapeY,
!h.shape.contains(f))continue}else if(0>k||0>E||E>=h.width||k>=h.height)continue;for(var l=!0,t=h;null!=t;){if(!t.visible){l=!1;break}t=t.parent}if(l)if(a.relX=E,a.relY=k,h.handleEvent(a),a.cancel)a.cancel=!1,a.propagate=!1;else return h}}return null},addEventListener:function(a){this.eventListeners.push(a)},removeEventListener:function(a){for(var b=0,c=this.eventListeners;b<c.length;){var d=c[b];++b;if(ua.compareMethods(d,a))return v.remove(this.eventListeners,d),!0}return!1},startDrag:function(a,
b,c){var d=this;this.events.startDrag(function(b){d.screenToViewport(b);a(b)},b,c)},stopDrag:function(){this.events.stopDrag()},getFocus:function(){if(null==this.events)return null;var a=this.events.getFocus();if(null==a)return null;a=a instanceof Dg?a:null;return null==a?null:this.interactive[this.interactive.indexOf(a)]},addEventTarget:function(a){for(var b=a,c=0;null!=b;)b=b.parent,++c;for(var b=c,c=0,d=this.interactive.length;c<d;){for(var e=c++,f=a,g=this.interactive[e],h=b,k=g,l=0;null!=k;)k=
k.parent,++l;for(var E=l,l=f,k=g;h>E;)f=l,l=l.parent,--h;for(;E>h;)g=k,k=k.parent,--E;for(;l!=k;)f=l,l=l.parent,g=k,k=k.parent;for(var h=-1,E=0,t=l.children.length;E<t;){var x=E++;if(l.children[x]==f){h=x;break}}f=h;l=-1;h=0;for(E=k.children.length;h<E;)if(t=h++,k.children[t]==g){l=t;break}if(f>l){this.interactive.splice(e,0,a);return}}this.interactive.push(a)},removeEventTarget:function(a,b){null==b&&(b=!1);v.remove(this.interactive,a);if(b&&null!=this.events)this.events.onRemove(a)},dispose:function(){if(this.allocated)this.onRemove();
this.ctx.dispose()},setElapsedTime:function(a){this.ctx.elapsedTime=a},drawImplTo:function(a,b,c){for(var d=0;d<b.length;){var e=b[d];++d;if(0==(e.flags&1<<V.Target._hx_index))throw new q("Can only draw to texture created with Target flag");}this.ctx.engine=X.CURRENT;d=this.ctx.engine.backgroundColor;this.ctx.engine.backgroundColor=null;this.ctx.engine.begin();this.ctx.globalAlpha=this.alpha;this.ctx.begin();this.ctx.pushTargets(b);null!=c&&this.ctx.manager.setOutput(c);1==b.length&&0==(b[0].flags&
1<<V.WasCleared._hx_index)&&this.ctx.engine.clear(0);a.drawRec(this.ctx);null!=c&&this.ctx.manager.setOutput();this.ctx.popTarget();this.ctx.engine.backgroundColor=d},syncOnly:function(a){var b=X.CURRENT;this.setElapsedTime(a);this.ctx.engine=b;this.ctx.frame++;this.ctx.time+=this.ctx.elapsedTime;this.ctx.globalAlpha=this.alpha;this.sync(this.ctx)},render:function(a){this.ctx.engine=a;this.ctx.frame++;this.ctx.time+=this.ctx.elapsedTime;this.ctx.globalAlpha=this.alpha;this.sync(this.ctx);0!=this.children.length&&
(this.ctx.begin(),this.ctx.drawScene(),this.ctx.end())},sync:function(a){if(!this.allocated)this.onAdd();Hd.prototype.sync.call(this,a)},onAdd:function(){this.checkResize();Hd.prototype.onAdd.call(this);this.window.addResizeEvent(z(this,this.checkResize))},onRemove:function(){Hd.prototype.onRemove.call(this);this.window.removeResizeEvent(z(this,this.checkResize))},captureBitmap:function(a){var b=X.CURRENT;null==a&&(a=new S(this.width,this.height,[V.Target]),a=new fa(a,0,0,this.width,this.height));
b.begin();b.setRenderZone(a.x|0,a.y|0,Math.ceil(a.width),Math.ceil(a.height));var c=a.innerTex;b.pushTarget(c);var d=this.width,e=this.height,f=this.offsetX,g=this.offsetY,h=this.viewportX,k=this.viewportY,l=this.ratioX,E=this.ratioY;this.width=c.width;this.height=c.height;this.ratioY=this.ratioX=1;this.viewportY=this.viewportX=this.offsetY=this.offsetX=0;this.posChanged=!0;this.render(b);b.popTarget();this.width=d;this.height=e;this.ratioX=l;this.ratioY=E;this.offsetX=f;this.offsetY=g;this.viewportX=
h;this.viewportY=k;this.posChanged=!0;b.setRenderZone();b.end();return new tg(a)},__class__:Mc});var Kd=K["h2d.Align"]={__ename__:!0,__constructs__:["Left","Right","Center","MultilineRight","MultilineCenter"],Left:{_hx_index:0,__enum__:"h2d.Align",toString:m},Right:{_hx_index:1,__enum__:"h2d.Align",toString:m},Center:{_hx_index:2,__enum__:"h2d.Align",toString:m},MultilineRight:{_hx_index:3,__enum__:"h2d.Align",toString:m},MultilineCenter:{_hx_index:4,__enum__:"h2d.Align",toString:m}};Kd.__empty_constructs__=
[Kd.Left,Kd.Right,Kd.Center,Kd.MultilineRight,Kd.MultilineCenter];var uh=function(a,b){this.constraintWidth=this.realMaxWidth=-1;Sa.call(this,b);this.set_font(a);this.set_textAlign(Kd.Left);this.set_letterSpacing(1);this.set_lineSpacing(0);this.set_text("");this.currentText="";this.set_textColor(16777215)};r["h2d.Text"]=uh;uh.__name__="h2d.Text";uh.__super__=Sa;uh.prototype=J(Sa.prototype,{set_font:function(a){if(this.font==a)return a;this.font=a;if(null!=a){var b=a.type;switch(b._hx_index){case 0:null!=
this.sdfShader&&(this.removeShader(this.sdfShader),this.sdfShader=null);break;case 1:var c=b.smoothing,d=b.alphaCutoff,b=b.channel;null==this.sdfShader&&(this.sdfShader=new Ff,this.addShader(this.sdfShader));this.sdfShader.alphaCutoff__=d;this.sdfShader.smoothing__=c;c=this.sdfShader;c.constModified=!0;c.channel__=b}}null!=this.glyphs&&(c=this.glyphs,null!=c&&null!=c.parent&&c.parent.removeChild(c));this.glyphs=new vg(null==a?null:a.tile,this);this.glyphs.set_visible(!1);this.rebuild();return a},
set_textAlign:function(a){if(this.textAlign==a)return a;this.textAlign=a;this.rebuild();return a},set_letterSpacing:function(a){if(this.letterSpacing==a)return a;this.letterSpacing=a;this.rebuild();return a},set_lineSpacing:function(a){if(this.lineSpacing==a)return a;this.lineSpacing=a;this.rebuild();return a},constraintSize:function(a,b){this.constraintWidth=a;this.updateConstraint()},onAdd:function(){Sa.prototype.onAdd.call(this);this.rebuild()},checkText:function(){this.textChanged&&this.text!=
this.currentText&&(this.textChanged=!1,this.currentText=this.text,this.calcDone=!1,this.needsRebuild=!0)},sync:function(a){Sa.prototype.sync.call(this,a);this.textChanged&&this.text!=this.currentText&&(this.textChanged=!1,this.currentText=this.text,this.calcDone=!1,this.needsRebuild=!0);this.needsRebuild&&this.initGlyphs(this.currentText)},draw:function(a){if(null==this.glyphs)this.emitTile(a,fa.fromColor(16711935,16,16));else{this.textChanged&&this.text!=this.currentText&&(this.textChanged=!1,this.currentText=
this.text,this.calcDone=!1,this.needsRebuild=!0);this.needsRebuild&&this.initGlyphs(this.currentText);if(null!=this.dropShadow){var b=this.absX,c=this.absY;this.absX+=this.dropShadow.dx*this.matA+this.dropShadow.dy*this.matC;this.absY+=this.dropShadow.dx*this.matB+this.dropShadow.dy*this.matD;var d=this.color.x,e=this.color.y,f=this.color.z,g=this.color.w,h=this.color,k=this.dropShadow.color;h.x=(k>>16&255)/255;h.y=(k>>8&255)/255;h.z=(k&255)/255;h.w=(k>>>24)/255;this.color.w=this.dropShadow.alpha*
g;this.glyphs.drawWith(a,this);this.absX=b;this.absY=c;b=this.color;null==g&&(g=1);null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);b.x=d;b.y=e;b.z=f;b.w=g}this.glyphs.drawWith(a,this)}},set_text:function(a){a=null==a?"null":a;if(a==this.text)return a;this.text=a;this.textChanged=!0;this.validateText();null!=this.parentContainer&&this.parentContainer.contentChanged(this);return a},validateText:function(){},rebuild:function(){this.calcDone=!1;this.needsRebuild=!0;null!=this.parentContainer&&this.parentContainer.contentChanged(this)},
calcTextWidth:function(a){if(this.calcDone){var b=this.calcWidth,c=this.calcHeight,d=this.calcSizeHeight,e=this.calcXMin,f=this.calcYMin;this.initGlyphs(a,!1);a=this.calcWidth;this.calcWidth=b;this.calcHeight=c;this.calcSizeHeight=d;this.calcXMin=e;this.calcYMin=f;return a}this.initGlyphs(a,!1);this.calcDone=!1;return this.calcWidth},splitText:function(a){return this.splitRawText(a,0,0)},splitRawText:function(a,b,c,d,e,f){null==f&&(f=-1);null==c&&(c=0);null==b&&(b=0);var g=this.realMaxWidth;if(0>
g){if(null==e)return a;g=Infinity}null==d&&(d=this.font);for(var h=[],k=0,l=b,E=0,t=a.length;E<t;){var x=E++,C=v.cca(a,x),M=d.glyphs.h[C];null==M&&(M=d.charset.resolveChar(C,d.glyphs),null==M&&(M=13==C||10==C?d.nullChar:d.defaultChar));var m=10==C,p=M.width+M.getKerningOffset(f);if(d.charset.isBreakChar(C)){0==h.length&&(0<b&&l>g)&&(h.push(""),null!=e&&e.push(b),l-=b);for(var n=l+p+this.letterSpacing,q=x+1,r=a.length,s=!1;n<=g&&q<r;){var u=v.cca(a,q++);if(d.charset.isSpace(u)||10==u){s=!0;break}var A=
d.glyphs.h[u];null==A&&(A=d.charset.resolveChar(u,d.glyphs),null==A&&(A=13==u||10==u?d.nullChar:d.defaultChar));n+=A.width+this.letterSpacing+A.getKerningOffset(f);f=u;if(d.charset.isBreakChar(u))break}if(n>g||!s&&n+c>g)m=!0,d.charset.isSpace(C)?(h.push(v.substr(a,k,x-k)),M=null):h.push(v.substr(a,k,x+1-k)),k=x+1}null!=M&&10!=C&&(l+=p+this.letterSpacing);m?(null!=e&&e.push(l),l=0,f=-1):f=C}k<a.length&&(0==h.length&&(0<b&&l+c-this.letterSpacing>g)&&(h.push(""),null!=e&&e.push(b),l-=b),h.push(v.substr(a,
k,a.length-k)),null!=e&&e.push(l));return h.join("\n")},getTextProgress:function(a,b){return b>=a.length?a:v.substr(a,0,b|0)},initGlyphs:function(a,b){null==b&&(b=!0);b&&this.glyphs.clear();for(var c=0,d=0,e=0,f=0,g=0,h=-1,k=0,l=this.textAlign,E=[],t=this.font.lineHeight+this.lineSpacing,x=this.splitRawText(a,0,0,null,E),C=0;C<E.length;){var M=E[C];++C;M>c&&(c=M)}this.calcWidth=c;switch(l._hx_index){case 0:c=0;break;case 1:case 2:case 3:case 4:c=l==Kd.MultilineCenter||l==Kd.MultilineRight?Math.ceil(this.calcWidth):
0>this.realMaxWidth?0:Math.ceil(this.realMaxWidth);f=l==Kd.Center||l==Kd.MultilineCenter?0.5:1;C=0;for(M=E.length;C<M;){var m=C++;E[m]=Math.floor((c-E[m])*f)}f=c=E[0]}C=0;for(M=x.length;C<M;){var m=C++,m=v.cca(x,m),p=this.font,n=p.glyphs.h[m];null==n&&(n=p.charset.resolveChar(m,p.glyphs),null==n&&(n=13==m||10==m?p.nullChar:p.defaultChar));p=n;h=p.getKerningOffset(h);n=p.width+h;if(10==m){c>e&&(e=c);switch(l._hx_index){case 0:c=0;break;case 1:case 2:case 3:case 4:c=E[++k],c<f&&(f=c)}d+=t;h=-1}else{if(null!=
p){if(b){var q=this.glyphs;q.content.add(c+h,d,q.curColor.x,q.curColor.y,q.curColor.z,q.curColor.w,p.t)}0==d&&p.t.dy<g&&(g=p.t.dy);c+=n+this.letterSpacing}h=m}}c>e&&(e=c);this.calcXMin=f;this.calcYMin=g;this.calcWidth=e-f;this.calcHeight=d+this.font.lineHeight;this.calcSizeHeight=d+(0<this.font.baseLine?this.font.baseLine:this.font.lineHeight);this.calcDone=!0;b&&(this.needsRebuild=!1)},updateSize:function(){this.textChanged&&this.text!=this.currentText&&(this.textChanged=!1,this.currentText=this.text,
this.calcDone=!1,this.needsRebuild=!0);this.calcDone||this.initGlyphs(this.text,this.needsRebuild)},get_textHeight:function(){this.textChanged&&this.text!=this.currentText&&(this.textChanged=!1,this.currentText=this.text,this.calcDone=!1,this.needsRebuild=!0);this.calcDone||this.initGlyphs(this.text,this.needsRebuild);return this.calcHeight},get_textWidth:function(){this.textChanged&&this.text!=this.currentText&&(this.textChanged=!1,this.currentText=this.text,this.calcDone=!1,this.needsRebuild=!0);
this.calcDone||this.initGlyphs(this.text,this.needsRebuild);return this.calcWidth},set_maxWidth:function(a){if(this.maxWidth==a)return a;this.maxWidth=a;this.updateConstraint();return a},updateConstraint:function(){var a=this.realMaxWidth;if(null==this.maxWidth)this.realMaxWidth=this.constraintWidth;else if(0>this.constraintWidth)this.realMaxWidth=this.maxWidth;else{var b=this.maxWidth,c=this.constraintWidth;this.realMaxWidth=b>c?c:b}this.realMaxWidth!=a&&this.rebuild()},set_textColor:function(a){if(this.textColor==
a)return a;this.textColor=a;var b=this.color.w,c=this.color;c.x=(a>>16&255)/255;c.y=(a>>8&255)/255;c.z=(a&255)/255;c.w=(a>>>24)/255;this.color.w=b;return a},getBoundsRec:function(a,b,c){Sa.prototype.getBoundsRec.call(this,a,b,c);this.textChanged&&this.text!=this.currentText&&(this.textChanged=!1,this.currentText=this.text,this.calcDone=!1,this.needsRebuild=!0);this.calcDone||this.initGlyphs(this.text,this.needsRebuild);var d,e,f;c?(c=this.calcXMin,d=0,e=this.calcWidth,f=this.calcSizeHeight):(c=this.calcXMin,
d=this.calcYMin,e=this.calcWidth,f=this.calcHeight-this.calcYMin);this.addBounds(a,b,c,d,e,f)},__class__:uh});var fa=function(a,b,c,d,e,f,g){null==g&&(g=0);null==f&&(f=0);this.innerTex=a;this.x=b;this.y=c;this.width=d;this.height=e;this.dx=f;this.dy=g;null!=a&&this.setTexture(a)};r["h2d.Tile"]=fa;fa.__name__="h2d.Tile";fa.fromColor=function(a,b,c,d){null==d&&(d=1);null==c&&(c=1);null==b&&(b=1);a=new fa(S.fromColor(a,d),0,0,1,1);a.width=b;a.height=c;return a};fa.fromBitmap=function(a){var b=S.fromBitmap(a);
return new fa(b,0,0,a.ctx.canvas.width,a.ctx.canvas.height)};fa.autoCut=function(a,b,c){a.lock();null==c&&(c=b);for(var d=a.getPixel(a.ctx.canvas.width-1,a.ctx.canvas.height-1),e=[],f=1,g=1;f<a.ctx.canvas.width;)f<<=1;for(;g<a.ctx.canvas.height;)g<<=1;for(var f=new S(f,g),g=0,h=a.ctx.canvas.height/c|0;g<h;){var k=g++,l=[];e[k]=l;for(var E=0,t=a.ctx.canvas.width/b|0;E<t;){var x=E++,C=fa.isEmpty(a,x*b,k*c,b,c,d);if(null==C)break;l.push(new fa(f,x*b+C.dx,k*c+C.dy,C.w,C.h,C.dx,C.dy))}}a.unlock();b=new fa(f,
0,0,a.ctx.canvas.width,a.ctx.canvas.height);b.upload(a);return{main:b,tiles:e}};fa.fromTexture=function(a){return new fa(a,0,0,a.width,a.height)};fa.fromPixels=function(a){var b=a.makeSquare(!0),c=S.fromPixels(b);b!=a&&b.dispose();return new fa(c,0,0,a.width,a.height)};fa.isEmpty=function(a,b,c,d,e,f){for(var g=!0,h=d,k=e,l=0,E=0,t=0;t<d;)for(var x=t++,C=0,M=e;C<M;){var m=C++,p=a.getPixel(x+b,m+c);0==(p&-16777216)?0!=p&&a.setPixel(x+b,m+c,0):(p!=f&&(g=!1,x<h&&(h=x),m<k&&(k=m),x>l&&(l=x),m>E&&(E=m)),
p==f&&0!=p&&a.setPixel(x+b,m+c,0))}return g?null:{dx:h,dy:k,w:l-h+1,h:E-k+1}};fa.prototype={get_ix:function(){return Math.floor(this.x)},get_iy:function(){return Math.floor(this.y)},get_iwidth:function(){return Math.ceil(this.width+this.x)-Math.floor(this.x)},get_iheight:function(){return Math.ceil(this.height+this.y)-Math.floor(this.y)},getTexture:function(){return this.innerTex},isDisposed:function(){if(null!=this.innerTex){var a=this.innerTex;return null==a.t?null==a.realloc:!1}return!0},setTexture:function(a){this.innerTex=
a;null!=a&&(this.u=this.x/a.width,this.v=this.y/a.height,this.u2=(this.x+this.width)/a.width,this.v2=(this.y+this.height)/a.height)},switchTexture:function(a){this.setTexture(a.innerTex)},sub:function(a,b,c,d,e,f){null==f&&(f=0);null==e&&(e=0);return new fa(this.innerTex,this.x+a,this.y+b,c,d,e,f)},center:function(){return this.sub(0,0,this.width,this.height,-(0.5*this.width),-(0.5*this.height))},setCenterRatio:function(a,b){null==b&&(b=0.5);null==a&&(a=0.5);this.dx=-(a*this.width);this.dy=-(b*this.height)},
flipX:function(){var a=this.u;this.u=this.u2;this.u2=a;this.dx=-this.dx-this.width},flipY:function(){var a=this.v;this.v=this.v2;this.v2=a;this.dy=-this.dy-this.height},setPosition:function(a,b){this.x=a;this.y=b;var c=this.innerTex;null!=c&&(this.u=a/c.width,this.v=b/c.height,this.u2=(a+this.width)/c.width,this.v2=(b+this.height)/c.height)},setSize:function(a,b){this.width=a;this.height=b;var c=this.innerTex;null!=c&&(this.u2=(this.x+a)/c.width,this.v2=(this.y+b)/c.height)},scaleToSize:function(a,
b){this.width=a;this.height=b},scrollDiscrete:function(a,b){var c=this.innerTex;this.u+=a/c.width;this.v-=b/c.height;this.u2+=a/c.width;this.v2-=b/c.height;this.x=this.u*c.width;this.y=this.v*c.height},dispose:function(){null!=this.innerTex&&this.innerTex.dispose();this.innerTex=null},clone:function(){var a=new fa(null,this.x,this.y,this.width,this.height,this.dx,this.dy);a.innerTex=this.innerTex;a.u=this.u;a.u2=this.u2;a.v=this.v;a.v2=this.v2;return a},split:function(a,b,c){null==c&&(c=!1);null==
b&&(b=!1);null==a&&(a=0);var d=[];if(b){0==a&&(a=this.height/this.width|0);b=c?this.height/a:this.height/a|0;for(c=0;c<a;){var e=c++;d.push(this.sub(0,e*b,this.width,b))}}else{0==a&&(a=this.width/this.height|0);b=c?this.width/a:this.width/a|0;for(c=0;c<a;)e=c++,d.push(this.sub(e*b,0,b,this.height))}return d},gridFlatten:function(a,b,c){null==c&&(c=0);null==b&&(b=0);for(var d=[],e=0,f=this.height/a|0;e<f;)for(var g=e++,h=0,k=this.width/a|0;h<k;){var l=h++;d.push(this.sub(l*a,g*a,a,a,b,c))}return d},
grid:function(a,b,c){null==c&&(c=0);null==b&&(b=0);for(var d=[],e=0,f=this.width/a|0;e<f;){for(var g=e++,h=[],k=0,l=this.height/a|0;k<l;){var E=k++;h.push(this.sub(g*a,E*a,a,a,b,c))}d.push(h)}return d},toString:function(){return"Tile("+this.x+","+this.y+","+this.width+"x"+this.height+(0!=this.dx||0!=this.dy?","+this.dx+":"+this.dy:"")+")"},upload:function(a){this.innerTex.uploadBitmap(a)},__class__:fa};var bc=function(){};r["hxd.impl._Serializable.NoSerializeSupport"]=bc;bc.__name__="hxd.impl._Serializable.NoSerializeSupport";
bc.__isInterface__=!0;var Pb=function(){this.refCount=0};r["h3d.prim.Primitive"]=Pb;Pb.__name__="h3d.prim.Primitive";Pb.__interfaces__=[bc];Pb.prototype={triCount:function(){return null!=this.indexes?this.indexes.count/3|0:null==this.buffer?0:this.buffer.totalVertices()/3|0},vertexCount:function(){return 0},getCollider:function(){throw new q("not implemented for "+n.string(this));},getBounds:function(){throw new q("not implemented for "+n.string(this));},incref:function(){this.refCount++},decref:function(){this.refCount--;
0>=this.refCount&&(this.refCount=0,this.dispose())},alloc:function(a){throw new q("not implemented");},selectMaterial:function(a){},buildNormalsDisplay:function(){throw new q("not implemented for "+n.string(this));},render:function(a){(null==this.buffer||this.buffer.isDisposed())&&this.alloc(a);null==this.indexes?0!=(this.buffer.flags&1<<ba.Quads._hx_index)?a.renderBuffer(this.buffer,a.mem.quadIndexes,2,0,-1):a.renderBuffer(this.buffer,a.mem.triIndexes,3,0,-1):a.renderIndexed(this.buffer,this.indexes)},
dispose:function(){null!=this.buffer&&(this.buffer.dispose(),this.buffer=null);null!=this.indexes&&(this.indexes.dispose(),this.indexes=null)},toString:function(){return ia.getClass(this).__name__.split(".").pop()},__class__:Pb};var Jh=function(){this.refCount=0;this.clear()};r["h2d.TileLayerContent"]=Jh;Jh.__name__="h2d.TileLayerContent";Jh.__super__=Pb;Jh.prototype=J(Pb.prototype,{clear:function(){this.tmp=Ob._new(0);null!=this.buffer&&this.buffer.dispose();this.buffer=null;this.yMin=this.xMin=
Infinity;this.yMax=this.xMax=-Infinity},isEmpty:function(){return 0==this.triCount()},triCount:function(){return null==this.buffer?this.tmp.pos>>4:this.buffer.totalVertices()>>1},addColor:function(a,b,c,d){this.add(a,b,c.x,c.y,c.z,c.w,d)},add:function(a,b,c,d,e,f,g){var h=a+g.dx,k=b+g.dy,l=this.tmp;if(l.pos==l.array.length){var E=l.array.length<<1;128>E&&(E=128);var t=new Float32Array(E);t.set(l.array);l.array=t}l.array[l.pos++]=h;var x=this.tmp;if(x.pos==x.array.length){var C=x.array.length<<1;128>
C&&(C=128);var M=new Float32Array(C);M.set(x.array);x.array=M}x.array[x.pos++]=k;var m=this.tmp,p=g.u;if(m.pos==m.array.length){var n=m.array.length<<1;128>n&&(n=128);var q=new Float32Array(n);q.set(m.array);m.array=q}m.array[m.pos++]=p;var r=this.tmp,s=g.v;if(r.pos==r.array.length){var u=r.array.length<<1;128>u&&(u=128);var A=new Float32Array(u);A.set(r.array);r.array=A}r.array[r.pos++]=s;var y=this.tmp;if(y.pos==y.array.length){var B=y.array.length<<1;128>B&&(B=128);var w=new Float32Array(B);w.set(y.array);
y.array=w}y.array[y.pos++]=c;var v=this.tmp;if(v.pos==v.array.length){var F=v.array.length<<1;128>F&&(F=128);var z=new Float32Array(F);z.set(v.array);v.array=z}v.array[v.pos++]=d;var G=this.tmp;if(G.pos==G.array.length){var I=G.array.length<<1;128>I&&(I=128);var J=new Float32Array(I);J.set(G.array);G.array=J}G.array[G.pos++]=e;var K=this.tmp;if(K.pos==K.array.length){var L=K.array.length<<1;128>L&&(L=128);var N=new Float32Array(L);N.set(K.array);K.array=N}K.array[K.pos++]=f;var Q=this.tmp,S=h+g.width;
if(Q.pos==Q.array.length){var P=Q.array.length<<1;128>P&&(P=128);var R=new Float32Array(P);R.set(Q.array);Q.array=R}Q.array[Q.pos++]=S;var V=this.tmp;if(V.pos==V.array.length){var O=V.array.length<<1;128>O&&(O=128);var Z=new Float32Array(O);Z.set(V.array);V.array=Z}V.array[V.pos++]=k;var T=this.tmp,W=g.u2;if(T.pos==T.array.length){var Y=T.array.length<<1;128>Y&&(Y=128);var aa=new Float32Array(Y);aa.set(T.array);T.array=aa}T.array[T.pos++]=W;var X=this.tmp,ea=g.v;if(X.pos==X.array.length){var U=X.array.length<<
1;128>U&&(U=128);var ja=new Float32Array(U);ja.set(X.array);X.array=ja}X.array[X.pos++]=ea;var ca=this.tmp;if(ca.pos==ca.array.length){var qa=ca.array.length<<1;128>qa&&(qa=128);var $=new Float32Array(qa);$.set(ca.array);ca.array=$}ca.array[ca.pos++]=c;var Ed=this.tmp;if(Ed.pos==Ed.array.length){var Xa=Ed.array.length<<1;128>Xa&&(Xa=128);var na=new Float32Array(Xa);na.set(Ed.array);Ed.array=na}Ed.array[Ed.pos++]=d;var Ke=this.tmp;if(Ke.pos==Ke.array.length){var ia=Ke.array.length<<1;128>ia&&(ia=128);
var ma=new Float32Array(ia);ma.set(Ke.array);Ke.array=ma}Ke.array[Ke.pos++]=e;var ka=this.tmp;if(ka.pos==ka.array.length){var ba=ka.array.length<<1;128>ba&&(ba=128);var wa=new Float32Array(ba);wa.set(ka.array);ka.array=wa}ka.array[ka.pos++]=f;var la=this.tmp;if(la.pos==la.array.length){var D=la.array.length<<1;128>D&&(D=128);var Ha=new Float32Array(D);Ha.set(la.array);la.array=Ha}la.array[la.pos++]=h;var za=this.tmp,da=k+g.height;if(za.pos==za.array.length){var dd=za.array.length<<1;128>dd&&(dd=128);
var Pe=new Float32Array(dd);Pe.set(za.array);za.array=Pe}za.array[za.pos++]=da;var zc=this.tmp,ya=g.u;if(zc.pos==zc.array.length){var Cb=zc.array.length<<1;128>Cb&&(Cb=128);var Fa=new Float32Array(Cb);Fa.set(zc.array);zc.array=Fa}zc.array[zc.pos++]=ya;var ga=this.tmp,yg=g.v2;if(ga.pos==ga.array.length){var pa=ga.array.length<<1;128>pa&&(pa=128);var Ea=new Float32Array(pa);Ea.set(ga.array);ga.array=Ea}ga.array[ga.pos++]=yg;var Fd=this.tmp;if(Fd.pos==Fd.array.length){var ha=Fd.array.length<<1;128>ha&&
(ha=128);var Oa=new Float32Array(ha);Oa.set(Fd.array);Fd.array=Oa}Fd.array[Fd.pos++]=c;var Ga=this.tmp;if(Ga.pos==Ga.array.length){var ta=Ga.array.length<<1;128>ta&&(ta=128);var Af=new Float32Array(ta);Af.set(Ga.array);Ga.array=Af}Ga.array[Ga.pos++]=d;var Aa=this.tmp;if(Aa.pos==Aa.array.length){var fb=Aa.array.length<<1;128>fb&&(fb=128);var Qe=new Float32Array(fb);Qe.set(Aa.array);Aa.array=Qe}Aa.array[Aa.pos++]=e;var Ra=this.tmp;if(Ra.pos==Ra.array.length){var Ac=Ra.array.length<<1;128>Ac&&(Ac=128);
var ra=new Float32Array(Ac);ra.set(Ra.array);Ra.array=ra}Ra.array[Ra.pos++]=f;var bb=this.tmp,Pa=h+g.width;if(bb.pos==bb.array.length){var ua=bb.array.length<<1;128>ua&&(ua=128);var va=new Float32Array(ua);va.set(bb.array);bb.array=va}bb.array[bb.pos++]=Pa;var oa=this.tmp,Va=k+g.height;if(oa.pos==oa.array.length){var $a=oa.array.length<<1;128>$a&&($a=128);var Ma=new Float32Array($a);Ma.set(oa.array);oa.array=Ma}oa.array[oa.pos++]=Va;var Re=this.tmp,Wa=g.u2;if(Re.pos==Re.array.length){var wb=Re.array.length<<
1;128>wb&&(wb=128);var Ca=new Float32Array(wb);Ca.set(Re.array);Re.array=Ca}Re.array[Re.pos++]=Wa;var xb=this.tmp,La=g.v2;if(xb.pos==xb.array.length){var Le=xb.array.length<<1;128>Le&&(Le=128);var Ba=new Float32Array(Le);Ba.set(xb.array);xb.array=Ba}xb.array[xb.pos++]=La;var xa=this.tmp;if(xa.pos==xa.array.length){var Ya=xa.array.length<<1;128>Ya&&(Ya=128);var Qa=new Float32Array(Ya);Qa.set(xa.array);xa.array=Qa}xa.array[xa.pos++]=c;var fa=this.tmp;if(fa.pos==fa.array.length){var Sa=fa.array.length<<
1;128>Sa&&(Sa=128);var Ka=new Float32Array(Sa);Ka.set(fa.array);fa.array=Ka}fa.array[fa.pos++]=d;var Da=this.tmp;if(Da.pos==Da.array.length){var sa=Da.array.length<<1;128>sa&&(sa=128);var Ua=new Float32Array(sa);Ua.set(Da.array);Da.array=Ua}Da.array[Da.pos++]=e;var Zb=this.tmp;if(Zb.pos==Zb.array.length){var Kb=Zb.array.length<<1;128>Kb&&(Kb=128);var Ja=new Float32Array(Kb);Ja.set(Zb.array);Zb.array=Ja}Zb.array[Zb.pos++]=f;var Lb=a+g.dx,qb=b+g.dy;Lb<this.xMin&&(this.xMin=Lb);qb<this.yMin&&(this.yMin=
qb);Lb+=g.width;qb+=g.height;Lb>this.xMax&&(this.xMax=Lb);qb>this.yMax&&(this.yMax=qb)},addTransform:function(a,b,c,d,e,f,g){var h=Math.cos(e),k=Math.sin(e),l=g.width,E=g.height,t=g.dx*c,x=g.dy*d,C=t*h-x*k+a,M=x*h+t*k+b,m=this.tmp;if(m.pos==m.array.length){var p=m.array.length<<1;128>p&&(p=128);var n=new Float32Array(p);n.set(m.array);m.array=n}m.array[m.pos++]=C;var q=this.tmp;if(q.pos==q.array.length){var r=q.array.length<<1;128>r&&(r=128);var s=new Float32Array(r);s.set(q.array);q.array=s}q.array[q.pos++]=
M;var u=this.tmp,A=g.u;if(u.pos==u.array.length){var y=u.array.length<<1;128>y&&(y=128);var B=new Float32Array(y);B.set(u.array);u.array=B}u.array[u.pos++]=A;var w=this.tmp,v=g.v;if(w.pos==w.array.length){var F=w.array.length<<1;128>F&&(F=128);var z=new Float32Array(F);z.set(w.array);w.array=z}w.array[w.pos++]=v;var G=this.tmp,I=f.x;if(G.pos==G.array.length){var J=G.array.length<<1;128>J&&(J=128);var K=new Float32Array(J);K.set(G.array);G.array=K}G.array[G.pos++]=I;var L=this.tmp,Q=f.y;if(L.pos==
L.array.length){var N=L.array.length<<1;128>N&&(N=128);var S=new Float32Array(N);S.set(L.array);L.array=S}L.array[L.pos++]=Q;var V=this.tmp,P=f.z;if(V.pos==V.array.length){var O=V.array.length<<1;128>O&&(O=128);var R=new Float32Array(O);R.set(V.array);V.array=R}V.array[V.pos++]=P;var T=this.tmp,Z=f.w;if(T.pos==T.array.length){var X=T.array.length<<1;128>X&&(X=128);var Y=new Float32Array(X);Y.set(T.array);T.array=Y}T.array[T.pos++]=Z;C<this.xMin&&(this.xMin=C);M<this.yMin&&(this.yMin=M);C>this.xMax&&
(this.xMax=C);M>this.yMax&&(this.yMax=M);var aa=(g.dx+l)*c,W=g.dy*d,ea=aa*h-W*k+a,ca=W*h+aa*k+b,U=this.tmp;if(U.pos==U.array.length){var ja=U.array.length<<1;128>ja&&(ja=128);var ka=new Float32Array(ja);ka.set(U.array);U.array=ka}U.array[U.pos++]=ea;var qa=this.tmp;if(qa.pos==qa.array.length){var ia=qa.array.length<<1;128>ia&&(ia=128);var Xa=new Float32Array(ia);Xa.set(qa.array);qa.array=Xa}qa.array[qa.pos++]=ca;var $=this.tmp,na=g.u2;if($.pos==$.array.length){var la=$.array.length<<1;128>la&&(la=
128);var ba=new Float32Array(la);ba.set($.array);$.array=ba}$.array[$.pos++]=na;var ma=this.tmp,za=g.v;if(ma.pos==ma.array.length){var wa=ma.array.length<<1;128>wa&&(wa=128);var ga=new Float32Array(wa);ga.set(ma.array);ma.array=ga}ma.array[ma.pos++]=za;var D=this.tmp,Ha=f.x;if(D.pos==D.array.length){var da=D.array.length<<1;128>da&&(da=128);var pa=new Float32Array(da);pa.set(D.array);D.array=pa}D.array[D.pos++]=Ha;var dd=this.tmp,Pe=f.y;if(dd.pos==dd.array.length){var zc=dd.array.length<<1;128>zc&&
(zc=128);var Fa=new Float32Array(zc);Fa.set(dd.array);dd.array=Fa}dd.array[dd.pos++]=Pe;var Cb=this.tmp,ya=f.z;if(Cb.pos==Cb.array.length){var xa=Cb.array.length<<1;128>xa&&(xa=128);var fa=new Float32Array(xa);fa.set(Cb.array);Cb.array=fa}Cb.array[Cb.pos++]=ya;var ha=this.tmp,ta=f.w;if(ha.pos==ha.array.length){var Fd=ha.array.length<<1;128>Fd&&(Fd=128);var Ea=new Float32Array(Fd);Ea.set(ha.array);ha.array=Ea}ha.array[ha.pos++]=ta;ea<this.xMin&&(this.xMin=ea);ca<this.yMin&&(this.yMin=ca);ea>this.xMax&&
(this.xMax=ea);ca>this.yMax&&(this.yMax=ca);var Oa=g.dx*c,Ga=(g.dy+E)*d,ua=Oa*h-Ga*k+a,ra=Ga*h+Oa*k+b,Aa=this.tmp;if(Aa.pos==Aa.array.length){var fb=Aa.array.length<<1;128>fb&&(fb=128);var Da=new Float32Array(fb);Da.set(Aa.array);Aa.array=Da}Aa.array[Aa.pos++]=ua;var Ra=this.tmp;if(Ra.pos==Ra.array.length){var Ac=Ra.array.length<<1;128>Ac&&(Ac=128);var Ma=new Float32Array(Ac);Ma.set(Ra.array);Ra.array=Ma}Ra.array[Ra.pos++]=ra;var bb=this.tmp,Ca=g.u;if(bb.pos==bb.array.length){var Pa=bb.array.length<<
1;128>Pa&&(Pa=128);var va=new Float32Array(Pa);va.set(bb.array);bb.array=va}bb.array[bb.pos++]=Ca;var oa=this.tmp,Va=g.v2;if(oa.pos==oa.array.length){var $a=oa.array.length<<1;128>$a&&($a=128);var Ya=new Float32Array($a);Ya.set(oa.array);oa.array=Ya}oa.array[oa.pos++]=Va;var Ba=this.tmp,Wa=f.x;if(Ba.pos==Ba.array.length){var wb=Ba.array.length<<1;128>wb&&(wb=128);var Sa=new Float32Array(wb);Sa.set(Ba.array);Ba.array=Sa}Ba.array[Ba.pos++]=Wa;var xb=this.tmp,La=f.y;if(xb.pos==xb.array.length){var Qa=
xb.array.length<<1;128>Qa&&(Qa=128);var Ka=new Float32Array(Qa);Ka.set(xb.array);xb.array=Ka}xb.array[xb.pos++]=La;var sa=this.tmp,Ua=f.z;if(sa.pos==sa.array.length){var Ja=sa.array.length<<1;128>Ja&&(Ja=128);var yb=new Float32Array(Ja);yb.set(sa.array);sa.array=yb}sa.array[sa.pos++]=Ua;var Na=this.tmp,Za=f.w;if(Na.pos==Na.array.length){var Ta=Na.array.length<<1;128>Ta&&(Ta=128);var db=new Float32Array(Ta);db.set(Na.array);Na.array=db}Na.array[Na.pos++]=Za;ua<this.xMin&&(this.xMin=ua);ra<this.yMin&&
(this.yMin=ra);ua>this.xMax&&(this.xMax=ua);ra>this.yMax&&(this.yMax=ra);var hb=(g.dx+l)*c,Zb=(g.dy+E)*d,Kb=hb*h-Zb*k+a,ob=Zb*h+hb*k+b,Lb=this.tmp;if(Lb.pos==Lb.array.length){var qb=Lb.array.length<<1;128>qb&&(qb=128);var ib=new Float32Array(qb);ib.set(Lb.array);Lb.array=ib}Lb.array[Lb.pos++]=Kb;var pb=this.tmp;if(pb.pos==pb.array.length){var Bb=pb.array.length<<1;128>Bb&&(Bb=128);var Eb=new Float32Array(Bb);Eb.set(pb.array);pb.array=Eb}pb.array[pb.pos++]=ob;var ab=this.tmp,jb=g.u2;if(ab.pos==ab.array.length){var Hb=
ab.array.length<<1;128>Hb&&(Hb=128);var sb=new Float32Array(Hb);sb.set(ab.array);ab.array=sb}ab.array[ab.pos++]=jb;var Bc=this.tmp,rb=g.v2;if(Bc.pos==Bc.array.length){var Db=Bc.array.length<<1;128>Db&&(Db=128);var Ib=new Float32Array(Db);Ib.set(Bc.array);Bc.array=Ib}Bc.array[Bc.pos++]=rb;var Wb=this.tmp,Fb=f.x;if(Wb.pos==Wb.array.length){var ub=Wb.array.length<<1;128>ub&&(ub=128);var Mb=new Float32Array(ub);Mb.set(Wb.array);Wb.array=Mb}Wb.array[Wb.pos++]=Fb;var Cc=this.tmp,Tb=f.y;if(Cc.pos==Cc.array.length){var tb=
Cc.array.length<<1;128>tb&&(tb=128);var dc=new Float32Array(tb);dc.set(Cc.array);Cc.array=dc}Cc.array[Cc.pos++]=Tb;var Gb=this.tmp,Ob=f.z;if(Gb.pos==Gb.array.length){var Rb=Gb.array.length<<1;128>Rb&&(Rb=128);var kb=new Float32Array(Rb);kb.set(Gb.array);Gb.array=kb}Gb.array[Gb.pos++]=Ob;var Ab=this.tmp,zb=f.w;if(Ab.pos==Ab.array.length){var Yb=Ab.array.length<<1;128>Yb&&(Yb=128);var eb=new Float32Array(Yb);eb.set(Ab.array);Ab.array=eb}Ab.array[Ab.pos++]=zb;Kb<this.xMin&&(this.xMin=Kb);ob<this.yMin&&
(this.yMin=ob);Kb>this.xMax&&(this.xMax=Kb);ob>this.yMax&&(this.yMax=ob)},addPoint:function(a,b,c){var d=this.tmp;if(d.pos==d.array.length){var e=d.array.length<<1;128>e&&(e=128);e=new Float32Array(e);e.set(d.array);d.array=e}d.array[d.pos++]=a;d=this.tmp;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=b;d=this.tmp;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=
0;d=this.tmp;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=0;d=this.tmp;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=(c>>16&255)/255;d=this.tmp;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=(c>>8&255)/255;d=this.tmp;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&
(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=(c&255)/255;d=this.tmp;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=(c>>>24)/255;a<this.xMin&&(this.xMin=a);b<this.yMin&&(this.yMin=b);a>this.xMax&&(this.xMax=a);b>this.yMax&&(this.yMax=b)},insertColor:function(a){var b=this.tmp;if(b.pos==b.array.length){var c=b.array.length<<1;128>c&&(c=128);c=new Float32Array(c);c.set(b.array);b.array=c}b.array[b.pos++]=
(a>>16&255)/255;b=this.tmp;b.pos==b.array.length&&(c=b.array.length<<1,128>c&&(c=128),c=new Float32Array(c),c.set(b.array),b.array=c);b.array[b.pos++]=(a>>8&255)/255;b=this.tmp;b.pos==b.array.length&&(c=b.array.length<<1,128>c&&(c=128),c=new Float32Array(c),c.set(b.array),b.array=c);b.array[b.pos++]=(a&255)/255;b=this.tmp;b.pos==b.array.length&&(c=b.array.length<<1,128>c&&(c=128),c=new Float32Array(c),c.set(b.array),b.array=c);b.array[b.pos++]=(a>>>24)/255},rectColor:function(a,b,c,d,e){var f=this.tmp;
if(f.pos==f.array.length){var g=f.array.length<<1;128>g&&(g=128);var h=new Float32Array(g);h.set(f.array);f.array=h}f.array[f.pos++]=a;var k=this.tmp;if(k.pos==k.array.length){var l=k.array.length<<1;128>l&&(l=128);var E=new Float32Array(l);E.set(k.array);k.array=E}k.array[k.pos++]=b;var t=this.tmp;if(t.pos==t.array.length){var x=t.array.length<<1;128>x&&(x=128);var C=new Float32Array(x);C.set(t.array);t.array=C}t.array[t.pos++]=0;var M=this.tmp;if(M.pos==M.array.length){var m=M.array.length<<1;128>
m&&(m=128);var p=new Float32Array(m);p.set(M.array);M.array=p}M.array[M.pos++]=0;var n=this.tmp;if(n.pos==n.array.length){var q=n.array.length<<1;128>q&&(q=128);var r=new Float32Array(q);r.set(n.array);n.array=r}n.array[n.pos++]=(e>>16&255)/255;var s=this.tmp;if(s.pos==s.array.length){var u=s.array.length<<1;128>u&&(u=128);var A=new Float32Array(u);A.set(s.array);s.array=A}s.array[s.pos++]=(e>>8&255)/255;var y=this.tmp;if(y.pos==y.array.length){var w=y.array.length<<1;128>w&&(w=128);var B=new Float32Array(w);
B.set(y.array);y.array=B}y.array[y.pos++]=(e&255)/255;var v=this.tmp;if(v.pos==v.array.length){var F=v.array.length<<1;128>F&&(F=128);var G=new Float32Array(F);G.set(v.array);v.array=G}v.array[v.pos++]=(e>>>24)/255;var z=this.tmp;if(z.pos==z.array.length){var I=z.array.length<<1;128>I&&(I=128);var J=new Float32Array(I);J.set(z.array);z.array=J}z.array[z.pos++]=a+c;var K=this.tmp;if(K.pos==K.array.length){var L=K.array.length<<1;128>L&&(L=128);var Q=new Float32Array(L);Q.set(K.array);K.array=Q}K.array[K.pos++]=
b;var N=this.tmp;if(N.pos==N.array.length){var V=N.array.length<<1;128>V&&(V=128);var S=new Float32Array(V);S.set(N.array);N.array=S}N.array[N.pos++]=1;var T=this.tmp;if(T.pos==T.array.length){var O=T.array.length<<1;128>O&&(O=128);var P=new Float32Array(O);P.set(T.array);T.array=P}T.array[T.pos++]=0;var R=this.tmp;if(R.pos==R.array.length){var Z=R.array.length<<1;128>Z&&(Z=128);var X=new Float32Array(Z);X.set(R.array);R.array=X}R.array[R.pos++]=(e>>16&255)/255;var Y=this.tmp;if(Y.pos==Y.array.length){var aa=
Y.array.length<<1;128>aa&&(aa=128);var W=new Float32Array(aa);W.set(Y.array);Y.array=W}Y.array[Y.pos++]=(e>>8&255)/255;var U=this.tmp;if(U.pos==U.array.length){var ea=U.array.length<<1;128>ea&&(ea=128);var ca=new Float32Array(ea);ca.set(U.array);U.array=ca}U.array[U.pos++]=(e&255)/255;var ja=this.tmp;if(ja.pos==ja.array.length){var qa=ja.array.length<<1;128>qa&&(qa=128);var $=new Float32Array(qa);$.set(ja.array);ja.array=$}ja.array[ja.pos++]=(e>>>24)/255;var ma=this.tmp;if(ma.pos==ma.array.length){var Xa=
ma.array.length<<1;128>Xa&&(Xa=128);var ka=new Float32Array(Xa);ka.set(ma.array);ma.array=ka}ma.array[ma.pos++]=a;var ia=this.tmp;if(ia.pos==ia.array.length){var la=ia.array.length<<1;128>la&&(la=128);var na=new Float32Array(la);na.set(ia.array);ia.array=na}ia.array[ia.pos++]=b+d;var ba=this.tmp;if(ba.pos==ba.array.length){var wa=ba.array.length<<1;128>wa&&(wa=128);var za=new Float32Array(wa);za.set(ba.array);ba.array=za}ba.array[ba.pos++]=0;var ga=this.tmp;if(ga.pos==ga.array.length){var D=ga.array.length<<
1;128>D&&(D=128);var ha=new Float32Array(D);ha.set(ga.array);ga.array=ha}ga.array[ga.pos++]=1;var da=this.tmp;if(da.pos==da.array.length){var Ha=da.array.length<<1;128>Ha&&(Ha=128);var dd=new Float32Array(Ha);dd.set(da.array);da.array=dd}da.array[da.pos++]=(e>>16&255)/255;var pa=this.tmp;if(pa.pos==pa.array.length){var zc=pa.array.length<<1;128>zc&&(zc=128);var Fa=new Float32Array(zc);Fa.set(pa.array);pa.array=Fa}pa.array[pa.pos++]=(e>>8&255)/255;var Cb=this.tmp;if(Cb.pos==Cb.array.length){var xa=
Cb.array.length<<1;128>xa&&(xa=128);var ua=new Float32Array(xa);ua.set(Cb.array);Cb.array=ua}Cb.array[Cb.pos++]=(e&255)/255;var Ba=this.tmp;if(Ba.pos==Ba.array.length){var ra=Ba.array.length<<1;128>ra&&(ra=128);var ya=new Float32Array(ra);ya.set(Ba.array);Ba.array=ya}Ba.array[Ba.pos++]=(e>>>24)/255;var fa=this.tmp;if(fa.pos==fa.array.length){var Ea=fa.array.length<<1;128>Ea&&(Ea=128);var Oa=new Float32Array(Ea);Oa.set(fa.array);fa.array=Oa}fa.array[fa.pos++]=a+c;var Ga=this.tmp;if(Ga.pos==Ga.array.length){var ta=
Ga.array.length<<1;128>ta&&(ta=128);var sa=new Float32Array(ta);sa.set(Ga.array);Ga.array=sa}Ga.array[Ga.pos++]=b+d;var Aa=this.tmp;if(Aa.pos==Aa.array.length){var fb=Aa.array.length<<1;128>fb&&(fb=128);var Da=new Float32Array(fb);Da.set(Aa.array);Aa.array=Da}Aa.array[Aa.pos++]=1;var Ra=this.tmp;if(Ra.pos==Ra.array.length){var Ac=Ra.array.length<<1;128>Ac&&(Ac=128);var Pa=new Float32Array(Ac);Pa.set(Ra.array);Ra.array=Pa}Ra.array[Ra.pos++]=1;var bb=this.tmp;if(bb.pos==bb.array.length){var Ma=bb.array.length<<
1;128>Ma&&(Ma=128);var Ya=new Float32Array(Ma);Ya.set(bb.array);bb.array=Ya}bb.array[bb.pos++]=(e>>16&255)/255;var va=this.tmp;if(va.pos==va.array.length){var oa=va.array.length<<1;128>oa&&(oa=128);var Va=new Float32Array(oa);Va.set(va.array);va.array=Va}va.array[va.pos++]=(e>>8&255)/255;var $a=this.tmp;if($a.pos==$a.array.length){var Qa=$a.array.length<<1;128>Qa&&(Qa=128);var Ca=new Float32Array(Qa);Ca.set($a.array);$a.array=Ca}$a.array[$a.pos++]=(e&255)/255;var Wa=this.tmp;if(Wa.pos==Wa.array.length){var wb=
Wa.array.length<<1;128>wb&&(wb=128);var Sa=new Float32Array(wb);Sa.set(Wa.array);Wa.array=Sa}Wa.array[Wa.pos++]=(e>>>24)/255;a<this.xMin&&(this.xMin=a);b<this.yMin&&(this.yMin=b);a+=c;b+=d;a>this.xMax&&(this.xMax=a);b>this.yMax&&(this.yMax=b)},rectGradient:function(a,b,c,d,e,f,g,h){var k=this.tmp;if(k.pos==k.array.length){var l=k.array.length<<1;128>l&&(l=128);var E=new Float32Array(l);E.set(k.array);k.array=E}k.array[k.pos++]=a;var t=this.tmp;if(t.pos==t.array.length){var x=t.array.length<<1;128>
x&&(x=128);var C=new Float32Array(x);C.set(t.array);t.array=C}t.array[t.pos++]=b;var M=this.tmp;if(M.pos==M.array.length){var m=M.array.length<<1;128>m&&(m=128);var p=new Float32Array(m);p.set(M.array);M.array=p}M.array[M.pos++]=0;var n=this.tmp;if(n.pos==n.array.length){var q=n.array.length<<1;128>q&&(q=128);var r=new Float32Array(q);r.set(n.array);n.array=r}n.array[n.pos++]=0;var s=this.tmp;if(s.pos==s.array.length){var u=s.array.length<<1;128>u&&(u=128);var A=new Float32Array(u);A.set(s.array);
s.array=A}s.array[s.pos++]=(e>>16&255)/255;var y=this.tmp;if(y.pos==y.array.length){var w=y.array.length<<1;128>w&&(w=128);var B=new Float32Array(w);B.set(y.array);y.array=B}y.array[y.pos++]=(e>>8&255)/255;var v=this.tmp;if(v.pos==v.array.length){var F=v.array.length<<1;128>F&&(F=128);var z=new Float32Array(F);z.set(v.array);v.array=z}v.array[v.pos++]=(e&255)/255;var G=this.tmp;if(G.pos==G.array.length){var I=G.array.length<<1;128>I&&(I=128);var K=new Float32Array(I);K.set(G.array);G.array=K}G.array[G.pos++]=
(e>>>24)/255;var J=this.tmp;if(J.pos==J.array.length){var L=J.array.length<<1;128>L&&(L=128);var N=new Float32Array(L);N.set(J.array);J.array=N}J.array[J.pos++]=a+c;var Q=this.tmp;if(Q.pos==Q.array.length){var V=Q.array.length<<1;128>V&&(V=128);var S=new Float32Array(V);S.set(Q.array);Q.array=S}Q.array[Q.pos++]=b;var T=this.tmp;if(T.pos==T.array.length){var R=T.array.length<<1;128>R&&(R=128);var O=new Float32Array(R);O.set(T.array);T.array=O}T.array[T.pos++]=1;var P=this.tmp;if(P.pos==P.array.length){var Y=
P.array.length<<1;128>Y&&(Y=128);var Z=new Float32Array(Y);Z.set(P.array);P.array=Z}P.array[P.pos++]=0;var X=this.tmp;if(X.pos==X.array.length){var U=X.array.length<<1;128>U&&(U=128);var aa=new Float32Array(U);aa.set(X.array);X.array=aa}X.array[X.pos++]=(f>>16&255)/255;var W=this.tmp;if(W.pos==W.array.length){var ea=W.array.length<<1;128>ea&&(ea=128);var ja=new Float32Array(ea);ja.set(W.array);W.array=ja}W.array[W.pos++]=(f>>8&255)/255;var ca=this.tmp;if(ca.pos==ca.array.length){var ma=ca.array.length<<
1;128>ma&&(ma=128);var qa=new Float32Array(ma);qa.set(ca.array);ca.array=qa}ca.array[ca.pos++]=(f&255)/255;var ia=this.tmp;if(ia.pos==ia.array.length){var Xa=ia.array.length<<1;128>Xa&&(Xa=128);var $=new Float32Array(Xa);$.set(ia.array);ia.array=$}ia.array[ia.pos++]=(f>>>24)/255;var ba=this.tmp;if(ba.pos==ba.array.length){var ka=ba.array.length<<1;128>ka&&(ka=128);var la=new Float32Array(ka);la.set(ba.array);ba.array=la}ba.array[ba.pos++]=a;var ga=this.tmp;if(ga.pos==ga.array.length){var na=ga.array.length<<
1;128>na&&(na=128);var wa=new Float32Array(na);wa.set(ga.array);ga.array=wa}ga.array[ga.pos++]=b+d;var da=this.tmp;if(da.pos==da.array.length){var D=da.array.length<<1;128>D&&(D=128);var za=new Float32Array(D);za.set(da.array);da.array=za}da.array[da.pos++]=0;var pa=this.tmp;if(pa.pos==pa.array.length){var Ba=pa.array.length<<1;128>Ba&&(Ba=128);var fa=new Float32Array(Ba);fa.set(pa.array);pa.array=fa}pa.array[pa.pos++]=1;var ha=this.tmp;if(ha.pos==ha.array.length){var Ha=ha.array.length<<1;128>Ha&&
(Ha=128);var xa=new Float32Array(Ha);xa.set(ha.array);ha.array=xa}ha.array[ha.pos++]=(g>>16&255)/255;var Cb=this.tmp;if(Cb.pos==Cb.array.length){var Fa=Cb.array.length<<1;128>Fa&&(Fa=128);var ra=new Float32Array(Fa);ra.set(Cb.array);Cb.array=ra}Cb.array[Cb.pos++]=(g>>8&255)/255;var ua=this.tmp;if(ua.pos==ua.array.length){var ya=ua.array.length<<1;128>ya&&(ya=128);var Ea=new Float32Array(ya);Ea.set(ua.array);ua.array=Ea}ua.array[ua.pos++]=(g&255)/255;var ta=this.tmp;if(ta.pos==ta.array.length){var Ma=
ta.array.length<<1;128>Ma&&(Ma=128);var Oa=new Float32Array(Ma);Oa.set(ta.array);ta.array=Oa}ta.array[ta.pos++]=(g>>>24)/255;var Ga=this.tmp;if(Ga.pos==Ga.array.length){var sa=Ga.array.length<<1;128>sa&&(sa=128);var Da=new Float32Array(sa);Da.set(Ga.array);Ga.array=Da}Ga.array[Ga.pos++]=a+c;var Aa=this.tmp;if(Aa.pos==Aa.array.length){var fb=Aa.array.length<<1;128>fb&&(fb=128);var Pa=new Float32Array(fb);Pa.set(Aa.array);Aa.array=Pa}Aa.array[Aa.pos++]=b+d;var Ra=this.tmp;if(Ra.pos==Ra.array.length){var Qa=
Ra.array.length<<1;128>Qa&&(Qa=128);var Ya=new Float32Array(Qa);Ya.set(Ra.array);Ra.array=Ya}Ra.array[Ra.pos++]=1;var bb=this.tmp;if(bb.pos==bb.array.length){var Ca=bb.array.length<<1;128>Ca&&(Ca=128);var Sa=new Float32Array(Ca);Sa.set(bb.array);bb.array=Sa}bb.array[bb.pos++]=0;var va=this.tmp;if(va.pos==va.array.length){var oa=va.array.length<<1;128>oa&&(oa=128);var Va=new Float32Array(oa);Va.set(va.array);va.array=Va}va.array[va.pos++]=(h>>16&255)/255;var $a=this.tmp;if($a.pos==$a.array.length){var Ka=
$a.array.length<<1;128>Ka&&(Ka=128);var La=new Float32Array(Ka);La.set($a.array);$a.array=La}$a.array[$a.pos++]=(h>>8&255)/255;var Wa=this.tmp;if(Wa.pos==Wa.array.length){var wb=Wa.array.length<<1;128>wb&&(wb=128);var Na=new Float32Array(wb);Na.set(Wa.array);Wa.array=Na}Wa.array[Wa.pos++]=(h&255)/255;var xb=this.tmp;if(xb.pos==xb.array.length){var Ja=xb.array.length<<1;128>Ja&&(Ja=128);var Ua=new Float32Array(Ja);Ua.set(xb.array);xb.array=Ua}xb.array[xb.pos++]=(h>>>24)/255;a<this.xMin&&(this.xMin=
a);b<this.yMin&&(this.yMin=b);a+=c;b+=d;a>this.xMax&&(this.xMax=a);b>this.yMax&&(this.yMax=b)},fillArc:function(a,b,c,d,e,f){if(!(f<=e)){var g=f-e,h=Math.ceil(6.28*c/4);4>h&&(h=4);for(var g=g/h,k=-Infinity,l=-Infinity,E=0,t=0,x=0;x<h;)t=e+x*g,E=a+Math.cos(t)*c,t=b+Math.sin(t)*c,-Infinity!=k&&(this.addPoint(a,b,d),this.addPoint(E,t,d),this.addPoint(k,l,d),this.addPoint(k,l,d)),k=E,l=t,++x;E=a+Math.cos(f)*c;t=b+Math.sin(f)*c;this.addPoint(a,b,d);this.addPoint(E,t,d);this.addPoint(k,l,d);this.addPoint(k,
l,d)}},fillCircle:function(a,b,c,d){var e=Math.ceil(6.28*c/2);3>e&&(e=3);for(var f=2*Math.PI/e,g=-Infinity,h=-Infinity,k=-Infinity,l=-Infinity,E=0,t=0,x=0;x<e;)t=x++*f,E=a+Math.cos(t)*c,t=b+Math.sin(t)*c,-Infinity!=g&&(this.addPoint(a,b,d),this.addPoint(E,t,d),this.addPoint(g,h,d),this.addPoint(a,b,d)),-Infinity==k&&(k=E,l=t),g=E,h=t;this.addPoint(a,b,d);this.addPoint(E,t,d);this.addPoint(k,l,d);this.addPoint(a,b,d)},circle:function(a,b,c,d,e){if(!(d>c)){var f=Math.ceil(6.28*c/2);3>f&&(f=3);d=c-d;
for(var g=2*Math.PI/f,h=-Infinity,k=-Infinity,l=-Infinity,E=-Infinity,t=0;t<f;){var x=t++*g,C=a+Math.cos(x)*c,M=b+Math.sin(x)*c,m=a+Math.cos(x)*d,x=b+Math.sin(x)*d;-Infinity!=h&&(this.addPoint(C,M,e),this.addPoint(h,k,e),this.addPoint(m,x,e),this.addPoint(l,E,e));h=C;k=M;l=m;E=x}}},arc:function(a,b,c,d,e,f,g){if(!(d>c)&&!(f<=e)){var h=f-e,k=Math.ceil(6.28*c/4);3>k&&(k=3);d=c-d;for(var h=h/k,l=-Infinity,E=-Infinity,t=-Infinity,x=-Infinity,C=0,M=0,m=0,p=0,n=0;n<k;)C=n++,p=e+C*h,C=a+Math.cos(p)*c,M=
b+Math.sin(p)*c,m=a+Math.cos(p)*d,p=b+Math.sin(p)*d,-Infinity!=l&&(this.addPoint(C,M,g),this.addPoint(l,E,g),this.addPoint(m,p,g),this.addPoint(t,x,g)),l=C,E=M,t=m,x=p;C=a+Math.cos(f)*c;M=b+Math.sin(f)*c;m=a+Math.cos(f)*d;p=b+Math.sin(f)*d;this.addPoint(C,M,g);this.addPoint(l,E,g);this.addPoint(m,p,g);this.addPoint(t,x,g)}},alloc:function(a){null==this.tmp&&this.clear();0<this.tmp.pos&&(this.buffer=hb.ofFloats(this.tmp,8,[ba.Quads,ba.RawFormat]))},flush:function(){(null==this.buffer||this.buffer.isDisposed())&&
this.alloc(X.CURRENT)},doRender:function(a,b,c){(null==this.buffer||this.buffer.isDisposed())&&this.alloc(X.CURRENT);null!=this.buffer&&(null==c&&(c=-1),null==b&&(b=0),a.renderBuffer(this.buffer,a.mem.quadIndexes,2,b,c))},__class__:Jh});var vg=function(a,b){Sa.call(this,b);this.tile=a;this.rangeMin=this.rangeMax=-1;this.curColor=new B(1,1,1,1);this.content=new Jh};r["h2d.TileGroup"]=vg;vg.__name__="h2d.TileGroup";vg.__super__=Sa;vg.prototype=J(Sa.prototype,{getBoundsRec:function(a,b,c){Sa.prototype.getBoundsRec.call(this,
a,b,c);this.addBounds(a,b,this.content.xMin,this.content.yMin,this.content.xMax-this.content.xMin,this.content.yMax-this.content.yMin)},clear:function(){this.content.clear()},invalidate:function(){this.content.dispose()},count:function(){return this.content.triCount()>>1},onRemove:function(){this.content.dispose();Sa.prototype.onRemove.call(this)},setDefaultColor:function(a,b){null==b&&(b=1);this.curColor.x=(a>>16&255)/255;this.curColor.y=(a>>8&255)/255;this.curColor.z=(a&255)/255;this.curColor.w=
b},add:function(a,b,c){this.content.add(a,b,this.curColor.x,this.curColor.y,this.curColor.z,this.curColor.w,c)},addColor:function(a,b,c,d,e,f,g){this.content.add(a,b,c,d,e,f,g)},addAlpha:function(a,b,c,d){this.content.add(a,b,this.curColor.x,this.curColor.y,this.curColor.z,c,d)},addTransform:function(a,b,c,d,e,f){this.content.addTransform(a,b,c,d,e,this.curColor,f)},draw:function(a){this.drawWith(a,this)},sync:function(a){Sa.prototype.sync.call(this,a);a=this.content;(null==a.buffer||a.buffer.isDisposed())&&
a.alloc(X.CURRENT)},drawWith:function(a,b){var c=this.content.triCount();if(0!=c&&a.beginDrawObject(b,this.tile.innerTex)){var d=0>this.rangeMin?0:2*this.rangeMin;0<this.rangeMax&&this.rangeMax<2*c&&(c=2*this.rangeMax);this.content.doRender(a.engine,d,c-d)}},__class__:vg});var ub=function(){this.yMin=this.xMin=1E20;this.yMax=this.xMax=-1E20};r["h2d.col.Bounds"]=ub;ub.__name__="h2d.col.Bounds";ub.fromValues=function(a,b,c,d){var e=new ub;e.xMin=a;e.yMin=b;e.xMax=a+c;e.yMax=b+d;return e};ub.fromPoints=
function(a,b){var c=new ub;c.xMin=a.x;c.yMin=a.y;c.xMax=b.x;c.yMax=b.y;return c};ub.prototype={toIBounds:function(a){null==a&&(a=1);var b=Math.floor(this.xMin*a),c=Math.floor(this.yMin*a),d=Math.ceil(this.xMax*a)-b;a=Math.ceil(this.yMax*a)-c;var e=new Be;e.xMin=b;e.yMin=c;e.xMax=b+d;e.yMax=c+a;return e},intersects:function(a){return!(this.xMin>a.xMax||this.yMin>a.yMax||this.xMax<a.xMin||this.yMax<a.yMin)},contains:function(a){return a.x>=this.xMin&&a.x<this.xMax&&a.y>=this.yMin?a.y<this.yMax:!1},
addBounds:function(a){a.xMin<this.xMin&&(this.xMin=a.xMin);a.xMax>this.xMax&&(this.xMax=a.xMax);a.yMin<this.yMin&&(this.yMin=a.yMin);a.yMax>this.yMax&&(this.yMax=a.yMax)},addPoint:function(a){a.x<this.xMin&&(this.xMin=a.x);a.x>this.xMax&&(this.xMax=a.x);a.y<this.yMin&&(this.yMin=a.y);a.y>this.yMax&&(this.yMax=a.y)},addPos:function(a,b){a<this.xMin&&(this.xMin=a);a>this.xMax&&(this.xMax=a);b<this.yMin&&(this.yMin=b);b>this.yMax&&(this.yMax=b)},set:function(a,b,c,d){this.xMin=a;this.yMin=b;this.xMax=
a+c;this.yMax=b+d},setMin:function(a){this.xMin=a.x;this.yMin=a.y},setMax:function(a){this.xMax=a.x;this.yMax=a.y},doIntersect:function(a){var b=this.xMin,c=a.xMin;this.xMin=b<c?c:b;b=this.yMin;c=a.yMin;this.yMin=b<c?c:b;b=this.xMax;c=a.xMax;this.xMax=b>c?c:b;b=this.yMax;a=a.yMax;this.yMax=b>a?a:b},doUnion:function(a){var b=this.xMin,c=a.xMin;this.xMin=b>c?c:b;b=this.yMin;c=a.yMin;this.yMin=b>c?c:b;b=this.xMax;c=a.xMax;this.xMax=b<c?c:b;b=this.yMax;a=a.yMax;this.yMax=b<a?a:b},intersection:function(a){var b=
new ub,c=this.xMin,d=a.xMin;b.xMin=c<d?d:c;c=this.yMin;d=a.yMin;b.yMin=c<d?d:c;c=this.xMax;d=a.xMax;b.xMax=c>d?d:c;c=this.yMax;a=a.yMax;b.yMax=c>a?a:c;b.xMax<b.xMin&&(b.xMax=b.xMin);b.yMax<b.yMin&&(b.yMax=b.yMin);return b},union:function(a){var b=new ub,c=this.xMin,d=a.xMin;b.xMin=c>d?d:c;c=this.yMin;d=a.yMin;b.yMin=c>d?d:c;c=this.xMax;d=a.xMax;b.xMax=c<d?d:c;c=this.yMax;a=a.yMax;b.yMax=c<a?a:c;return b},load:function(a){this.xMin=a.xMin;this.yMin=a.yMin;this.xMax=a.xMax;this.yMax=a.yMax},scalePivot:function(a){this.xMin*=
a;this.yMin*=a;this.xMax*=a;this.yMax*=a},scaleCenter:function(a){var b=0.5*(this.xMax-this.xMin)*a;a*=0.5*(this.yMax-this.yMin);var c=0.5*(this.xMax+this.xMin),d=0.5*(this.yMax+this.yMin);this.xMin=c-b;this.yMin=d-a;this.xMax=c+b;this.yMax=d+a},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.xMin,d=this.yMin,e=this.xMax,f=this.yMax;this.yMin=this.xMin=1E20;this.yMax=this.xMax=-1E20;var g=c*b-d*a,h=c*a+d*b;g<this.xMin&&(this.xMin=g);g>this.xMax&&(this.xMax=g);h<this.yMin&&(this.yMin=
h);h>this.yMax&&(this.yMax=h);g=e*b-d*a;d=e*a+d*b;g<this.xMin&&(this.xMin=g);g>this.xMax&&(this.xMax=g);d<this.yMin&&(this.yMin=d);d>this.yMax&&(this.yMax=d);d=c*b-f*a;c=c*a+f*b;d<this.xMin&&(this.xMin=d);d>this.xMax&&(this.xMax=d);c<this.yMin&&(this.yMin=c);c>this.yMax&&(this.yMax=c);c=e*b-f*a;b=e*a+f*b;c<this.xMin&&(this.xMin=c);c>this.xMax&&(this.xMax=c);b<this.yMin&&(this.yMin=b);b>this.yMax&&(this.yMax=b)},offset:function(a,b){this.xMin+=a;this.xMax+=a;this.yMin+=b;this.yMax+=b},getMin:function(){return new ob(this.xMin,
this.yMin)},getCenter:function(){return new ob(0.5*(this.xMin+this.xMax),0.5*(this.yMin+this.yMax))},getSize:function(){return new ob(this.xMax-this.xMin,this.yMax-this.yMin)},getMax:function(){return new ob(this.xMax,this.yMax)},isEmpty:function(){return this.xMax<=this.xMin?!0:this.yMax<=this.yMin},empty:function(){this.yMin=this.xMin=1E20;this.yMax=this.xMax=-1E20},all:function(){this.yMin=this.xMin=-1E20;this.yMax=this.xMax=1E20},clone:function(){var a=new ub;a.xMin=this.xMin;a.yMin=this.yMin;
a.xMax=this.xMax;a.yMax=this.yMax;return a},get_x:function(){return this.xMin},get_y:function(){return this.yMin},set_x:function(a){this.xMax+=a-this.xMin;return this.xMin=a},set_y:function(a){this.yMax+=a-this.yMin;return this.yMin=a},get_width:function(){return this.xMax-this.xMin},get_height:function(){return this.yMax-this.yMin},set_width:function(a){this.xMax=this.xMin+a;return a},set_height:function(a){this.yMax=this.yMin+a;return a},toString:function(){return"{"+n.string(new ob(this.xMin,this.yMin))+
","+n.string(new ob(this.xMax-this.xMin,this.yMax-this.yMin))+"}"},__class__:ub};var lj=function(){};r["h2d.col.Collider"]=lj;lj.__name__="h2d.col.Collider";lj.__isInterface__=!0;lj.prototype={__class__:lj};var Be=function(){this.yMin=this.xMin=2147483647;this.yMax=this.xMax=-2147483648};r["h2d.col.IBounds"]=Be;Be.__name__="h2d.col.IBounds";Be.fromValues=function(a,b,c,d){var e=new Be;e.xMin=a;e.yMin=b;e.xMax=a+c;e.yMax=b+d;return e};Be.fromPoints=function(a,b){var c=new Be;c.xMin=a.x;c.yMin=a.y;
c.xMax=b.x;c.yMax=b.y;return c};Be.prototype={toBounds:function(a){null==a&&(a=1);var b=this.xMin*a,c=this.yMin*a,d=(this.xMax-this.xMin)*a;a*=this.yMax-this.yMin;var e=new ub;e.xMin=b;e.yMin=c;e.xMax=b+d;e.yMax=c+a;return e},intersects:function(a){return!(this.xMin>a.xMax||this.yMin>a.yMax||this.xMax<a.xMin||this.yMax<a.yMin)},contains:function(a){return a.x>=this.xMin&&a.x<this.xMax&&a.y>=this.yMin?a.y<this.yMax:!1},addBounds:function(a){a.xMin<this.xMin&&(this.xMin=a.xMin);a.xMax>this.xMax&&(this.xMax=
a.xMax);a.yMin<this.yMin&&(this.yMin=a.yMin);a.yMax>this.yMax&&(this.yMax=a.yMax)},addPoint:function(a){a.x<this.xMin&&(this.xMin=a.x);a.x>this.xMax&&(this.xMax=a.x);a.y<this.yMin&&(this.yMin=a.y);a.y>this.yMax&&(this.yMax=a.y)},addPos:function(a,b){a<this.xMin&&(this.xMin=a);a>this.xMax&&(this.xMax=a);b<this.yMin&&(this.yMin=b);b>this.yMax&&(this.yMax=b)},set:function(a,b,c,d){this.xMin=a;this.yMin=b;this.xMax=a+c;this.yMax=b+d},setMin:function(a){this.xMin=a.x;this.yMin=a.y},setMax:function(a){this.xMax=
a.x;this.yMax=a.y},doIntersect:function(a){var b=this.xMin,c=a.xMin;this.xMin=b<c?c:b;b=this.yMin;c=a.yMin;this.yMin=b<c?c:b;b=this.xMax;c=a.xMax;this.xMax=b>c?c:b;b=this.yMax;a=a.yMax;this.yMax=b>a?a:b},doUnion:function(a){var b=this.xMin,c=a.xMin;this.xMin=b>c?c:b;b=this.yMin;c=a.yMin;this.yMin=b>c?c:b;b=this.xMax;c=a.xMax;this.xMax=b<c?c:b;b=this.yMax;a=a.yMax;this.yMax=b<a?a:b},intersection:function(a){var b=new ub,c=this.xMin,d=a.xMin;b.xMin=c<d?d:c;c=this.yMin;d=a.yMin;b.yMin=c<d?d:c;c=this.xMax;
d=a.xMax;b.xMax=c>d?d:c;c=this.yMax;a=a.yMax;b.yMax=c>a?a:c;b.xMax<b.xMin&&(b.xMax=b.xMin);b.yMax<b.yMin&&(b.yMax=b.yMin);return b},union:function(a){var b=new ub,c=this.xMin,d=a.xMin;b.xMin=c>d?d:c;c=this.yMin;d=a.yMin;b.yMin=c>d?d:c;c=this.xMax;d=a.xMax;b.xMax=c<d?d:c;c=this.yMax;a=a.yMax;b.yMax=c<a?a:c;return b},load:function(a){this.xMin=a.xMin;this.yMin=a.yMin;this.xMax=a.xMax;this.yMax=a.yMax},offset:function(a,b){this.xMin+=a;this.xMax+=a;this.yMin+=b;this.yMax+=b},getMin:function(){return new Ld(this.xMin,
this.yMin)},getCenter:function(){return new Ld(this.xMin+this.xMax>>1,this.yMin+this.yMax>>1)},getSize:function(){return new Ld(this.xMax-this.xMin,this.yMax-this.yMin)},getMax:function(){return new Ld(this.xMax,this.yMax)},isEmpty:function(){return this.xMax>this.xMin?this.yMax<=this.yMin:!0},empty:function(){this.yMin=this.xMin=2147483647;this.yMax=this.xMax=-2147483648},all:function(){this.yMin=this.xMin=-2147483648;this.yMax=this.xMax=2147483647},clone:function(){var a=new Be;a.xMin=this.xMin;
a.yMin=this.yMin;a.xMax=this.xMax;a.yMax=this.yMax;return a},get_x:function(){return this.xMin},get_y:function(){return this.yMin},set_x:function(a){this.xMax+=a-this.xMin;return this.xMin=a},set_y:function(a){this.yMax+=a-this.yMin;return this.yMin=a},get_width:function(){return this.xMax-this.xMin},get_height:function(){return this.yMax-this.yMin},set_width:function(a){this.xMax=this.xMin+a;return a},set_height:function(a){this.yMax=this.yMin+a;return a},toString:function(){return"{"+n.string(new Ld(this.xMin,
this.yMin))+","+n.string(new Ld(this.xMax-this.xMin,this.yMax-this.yMin))+"}"},__class__:Be};var Ld=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};r["h2d.col.IPoint"]=Ld;Ld.__name__="h2d.col.IPoint";Ld.prototype={toPoint:function(a){null==a&&(a=1);return new ob(this.x*a,this.y*a)},distanceSq:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},distance:function(a){var b=this.x-a.x;a=this.y-a.y;return Math.sqrt(b*b+a*a)},toString:function(){return"{"+this.x+","+this.y+"}"},sub:function(a){return new ob(this.x-
a.x,this.y-a.y)},add:function(a){return new ob(this.x+a.x,this.y+a.y)},equals:function(a){return this.x==a.x?this.y==a.y:!1},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set:function(a,b){this.x=a;this.y=b},clone:function(){return new Ld(this.x,this.y)},__class__:Ld};var Rc=function(){this.a=1;this.c=this.b=0;this.d=1;this.y=this.x=0};r["h2d.col.Matrix"]=Rc;Rc.__name__="h2d.col.Matrix";
Rc.prototype={identity:function(){this.a=1;this.c=this.b=0;this.d=1;this.y=this.x=0},initTranslate:function(a,b){this.a=1;this.c=this.b=0;this.d=1;this.x=a;this.y=b},initScale:function(a,b){this.a=a;this.c=this.b=0;this.d=b;this.y=this.x=0},initRotate:function(a){var b=Math.cos(a);a=Math.sin(a);this.a=b;this.b=a;this.c=-a;this.d=b;this.y=this.x=0},invert:function(){this.inverse(this)},getDeterminant:function(){return this.a*this.d-this.b*this.c},inverse:function(a){var b=a.a,c=a.b,d=a.c,e=a.d,f=a.x;
a=a.y;var g=1/(this.a*this.d-this.b*this.c);this.a=e*g;this.b=-c*g;this.c=-d*g;this.d=b*g;this.x=(-f*e+d*a)*g;this.y=(f*c-b*a)*g},transform:function(a){return new ob(a.x*this.a+a.y*this.c+this.x,a.x*this.b+a.y*this.d+this.y)},translate:function(a,b){this.x+=a;this.y+=b},prependTranslate:function(a,b){this.x+=this.a*a+this.c*b;this.y+=this.b*a+this.d*b},multiply:function(a,b){var c=a.a,d=a.b,e=a.c,f=a.d,g=a.x,h=a.y,k=b.a,l=b.b,E=b.c,t=b.d,x=b.x,C=b.y;this.a=c*k+d*E;this.b=c*l+d*t;this.c=e*k+f*E;this.d=
e*l+f*t;this.x=g*k+h*E+x;this.y=g*l+h*t+C},getScale:function(a){null==a&&(a=new ob);a.x=Math.sqrt(this.a*this.a+this.b*this.b);a.y=Math.sqrt(this.c*this.c+this.d*this.d);0>this.a*this.d-this.b*this.c&&(a.x*=-1,a.y*=-1);return a},scale:function(a,b){this.a*=a;this.c*=a;this.x*=a;this.b*=b;this.d*=b;this.y*=b},rotate:function(a){var b=Rc.tmp,c=Math.cos(a);a=Math.sin(a);b.a=c;b.b=a;b.c=-a;b.d=c;b.x=0;b.y=0;this.multiply(this,Rc.tmp)},clone:function(){var a=new Rc;a.a=this.a;a.b=this.b;a.c=this.c;a.d=
this.d;a.x=this.x;a.y=this.y;return a},getPosition:function(a){null==a&&(a=new ob);a.x=this.x;a.y=this.y;return a},toString:function(){return"MAT=[\n  [ "+L.fmt(this.a)+", "+L.fmt(this.b)+" ]\n  [ "+L.fmt(this.c)+", "+L.fmt(this.d)+" ]\n  [ "+L.fmt(this.x)+", "+L.fmt(this.y)+" ]\n]"},__class__:Rc};var ob=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};r["h2d.col.Point"]=ob;ob.__name__="h2d.col.Point";ob.prototype={toIPoint:function(a){null==a&&(a=1);return new Ld(Math.round(this.x*
a),Math.round(this.y*a))},distanceSq:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},distance:function(a){var b=this.x-a.x;a=this.y-a.y;return Math.sqrt(b*b+a*a)},toString:function(){return"{"+L.fmt(this.x)+","+L.fmt(this.y)+"}"},sub:function(a){return new ob(this.x-a.x,this.y-a.y)},add:function(a){return new ob(this.x+a.x,this.y+a.y)},equals:function(a){return this.x==a.x?this.y==a.y:!1},dot:function(a){return this.x*a.x+this.y*a.y},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=
this.x*a+this.y*b;this.x=this.x*b-this.y*a;this.y=c},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var a=this.x*this.x+this.y*this.y,a=1E-10>a?0:1/Math.sqrt(a);this.x*=a;this.y*=a},normalizeFast:function(){var a=this.x*this.x+this.y*this.y,a=1/Math.sqrt(a);this.x*=a;this.y*=a},set:function(a,b){this.x=a;this.y=b},load:function(a){this.x=a.x;this.y=a.y},scale:function(a){this.x*=a;this.y*=a;return this},
clone:function(){return new ob(this.x,this.y)},__class__:ob};var Ck=function(){this.enable=!0;this.smooth=!1;this.boundsExtend=0;this.autoBounds=!0};r["h2d.filter.Filter"]=Ck;Ck.__name__="h2d.filter.Filter";Ck.prototype={get_enable:function(){return this.enable},set_enable:function(a){return this.enable=a},sync:function(a,b){},bind:function(a){},unbind:function(a){},getBounds:function(a,b){a.getBounds(a,b);b.xMin-=this.boundsExtend;b.yMin-=this.boundsExtend;b.xMax+=this.boundsExtend;b.yMax+=this.boundsExtend},
draw:function(a,b){return b},__class__:Ck};var ba=K["h3d.BufferFlag"]={__ename__:!0,__constructs__:"Dynamic Triangles Quads Managed RawFormat NoAlloc UniformBuffer".split(" "),Dynamic:{_hx_index:0,__enum__:"h3d.BufferFlag",toString:m},Triangles:{_hx_index:1,__enum__:"h3d.BufferFlag",toString:m},Quads:{_hx_index:2,__enum__:"h3d.BufferFlag",toString:m},Managed:{_hx_index:3,__enum__:"h3d.BufferFlag",toString:m},RawFormat:{_hx_index:4,__enum__:"h3d.BufferFlag",toString:m},NoAlloc:{_hx_index:5,__enum__:"h3d.BufferFlag",
toString:m},UniformBuffer:{_hx_index:6,__enum__:"h3d.BufferFlag",toString:m}};ba.__empty_constructs__=[ba.Dynamic,ba.Triangles,ba.Quads,ba.Managed,ba.RawFormat,ba.NoAlloc,ba.UniformBuffer];var hb=function(a,b,c){this.id=hb.GUID++;this.vertices=a;this.flags=0;if(null!=c)for(a=0;a<c.length;){var d=c[a];++a;this.flags|=1<<d._hx_index}0==(this.flags&1<<ba.NoAlloc._hx_index)&&X.CURRENT.mem.allocBuffer(this,b)};r["h3d.Buffer"]=hb;hb.__name__="h3d.Buffer";hb.ofFloats=function(a,b,c){var d=a.pos/b|0;b=new hb(d,
b,c);b.uploadVector(a,0,d);return b};hb.ofSubFloats=function(a,b,c,d){b=new hb(c,b,d);b.uploadVector(a,0,c);return b};hb.prototype={isDisposed:function(){return null!=this.buffer?null==this.buffer.vbuf:!0},dispose:function(){null!=this.buffer&&(this.buffer.freeBuffer(this),this.buffer=null,null!=this.next&&this.next.dispose())},totalVertices:function(){for(var a=0,b=this;null!=b;)a+=b.vertices,b=b.next;return a},uploadVector:function(a,b,c,d){null==d&&(d=0);for(var e=this;null!=e&&d>=e.vertices;)d-=
e.vertices,e=e.next;for(;0<c;){if(null==e)throw new q("Too many vertices");var f=c+d>e.vertices?e.vertices-d:c;e.buffer.uploadVertexBuffer(e.position+d,f,a,b);d=0;b+=f*this.buffer.stride;c-=f;e=e.next}},uploadBytes:function(a,b,c){for(var d=this;0<c;){if(null==d)throw new q("Too many vertices");var e=c>d.vertices?d.vertices:c;d.buffer.uploadVertexBytes(d.position,e,a,b);b+=4*e*this.buffer.stride;c-=e;d=d.next}},readBytes:function(a,b,c,d){null==d&&(d=0);for(var e=this;null!=e&&d>=e.vertices;)d-=e.vertices,
e=e.next;for(;0<c;){if(null==e)throw new q("Too many vertices");var f=c+d>e.vertices?e.vertices-d:c;e.buffer.readVertexBytes(e.position+d,f,a,b);d=0;b+=4*f*this.buffer.stride;c-=f;e=e.next}},__class__:hb};var Hg=function(a,b){this.buffer=a;this.offset=b};r["h3d.BufferOffset"]=Hg;Hg.__name__="h3d.BufferOffset";Hg.prototype={clone:function(){return new Hg(this.buffer,this.offset)},dispose:function(){null!=this.buffer&&(this.buffer.dispose(),this.buffer=null);this.next=null},__class__:Hg};var Ig=function(a,
b,c,d,e,f){null==f&&(f=!1);null==e&&(e=4E3);null==d&&(d=0.02);null==c&&(c=1.333333);null==b&&(b=1);null==a&&(a=25);this.viewX=this.viewY=0;this.fovY=a;this.zoom=b;this.screenRatio=c;this.zNear=d;this.zFar=e;this.rightHanded=f;this.pos=new B(2,3,4);this.up=new B(0,0,1);this.target=new B(0,0,0);this.m=new P;this.mcam=new P;this.mproj=new P;this.frustum=new Kh;this.update()};r["h3d.Camera"]=Ig;Ig.__name__="h3d.Camera";Ig.prototype={setFovX:function(a,b){var c=Math.PI/180;this.fovY=2*Math.atan(Math.tan(0.5*
a*c)/b)/c},getFovX:function(){var a=Math.PI/180;return 2*Math.atan(Math.tan(0.5*this.fovY*a)*this.screenRatio)/a},clone:function(){var a=new Ig(this.fovY,this.zoom,this.screenRatio,this.zNear,this.zFar,this.rightHanded),b=this.pos;a.pos=new B(b.x,b.y,b.z,b.w);b=this.up;a.up=new B(b.x,b.y,b.z,b.w);b=this.target;a.target=new B(b.x,b.y,b.z,b.w);a.update();return a},getInverseViewProj:function(){null==this.minv&&(this.minv=new P);this.needInv&&(this.minv.initInverse(this.m),this.needInv=!1);return this.minv},
getInverseProj:function(){null==this.mprojInv&&(this.mprojInv=new P,this.mprojInv._44=0);0==this.mprojInv._44&&this.mprojInv.initInverse(this.mproj);return this.mprojInv},getInverseView:function(){null==this.mcamInv&&(this.mcamInv=new P,this.mcamInv._44=0);0==this.mcamInv._44&&this.mcamInv.initInverse(this.mcam);return this.mcamInv},setCubeMap:function(a,b){var c=0,d=0,e=0;switch(a){case 0:var c=1,f=this.up,g=0,h=1,k=0;null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);f.x=g;f.y=h;f.z=k;f.w=1;break;case 1:c=
-1;f=this.up;g=0;h=1;k=0;null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);f.x=g;f.y=h;f.z=k;f.w=1;break;case 2:d=1;f=this.up;h=g=0;k=-1;null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);f.x=g;f.y=h;f.z=k;f.w=1;break;case 3:d=-1;f=this.up;h=g=0;k=1;null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);f.x=g;f.y=h;f.z=k;f.w=1;break;case 4:e=1;f=this.up;g=0;h=1;k=0;null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);f.x=g;f.y=h;f.z=k;f.w=1;break;case 5:e=-1,f=this.up,g=0,h=1,k=0,null==k&&(k=0),null==h&&(h=0),null==g&&(g=0),
f.x=g,f.y=h,f.z=k,f.w=1}null!=b&&(f=this.pos,f.x=b.x,f.y=b.y,f.z=b.z,f.w=b.w);f=this.target;c=this.pos.x+c;d=this.pos.y+d;e=this.pos.z+e;null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);f.x=c;f.y=d;f.z=e;f.w=1},unproject:function(a,b,c){a=new B(a,b,c);b=this.getInverseViewProj();c=a.x*b._12+a.y*b._22+a.z*b._32+a.w*b._42;var d=a.x*b._13+a.y*b._23+a.z*b._33+a.w*b._43,e=1/(a.x*b._14+a.y*b._24+a.z*b._34+a.w*b._44);a.x=(a.x*b._11+a.y*b._21+a.z*b._31+a.w*b._41)*e;a.y=c*e;a.z=d*e;a.w=1;return a},rayFromScreen:function(a,
b){var c=X.CURRENT,d=2*(a/c.width-0.5),e=2*(0.5-b/c.height),f=this.unproject(d,e,0),c=f.x,g=f.y,f=f.z;null==f&&(f=0);null==g&&(g=0);null==c&&(c=0);var h=this.unproject(d,e,1),d=h.x,e=h.y,h=h.z;null==h&&(h=0);null==e&&(e=0);null==d&&(d=0);var k=new ld;k.px=c;k.py=g;k.pz=f;k.lx=d-c;k.ly=e-g;k.lz=h-f;k.normalize();return k},update:function(){if(null!=this.follow){var a=this.pos,b=0,c=0,d=0;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);a.x=b;a.y=c;a.z=d;a.w=1;a=this.target;d=c=b=0;null==d&&(d=0);null==
c&&(c=0);null==b&&(b=0);a.x=b;a.y=c;a.z=d;a.w=1;this.follow.pos.localToGlobal(this.pos);this.follow.target.localToGlobal(this.target);if(null!=this.follow.pos.name)for(a=this.follow.pos;null!=a;){if(null!=a.currentAnimation&&(b=a.currentAnimation.getPropValue(this.follow.pos.name,"FOVY"),null!=b)){this.fovY=b;break}a=a.parent}}this.makeCameraMatrix(this.mcam);this.makeFrustumMatrix(this.mproj);this.m.multiply(this.mcam,this.mproj);this.needInv=!0;null!=this.mcamInv&&(this.mcamInv._44=0);null!=this.mprojInv&&
(this.mprojInv._44=0);this.frustum.loadMatrix(this.m)},getFrustumCorners:function(a){null==a&&(a=1);return[this.unproject(-1,1,0),this.unproject(1,1,0),this.unproject(1,-1,0),this.unproject(-1,-1,0),this.unproject(-1,1,a),this.unproject(1,1,a),this.unproject(1,-1,a),this.unproject(-1,-1,a)]},lostUp:function(){var a=this.pos,a=new B(a.x,a.y,a.z,a.w);a.normalize();var b=this.up;return 0.999<Math.abs(a.x*b.x+a.y*b.y+a.z*b.z)},movePosAxis:function(a,b,c){null==c&&(c=0);var d=c;null==d&&(d=0);null==b&&
(b=0);null==a&&(a=0);c=a;a=b;b=d;var d=this.mcam,e=c*d._12+a*d._22+b*d._32+1*d._42,f=c*d._13+a*d._23+b*d._33+1*d._43,g=1/(c*d._14+a*d._24+b*d._34+1*d._44);c=(c*d._11+a*d._21+b*d._31+1*d._41)*g;this.pos.x+=c;this.pos.y+=e*g;this.pos.z+=f*g},moveTargetAxis:function(a,b,c){null==c&&(c=0);var d=c;null==d&&(d=0);null==b&&(b=0);null==a&&(a=0);c=a;a=b;b=d;var d=this.mcam,e=c*d._12+a*d._22+b*d._32+1*d._42,f=c*d._13+a*d._23+b*d._33+1*d._43,g=1/(c*d._14+a*d._24+b*d._34+1*d._44);c=(c*d._11+a*d._21+b*d._31+1*
d._41)*g;this.target.x+=c;this.target.y+=e*g;this.target.z+=f*g},forward:function(a){null==a&&(a=1);var b=1-0.025*a;a=this.pos;var c=this.target.x+(this.pos.x-this.target.x)*b,d=this.target.y+(this.pos.y-this.target.y)*b,b=this.target.z+(this.pos.z-this.target.z)*b;null==b&&(b=0);null==d&&(d=0);null==c&&(c=0);a.x=c;a.y=d;a.z=b;a.w=1},backward:function(a){null==a&&(a=1);var b=1+0.025*a;a=this.pos;var c=this.target.x+(this.pos.x-this.target.x)*b,d=this.target.y+(this.pos.y-this.target.y)*b,b=this.target.z+
(this.pos.z-this.target.z)*b;null==b&&(b=0);null==d&&(d=0);null==c&&(c=0);a.x=c;a.y=d;a.z=b;a.w=1},makeCameraMatrix:function(a){var b=this.target,c=this.pos,d=b.x-c.x,e=b.y-c.y,b=b.z-c.z;null==b&&(b=0);null==e&&(e=0);null==d&&(d=0);this.rightHanded&&(d*=-1,e*=-1,b*=-1);var c=1/Math.sqrt(d*d+e*e+b*b),d=d*c,e=e*c,b=b*c,f=this.up,c=f.y*b-f.z*e,g=f.z*d-f.x*b,f=f.x*e-f.y*d;null==f&&(f=0);null==g&&(g=0);null==c&&(c=0);var h=1/Math.sqrt(c*c+g*g+f*f),c=c*h,g=g*h,f=f*h;0==Math.sqrt(c*c+g*g+f*f)&&(c=e,g=b,
f=d);var h=e*f-b*g,k=b*c-d*f,l=d*g-e*c;null==l&&(l=0);null==k&&(k=0);null==h&&(h=0);a._11=c;a._12=h;a._13=d;a._14=0;a._21=g;a._22=k;a._23=e;a._24=0;a._31=f;a._32=l;a._33=b;a._34=0;var E=this.pos;a._41=-(c*E.x+g*E.y+f*E.z);c=this.pos;a._42=-(h*c.x+k*c.y+l*c.z);c=this.pos;a._43=-(d*c.x+e*c.y+b*c.z);a._44=1},makeFrustumMatrix:function(a){a.zero();var b=this.orthoBounds;if(null!=b){var c=1/(b.xMax-b.xMin),d=1/(b.yMax-b.yMin),e=1/(b.zMax-b.zMin);a._11=2*c;a._22=2*d;a._33=e;a._41=-(b.xMin+b.xMax)*c;a._42=
-(b.yMin+b.yMax)*d;a._43=-b.zMin*e;a._44=1}else b=Math.atan(Math.tan(0.5*this.fovY*(Math.PI/180))*this.screenRatio),b=this.zoom/Math.tan(b),a._11=b,a._22=b*this.screenRatio,a._33=this.zFar/(this.zFar-this.zNear),a._34=1,a._43=-(this.zNear*this.zFar)/(this.zFar-this.zNear);a._11+=this.viewX*a._14;a._21+=this.viewX*a._24;a._31+=this.viewX*a._34;a._41+=this.viewX*a._44;a._12+=this.viewY*a._14;a._22+=this.viewY*a._24;a._32+=this.viewY*a._34;a._42+=this.viewY*a._44;this.rightHanded&&(a._33*=-1,a._34*=
-1)},project:function(a,b,c,d,e,f){null==f&&(f=!0);a=new B(a,b,c);b=this.m;c=a.x*b._12+a.y*b._22+a.z*b._32+a.w*b._42;var g=a.x*b._13+a.y*b._23+a.z*b._33+a.w*b._43,h=1/(a.x*b._14+a.y*b._24+a.z*b._34+a.w*b._44);a.x=(a.x*b._11+a.y*b._21+a.z*b._31+a.w*b._41)*h;a.y=c*h;a.z=g*h;a.w=1;a.x=0.5*(a.x+1)*d;a.y=0.5*(-a.y+1)*e;f&&(a.x=Math.round(a.x),a.y=Math.round(a.y));return a},load:function(a){var b=this.pos,c=a.pos;b.x=c.x;b.y=c.y;b.z=c.z;b.w=c.w;b=this.target;c=a.target;b.x=c.x;b.y=c.y;b.z=c.z;b.w=c.w;b=
this.up;c=a.up;b.x=c.x;b.y=c.y;b.z=c.z;b.w=c.w;null!=a.orthoBounds?(this.orthoBounds=new Hb,this.orthoBounds.load(a.orthoBounds)):this.orthoBounds=null;this.fovY=a.fovY;this.screenRatio=a.screenRatio;this.zoom=a.zoom;this.zNear=a.zNear;this.zFar=a.zFar;this.follow=null!=a.follow?{pos:a.follow.pos,target:a.follow.target}:null;this.viewX=a.viewX;this.viewY=a.viewY;this.update()},__class__:Ig};var mj=function(a,b,c,d){this.t=a;this.next=b;this.layer=c;this.mipLevel=d};r["h3d._Engine.TargetTmp"]=mj;mj.__name__=
"h3d._Engine.TargetTmp";mj.prototype={__class__:mj};var X=function(){this.resCache=new zb;this.ready=!1;this.textureColorCache=new na;this.tmpVector=new B;this.backgroundColor=-16777216;this.hardware=!X.SOFTWARE_DRIVER;this.antiAlias=X.ANTIALIASING;this.autoResize=!0;this.set_fullScreen(!U.getValue(Lh.IsWindowed));this.window=db.getInstance();this.realFps=U.getDefaultFrameRate();this.lastTime=Date.now()/1E3;this.window.addResizeEvent(z(this,this.onWindowResize));this.driver=new W(this.antiAlias);
X.CURRENT=this};r["h3d.Engine"]=X;X.__name__="h3d.Engine";X.getCurrent=function(){return X.CURRENT};X.prototype={setDriver:function(a){this.driver=a;null!=this.mem&&(this.mem.driver=a)},setCurrent:function(){X.CURRENT=this},init:function(){this.driver.init(z(this,this.onCreate),!this.hardware)},driverName:function(a){null==a&&(a=!1);return this.driver.getDriverName(a)},selectShader:function(a){this.needFlushTarget&&this.doFlushTarget();this.driver.selectShader(a)&&this.shaderSwitches++},selectMaterial:function(a){this.driver.selectMaterial(a)},
uploadShaderBuffers:function(a,b){this.driver.uploadShaderBuffers(a,b)},selectBuffer:function(a){if(a.isDisposed())return!1;this.needFlushTarget&&this.doFlushTarget();this.driver.selectBuffer(a);return!0},renderTriBuffer:function(a,b,c){null==c&&(c=-1);null==b&&(b=0);this.renderBuffer(a,this.mem.triIndexes,3,b,c)},renderQuadBuffer:function(a,b,c){null==c&&(c=-1);null==b&&(b=0);this.renderBuffer(a,this.mem.quadIndexes,2,b,c)},renderBuffer:function(a,b,c,d,e){null==e&&(e=-1);null==d&&(d=0);if(!b.isDisposed())for(;;){var f=
a.vertices/c|0,g=a.position/c|0;if(0<d){if(d>=f)if(d-=f,a=a.next,null==a)break;else continue;g+=d;f-=d;d=0}if(0<=e){if(0==e)break;e-=f;0>e&&(f+=e,e=0)}0<f&&this.selectBuffer(a)&&(this.driver.draw(b.ibuf,3*g,f),this.drawTriangles+=f,this.drawCalls++);a=a.next;if(null==a)break}},renderIndexed:function(a,b,c,d){null==d&&(d=-1);null==c&&(c=0);if(null!=a.next)throw new q("Buffer is split");if(!b.isDisposed()){var e=b.count/3|0;0>d&&(d=e-c);0<d&&this.selectBuffer(a)&&(this.driver.draw(b.ibuf,3*c,d),this.drawTriangles+=
d,this.drawCalls++)}},renderMultiBuffers:function(a,b,c,d){null==d&&(d=-1);null==c&&(c=0);var e=b.count/3|0;0>=e||(this.needFlushTarget&&this.doFlushTarget(),this.driver.selectMultiBuffers(a),b.isDisposed()||(0>d&&(d=e-c),0<d&&(this.driver.draw(b.ibuf,3*c,d),this.drawTriangles+=d,this.drawCalls++)))},renderInstanced:function(a,b,c){this.needFlushTarget&&this.doFlushTarget();this.driver.selectMultiBuffers(a);!b.isDisposed()&&0<c.commandCount&&(this.driver.drawInstanced(b.ibuf,c),this.drawTriangles+=
c.triCount,this.drawCalls++)},set_debug:function(a){this.debug=a;this.driver.setDebug(this.debug);return a},onCreate:function(a){X.CURRENT=this;this.autoResize&&(this.width=this.window.get_width(),this.height=this.window.get_height());a?(Md.get().onContextLost(),this.mem.onContextLost()):(this.mem=new oe(this.driver),this.mem.init(),this.nullTexture=new S(0,0,[V.NoAlloc]));this.hardware=this.driver.hasFeature(Ja.HardwareAccelerated);this.set_debug(this.debug);this.set_fullScreen(this.fullScreen);
this.resize(this.width,this.height);if(a)this.onContextLost();else this.onReady();this.ready=!0},onContextLost:function(){},onReady:function(){},onWindowResize:function(){if(this.autoResize&&!this.driver.isDisposed()){var a=this.window.get_width(),b=this.window.get_height();(a!=this.width||b!=this.height)&&this.resize(a,b);this.onResized()}},set_fullScreen:function(a){this.fullScreen=a;null!=this.mem&&U.getValue(Lh.IsWindowed)&&this.window.set_displayMode(a?tc.Borderless:tc.Windowed);return a},onResized:function(){},
resize:function(a,b){32>a&&(a=32);32>b&&(b=32);this.width=a;this.height=b;this.driver.isDisposed()||this.driver.resize(a,b)},begin:function(){if(this.driver.isDisposed())return!1;this.drawCalls=this.shaderSwitches=this.drawTriangles=0;this.targetStack=null;this.needFlushTarget=null!=this.currentTargetTex;this.driver.begin(ea.frameCount);null!=this.backgroundColor&&this.clear(this.backgroundColor,1,0);return!0},hasFeature:function(a){return this.driver.hasFeature(a)},end:function(){this.driver.end()},
getCurrentTarget:function(){return null==this.targetStack?null:this.targetStack.t},pushTarget:function(a,b,c){null==c&&(c=0);null==b&&(b=0);var d=this.targetTmp;null==d?d=new mj(a,this.targetStack,b,c):(this.targetTmp=d.next,d.t=a,d.next=this.targetStack,d.mipLevel=c,d.layer=b);this.targetStack=d;this.updateNeedFlush()},updateNeedFlush:function(){var a=this.targetStack;this.needFlushTarget=null==a?null!=this.currentTargetTex:this.currentTargetTex!=a.t||this.currentTargetLayer!=a.layer||this.currentTargetMip!=
a.mipLevel||null!=a.textures},pushTargets:function(a){this.pushTarget(this.nullTexture);this.targetStack.textures=a;this.needFlushTarget=!0},popTarget:function(){var a=this.targetStack;if(null==a)throw new q("popTarget() with no matching pushTarget()");this.targetStack=a.next;this.updateNeedFlush();a.t=null;a.textures=null;a.next=this.targetTmp;this.targetTmp=a},flushTarget:function(){this.needFlushTarget&&this.doFlushTarget()},doFlushTarget:function(){var a=this.targetStack;null==a?(this.driver.setRenderTarget(null),
this.currentTargetTex=null):(null!=a.textures?this.driver.setRenderTargets(a.textures):this.driver.setRenderTarget(a.t,a.layer,a.mipLevel),this.currentTargetTex=a.t,this.currentTargetLayer=a.layer,this.currentTargetMip=a.mipLevel);this.needFlushTarget=!1},clearF:function(a,b,c){this.needFlushTarget&&this.doFlushTarget();this.driver.clear(a,b,c)},clear:function(a,b,c){if(null!=a){var d=this.tmpVector;d.x=(a>>16&255)/255;d.y=(a>>8&255)/255;d.z=(a&255)/255;d.w=(a>>>24)/255}this.needFlushTarget&&this.doFlushTarget();
this.driver.clear(null==a?null:this.tmpVector,b,c)},setRenderZone:function(a,b,c,d){null==d&&(d=-1);null==c&&(c=-1);null==b&&(b=0);null==a&&(a=0);this.needFlushTarget&&this.doFlushTarget();this.driver.setRenderZone(a,b,c,d)},render:function(a){if(!this.begin())return!1;a.render(this);this.end();var b=Date.now()/1E3-this.lastTime;this.lastTime+=b;0<b&&(a=1/b,a>2*this.realFps?a=2*this.realFps:a<0.5*this.realFps&&(a=0.5*this.realFps),b/=0.5,0.3<b&&(b=0.3),this.realFps=this.realFps*(1-b)+a*b);return!0},
dispose:function(){this.driver.dispose();this.window.removeResizeEvent(z(this,this.onWindowResize))},get_fps:function(){return Math.ceil(100*this.realFps)/100},__class__:X};var md=function(a,b){null==b&&(b=!1);this.mem=X.CURRENT.mem;this.count=a;this.is32=b;this.mem.allocIndexes(this)};r["h3d.Indexes"]=md;md.__name__="h3d.Indexes";md.alloc=function(a,b,c){null==c&&(c=-1);0>c&&(c=a.length);b=new md(c);b.upload(a,0,c);return b};md.prototype={isDisposed:function(){return null==this.ibuf},upload:function(a,
b,c,d){null==d&&(d=0);this.mem.driver.uploadIndexBuffer(this.ibuf,b,c,a,d)},uploadBytes:function(a,b,c){this.mem.driver.uploadIndexBytes(this.ibuf,0,c,a,b)},readBytes:function(a,b,c,d){null==d&&(d=0);this.mem.driver.readIndexBytes(this.ibuf,d,c,a,b)},dispose:function(){null!=this.ibuf&&this.mem.deleteIndexes(this)},__class__:md};var P=function(){};r["h3d.Matrix"]=P;P.__name__="h3d.Matrix";P.I=function(){var a=new P;a.identity();return a};P.L=function(a){var b=new P;b.loadValues(a);return b};P.T=function(a,
b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);var d=new P;d.initTranslation(a,b,c);return d};P.R=function(a,b,c){var d=new P;d.initRotation(a,b,c);return d};P.S=function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);var d=new P;d.initScale(a,b,c);return d};P.lookAtX=function(a,b,c){null==b&&(b=new B(0,0,1));null==c&&(c=new P);var d=a.x*a.x+a.y*a.y+a.z*a.z,d=1E-10>d?0:1/Math.sqrt(d),e=a.x*d,f=a.y*d;a=a.z*d;null==a&&(a=0);null==f&&(f=0);null==e&&(e=0);var g=b.y*a-b.z*f,d=b.z*e-b.x*a,h=b.x*
f-b.y*e;null==h&&(h=0);null==d&&(d=0);null==g&&(g=0);b=g;g=b*b+d*d+h*h;g=1E-10>g?0:1/Math.sqrt(g);b*=g;d*=g;h*=g;null==h&&(h=0);null==d&&(d=0);null==b&&(b=0);1E-10>b*b+d*d+h*h&&(b=f,d=a,h=e);var g=f*h-a*d,k=a*b-e*h,l=e*d-f*b;null==l&&(l=0);null==k&&(k=0);null==g&&(g=0);c._11=e;c._12=f;c._13=a;c._14=0;c._21=b;c._22=d;c._23=h;c._24=0;c._31=g;c._32=k;c._33=l;c._34=0;c._41=0;c._42=0;c._43=0;c._44=1;return c};P.prototype={get_tx:function(){return this._41},get_ty:function(){return this._42},get_tz:function(){return this._43},
set_tx:function(a){return this._41=a},set_ty:function(a){return this._42=a},set_tz:function(a){return this._43=a},equal:function(a){return this._11==a._11&&this._12==a._12&&this._13==a._13&&this._14==a._14&&this._21==a._21&&this._22==a._22&&this._23==a._23&&this._24==a._24&&this._31==a._31&&this._32==a._32&&this._33==a._33&&this._34==a._34&&this._41==a._41&&this._42==a._42&&this._43==a._43?this._44==a._44:!1},zero:function(){this._44=this._43=this._42=this._41=this._34=this._33=this._32=this._31=
this._24=this._23=this._22=this._21=this._14=this._13=this._12=this._11=0},identity:function(){this._11=1;this._21=this._14=this._13=this._12=0;this._22=1;this._32=this._31=this._24=this._23=0;this._33=1;this._43=this._42=this._41=this._34=0;this._44=1},initRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this._11=1;this._21=this._14=this._13=this._12=0;this._22=b;this._23=a;this._31=this._24=0;this._32=-a;this._33=b;this._43=this._42=this._41=this._34=0;this._44=1},initRotationY:function(a){var b=
Math.cos(a);a=Math.sin(a);this._11=b;this._12=0;this._13=-a;this._21=this._14=0;this._22=1;this._24=this._23=0;this._31=a;this._32=0;this._33=b;this._43=this._42=this._41=this._34=0;this._44=1},initRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this._11=b;this._12=a;this._14=this._13=0;this._21=-a;this._22=b;this._32=this._31=this._24=this._23=0;this._33=1;this._43=this._42=this._41=this._34=0;this._44=1},initTranslation:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._11=
1;this._21=this._14=this._13=this._12=0;this._22=1;this._32=this._31=this._24=this._23=0;this._33=1;this._34=0;this._41=a;this._42=b;this._43=c;this._44=1},initScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._11=a;this._21=this._14=this._13=this._12=0;this._22=b;this._32=this._31=this._24=this._23=0;this._33=c;this._43=this._42=this._41=this._34=0;this._44=1},initRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=-a.x,g=-a.y,h=-a.z,k=1/Math.sqrt(f*f+g*g+h*h),
f=f*k,g=g*k,h=h*k,k=f*e,l=h*e;this._11=c+f*k;this._12=g*k-h*d;this._13=f*l+g*d;this._14=0;this._21=g*k+h*d;this._22=c+g*g*e;this._23=g*l-f*d;this._24=0;this._31=f*l-g*d;this._32=g*l+f*d;this._33=c+h*l;this._43=this._42=this._41=this._34=0;this._44=1},initRotation:function(a,b,c){var d=Math.cos(a);a=Math.sin(a);var e=Math.cos(b);b=Math.sin(b);var f=Math.cos(c);c=Math.sin(c);var g=d*b,h=a*b;this._11=e*f;this._12=e*c;this._13=-b;this._14=0;this._21=h*f-d*c;this._22=h*c+d*f;this._23=a*e;this._24=0;this._31=
g*f+a*c;this._32=g*c-a*f;this._33=d*e;this._43=this._42=this._41=this._34=0;this._44=1},translate:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._11+=a*this._14;this._12+=b*this._14;this._13+=c*this._14;this._21+=a*this._24;this._22+=b*this._24;this._23+=c*this._24;this._31+=a*this._34;this._32+=b*this._34;this._33+=c*this._34;this._41+=a*this._44;this._42+=b*this._44;this._43+=c*this._44},scale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._11*=a;this._21*=
a;this._31*=a;this._41*=a;this._12*=b;this._22*=b;this._32*=b;this._42*=b;this._13*=c;this._23*=c;this._33*=c;this._43*=c},rotate:function(a,b,c){var d=P.tmp;d.initRotation(a,b,c);this.multiply(this,d)},rotateAxis:function(a,b){var c=P.tmp;c.initRotationAxis(a,b);this.multiply(this,c)},getPosition:function(a){null==a&&(a=new B);var b=this._41,c=this._42,d=this._43,e=this._44;null==e&&(e=1);null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);a.x=b;a.y=c;a.z=d;a.w=e;return a},setPosition:function(a){this._41=
a.x;this._42=a.y;this._43=a.z;this._44=a.w},prependTranslation:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);var d=this._12*a+this._22*b+this._32*c+this._42,e=this._13*a+this._23*b+this._33*c+this._43,f=this._14*a+this._24*b+this._34*c+this._44;this._41=this._11*a+this._21*b+this._31*c+this._41;this._42=d;this._43=e;this._44=f},getScale:function(a){null==a&&(a=new B);a.x=Math.sqrt(this._11*this._11+this._12*this._12+this._13*this._13);a.y=Math.sqrt(this._21*this._21+this._22*this._22+
this._23*this._23);a.z=Math.sqrt(this._31*this._31+this._32*this._32+this._33*this._33);0>this._11*(this._22*this._33-this._23*this._32)+this._12*(this._23*this._31-this._21*this._33)+this._13*(this._21*this._32-this._22*this._31)&&(a.x*=-1,a.y*=-1,a.z*=-1);return a},prependRotation:function(a,b,c){var d=P.tmp;d.initRotation(a,b,c);this.multiply(d,this)},prependRotationAxis:function(a,b){var c=P.tmp;c.initRotationAxis(a,b);this.multiply(c,this)},prependScale:function(a,b,c){null==c&&(c=1);null==b&&
(b=1);null==a&&(a=1);var d=P.tmp;d.initScale(a,b,c);this.multiply(d,this)},multiply3x4:function(a,b){var c=a._11,d=a._12,e=a._13,f=a._21,g=a._22,h=a._23,k=a._31,l=a._32,E=a._33,t=a._41,x=a._42,C=a._43,M=b._11,m=b._12,p=b._13,n=b._21,q=b._22,r=b._23,s=b._31,u=b._32,A=b._33,y=b._41,w=b._42,v=b._43;this._11=c*M+d*n+e*s;this._12=c*m+d*q+e*u;this._13=c*p+d*r+e*A;this._14=0;this._21=f*M+g*n+h*s;this._22=f*m+g*q+h*u;this._23=f*p+g*r+h*A;this._24=0;this._31=k*M+l*n+E*s;this._32=k*m+l*q+E*u;this._33=k*p+l*
r+E*A;this._34=0;this._41=t*M+x*n+C*s+y;this._42=t*m+x*q+C*u+w;this._43=t*p+x*r+C*A+v;this._44=1},multiply3x4inline:function(a,b){var c=a._11,d=a._12,e=a._13,f=a._21,g=a._22,h=a._23,k=a._31,l=a._32,E=a._33,t=a._41,x=a._42,C=a._43,M=b._11,m=b._12,p=b._13,n=b._21,q=b._22,r=b._23,s=b._31,u=b._32,A=b._33,y=b._41,w=b._42,v=b._43;this._11=c*M+d*n+e*s;this._12=c*m+d*q+e*u;this._13=c*p+d*r+e*A;this._14=0;this._21=f*M+g*n+h*s;this._22=f*m+g*q+h*u;this._23=f*p+g*r+h*A;this._24=0;this._31=k*M+l*n+E*s;this._32=
k*m+l*q+E*u;this._33=k*p+l*r+E*A;this._34=0;this._41=t*M+x*n+C*s+y;this._42=t*m+x*q+C*u+w;this._43=t*p+x*r+C*A+v;this._44=1},multiply:function(a,b){var c=a._11,d=a._12,e=a._13,f=a._14,g=a._21,h=a._22,k=a._23,l=a._24,E=a._31,t=a._32,x=a._33,C=a._34,M=a._41,m=a._42,p=a._43,n=a._44,q=b._11,r=b._12,s=b._13,u=b._14,A=b._21,y=b._22,w=b._23,v=b._24,B=b._31,F=b._32,G=b._33,z=b._34,I=b._41,J=b._42,K=b._43,L=b._44;this._11=c*q+d*A+e*B+f*I;this._12=c*r+d*y+e*F+f*J;this._13=c*s+d*w+e*G+f*K;this._14=c*u+d*v+e*
z+f*L;this._21=g*q+h*A+k*B+l*I;this._22=g*r+h*y+k*F+l*J;this._23=g*s+h*w+k*G+l*K;this._24=g*u+h*v+k*z+l*L;this._31=E*q+t*A+x*B+C*I;this._32=E*r+t*y+x*F+C*J;this._33=E*s+t*w+x*G+C*K;this._34=E*u+t*v+x*z+C*L;this._41=M*q+m*A+p*B+n*I;this._42=M*r+m*y+p*F+n*J;this._43=M*s+m*w+p*G+n*K;this._44=M*u+m*v+p*z+n*L},multiplyValue:function(a){this._11*=a;this._12*=a;this._13*=a;this._14*=a;this._21*=a;this._22*=a;this._23*=a;this._24*=a;this._31*=a;this._32*=a;this._33*=a;this._34*=a;this._41*=a;this._42*=a;
this._43*=a;this._44*=a},invert:function(){this.initInverse(this)},getDeterminant:function(){return this._11*(this._22*this._33-this._23*this._32)+this._12*(this._23*this._31-this._21*this._33)+this._13*(this._21*this._32-this._22*this._31)},inverse3x4:function(a){var b=a._11,c=a._12,d=a._13,e=a._21,f=a._22,g=a._23,h=a._31,k=a._32,l=a._33,E=a._41,t=a._42;a=a._43;this._11=f*l-g*k;this._12=d*k-c*l;this._13=c*g-d*f;this._14=0;this._21=g*h-e*l;this._22=b*l-d*h;this._23=d*e-b*g;this._24=0;this._31=e*k-
f*h;this._32=c*h-b*k;this._33=b*f-c*e;this._34=0;this._41=-e*k*a+e*l*t+h*f*a-h*g*t-E*f*l+E*g*k;this._42=b*k*a-b*l*t-h*c*a+h*d*t+E*c*l-E*d*k;this._43=-b*f*a+b*g*t+e*c*a-e*d*t-E*c*g+E*d*f;this._44=b*f*l-b*g*k-e*c*l+e*d*k+h*c*g-h*d*f;this._44=1;b=b*this._11+c*this._21+d*this._31;1E-10>(0>b?-b:b)?this.zero():(b=1/b,this._11*=b,this._12*=b,this._13*=b,this._21*=b,this._22*=b,this._23*=b,this._31*=b,this._32*=b,this._33*=b,this._41*=b,this._42*=b,this._43*=b)},initInverse:function(a){var b=a._11,c=a._12,
d=a._13,e=a._14,f=a._21,g=a._22,h=a._23,k=a._24,l=a._31,E=a._32,t=a._33,x=a._34,C=a._41,m=a._42,p=a._43;a=a._44;this._11=g*t*a-g*x*p-E*h*a+E*k*p+m*h*x-m*k*t;this._12=-c*t*a+c*x*p+E*d*a-E*e*p-m*d*x+m*e*t;this._13=c*h*a-c*k*p-g*d*a+g*e*p+m*d*k-m*e*h;this._14=-c*h*x+c*k*t+g*d*x-g*e*t-E*d*k+E*e*h;this._21=-f*t*a+f*x*p+l*h*a-l*k*p-C*h*x+C*k*t;this._22=b*t*a-b*x*p-l*d*a+l*e*p+C*d*x-C*e*t;this._23=-b*h*a+b*k*p+f*d*a-f*e*p-C*d*k+C*e*h;this._24=b*h*x-b*k*t-f*d*x+f*e*t+l*d*k-l*e*h;this._31=f*E*a-f*x*m-l*g*
a+l*k*m+C*g*x-C*k*E;this._32=-b*E*a+b*x*m+l*c*a-l*e*m-C*c*x+C*e*E;this._33=b*g*a-b*k*m-f*c*a+f*e*m+C*c*k-C*e*g;this._34=-b*g*x+b*k*E+f*c*x-f*e*E-l*c*k+l*e*g;this._41=-f*E*p+f*t*m+l*g*p-l*h*m-C*g*t+C*h*E;this._42=b*E*p-b*t*m-l*c*p+l*d*m+C*c*t-C*d*E;this._43=-b*g*p+b*h*m+f*c*p-f*d*m-C*c*h+C*d*g;this._44=b*g*t-b*h*E-f*c*t+f*d*E+l*c*h-l*d*g;b=b*this._11+c*this._21+d*this._31+e*this._41;1E-10>(0>b?-b:b)?this.zero():(b=1/b,this._11*=b,this._12*=b,this._13*=b,this._14*=b,this._21*=b,this._22*=b,this._23*=
b,this._24*=b,this._31*=b,this._32*=b,this._33*=b,this._34*=b,this._41*=b,this._42*=b,this._43*=b,this._44*=b)},initInverse3x3:function(a){var b=a._11,c=a._12,d=a._13,e=a._21,f=a._22,g=a._23,h=a._31,k=a._32;a=a._33;this._11=f*a-k*g;this._12=-c*a+k*d;this._13=c*g-f*d;this._21=-e*a+h*g;this._22=b*a-h*d;this._23=-b*g+e*d;this._31=e*k-h*f;this._32=-b*k+h*c;this._33=b*f-e*c;b=b*this._11+c*this._21+d*this._31;1E-10>(0>b?-b:b)?this.zero():(b=1/b,this._11*=b,this._12*=b,this._13*=b,this._14=0,this._21*=b,
this._22*=b,this._23*=b,this._24=0,this._31*=b,this._32*=b,this._33*=b,this._43=this._42=this._41=this._34=0,this._44=1)},front:function(){var a=new B(this._11,this._12,this._13),b=1/Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);a.x*=b;a.y*=b;a.z*=b;return a},right:function(){var a=new B(this._21,this._22,this._23),b=1/Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);a.x*=b;a.y*=b;a.z*=b;return a},up:function(){var a=new B(this._31,this._32,this._33),b=1/Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);a.x*=b;a.y*=b;a.z*=b;return a},transpose:function(){var a=
this._12;this._12=this._21;this._21=a;a=this._13;this._13=this._31;this._31=a;a=this._14;this._14=this._41;this._41=a;a=this._23;this._23=this._32;this._32=a;a=this._24;this._24=this._42;this._42=a;a=this._34;this._34=this._43;this._43=a},clone:function(){var a=new P;a._11=this._11;a._12=this._12;a._13=this._13;a._14=this._14;a._21=this._21;a._22=this._22;a._23=this._23;a._24=this._24;a._31=this._31;a._32=this._32;a._33=this._33;a._34=this._34;a._41=this._41;a._42=this._42;a._43=this._43;a._44=this._44;
return a},load:function(a){this._11=a._11;this._12=a._12;this._13=a._13;this._14=a._14;this._21=a._21;this._22=a._22;this._23=a._23;this._24=a._24;this._31=a._31;this._32=a._32;this._33=a._33;this._34=a._34;this._41=a._41;this._42=a._42;this._43=a._43;this._44=a._44},loadValues:function(a){this._11=a[0];this._12=a[1];this._13=a[2];this._14=a[3];this._21=a[4];this._22=a[5];this._23=a[6];this._24=a[7];this._31=a[8];this._32=a[9];this._33=a[10];this._34=a[11];this._41=a[12];this._42=a[13];this._43=a[14];
this._44=a[15]},getFloats:function(){return[this._11,this._12,this._13,this._14,this._21,this._22,this._23,this._24,this._31,this._32,this._33,this._34,this._41,this._42,this._43,this._44]},getEulerAngles:function(){var a=this.clone(),b=null;null==b&&(b=new B);b.x=Math.sqrt(this._11*this._11+this._12*this._12+this._13*this._13);b.y=Math.sqrt(this._21*this._21+this._22*this._22+this._23*this._23);b.z=Math.sqrt(this._31*this._31+this._32*this._32+this._33*this._33);0>this._11*(this._22*this._33-this._23*
this._32)+this._12*(this._23*this._31-this._21*this._33)+this._13*(this._21*this._32-this._22*this._31)&&(b.x*=-1,b.y*=-1,b.z*=-1);a.prependScale(1/b.x,1/b.y,1/b.z);var c=Math.sqrt(a._11*a._11+a._12*a._12);return 0.01<c?(b=new B(Math.atan2(a._23,a._33),Math.atan2(-a._13,c),Math.atan2(a._12,a._11)),a=new B(Math.atan2(-a._23,-a._33),Math.atan2(-a._13,-c),Math.atan2(-a._12,-a._11)),b.x*b.x+b.y*b.y+b.z*b.z<a.x*a.x+a.y*a.y+a.z*a.z?b:a):new B(Math.atan2(-a._32,a._22),Math.atan2(-a._13,c),0)},toString:function(){return"MAT=[\n  [ "+
L.fmt(this._11)+", "+L.fmt(this._12)+", "+L.fmt(this._13)+", "+L.fmt(this._14)+" ]\n  [ "+L.fmt(this._21)+", "+L.fmt(this._22)+", "+L.fmt(this._23)+", "+L.fmt(this._24)+" ]\n  [ "+L.fmt(this._31)+", "+L.fmt(this._32)+", "+L.fmt(this._33)+", "+L.fmt(this._34)+" ]\n  [ "+L.fmt(this._41)+", "+L.fmt(this._42)+", "+L.fmt(this._43)+", "+L.fmt(this._44)+" ]\n]"},colorHue:function(a){if(0!=a){var b=Math.cos(-a);a=Math.sin(-a);var c=(1-b)/3,d=P.tmp;d._11=b+c;d._12=c-0.5773502691896257*a;d._13=c+0.5773502691896257*
a;d._21=c+0.5773502691896257*a;d._22=b+c;d._23=c-0.5773502691896257*a;d._31=c-0.5773502691896257*a;d._32=c+0.5773502691896257*a;d._33=b+c;d._34=0;d._41=0;d._42=0;d._43=0;this.multiply3x4(this,d)}},colorSaturate:function(a){++a;var b=1-a,c=0.212671*b,d=0.71516*b,b=0.072169*b,e=P.tmp;e._11=c+a;e._12=c;e._13=c;e._21=d;e._22=d+a;e._23=d;e._31=b;e._32=b;e._33=b+a;e._41=0;e._42=0;e._43=0;this.multiply3x4(this,e)},colorContrast:function(a){var b=P.tmp,c=a+1;b._11=c;b._12=0;b._13=0;b._21=0;b._22=c;b._23=
0;b._31=0;b._32=0;b._33=c;b._41=0.5*-a;b._42=0.5*-a;b._43=0.5*-a;this.multiply3x4(this,b)},colorLightness:function(a){this._41+=a;this._42+=a;this._43+=a},colorGain:function(a,b){var c=P.tmp;c._11=1-b;c._12=0;c._13=0;c._21=0;c._22=1-b;c._23=0;c._31=0;c._32=0;c._33=1-b;c._41=(a>>16&255)/255*b;c._42=(a>>8&255)/255*b;c._43=(a&255)/255*b;this.multiply3x4(this,c)},colorBits:function(a,b){var c=0,d=0,e=0,f=0,g=0,h=0,k=0,l=0,E=0,t=a;1==(t&1)&&(c=1);t>>=1;1==(t&1)&&(d=1);t>>=1;1==(t&1)&&(e=1);t>>=1;1==(t&
1)&&(f=1);t>>=1;1==(t&1)&&(g=1);t>>=1;1==(t&1)&&(h=1);t>>=1;1==(t&1)&&(k=1);t>>=1;1==(t&1)&&(l=1);1==(t>>1&1)&&(E=1);var t=c+f+k,x=d+g+l,C=e+h+E;1<t&&(c/=t,f/=t,k/=t);1<x&&(d/=x,g/=x,l/=x);1<C&&(e/=C,h/=C,E/=C);var t=this._11*d+this._12*g+this._13*l,x=this._11*e+this._12*h+this._13*E,C=this._21*c+this._22*f+this._23*k,m=this._21*d+this._22*g+this._23*l,p=this._21*e+this._22*h+this._23*E,n=this._31*c+this._32*f+this._33*k,d=this._31*d+this._32*g+this._33*l,e=this._31*e+this._32*h+this._33*E,h=1-b;
this._11=this._11*h+(this._11*c+this._12*f+this._13*k)*b;this._12=this._12*h+t*b;this._13=this._13*h+x*b;this._21=this._21*h+C*b;this._22=this._22*h+m*b;this._23=this._23*h+p*b;this._31=this._31*h+n*b;this._32=this._32*h+d*b;this._33=this._33*h+e*b},colorAdd:function(a){this._41+=(a>>16&255)/255;this._42+=(a>>8&255)/255;this._43+=(a&255)/255},colorSet:function(a,b){null==b&&(b=1);this.zero();this._44=b;this._41+=(a>>16&255)/255;this._42+=(a>>8&255)/255;this._43+=(a&255)/255},adjustColor:function(a){null!=
a.hue&&this.colorHue(a.hue);null!=a.saturation&&this.colorSaturate(a.saturation);null!=a.contrast&&this.colorContrast(a.contrast);null!=a.lightness&&this.colorLightness(a.lightness);null!=a.gain&&this.colorGain(a.gain.color,a.gain.alpha)},__class__:P};var Oe=function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d};r["h3d.Quat"]=Oe;Oe.__name__="h3d.Quat";Oe.prototype={set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d},identity:function(){this.x=
this.y=this.z=0;this.w=1},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},load:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w},clone:function(){return new Oe(this.x,this.y,this.z,this.w)},initMoveTo:function(a,b){var c=a.x+b.x,d=a.y+b.y,e=a.z+b.z;Math.sqrt(c*c+d*d+e*e);this.x=a.y*e-a.z*d;this.y=a.z*c-a.x*e;this.z=a.x*d-a.y*c;this.w=a.x*c+a.y*d+a.z*e;this.normalize()},
initDirection:function(a){var b=a.x,c=a.y;a=a.z;null==a&&(a=0);null==c&&(c=0);null==b&&(b=0);var d=b*b+c*c+a*a,d=1E-10>d?0:1/Math.sqrt(d),b=b*d,c=c*d,d=a*d;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);a=b;var b=c,c=d,d=-b,e=a,f=0;null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);var g=d*d+e*e+f*f,g=1E-10>g?0:1/Math.sqrt(g),d=d*g,e=e*g,f=f*g;null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);var h=e,e=f;1E-10>d*d+h*h+e*e&&(d=b,h=c,e=a);var f=b*e-c*h,g=c*d-a*e,k=a*h-b*d;null==k&&(k=0);null==g&&(g=0);null==f&&
(f=0);var l=a+h+k;0<l?(a=2*Math.sqrt(l+1),h=1/a,this.x=(e-g)*h,this.y=(f-c)*h,this.z=(b-d)*h,this.w=0.25*a):a>h&&a>k?(a=2*Math.sqrt(1+a-h-k),h=1/a,this.x=0.25*a,this.y=(d+b)*h,this.z=(f+c)*h,this.w=(e-g)*h):h>k?(a=2*Math.sqrt(1+h-a-k),h=1/a,this.x=(d+b)*h,this.y=0.25*a,this.z=(g+e)*h,this.w=(f-c)*h):(a=2*Math.sqrt(1+k-a-h),h=1/a,this.x=(f+c)*h,this.y=(g+e)*h,this.z=0.25*a,this.w=(b-d)*h)},initRotateAxis:function(a,b,c,d){var e=Math.sin(d/2);d=Math.cos(d/2);this.x=a*e;this.y=b*e;this.z=c*e;this.w=
d*Math.sqrt(a*a+b*b+c*c);this.normalize()},initRotateMatrix:function(a){var b=a._11+a._22+a._33;if(0<b){var b=2*Math.sqrt(b+1),c=1/b;this.x=(a._23-a._32)*c;this.y=(a._31-a._13)*c;this.z=(a._12-a._21)*c;this.w=0.25*b}else a._11>a._22&&a._11>a._33?(b=2*Math.sqrt(1+a._11-a._22-a._33),c=1/b,this.x=0.25*b,this.y=(a._21+a._12)*c,this.z=(a._31+a._13)*c,this.w=(a._23-a._32)*c):a._22>a._33?(b=2*Math.sqrt(1+a._22-a._11-a._33),c=1/b,this.x=(a._21+a._12)*c,this.y=0.25*b,this.z=(a._32+a._23)*c,this.w=(a._31-a._13)*
c):(b=2*Math.sqrt(1+a._33-a._11-a._22),c=1/b,this.x=(a._31+a._13)*c,this.y=(a._32+a._23)*c,this.z=0.25*b,this.w=(a._12-a._21)*c)},normalize:function(){var a=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;1E-10>a?(this.x=this.y=this.z=0,this.w=1):(a=1/Math.sqrt(a),this.x*=a,this.y*=a,this.z*=a,this.w*=a)},initRotation:function(a,b,c){var d=Math.sin(0.5*a);a=Math.cos(0.5*a);var e=Math.sin(0.5*b);b=Math.cos(0.5*b);var f=Math.sin(0.5*c);c=Math.cos(0.5*c);var g=b*c,h=e*f;this.x=d*g-a*h;this.y=
a*e*c+d*b*f;this.z=a*b*f-d*e*c;this.w=a*g+d*h},multiply:function(a,b){var c=a.w*b.y-a.x*b.z+a.y*b.w+a.z*b.x,d=a.w*b.z+a.x*b.y-a.y*b.x+a.z*b.w,e=a.w*b.w-a.x*b.x-a.y*b.y-a.z*b.z;this.x=a.x*b.w+a.w*b.x+a.y*b.z-a.z*b.y;this.y=c;this.z=d;this.w=e},toEuler:function(){return this.toMatrix().getEulerAngles()},lerp:function(a,b,c,d){null==d&&(d=!1);d=d&&0>a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w?c-1:1-c;var e=a.y*c+b.y*d,f=a.z*c+b.z*d,g=a.w*c+b.w*d;this.x=a.x*c+b.x*d;this.y=e;this.z=f;this.w=g},slerp:function(a,b,
c){var d=a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w;if(1<=(0>d?-d:d))this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w;else{var e=Math.acos(d),f=1/Math.sqrt(1-d*d);if(1E3<(0>f?-f:f)){var g=!0;null==g&&(g=!1);g=g&&0>a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w?-0.5:0.5;c=0.5*a.y+b.y*g;d=0.5*a.z+b.z*g;e=0.5*a.w+b.w*g;this.x=0.5*a.x+b.x*g;this.y=c;this.z=d;this.w=e}else g=Math.sin((1-c)*e)*f,c=Math.sin(c*e)*f*(0>d?-1:1),this.x=a.x*g+b.x*c,this.y=a.y*g+b.y*c,this.z=a.z*g+b.z*c,this.w=a.w*g+b.w*c}},conjugate:function(){this.x=-this.x;
this.y=-this.y;this.z=-this.z},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},getDirection:function(){return new B(1-2*(this.y*this.y+this.z*this.z),2*(this.x*this.y-this.z*this.w),2*(this.x*this.z+this.y*this.w))},toMatrix:function(a){null==a&&(a=new P);var b=this.x*this.x,c=this.x*this.y,d=this.x*this.z,e=this.x*this.w,f=this.y*this.y,g=this.y*this.z,h=this.y*this.w,k=this.z*this.z,l=this.z*this.w;
a._11=1-2*(f+k);a._12=2*(c+l);a._13=2*(d-h);a._14=0;a._21=2*(c-l);a._22=1-2*(b+k);a._23=2*(g+e);a._24=0;a._31=2*(d+h);a._32=2*(g-e);a._33=1-2*(b+f);a._34=0;a._41=0;a._42=0;a._43=0;a._44=1;return a},toString:function(){return"{"+L.fmt(this.x)+","+L.fmt(this.y)+","+L.fmt(this.z)+","+L.fmt(this.w)+"}"},__class__:Oe};var B=function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d};r["h3d.Vector"]=B;B.__name__="h3d.Vector";B.fromColor=function(a,
b){null==b&&(b=1);var c=b/255;return new B((a>>16&255)*c,(a>>8&255)*c,(a&255)*c,(a>>>24)*c)};B.fromArray=function(a){var b=new B;0<a.length&&(b.x=a[0]);1<a.length&&(b.y=a[1]);2<a.length&&(b.z=a[2]);3<a.length&&(b.w=a[3]);return b};B.prototype={distance:function(a){var b=a.x-this.x,c=a.y-this.y;a=a.z-this.z;return Math.sqrt(b*b+c*c+a*a)},distanceSq:function(a){var b=a.x-this.x,c=a.y-this.y;a=a.z-this.z;return b*b+c*c+a*a},sub:function(a){return new B(this.x-a.x,this.y-a.y,this.z-a.z,this.w-a.w)},add:function(a){return new B(this.x+
a.x,this.y+a.y,this.z+a.z,this.w+a.w)},cross:function(a){return new B(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*a.y-this.y*a.x,1)},reflect:function(a){var b=2*(this.x*a.x+this.y*a.y+this.z*a.z);return new B(this.x-b*a.x,this.y-b*a.y,this.z-b*a.z,1)},dot3:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},dot4:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+
this.y*this.y+this.z*this.z)},normalize:function(){var a=this.x*this.x+this.y*this.y+this.z*this.z,a=1E-10>a?0:1/Math.sqrt(a);this.x*=a;this.y*=a;this.z*=a},normalizeFast:function(){var a=1/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);this.x*=a;this.y*=a;this.z*=a},getNormalized:function(){var a=this.x*this.x+this.y*this.y+this.z*this.z,a=1E-10>a?0:1/Math.sqrt(a);return new B(this.x*a,this.y*a,this.z*a)},set:function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=
a;this.y=b;this.z=c;this.w=d},load:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w},scale3:function(a){this.x*=a;this.y*=a;this.z*=a},project:function(a){var b=this.x*a._12+this.y*a._22+this.z*a._32+this.w*a._42,c=this.x*a._13+this.y*a._23+this.z*a._33+this.w*a._43,d=1/(this.x*a._14+this.y*a._24+this.z*a._34+this.w*a._44);this.x=(this.x*a._11+this.y*a._21+this.z*a._31+this.w*a._41)*d;this.y=b*d;this.z=c*d;this.w=1},lerp:function(a,b,c){var d=a.x,e=a.y,e=e+c*(b.y-e),f=a.z,f=f+c*(b.z-f);a=a.w;
a+=c*(b.w-a);this.x=d+c*(b.x-d);this.y=e;this.z=f;this.w=a},transform3x4:function(a){var b=this.x*a._12+this.y*a._22+this.z*a._32+this.w*a._42,c=this.x*a._13+this.y*a._23+this.z*a._33+this.w*a._43;this.x=this.x*a._11+this.y*a._21+this.z*a._31+this.w*a._41;this.y=b;this.z=c},transform3x3:function(a){var b=this.x*a._12+this.y*a._22+this.z*a._32,c=this.x*a._13+this.y*a._23+this.z*a._33;this.x=this.x*a._11+this.y*a._21+this.z*a._31;this.y=b;this.z=c},transform:function(a){var b=this.x*a._12+this.y*a._22+
this.z*a._32+this.w*a._42,c=this.x*a._13+this.y*a._23+this.z*a._33+this.w*a._43,d=this.x*a._14+this.y*a._24+this.z*a._34+this.w*a._44;this.x=this.x*a._11+this.y*a._21+this.z*a._31+this.w*a._41;this.y=b;this.z=c;this.w=d},clone:function(){return new B(this.x,this.y,this.z,this.w)},toPoint:function(){return new wa(this.x,this.y,this.z)},toString:function(){return"{"+L.fmt(this.x)+","+L.fmt(this.y)+","+L.fmt(this.z)+","+L.fmt(this.w)+"}"},get_r:function(){return this.x},get_g:function(){return this.y},
get_b:function(){return this.z},get_a:function(){return this.w},set_r:function(a){return this.x=a},set_g:function(a){return this.y=a},set_b:function(a){return this.z=a},set_a:function(a){return this.w=a},setColor:function(a){this.x=(a>>16&255)/255;this.y=(a>>8&255)/255;this.z=(a&255)/255;this.w=(a>>>24)/255},makeColor:function(a,b,c){null==c&&(c=0.5);null==b&&(b=1);a%=6.283185307179586;a=0<=a?a:a+6.283185307179586;var d=2*c-1;b*=1-(0>d?-d:d);d=3*a/3.141592653589793%2-1;d=b*(1-(0>d?-d:d));c-=b/2;1.0471975511965976>
a?(this.x=b,this.y=d,this.z=0):2.0943951023931953>a?(this.x=d,this.y=b,this.z=0):3.141592653589793>a?(this.x=0,this.y=b,this.z=d):4.1887902047863905>a?(this.x=0,this.y=d,this.z=b):5.235987755982989>a?(this.x=d,this.y=0,this.z=b):(this.x=b,this.y=0,this.z=d);this.x+=c;this.y+=c;this.z+=c;this.w=1},toColor:function(){var a=this.w,b=this.x,c=this.y,d=this.z;return(255*(0>a?0:1<a?1:a)+0.499|0)<<24|(255*(0>b?0:1<b?1:b)+0.499|0)<<16|(255*(0>c?0:1<c?1:c)+0.499|0)<<8|255*(0>d?0:1<d?1:d)+0.499|0},toColorHSL:function(){var a=
this.x,b=this.y,a=a<b?b:a,b=this.z,a=a<b?b:a,b=this.x,c=this.y,b=b>c?c:b,c=this.z,c=b>c?c:b,b=(a+c)/2;if(a==c)a=c=0;else var d=a-c,c=0.5<b?d/(2-a-c):d/(a+c),a=a==this.x?(this.y-this.z)/d+(this.y<this.z?6:0):a==this.y?(this.z-this.x)/d+2:(this.x-this.y)/d+4,a=1.0471975511965976*a;return new B(a,c,b,this.w)},__class__:B};var $e=function(a){this.objectName=a};r["h3d.anim.AnimatedObject"]=$e;$e.__name__="h3d.anim.AnimatedObject";$e.prototype={clone:function(){return new $e(this.objectName)},__class__:$e};
var Qb=function(a,b,c){this.name=a;this.frameCount=b;this.sampling=c;this.objects=[];this.lastEvent=-1;this.frame=0;this.speed=1;this.loop=!0;this.pause=!1};r["h3d.anim.Animation"]=Qb;Qb.__name__="h3d.anim.Animation";Qb.__interfaces__=[bc];Qb.prototype={getDuration:function(){return this.frameCount/(this.sampling*this.speed)},getIFrame:function(){var a=this.frame|0,b=this.endFrame();a==b&&--a;return a},unbind:function(a){for(var b=0,c=this.objects;b<c.length;){var d=c[b];++b;if(d.objectName==a){this.isSync=
!1;d.targetObject=null;d.targetSkin=null;break}}},setEvents:function(a){for(var b=[],c=0,d=this.frameCount;c<d;)c++,b.push(null);this.events=b;for(a=a instanceof Array?v.iter(a):a.iterator();a.hasNext();)b=a.next(),null==this.events[b.frame]&&(this.events[b.frame]=[]),this.events[b.frame].push(b.data)},addEvent:function(a,b){null==this.events&&(this.events=[]);null==this.events[a]?this.events[a]=[b]:this.events[a].push(b)},getEvents:function(){return this.events},getObjects:function(){return this.objects},
setFrame:function(a){this.frame=a;for(this.lastEvent=-1;0>this.frame;)this.frame+=this.frameCount;for(;this.frame>this.frameCount;)this.frame-=this.frameCount},clone:function(a){null==a&&(a=new Qb(this.name,this.frameCount,this.sampling));a.objects=this.objects;a.speed=this.speed;a.loop=this.loop;a.pause=this.pause;a.events=this.events;a.resourcePath=this.resourcePath;return a},initInstance:function(){this.isInstance=!0},createInstance:function(a){for(var b=[],c=0,d=this.objects;c<d.length;){var e=
d[c];++c;b.push(e.clone())}c=this.clone();c.objects=b;c.bind(a);c.initInstance();return c},bind:function(a){for(var b=null,c=0,d=this.objects.slice();c<d.length;){var e=d[c];++c;if(null!=b){var f=e.objectName,g=b.skinData.namedJoints,f=null!=Q[f]?g.getReserved(f):g.h[f];if(null!=f){e.targetSkin=b;e.targetJoint=f.index;continue}}f=a.getObjectByName(e.objectName);null==f?v.remove(this.objects,e):(g=f instanceof Gf?f:null,null!=g?(b=g.parent,e.targetSkin=b,e.targetJoint=g.index):e.targetObject=f)}this.isSync=
!1},getPropValue:function(a,b){return null},sync:function(a){throw new q("assert");},isPlaying:function(){return this.pause?!1:1E-6<(0>this.speed?-this.speed:this.speed)},endFrame:function(){return this.frameCount},update:function(a){if(!this.isInstance)throw new q("You must instanciate this animation first");if(!this.isPlaying())return 0;if(null!=this.events&&null!=this.onEvent){var b=this.frame|0,c=this.frame+a*this.speed*this.sampling|0;c>=this.frameCount&&(c=this.frameCount-1);for(var d=c+1;b<
d;)if(c=b++,c!=this.lastEvent&&(this.lastEvent=c,null!=this.events[c])){b=this.frame;d=a;a-=(c-this.frame)/(this.speed*this.sampling);this.frame=c;for(var e=0,f=this.events[c];e<f.length;){var g=f[e];++e;this.onEvent(g)}if(this.frame==c&&c==this.frameCount-1){this.frame=b;a=d;break}else return a}}if(null!=this.onAnimEnd&&(c=this.endFrame(),b=0==this.speed?0:(c-this.frame)/(this.speed*this.sampling),b<=a&&0<b))return this.frame=c,a-=b,this.onAnimEnd(),this.frame==c&&this.isPlaying()&&(this.loop?this.frame=
0:a=0),a;this.frame+=a*this.speed*this.sampling;this.frame>=this.frameCount&&(this.frame=this.loop?this.frame%this.frameCount:this.frameCount);return 0},initAndBind:function(a){this.bind(a);this.initInstance();this.pause=!0},toString:function(){return this.name},__class__:Qb};var da=K["h3d.anim.DataLayout"]={__ename__:!0,__constructs__:"Position Rotation Scale UV Alpha Property SingleFrame".split(" "),Position:{_hx_index:0,__enum__:"h3d.anim.DataLayout",toString:m},Rotation:{_hx_index:1,__enum__:"h3d.anim.DataLayout",
toString:m},Scale:{_hx_index:2,__enum__:"h3d.anim.DataLayout",toString:m},UV:{_hx_index:3,__enum__:"h3d.anim.DataLayout",toString:m},Alpha:{_hx_index:4,__enum__:"h3d.anim.DataLayout",toString:m},Property:{_hx_index:5,__enum__:"h3d.anim.DataLayout",toString:m},SingleFrame:{_hx_index:6,__enum__:"h3d.anim.DataLayout",toString:m}};da.__empty_constructs__=[da.Position,da.Rotation,da.Scale,da.UV,da.Alpha,da.Property,da.SingleFrame];var Jg=function(a,b){this.objectName=a;this.dataOffset=b};r["h3d.anim.BufferObject"]=
Jg;Jg.__name__="h3d.anim.BufferObject";Jg.__super__=$e;Jg.prototype=J($e.prototype,{getStride:function(){var a=0;0!=(this.layout&1<<da.Position._hx_index)&&(a+=3);0!=(this.layout&1<<da.Rotation._hx_index)&&(a+=3);0!=(this.layout&1<<da.Scale._hx_index)&&(a+=3);0!=(this.layout&1<<da.UV._hx_index)&&(a+=2);0!=(this.layout&1<<da.Alpha._hx_index)&&++a;0!=(this.layout&1<<da.Property._hx_index)&&++a;return a},clone:function(){var a=new Jg(this.objectName,this.dataOffset);a.layout=this.layout;a.propName=this.propName;
return a},__class__:Jg});var Hf=function(a,b,c){Qb.call(this,a,b,c);this.syncFrame=-1};r["h3d.anim.BufferAnimation"]=Hf;Hf.__name__="h3d.anim.BufferAnimation";Hf.__super__=Qb;Hf.prototype=J(Qb.prototype,{setData:function(a,b){this.data=a;this.stride=b},addObject:function(a,b){var c=new Jg(a,b);this.objects.push(c);return c},getPropValue:function(a,b){for(var c=0,d=this.objects;c<d.length;){var e=d[c];++c;if(e.objectName==a&&e.propName==b)return e.propCurrentValue}return null},getFrames:function(){return this.objects},
clone:function(a){null==a&&(a=new Hf(this.name,this.frameCount,this.sampling));Qb.prototype.clone.call(this,a);(a instanceof Hf?a:null).setData(this.data,this.stride);return a},endFrame:function(){return this.loop?this.frameCount:this.frameCount-1},initInstance:function(){Qb.prototype.initInstance.call(this);for(var a=this.objects,b=0;b<a.length;){var c=a[b];++b;0!=(c.layout&1<<da.Property._hx_index)&&(c.propCurrentValue=this.data[c.dataOffset]);var d;0!=(c.layout&1<<da.Alpha._hx_index)?null!=c.targetObject?
(d=c.targetObject,d=null==(d instanceof Da?d:null)):d=!0:d=!1;if(d)throw new q(c.objectName+" should be a mesh (for alpha animation)");if(0!=(c.layout&1<<da.Position._hx_index)||0!=(c.layout&1<<da.Rotation._hx_index)||0!=(c.layout&1<<da.Scale._hx_index))c.matrix=new P,c.matrix.identity(),0==(c.layout&1<<da.Position._hx_index)&&null!=c.targetSkin&&(d=c.targetSkin.getSkinData().allJoints[c.targetJoint].defMat,c.matrix._14=d._41,c.matrix._24=d._42,c.matrix._34=d._43)}a.sort(z(this,this.sortByFrameCountDesc))},
sortByFrameCountDesc:function(a,b){return(0!=(b.layout&1<<da.SingleFrame._hx_index)?0:1)-(0!=(a.layout&1<<da.SingleFrame._hx_index)?0:1)},uvLerp:function(a,b,c){a%=1;b%=1;a<b-0.5?++a:a>b+0.5&&--a;return a*(1-c)+b*c},sync:function(a){null==a&&(a=!1);if(this.frame!=this.syncFrame||a){var b=this.frame|0,c=this.endFrame();b==c&&--b;var c=(b+1)%this.frameCount,d=this.frame-b,e=1-d;0>b?b=c=0:this.frame>=this.frameCount?b=c=this.frameCount-1:!this.loop&&0==c&&(c=this.frameCount-1);this.syncFrame=this.frame;
a&&(this.isSync=!1);for(var f=0,g=this.objects;f<g.length;){var h=g[f];++f;if(!(null==h.targetObject&&null==h.targetSkin)){var k=h.layout,l=this.stride*b+h.dataOffset,E=this.stride*c+h.dataOffset;if(0!=(k&1<<da.SingleFrame._hx_index)){if(this.isSync)break;l=E=h.dataOffset}var t=h.matrix;if(null!=t){0!=(k&1<<da.Position._hx_index)?(t._41=this.data[l++]*e+this.data[E++]*d,t._42=this.data[l++]*e+this.data[E++]*d,t._43=this.data[l++]*e+this.data[E++]*d):(t._41=t._14,t._42=t._24,t._43=t._34);if(0!=(k&
1<<da.Rotation._hx_index)){var x=this.data[l++],C=this.data[l++],m=this.data[l++],p=1-(x*x+C*C+m*m),p=Math.sqrt(0>p?-p:p),n=this.data[E++],q=this.data[E++],r=this.data[E++],s=1-(n*n+q*q+r*r),s=Math.sqrt(0>s?-s:s),u=0>x*n+C*q+m*r+p*s?-d:d,x=x*e+n*u,C=C*e+q*u,m=m*e+r*u,p=p*e+s*u,r=1/Math.sqrt(x*x+C*C+m*m+p*p),x=x*r,C=C*r,m=m*r,p=p*r;if(a)t._12=x,t._13=C,t._21=m,t._23=p,0!=(k&1<<da.Scale._hx_index)?(t._11=this.data[l++]*e+this.data[E++]*d,t._22=this.data[l++]*e+this.data[E++]*d,t._33=this.data[l++]*
e+this.data[E++]*d):(t._11=1,t._22=1,t._33=1);else{var r=x*x,s=x*C,u=x*m,x=x*p,q=C*C,n=C*m,C=C*p,A=m*m,m=m*p;t._11=1-2*(q+A);t._12=2*(s+m);t._13=2*(u-C);t._21=2*(s-m);t._22=1-2*(r+A);t._23=2*(n+x);t._31=2*(u+C);t._32=2*(n-x);t._33=1-2*(r+q);0!=(k&1<<da.Scale._hx_index)&&(C=this.data[l++]*e+this.data[E++]*d,m=this.data[l++]*e+this.data[E++]*d,x=this.data[l++]*e+this.data[E++]*d,t._11*=C,t._12*=C,t._13*=C,t._21*=m,t._22*=m,t._23*=m,t._31*=x,t._32*=x,t._33*=x)}}else t._12=0,t._13=0,t._21=0,t._23=a?1:
0,0!=(k&1<<da.Scale._hx_index)?(t._11=this.data[l++]*e+this.data[E++]*d,t._22=this.data[l++]*e+this.data[E++]*d,t._33=this.data[l++]*e+this.data[E++]*d):(t._11=1,t._22=1,t._33=1);null!=h.targetSkin?(h.targetSkin.currentRelPose[h.targetJoint]=t,h.targetSkin.jointsUpdated=!0):(C=h.targetObject,C.defaultTransform=t,C.flags|=1)}0!=(k&1<<da.UV._hx_index)&&(C=h.targetObject.toMesh().material,t=C.passes.getShader(Fc),null==t&&(t=C.passes.addShader(new Fc),C.get_texture().set_wrap(Ef.Repeat)),C=this.data[l++],
m=this.data[E++],C%=1,m%=1,C<m-0.5?++C:C>m+0.5&&--C,t.uvDelta__.x=C*(1-d)+m*d,C=this.data[l++],m=this.data[E++],C%=1,m%=1,C<m-0.5?++C:C>m+0.5&&--C,t.uvDelta__.y=C*(1-d)+m*d);0!=(k&1<<da.Alpha._hx_index)&&(t=h.targetObject.toMesh().material,t.blendMode==ra.None&&t.set_blendMode(ra.Alpha),t.mshader.color__.w=this.data[l++]*e+this.data[E++]*d);0!=(k&1<<da.Property._hx_index)&&(h.propCurrentValue=this.data[l++]*e+this.data[E++]*d)}}a||(this.isSync=!0)}},__class__:Hf});var nj=function(){};r["h3d.anim.LinearFrame"]=
nj;nj.__name__="h3d.anim.LinearFrame";nj.prototype={toMatrix:function(){var a=new P;(new Oe(this.qx,this.qy,this.qz,this.qw)).toMatrix(a);a.prependScale(this.sx,this.sy,this.sz);a.translate(this.tx,this.ty,this.tz);return a},__class__:nj};var Nd=function(a){this.hasPosition=!0;this.objectName=a};r["h3d.anim.LinearObject"]=Nd;Nd.__name__="h3d.anim.LinearObject";Nd.__super__=$e;Nd.prototype=J($e.prototype,{clone:function(){var a=new Nd(this.objectName);a.hasPosition=this.hasPosition;a.hasRotation=this.hasRotation;
a.hasScale=this.hasScale;a.frames=this.frames;a.alphas=this.alphas;a.uvs=this.uvs;a.propName=this.propName;a.propValues=this.propValues;return a},__class__:Nd});var Kg=function(a,b,c){Qb.call(this,a,b,c);this.syncFrame=-1};r["h3d.anim.LinearAnimation"]=Kg;Kg.__name__="h3d.anim.LinearAnimation";Kg.__super__=Qb;Kg.prototype=J(Qb.prototype,{addCurve:function(a,b,c,d,e){a=new Nd(a);a.frames=b;a.hasPosition=c;a.hasRotation=d;a.hasScale=e;this.objects.push(a)},addAlphaCurve:function(a,b){var c=new Nd(a);
c.alphas=b;this.objects.push(c)},addUVCurve:function(a,b){var c=new Nd(a);c.uvs=b;this.objects.push(c)},addPropCurve:function(a,b,c){a=new Nd(a);a.propName=b;a.propValues=c;this.objects.push(a)},getPropValue:function(a,b){for(var c=0,d=this.objects;c<d.length;){var e=d[c];++c;if(e.objectName==a&&e.propName==b)return e.propCurrentValue}return null},getFrames:function(){return this.objects},clone:function(a){null==a&&(a=new Kg(this.name,this.frameCount,this.sampling));Qb.prototype.clone.call(this,a);
return a},endFrame:function(){return this.loop?this.frameCount:this.frameCount-1},initInstance:function(){Qb.prototype.initInstance.call(this);for(var a=this.objects,b=0;b<a.length;){var c=a[b];++b;if(null!=c.propValues)c.propCurrentValue=c.propValues[0];else{var d;null!=c.alphas?null!=c.targetObject?(d=c.targetObject,d=null==(d instanceof Da?d:null)):d=!0:d=!1;if(d)throw new q(c.objectName+" should be a mesh (for alpha animation)");null!=c.uvs||null!=c.alphas||(c.matrix=new P,c.matrix.identity())}}a.sort(z(this,
this.sortByFrameCountDesc))},sortByFrameCountDesc:function(a,b){return(null==b.frames?10:b.frames.length)-(null==a.frames?10:a.frames.length)},uvLerp:function(a,b,c){a%=1;b%=1;a<b-0.5?++a:a>b+0.5&&--a;return a*(1-c)+b*c},sync:function(a){null==a&&(a=!1);if(this.frame!=this.syncFrame||a){var b=this.frame|0,c=this.endFrame();b==c&&--b;var c=(b+1)%this.frameCount,d=this.frame-b,e=1-d;0>b?b=c=0:this.frame>=this.frameCount?b=c=this.frameCount-1:!this.loop&&0==c&&(c=this.frameCount-1);this.syncFrame=this.frame;
a&&(this.isSync=!1);for(var f=0,g=this.objects;f<g.length;){var h=g[f];++f;if(!(null==h.targetObject&&null==h.targetSkin))if(null!=h.alphas){var k=h.targetObject.toMesh().material;k.blendMode==ra.None&&k.set_blendMode(ra.Alpha);k.mshader.color__.w=h.alphas[b]*e+h.alphas[c]*d}else if(null!=h.uvs){var l=h.targetObject.toMesh().material,k=l.passes.getShader(Fc);null==k&&(k=l.passes.addShader(new Fc),l.get_texture().set_wrap(Ef.Repeat));var l=h.uvs[b<<1],m=h.uvs[c<<1],l=l%1,m=m%1;l<m-0.5?++l:l>m+0.5&&
--l;k.uvDelta__.x=l*(1-d)+m*d;l=h.uvs[b<<1|1];h=h.uvs[c<<1|1];l%=1;h%=1;l<h-0.5?++l:l>h+0.5&&--l;k.uvDelta__.y=l*(1-d)+h*d}else if(null!=h.propValues)h.propCurrentValue=h.propValues[b]*e+h.propValues[c]*d;else{k=b;l=c;if(1==h.frames.length){if(this.isSync)break;k=l=0}k=h.frames[k];m=h.frames[l];l=h.matrix;l._41=k.tx*e+m.tx*d;l._42=k.ty*e+m.ty*d;l._43=k.tz*e+m.tz*d;if(h.hasRotation){var t=0>k.qx*m.qx+k.qy*m.qy+k.qz*m.qz+k.qw*m.qw?-d:d,x=k.qx*e+m.qx*t,C=k.qy*e+m.qy*t,p=k.qz*e+m.qz*t,t=k.qw*e+m.qw*t,
n=1/Math.sqrt(x*x+C*C+p*p+t*t),x=x*n,C=C*n,p=p*n,t=t*n;if(a)l._12=x,l._13=C,l._21=p,l._23=t,h.hasScale?(l._11=k.sx*e+m.sx*d,l._22=k.sy*e+m.sy*d,l._33=k.sz*e+m.sz*d):(l._11=1,l._22=1,l._33=1);else{var n=x*x,q=x*C,r=x*p,x=x*t,s=C*C,u=C*p,C=C*t,xc=p*p,p=p*t;l._11=1-2*(s+xc);l._12=2*(q+p);l._13=2*(r-C);l._21=2*(q-p);l._22=1-2*(n+xc);l._23=2*(u+x);l._31=2*(r+C);l._32=2*(u-x);l._33=1-2*(n+s);h.hasScale&&(p=k.sx*e+m.sx*d,t=k.sy*e+m.sy*d,k=k.sz*e+m.sz*d,l._11*=p,l._12*=p,l._13*=p,l._21*=t,l._22*=t,l._23*=
t,l._31*=k,l._32*=k,l._33*=k)}}else l._12=0,l._13=0,l._21=0,l._23=a?1:0,h.hasScale?(l._11=k.sx*e+m.sx*d,l._22=k.sy*e+m.sy*d,l._33=k.sz*e+m.sz*d):(l._11=1,l._22=1,l._33=1);null!=h.targetSkin?(h.targetSkin.currentRelPose[h.targetJoint]=h.matrix,h.targetSkin.jointsUpdated=!0):(k=h.targetObject,k.defaultTransform=h.matrix,k.flags|=1)}}a||(this.isSync=!0)}},__class__:Kg});var oj=function(){this.splitIndex=this.bindIndex=-1;this.subs=[]};r["h3d.anim.Joint"]=oj;oj.__name__="h3d.anim.Joint";oj.prototype=
{__class__:oj};var pj=function(){};r["h3d.anim._Skin.Permut"]=pj;pj.__name__="h3d.anim._Skin.Permut";pj.prototype={__class__:pj};var qj=function(a,b){this.j=a;this.w=b};r["h3d.anim._Skin.Influence"]=qj;qj.__name__="h3d.anim._Skin.Influence";qj.prototype={__class__:qj};var rj=function(a,b,c){this.name=a;this.vertexCount=b;this.bonesPerVertex=c;0<b&&(this.vertexJoints=Array(b*c),this.vertexWeights=Array(b*c),this.envelop=[])};r["h3d.anim.Skin"]=rj;rj.__name__="h3d.anim.Skin";rj.prototype={setJoints:function(a,
b){this.rootJoints=b;this.allJoints=a;this.namedJoints=new ga;for(var c=0;c<a.length;){var d=a[c];++c;if(null!=d.name){var e=d.name,f=this.namedJoints;null!=Q[e]?f.setReserved(e,d):f.h[e]=d}}},addInfluence:function(a,b,c){var d=this.envelop[a];null==d&&(d=this.envelop[a]=[]);d.push(new qj(b,c))},sortInfluences:function(a,b){return b.w>a.w?1:-1},isSplit:function(){return null!=this.splitJoints},initWeights:function(){this.boundJoints=[];for(var a=0,b=0,c=this.vertexCount;b<c;){var d=b++,d=this.envelop[d];
null==d&&(d=[]);ib.sort(d,z(this,this.sortInfluences));d.length>this.bonesPerVertex&&(d=d.slice(0,this.bonesPerVertex));for(var e=0,f=0;f<d.length;){var g=d[f];++f;e+=g.w}e=1/e;f=0;for(g=this.bonesPerVertex;f<g;){var h=f++,h=d[h];null==h?(this.vertexJoints[a]=0,this.vertexWeights[a]=0):(-1==h.j.bindIndex&&(h.j.bindIndex=this.boundJoints.length,this.boundJoints.push(h.j)),this.vertexJoints[a]=h.j.bindIndex,this.vertexWeights[a]=h.w*e);++a}}this.envelop=null},sortByBindIndex:function(a,b){return a.bindIndex-
b.bindIndex},isSub:function(a,b){for(var c=0,d=b.length,e=0;e<a.length;){var f=a[e];for(++e;f!=b[c++];)if(c>=d)return!1}return!0},merge:function(a){for(var b=0;b<a.length;){var c=a[b];++b;for(var d=0;d<a.length;){var e=a[d];++d;if(c!=e&&c.material==e.material&&this.isSub(c.joints,e.joints)){b=0;for(d=c.triangles;b<d.length;){var f=d[b];++b;e.triangles.push(f)}v.remove(a,c);return!0}}}return!1},jointsDiff:function(a,b){for(var c=0,d=0,e=0,f=a.joints.length,g=b.joints.length;d<f&&e<g;){var h=a.joints[d],
k=b.joints[e];h==k?(++d,++e):(++c,h.bindIndex<k.bindIndex?++d:++e)}return c+(f-d)+(g-e)},split:function(a,b,c){if(null!=this.splitJoints)return!0;if(this.boundJoints.length<=a)return!1;this.splitJoints=[];this.triangleGroups=Array(b.length/3|0);for(var d=[],e=0,f=b.length/3|0;e<f;){for(var g=e++,h=3*g,k=null==c?0:c[g],l=[],m=0;3>m;)for(var t=m++,t=b[h+t],x=0,C=this.bonesPerVertex;x<C;){var p=x++,p=t*this.bonesPerVertex+p;0!=this.vertexWeights[p]&&(p=this.boundJoints[this.vertexJoints[p]],p.splitIndex!=
h&&(p.splitIndex=h,l.push(p)))}l.sort(z(this,this.sortByBindIndex));for(h=0;h<d.length;)if(m=d[h],++h,m.material==k&&this.isSub(l,m.joints)){m.triangles.push(g);l=null;break}if(null!=l){for(h=0;h<d.length;)if(m=d[h],++h,m.material==k&&this.isSub(m.joints,l)){m.joints=l;m.triangles.push(g);l=null;break}null!=l&&(h=new pj,h.joints=l,h.triangles=[g],h.material=k,d.push(h))}}for(;;){for(;this.merge(d););e=c=1E5;b=f=null;g=0;for(k=d.length;g<k;)if(h=g++,l=d[h],l.joints.length!=a){h+=1;for(m=d.length;h<
m;)t=h++,t=d[t],t.joints.length==a||l.material!=t.material||(x=this.jointsDiff(l,t),C=x+(l.joints.length+t.joints.length-x>>1),C>a||(C>e||C==e&&x>c)||(c=x,e=C,f=l,b=t))}if(null==f)break;c=f;e=0;for(f=c.joints;e<f.length;)g=f[e],++e,v.remove(b.joints,g),b.joints.push(g);b.joints.sort(z(this,this.sortByBindIndex));e=0;for(f=c.triangles;e<f.length;)g=f[e],++e,b.triangles.push(g);v.remove(d,c)}b=0;for(c=d.length;b<c;){e=b++;f=0;for(g=d[e].triangles;f<g.length;)k=g[f],++f,this.triangleGroups[k]=e}b=[];
c=0;for(e=this.boundJoints;c<e.length;){f=e[c];++c;g=[];for(k=0;k<d.length;)l=d[k],++k,0<=l.joints.indexOf(f)&&g.push(l);b.push({j:f,pl:g})}b.sort(function(a,b){return b.pl.length-a.pl.length});for(c=0;c<d.length;)e=d[c],++c,e.indexedJoints=[];for(c=0;c<b.length;){e=b[c];++c;e.j.splitIndex=-1;g=0;for(k=a;g<k;){f=g++;l=!0;h=0;for(m=e.pl;h<m.length;)if(t=m[h],++h,null!=t.indexedJoints[f]){l=!1;break}if(l){e.j.splitIndex=f;g=0;for(k=e.pl;g<k.length;)l=k[g],++g,l.indexedJoints[f]=e.j;break}}if(0>e.j.splitIndex)throw new q("Failed to assign index while spliting skin");
}this.splitJoints=[];for(a=0;a<d.length;){b=d[a];++a;c=[];e=0;for(f=b.indexedJoints.length;e<f;)g=e++,g=b.indexedJoints[g],null==g&&(g=this.boundJoints[0]),c.push(g);this.splitJoints.push({material:b.material,joints:c})}d=0;for(a=this.vertexJoints.length;d<a;)b=d++,this.vertexJoints[b]=this.boundJoints[this.vertexJoints[b]].splitIndex;return!0},__class__:rj};var cc=function(){};r["h3d.col.Collider"]=cc;cc.__name__="h3d.col.Collider";cc.__isInterface__=!0;cc.__interfaces__=[bc];cc.prototype={__class__:cc};
var Hb=function(){this.xMin=1E20;this.xMax=-1E20;this.yMin=1E20;this.yMax=-1E20;this.zMin=1E20;this.zMax=-1E20};r["h3d.col.Bounds"]=Hb;Hb.__name__="h3d.col.Bounds";Hb.__interfaces__=[cc];Hb.fromPoints=function(a,b){var c=new Hb;c.xMin=a.x;c.yMin=a.y;c.zMin=a.z;c.xMax=b.x;c.yMax=b.y;c.zMax=b.z;return c};Hb.fromValues=function(a,b,c,d,e,f){var g=new Hb;g.xMin=a;g.yMin=b;g.zMin=c;g.xMax=a+d;g.yMax=b+e;g.zMax=c+f;return g};Hb.prototype={inFrustum:function(a,b){if(null!=b)throw new q("Not implemented");
return a.hasBounds(this)},inSphere:function(a){var b=a.x,c=a.y,d=a.z;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);var e=this.xMin,f=a.x,g=this.xMax,f=f>g?g:f,e=e<f?f:e,f=this.yMin,g=a.y,h=this.yMax,g=g>h?h:g,f=f<g?g:f,g=this.zMin,h=a.z,k=this.zMax,h=h>k?k:h,g=g<h?h:g;null==g&&(g=0);null==f&&(f=0);null==e&&(e=0);b=e-b;c=f-c;d=g-d;return b*b+c*c+d*d<a.r*a.r},testPlane:function(a){var b=a.nx,c=a.ny,d=a.nz,e=b*(this.xMax+this.xMin)+c*(this.yMax+this.yMin)+d*(this.zMax+this.zMin);0>b&&(b=-b);0>c&&(c=-c);
0>d&&(d=-d);return e+(b*(this.xMax-this.xMin)+c*(this.yMax-this.yMin)+d*(this.zMax-this.zMin))-2*a.d},rayIntersection:function(a,b){var c=(this.xMin-a.px)/a.lx,d=(this.yMin-a.py)/a.ly,e=(this.zMin-a.pz)/a.lz,f=(this.xMax-a.px)/a.lx,g=(this.yMax-a.py)/a.ly,h=(this.zMax-a.pz)/a.lz,k=c>f?f:c,l=d>g?g:d,m=e>h?h:e,c=c<f?f:c,d=d<g?g:d,e=e<h?h:e,h=c>d?d:c,k=k<l?l:k,m=k<m?m:k;return(h>e?e:h)<m?-1:m},inFrustumDetails:function(a,b){null==b&&(b=!0);var c=1,d=a._14+a._11,e=a._24+a._21,f=a._34+a._31,g=a._44+a._41;
if(0>d*(0<d?this.xMax:this.xMin)+e*(0<e?this.yMax:this.yMin)+f*(0<f?this.zMax:this.zMin)+g)return-1;if(0>d*(0<d?this.xMin:this.xMax)+e*(0<e?this.yMin:this.yMax)+f*(0<f?this.zMin:this.zMax)+g)c=0;d=a._14-a._11;e=a._24-a._21;f=a._34-a._31;g=a._44-a._41;if(0>d*(0<d?this.xMax:this.xMin)+e*(0<e?this.yMax:this.yMin)+f*(0<f?this.zMax:this.zMin)+g)return-1;if(0>d*(0<d?this.xMin:this.xMax)+e*(0<e?this.yMin:this.yMax)+f*(0<f?this.zMin:this.zMax)+g)c=0;d=a._14+a._12;e=a._24+a._22;f=a._34+a._32;g=a._44+a._42;
if(0>d*(0<d?this.xMax:this.xMin)+e*(0<e?this.yMax:this.yMin)+f*(0<f?this.zMax:this.zMin)+g)return-1;if(0>d*(0<d?this.xMin:this.xMax)+e*(0<e?this.yMin:this.yMax)+f*(0<f?this.zMin:this.zMax)+g)c=0;d=a._14-a._12;e=a._24-a._22;f=a._34-a._32;g=a._44-a._42;if(0>d*(0<d?this.xMax:this.xMin)+e*(0<e?this.yMax:this.yMin)+f*(0<f?this.zMax:this.zMin)+g)return-1;if(0>d*(0<d?this.xMin:this.xMax)+e*(0<e?this.yMin:this.yMax)+f*(0<f?this.zMin:this.zMax)+g)c=0;if(b){d=a._13;e=a._23;f=a._33;g=a._43;if(0>d*(0<d?this.xMax:
this.xMin)+e*(0<e?this.yMax:this.yMin)+f*(0<f?this.zMax:this.zMin)+g)return-1;if(0>d*(0<d?this.xMin:this.xMax)+e*(0<e?this.yMin:this.yMax)+f*(0<f?this.zMin:this.zMax)+g)c=0;d=a._14-a._13;e=a._24-a._23;f=a._34-a._33;g=a._44-a._43;if(0>d*(0<d?this.xMax:this.xMin)+e*(0<e?this.yMax:this.yMin)+f*(0<f?this.zMax:this.zMin)+g)return-1;if(0>d*(0<d?this.xMin:this.xMax)+e*(0<e?this.yMin:this.yMax)+f*(0<f?this.zMin:this.zMax)+g)c=0}return c},transform3x3:function(a){var b=this.xMin,c=this.yMin,d=this.zMin,e=
this.xMax,f=this.yMax,g=this.zMax;this.xMin=1E20;this.xMax=-1E20;this.yMin=1E20;this.yMax=-1E20;this.zMin=1E20;this.zMax=-1E20;var h=0,k=0,l=0,h=b,k=c,l=d,m=h*a._12+k*a._22+l*a._32,t=h*a._13+k*a._23+l*a._33,h=h*a._11+k*a._21+l*a._31,k=m,l=t;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=b;k=c;l=g;m=h*a._12+k*a._22+l*a._32;t=h*a._13+k*a._23+l*a._33;h=h*a._11+k*a._21+l*a._31;k=m;l=t;
h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=b;k=f;l=d;m=h*a._12+k*a._22+l*a._32;t=h*a._13+k*a._23+l*a._33;h=h*a._11+k*a._21+l*a._31;k=m;l=t;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=b;k=f;l=g;b=h*a._12+k*a._22+l*a._32;m=h*a._13+k*a._23+l*a._33;h=h*a._11+k*a._21+
l*a._31;k=b;l=m;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=e;k=c;l=d;b=h*a._12+k*a._22+l*a._32;m=h*a._13+k*a._23+l*a._33;h=h*a._11+k*a._21+l*a._31;k=b;l=m;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=e;k=c;l=g;c=h*a._12+k*a._22+l*a._32;b=h*a._13+k*a._23+l*a._33;
h=h*a._11+k*a._21+l*a._31;k=c;l=b;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=e;k=f;l=d;d=h*a._12+k*a._22+l*a._32;c=h*a._13+k*a._23+l*a._33;h=h*a._11+k*a._21+l*a._31;k=d;l=c;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=e;k=f;l=g;e=h*a._12+k*a._22+l*a._32;f=h*a._13+
k*a._23+l*a._33;h=h*a._11+k*a._21+l*a._31;k=e;l=f;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l)},transform:function(a){var b=this.xMin,c=this.yMin,d=this.zMin,e=this.xMax,f=this.yMax,g=this.zMax;this.xMin=1E20;this.xMax=-1E20;this.yMin=1E20;this.yMax=-1E20;this.zMin=1E20;this.zMax=-1E20;if(!(e<b&&f<c&&g<d)){var h=0,k=0,l=0,h=b,k=c,l=d,m=h*a._12+k*a._22+l*a._32+a._42,t=h*a._13+k*a._23+
l*a._33+a._43,h=h*a._11+k*a._21+l*a._31+a._41,k=m,l=t;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=b;k=c;l=g;m=h*a._12+k*a._22+l*a._32+a._42;t=h*a._13+k*a._23+l*a._33+a._43;h=h*a._11+k*a._21+l*a._31+a._41;k=m;l=t;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=b;k=f;
l=d;m=h*a._12+k*a._22+l*a._32+a._42;t=h*a._13+k*a._23+l*a._33+a._43;h=h*a._11+k*a._21+l*a._31+a._41;k=m;l=t;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=b;k=f;l=g;b=h*a._12+k*a._22+l*a._32+a._42;m=h*a._13+k*a._23+l*a._33+a._43;h=h*a._11+k*a._21+l*a._31+a._41;k=b;l=m;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&
(this.zMin=l);l>this.zMax&&(this.zMax=l);h=e;k=c;l=d;b=h*a._12+k*a._22+l*a._32+a._42;m=h*a._13+k*a._23+l*a._33+a._43;h=h*a._11+k*a._21+l*a._31+a._41;k=b;l=m;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=e;k=c;l=g;c=h*a._12+k*a._22+l*a._32+a._42;b=h*a._13+k*a._23+l*a._33+a._43;h=h*a._11+k*a._21+l*a._31+a._41;k=c;l=b;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&
(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=e;k=f;l=d;d=h*a._12+k*a._22+l*a._32+a._42;c=h*a._13+k*a._23+l*a._33+a._43;h=h*a._11+k*a._21+l*a._31+a._41;k=d;l=c;h<this.xMin&&(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l);h=e;k=f;l=g;e=h*a._12+k*a._22+l*a._32+a._42;f=h*a._13+k*a._23+l*a._33+a._43;h=h*a._11+k*a._21+l*a._31+a._41;k=e;l=f;h<this.xMin&&
(this.xMin=h);h>this.xMax&&(this.xMax=h);k<this.yMin&&(this.yMin=k);k>this.yMax&&(this.yMax=k);l<this.zMin&&(this.zMin=l);l>this.zMax&&(this.zMax=l)}},collide:function(a){return!(this.xMin>a.xMax||this.yMin>a.yMax||this.zMin>a.zMax||this.xMax<a.xMin||this.yMax<a.yMin||this.zMax<a.zMin)},contains:function(a){return a.x>=this.xMin&&a.x<this.xMax&&a.y>=this.yMin&&a.y<this.yMax&&a.z>=this.zMin?a.z<this.zMax:!1},add:function(a){a.xMin<this.xMin&&(this.xMin=a.xMin);a.xMax>this.xMax&&(this.xMax=a.xMax);
a.yMin<this.yMin&&(this.yMin=a.yMin);a.yMax>this.yMax&&(this.yMax=a.yMax);a.zMin<this.zMin&&(this.zMin=a.zMin);a.zMax>this.zMax&&(this.zMax=a.zMax)},addPoint:function(a){a.x<this.xMin&&(this.xMin=a.x);a.x>this.xMax&&(this.xMax=a.x);a.y<this.yMin&&(this.yMin=a.y);a.y>this.yMax&&(this.yMax=a.y);a.z<this.zMin&&(this.zMin=a.z);a.z>this.zMax&&(this.zMax=a.z)},addPos:function(a,b,c){a<this.xMin&&(this.xMin=a);a>this.xMax&&(this.xMax=a);b<this.yMin&&(this.yMin=b);b>this.yMax&&(this.yMax=b);c<this.zMin&&
(this.zMin=c);c>this.zMax&&(this.zMax=c)},intersection:function(a,b){var c=a.xMin,d=b.xMin,e=a.yMin,f=b.yMin,g=a.zMin,h=b.zMin,k=a.xMax,l=b.xMax,m=a.yMax,t=b.yMax,x=a.zMax,C=b.zMax;this.xMin=c<d?d:c;this.xMax=k>l?l:k;this.yMin=e<f?f:e;this.yMax=m>t?t:m;this.zMin=g<h?h:g;this.zMax=x>C?C:x},offset:function(a,b,c){this.xMin+=a;this.xMax+=a;this.yMin+=b;this.yMax+=b;this.zMin+=c;this.zMax+=c},setMin:function(a){this.xMin=a.x;this.yMin=a.y;this.zMin=a.z},setMax:function(a){this.xMax=a.x;this.yMax=a.y;
this.zMax=a.z},load:function(a){this.xMin=a.xMin;this.xMax=a.xMax;this.yMin=a.yMin;this.yMax=a.yMax;this.zMin=a.zMin;this.zMax=a.zMax},scalePivot:function(a){this.xMin*=a;this.yMin*=a;this.zMin*=a;this.xMax*=a;this.yMax*=a;this.zMax*=a},scaleCenter:function(a){var b=0.5*(this.xMax-this.xMin)*a,c=0.5*(this.yMax-this.yMin)*a;a*=0.5*(this.zMax-this.zMin);var d=0.5*(this.xMax+this.xMin),e=0.5*(this.yMax+this.yMin),f=0.5*(this.zMax+this.zMin);this.xMin=d-b;this.yMin=e-c;this.zMin=f-a;this.xMax=d+b;this.yMax=
e+c;this.zMax=f+a},getMin:function(){return new wa(this.xMin,this.yMin,this.zMin)},getCenter:function(){return new wa(0.5*(this.xMin+this.xMax),0.5*(this.yMin+this.yMax),0.5*(this.zMin+this.zMax))},getSize:function(){return new wa(this.xMax-this.xMin,this.yMax-this.yMin,this.zMax-this.zMin)},getMax:function(){return new wa(this.xMax,this.yMax,this.zMax)},get_xSize:function(){return this.xMax-this.xMin},get_ySize:function(){return this.yMax-this.yMin},get_zSize:function(){return this.zMax-this.zMin},
set_xSize:function(a){this.xMax=this.xMin+a;return a},set_ySize:function(a){this.yMax=this.yMin+a;return a},set_zSize:function(a){this.zMax=this.zMin+a;return a},isEmpty:function(){return this.xMax<this.xMin||this.yMax<this.yMin?!0:this.zMax<this.zMin},empty:function(){this.xMin=1E20;this.xMax=-1E20;this.yMin=1E20;this.yMax=-1E20;this.zMin=1E20;this.zMax=-1E20},all:function(){this.xMin=-1E20;this.xMax=1E20;this.yMin=-1E20;this.yMax=1E20;this.zMin=-1E20;this.zMax=1E20},clone:function(){var a=new Hb;
a.xMin=this.xMin;a.xMax=this.xMax;a.yMin=this.yMin;a.yMax=this.yMax;a.zMin=this.zMin;a.zMax=this.zMax;return a},toString:function(){return"Bounds{"+n.string(new wa(this.xMin,this.yMin,this.zMin))+","+n.string(new wa(this.xMax-this.xMin,this.yMax-this.yMin,this.zMax-this.zMin))+"}"},toSphere:function(){var a=this.xMax-this.xMin,b=this.yMax-this.yMin,c=this.zMax-this.zMin;return new If(0.5*(this.xMin+this.xMax),0.5*(this.yMin+this.yMax),0.5*(this.zMin+this.zMax),0.5*Math.sqrt(a*a+b*b+c*c))},__class__:Hb};
var Lg=function(a,b){this.a=a;this.b=b};r["h3d.col.OptimizedCollider"]=Lg;Lg.__name__="h3d.col.OptimizedCollider";Lg.__interfaces__=[cc,bc];Lg.prototype={rayIntersection:function(a,b){return 0>this.a.rayIntersection(a,b)?-1:this.b.rayIntersection(a,b)},contains:function(a){return this.a.contains(a)?this.b.contains(a):!1},inFrustum:function(a,b){return this.a.inFrustum(a,b)?this.b.inFrustum(a,b):!1},inSphere:function(a){return this.a.inSphere(a)?this.b.inSphere(a):!1},__class__:Lg};var Mg=function(a){this.colliders=
a};r["h3d.col.GroupCollider"]=Mg;Mg.__name__="h3d.col.GroupCollider";Mg.__interfaces__=[cc];Mg.prototype={rayIntersection:function(a,b){for(var c=-1,d=0,e=this.colliders;d<e.length;){var f=e[d];++d;f=f.rayIntersection(a,b);if(0<=f){if(!b)return f;if(0>c||f<c)c=f}}return c},contains:function(a){for(var b=0,c=this.colliders;b<c.length;){var d=c[b];++b;if(d.contains(a))return!0}return!1},inFrustum:function(a,b){for(var c=0,d=this.colliders;c<d.length;){var e=d[c];++c;if(e.inFrustum(a,b))return!0}return!1},
inSphere:function(a){for(var b=0,c=this.colliders;b<c.length;){var d=c[b];++b;if(d.inSphere(a))return!0}return!1},__class__:Mg};var Ng=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c};r["h3d.col.FPoint"]=Ng;Ng.__name__="h3d.col.FPoint";Ng.prototype={sub:function(a){return new Ng(this.x-a.x,this.y-a.y,this.z-a.z)},add:function(a){return new Ng(this.x+a.x,this.y+a.y,this.z+a.z)},cross:function(a){return new Ng(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*
a.y-this.y*a.x)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},toString:function(){return"FPoint{"+L.fmt(this.x)+","+L.fmt(this.y)+","+L.fmt(this.z)+"}"},__class__:Ng};var Kh=function(a){this.checkNearFar=!0;this.pleft=new pa(1,0,0,0);this.pright=new pa(1,0,0,0);this.ptop=new pa(1,0,0,0);this.pbottom=new pa(1,0,0,0);this.pnear=new pa(1,0,0,0);this.pfar=new pa(1,0,0,0);null!=a&&this.loadMatrix(a)};r["h3d.col.Frustum"]=Kh;Kh.__name__="h3d.col.Frustum";Kh.prototype={clone:function(){var a=
new Kh,b=a.pleft,c=this.pleft;b.nx=c.nx;b.ny=c.ny;b.nz=c.nz;b.d=c.d;b=a.pright;c=this.pright;b.nx=c.nx;b.ny=c.ny;b.nz=c.nz;b.d=c.d;b=a.ptop;c=this.ptop;b.nx=c.nx;b.ny=c.ny;b.nz=c.nz;b.d=c.d;b=a.pbottom;c=this.pbottom;b.nx=c.nx;b.ny=c.ny;b.nz=c.nz;b.d=c.d;b=a.pnear;c=this.pnear;b.nx=c.nx;b.ny=c.ny;b.nz=c.nz;b.d=c.d;b=a.pfar;c=this.pfar;b.nx=c.nx;b.ny=c.ny;b.nz=c.nz;b.d=c.d;a.checkNearFar=this.checkNearFar;return a},loadMatrix:function(a){var b=this.pleft,c=a._24+a._21,d=a._34+a._31,e=-(a._44+a._41);
b.nx=a._14+a._11;b.ny=c;b.nz=d;b.d=e;b=this.pright;c=a._24-a._21;d=a._34-a._31;e=a._41-a._44;b.nx=a._14-a._11;b.ny=c;b.nz=d;b.d=e;b=this.ptop;c=a._24-a._22;d=a._34-a._32;e=a._42-a._44;b.nx=a._14-a._12;b.ny=c;b.nz=d;b.d=e;b=this.pbottom;c=a._24+a._22;d=a._34+a._32;e=-(a._44+a._42);b.nx=a._14+a._12;b.ny=c;b.nz=d;b.d=e;b=this.pnear;c=a._23;d=a._33;e=-a._43;b.nx=a._13;b.ny=c;b.nz=d;b.d=e;b=this.pfar;c=a._24-a._23;d=a._34-a._33;e=a._43-a._44;b.nx=a._14-a._13;b.ny=c;b.nz=d;b.d=e;a=this.pleft;b=1/Math.sqrt(a.nx*
a.nx+a.ny*a.ny+a.nz*a.nz);a.nx*=b;a.ny*=b;a.nz*=b;a.d*=b;a=this.pright;b=1/Math.sqrt(a.nx*a.nx+a.ny*a.ny+a.nz*a.nz);a.nx*=b;a.ny*=b;a.nz*=b;a.d*=b;a=this.ptop;b=1/Math.sqrt(a.nx*a.nx+a.ny*a.ny+a.nz*a.nz);a.nx*=b;a.ny*=b;a.nz*=b;a.d*=b;a=this.pbottom;b=1/Math.sqrt(a.nx*a.nx+a.ny*a.ny+a.nz*a.nz);a.nx*=b;a.ny*=b;a.nz*=b;a.d*=b;a=this.pnear;b=1/Math.sqrt(a.nx*a.nx+a.ny*a.ny+a.nz*a.nz);a.nx*=b;a.ny*=b;a.nz*=b;a.d*=b;a=this.pfar;b=1/Math.sqrt(a.nx*a.nx+a.ny*a.ny+a.nz*a.nz);a.nx*=b;a.ny*=b;a.nz*=b;a.d*=
b},transform:function(a){var b=new P;b.initInverse(a);b.transpose();a=this.pleft;var c=a.nx,d=a.ny,e=a.nz,f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);var g=c*b._12+d*b._22+e*b._32+f*b._42,h=c*b._13+d*b._23+e*b._33+f*b._43,k=c*b._14+d*b._24+e*b._34+f*b._44,c=c*b._11+d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;a=this.pright;c=a.nx;d=a.ny;e=a.nz;f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);g=c*b._12+d*b._22+e*b._32+f*b._42;h=c*b._13+d*b._23+e*b._33+
f*b._43;k=c*b._14+d*b._24+e*b._34+f*b._44;c=c*b._11+d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;a=this.ptop;c=a.nx;d=a.ny;e=a.nz;f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);g=c*b._12+d*b._22+e*b._32+f*b._42;h=c*b._13+d*b._23+e*b._33+f*b._43;k=c*b._14+d*b._24+e*b._34+f*b._44;c=c*b._11+d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;a=this.pbottom;c=a.nx;d=a.ny;e=a.nz;f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);g=c*b._12+d*b._22+e*b._32+f*b._42;
h=c*b._13+d*b._23+e*b._33+f*b._43;k=c*b._14+d*b._24+e*b._34+f*b._44;c=c*b._11+d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;a=this.pfar;c=a.nx;d=a.ny;e=a.nz;f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);g=c*b._12+d*b._22+e*b._32+f*b._42;h=c*b._13+d*b._23+e*b._33+f*b._43;k=c*b._14+d*b._24+e*b._34+f*b._44;c=c*b._11+d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;a=this.pnear;c=a.nx;d=a.ny;e=a.nz;f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);g=c*b._12+
d*b._22+e*b._32+f*b._42;h=c*b._13+d*b._23+e*b._33+f*b._43;k=c*b._14+d*b._24+e*b._34+f*b._44;c=c*b._11+d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;b=this.pleft;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=a;b.d*=a;b=this.pright;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=a;b.d*=a;b=this.ptop;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=a;b.d*=a;b=this.pbottom;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=
a;b.d*=a;b=this.pnear;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=a;b.d*=a;b=this.pfar;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=a;b.d*=a},transform3x3:function(a){var b=new P;b.initInverse3x3(a);b.transpose();a=this.pleft;var c=a.nx,d=a.ny,e=a.nz,f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);var g=c*b._12+d*b._22+e*b._32+f*b._42,h=c*b._13+d*b._23+e*b._33+f*b._43,k=c*b._14+d*b._24+e*b._34+f*b._44,c=c*b._11+d*b._21+e*b._31+f*b._41;
a.nx=c;a.ny=g;a.nz=h;a.d=-k;a=this.pright;c=a.nx;d=a.ny;e=a.nz;f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);g=c*b._12+d*b._22+e*b._32+f*b._42;h=c*b._13+d*b._23+e*b._33+f*b._43;k=c*b._14+d*b._24+e*b._34+f*b._44;c=c*b._11+d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;a=this.ptop;c=a.nx;d=a.ny;e=a.nz;f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);g=c*b._12+d*b._22+e*b._32+f*b._42;h=c*b._13+d*b._23+e*b._33+f*b._43;k=c*b._14+d*b._24+e*b._34+f*b._44;c=c*b._11+
d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;a=this.pbottom;c=a.nx;d=a.ny;e=a.nz;f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);g=c*b._12+d*b._22+e*b._32+f*b._42;h=c*b._13+d*b._23+e*b._33+f*b._43;k=c*b._14+d*b._24+e*b._34+f*b._44;c=c*b._11+d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;a=this.pfar;c=a.nx;d=a.ny;e=a.nz;f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);g=c*b._12+d*b._22+e*b._32+f*b._42;h=c*b._13+d*b._23+e*b._33+f*b._43;k=c*b._14+d*b._24+
e*b._34+f*b._44;c=c*b._11+d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;a=this.pnear;c=a.nx;d=a.ny;e=a.nz;f=-a.d;null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);g=c*b._12+d*b._22+e*b._32+f*b._42;h=c*b._13+d*b._23+e*b._33+f*b._43;k=c*b._14+d*b._24+e*b._34+f*b._44;c=c*b._11+d*b._21+e*b._31+f*b._41;a.nx=c;a.ny=g;a.nz=h;a.d=-k;b=this.pleft;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=a;b.d*=a;b=this.pright;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=
a;b.nz*=a;b.d*=a;b=this.ptop;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=a;b.d*=a;b=this.pbottom;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=a;b.d*=a;b=this.pnear;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=a;b.d*=a;b=this.pfar;a=1/Math.sqrt(b.nx*b.nx+b.ny*b.ny+b.nz*b.nz);b.nx*=a;b.ny*=a;b.nz*=a;b.d*=a},hasPoint:function(a){var b=this.pleft;if(0>b.nx*a.x+b.ny*a.y+b.nz*a.z-b.d)return!1;b=this.pright;if(0>b.nx*a.x+b.ny*a.y+b.nz*a.z-
b.d)return!1;b=this.ptop;if(0>b.nx*a.x+b.ny*a.y+b.nz*a.z-b.d)return!1;b=this.pbottom;if(0>b.nx*a.x+b.ny*a.y+b.nz*a.z-b.d)return!1;if(this.checkNearFar){b=this.pnear;if(0>b.nx*a.x+b.ny*a.y+b.nz*a.z-b.d)return!1;b=this.pfar;if(0>b.nx*a.x+b.ny*a.y+b.nz*a.z-b.d)return!1}return!0},hasSphere:function(a){var b=a.x,c=a.y,d=a.z;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);var e=this.pleft;if(e.nx*b+e.ny*c+e.nz*d-e.d<-a.r)return!1;e=this.pright;if(e.nx*b+e.ny*c+e.nz*d-e.d<-a.r)return!1;e=this.ptop;if(e.nx*
b+e.ny*c+e.nz*d-e.d<-a.r)return!1;e=this.pbottom;if(e.nx*b+e.ny*c+e.nz*d-e.d<-a.r)return!1;if(this.checkNearFar){e=this.pnear;if(e.nx*b+e.ny*c+e.nz*d-e.d<-a.r)return!1;e=this.pfar;if(e.nx*b+e.ny*c+e.nz*d-e.d<-a.r)return!1}return!0},hasBounds:function(a){var b=this.pleft,c=b.nx,d=b.ny,e=b.nz,f=c*(a.xMax+a.xMin)+d*(a.yMax+a.yMin)+e*(a.zMax+a.zMin);0>c&&(c=-c);0>d&&(d=-d);0>e&&(e=-e);if(0>f+(c*(a.xMax-a.xMin)+d*(a.yMax-a.yMin)+e*(a.zMax-a.zMin))-2*b.d)return!1;b=this.pright;c=b.nx;d=b.ny;e=b.nz;f=c*
(a.xMax+a.xMin)+d*(a.yMax+a.yMin)+e*(a.zMax+a.zMin);0>c&&(c=-c);0>d&&(d=-d);0>e&&(e=-e);if(0>f+(c*(a.xMax-a.xMin)+d*(a.yMax-a.yMin)+e*(a.zMax-a.zMin))-2*b.d)return!1;b=this.ptop;c=b.nx;d=b.ny;e=b.nz;f=c*(a.xMax+a.xMin)+d*(a.yMax+a.yMin)+e*(a.zMax+a.zMin);0>c&&(c=-c);0>d&&(d=-d);0>e&&(e=-e);if(0>f+(c*(a.xMax-a.xMin)+d*(a.yMax-a.yMin)+e*(a.zMax-a.zMin))-2*b.d)return!1;b=this.ptop;c=b.nx;d=b.ny;e=b.nz;f=c*(a.xMax+a.xMin)+d*(a.yMax+a.yMin)+e*(a.zMax+a.zMin);0>c&&(c=-c);0>d&&(d=-d);0>e&&(e=-e);if(0>f+
(c*(a.xMax-a.xMin)+d*(a.yMax-a.yMin)+e*(a.zMax-a.zMin))-2*b.d)return!1;b=this.pnear;c=b.nx;d=b.ny;e=b.nz;f=c*(a.xMax+a.xMin)+d*(a.yMax+a.yMin)+e*(a.zMax+a.zMin);0>c&&(c=-c);0>d&&(d=-d);0>e&&(e=-e);if(0>f+(c*(a.xMax-a.xMin)+d*(a.yMax-a.yMin)+e*(a.zMax-a.zMin))-2*b.d)return!1;b=this.pfar;c=b.nx;d=b.ny;e=b.nz;f=c*(a.xMax+a.xMin)+d*(a.yMax+a.yMin)+e*(a.zMax+a.zMin);0>c&&(c=-c);0>d&&(d=-d);0>e&&(e=-e);return 0>f+(c*(a.xMax-a.xMin)+d*(a.yMax-a.yMin)+e*(a.zMax-a.zMin))-2*b.d?!1:!0},__class__:Kh};var ld=
function(){};r["h3d.col.Ray"]=ld;ld.__name__="h3d.col.Ray";ld.fromPoints=function(a,b){var c=new ld;c.px=a.x;c.py=a.y;c.pz=a.z;c.lx=b.x-a.x;c.ly=b.y-a.y;c.lz=b.z-a.z;c.normalize();return c};ld.fromValues=function(a,b,c,d,e,f){var g=new ld;g.px=a;g.py=b;g.pz=c;g.lx=d;g.ly=e;g.lz=f;g.normalize();return g};ld.prototype={clone:function(){var a=new ld;a.px=this.px;a.py=this.py;a.pz=this.pz;a.lx=this.lx;a.ly=this.ly;a.lz=this.lz;return a},load:function(a){this.px=a.px;this.py=a.py;this.pz=a.pz;this.lx=
a.lx;this.ly=a.ly;this.lz=a.lz},normalize:function(){var a=this.lx*this.lx+this.ly*this.ly+this.lz*this.lz;1!=a&&(a=1E-10>a?0:1/Math.sqrt(a),this.lx*=a,this.ly*=a,this.lz*=a)},transform:function(a){var b=this.px,c=this.py,d=this.pz;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);var e=b*a._12+c*a._22+d*a._32+1*a._42,f=b*a._13+c*a._23+d*a._33+1*a._43;this.px=b=b*a._11+c*a._21+d*a._31+1*a._41;this.py=e;this.pz=f;b=this.lx;c=this.ly;d=this.lz;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);e=b*a._12+c*a._22+
d*a._32;f=b*a._13+c*a._23+d*a._33;this.lx=b=b*a._11+c*a._21+d*a._31;this.ly=e;this.lz=f;this.normalize()},getPos:function(){return new wa(this.px,this.py,this.pz)},getDir:function(){return new wa(this.lx,this.ly,this.lz)},getPoint:function(a){return new wa(this.px+a*this.lx,this.py+a*this.ly,this.pz+a*this.lz)},toString:function(){return"Ray{"+n.string(new wa(this.px,this.py,this.pz))+","+n.string(new wa(this.lx,this.ly,this.lz))+"}"},intersect:function(a){var b=this.lx*a.nx+this.ly*a.ny+this.lz*
a.nz;a=a.d-(this.px*a.nx+this.py*a.ny+this.pz*a.nz);if(1E-10>(0>b?-b:b))return 1E-10>(0>a?-a:a)?new wa(this.px,this.py,this.pz):null;b=a/b;return new wa(this.px+this.lx*b,this.py+this.ly*b,this.pz+this.lz*b)},collideFrustum:function(a){var b=this.px,c=this.py,d=this.pz;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);var e=b*a._12+c*a._22+d*a._32+1*a._42,f=b*a._13+c*a._23+d*a._33+1*a._43,g=1/(b*a._14+c*a._24+d*a._34+1*a._44),b=(b*a._11+c*a._21+d*a._31+1*a._41)*g,c=e*g,d=f*g,e=this.px+this.lx,g=this.py+
this.ly,f=this.pz+this.lz;null==f&&(f=0);null==g&&(g=0);null==e&&(e=0);var h=g,k=f,l=e*a._12+h*a._22+k*a._32+1*a._42,f=e*a._13+h*a._23+k*a._33+1*a._43,g=1/(e*a._14+h*a._24+k*a._34+1*a._44),e=(e*a._11+h*a._21+k*a._31+1*a._41)*g,e=1/(e-b),h=1/(l*g-c),g=1/(f*g-d);a=(-1-b)*e;e*=1-b;b=(-1-c)*h;f=(1-c)*h;c=(0-d)*g;d=(1-d)*g;g=a>e?e:a;h=b>f?f:b;g=g<h?h:g;h=c>d?d:c;a=a<e?e:a;b=b<f?f:b;b=a>b?b:a;d=c<d?d:c;d=b>d?d:b;return!(0>d||(g<h?h:g)>d)},collide:function(a){var b=1/this.lx,c=1/this.ly,d=1/this.lz,e=(a.xMin-
this.px)*b,f=(a.xMax-this.px)*b,b=(a.yMin-this.py)*c,g=(a.yMax-this.py)*c,c=(a.zMin-this.pz)*d;a=(a.zMax-this.pz)*d;var d=e>f?f:e,h=b>g?g:b,d=d<h?h:d,h=c>a?a:c,e=e<f?f:e,b=b<g?g:b,e=e>b?b:e,c=c<a?a:c,c=e>c?c:e;return 0>c?!1:(d<h?h:d)>c?!1:!0},__class__:ld};var fd=function(a,b){this.obj=a;this.collider=b};r["h3d.col.ObjectCollider"]=fd;fd.__name__="h3d.col.ObjectCollider";fd.__interfaces__=[bc,cc];fd.prototype={rayIntersection:function(a,b){var c=fd.TMP_RAY;fd.TMP_RAY=null;c.px=a.px;c.py=a.py;c.pz=
a.pz;c.lx=a.lx;c.ly=a.ly;c.lz=a.lz;var d=this.obj.getInvPos(),e=a.px,f=a.py,g=a.pz;null==g&&(g=0);null==f&&(f=0);null==e&&(e=0);var h=e*d._12+f*d._22+g*d._32+1*d._42,k=e*d._13+f*d._23+g*d._33+1*d._43,e=e*d._11+f*d._21+g*d._31+1*d._41;a.px=e;a.py=h;a.pz=k;e=a.lx;f=a.ly;g=a.lz;null==g&&(g=0);null==f&&(f=0);null==e&&(e=0);h=e*d._12+f*d._22+g*d._32;k=e*d._13+f*d._23+g*d._33;e=e*d._11+f*d._21+g*d._31;a.lx=e;a.ly=h;a.lz=k;a.normalize();f=this.collider.rayIntersection(a,b);if(0>f)return a.px=c.px,a.py=c.py,
a.pz=c.pz,a.lx=c.lx,a.ly=c.ly,a.lz=c.lz,fd.TMP_RAY=c,f;d=a.px+f*a.lx;e=a.py+f*a.ly;g=a.pz+f*a.lz;null==g&&(g=0);null==e&&(e=0);null==d&&(d=0);f=e;h=g;k=this.obj.absPos;g=d*k._12+f*k._22+h*k._32+k._42;e=d*k._13+f*k._23+h*k._33+k._43;d=d*k._11+f*k._21+h*k._31+k._41;a.px=c.px;a.py=c.py;a.pz=c.pz;a.lx=c.lx;a.ly=c.ly;a.lz=c.lz;fd.TMP_RAY=c;c=d-a.px;d=g-a.py;e-=a.pz;null==e&&(e=0);null==e&&(e=0);return Math.sqrt(c*c+d*d+e*e)},contains:function(a){var b=a.x,c=a.y,d=a.z;null==d&&(d=0);null==c&&(c=0);null==
b&&(b=0);var e=this.obj.getInvPos(),f=a.x*e._12+a.y*e._22+a.z*e._32+e._42,g=a.x*e._13+a.y*e._23+a.z*e._33+e._43;a.x=a.x*e._11+a.y*e._21+a.z*e._31+e._41;a.y=f;a.z=g;e=this.collider.contains(a);a.x=b;a.y=c;a.z=d;return e},inFrustum:function(a,b){if(null==b)return this.collider.inFrustum(a,this.obj.getAbsPos());var c=fd.TMP_MAT,d=this.obj.getAbsPos(),e=b._11,f=b._12,g=b._13,h=b._21,k=b._22,l=b._23,m=b._31,t=b._32,x=b._33,C=b._41,p=b._42,n=b._43,q=d._11,r=d._12,s=d._13,u=d._21,xc=d._22,A=d._23,y=d._31,
w=d._32,v=d._33,B=d._41,F=d._42,d=d._43;c._11=e*q+f*u+g*y;c._12=e*r+f*xc+g*w;c._13=e*s+f*A+g*v;c._14=0;c._21=h*q+k*u+l*y;c._22=h*r+k*xc+l*w;c._23=h*s+k*A+l*v;c._24=0;c._31=m*q+t*u+x*y;c._32=m*r+t*xc+x*w;c._33=m*s+t*A+x*v;c._34=0;c._41=C*q+p*u+n*y+B;c._42=C*r+p*xc+n*w+F;c._43=C*s+p*A+n*v+d;c._44=1;return this.collider.inFrustum(a,c)},inSphere:function(a){var b=this.obj.getInvPos(),c=a.x,d=a.y,e=a.z,f=a.r,g=a.x,h=a.y,k=a.z;null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);var l=g*b._12+h*b._22+k*b._32+b._42,
m=g*b._13+h*b._23+k*b._33+b._43,g=g*b._11+h*b._21+k*b._31+b._41,h=l,k=m,l=null;null==l&&(l=new B);l.x=Math.sqrt(b._11*b._11+b._12*b._12+b._13*b._13);l.y=Math.sqrt(b._21*b._21+b._22*b._22+b._23*b._23);l.z=Math.sqrt(b._31*b._31+b._32*b._32+b._33*b._33);0>b._11*(b._22*b._33-b._23*b._32)+b._12*(b._23*b._31-b._21*b._33)+b._13*(b._21*b._32-b._22*b._31)&&(l.x*=-1,l.y*=-1,l.z*=-1);b=l;a.x=g;a.y=h;a.z=k;a.r*=Math.max(Math.max(b.x,b.y),b.z);b=this.collider.inSphere(a);a.x=c;a.y=d;a.z=e;a.r=f;return b},__class__:fd};
var pa=function(a,b,c,d){this.nx=a;this.ny=b;this.nz=c;this.d=d};r["h3d.col.Plane"]=pa;pa.__name__="h3d.col.Plane";pa.fromPoints=function(a,b,c){var d=b.x-a.x,e=b.y-a.y;b=b.z-a.z;null==b&&(b=0);null==e&&(e=0);null==d&&(d=0);var f=c.x-a.x,g=c.y-a.y,h=c.z-a.z;null==h&&(h=0);null==g&&(g=0);null==f&&(f=0);c=f;f=h;h=e*f-b*g;b=b*c-d*f;d=d*g-e*c;null==d&&(d=0);null==b&&(b=0);null==h&&(h=0);e=h;return new pa(e,b,d,e*a.x+b*a.y+d*a.z)};pa.fromNormalPoint=function(a,b){return new pa(a.x,a.y,a.z,a.x*b.x+a.y*
b.y+a.z*b.z)};pa.X=function(a){null==a&&(a=0);return new pa(1,0,0,a)};pa.Y=function(a){null==a&&(a=0);return new pa(0,1,0,a)};pa.Z=function(a){null==a&&(a=0);return new pa(0,0,1,a)};pa.frustumLeft=function(a){return new pa(a._14+a._11,a._24+a._21,a._34+a._31,-(a._44+a._41))};pa.frustumRight=function(a){return new pa(a._14-a._11,a._24-a._21,a._34-a._31,a._41-a._44)};pa.frustumBottom=function(a){return new pa(a._14+a._12,a._24+a._22,a._34+a._32,-(a._44+a._42))};pa.frustumTop=function(a){return new pa(a._14-
a._12,a._24-a._22,a._34-a._32,a._42-a._44)};pa.frustumNear=function(a){return new pa(a._13,a._23,a._33,-a._43)};pa.frustumFar=function(a){return new pa(a._14-a._13,a._24-a._23,a._34-a._33,a._43-a._44)};pa.prototype={getNormal:function(){return new wa(this.nx,this.ny,this.nz)},getNormalDistance:function(){return this.d},load:function(a){this.nx=a.nx;this.ny=a.ny;this.nz=a.nz;this.d=a.d},transform:function(a){var b=new P;b.initInverse(a);b.transpose();a=this.nx;var c=this.ny,d=this.nz,e=-this.d;null==
e&&(e=1);null==d&&(d=0);null==c&&(c=0);null==a&&(a=0);var f=a*b._12+c*b._22+d*b._32+e*b._42,g=a*b._13+c*b._23+d*b._33+e*b._43,h=a*b._14+c*b._24+d*b._34+e*b._44;this.nx=a=a*b._11+c*b._21+d*b._31+e*b._41;this.ny=f;this.nz=g;this.d=-h},transform3x3:function(a){var b=new P;b.initInverse3x3(a);b.transpose();a=this.nx;var c=this.ny,d=this.nz,e=-this.d;null==e&&(e=1);null==d&&(d=0);null==c&&(c=0);null==a&&(a=0);var f=a*b._12+c*b._22+d*b._32+e*b._42,g=a*b._13+c*b._23+d*b._33+e*b._43,h=a*b._14+c*b._24+d*b._34+
e*b._44;this.nx=a=a*b._11+c*b._21+d*b._31+e*b._41;this.ny=f;this.nz=g;this.d=-h},transformInverseTranspose:function(a){var b=this.nx,c=this.ny,d=this.nz,e=-this.d;null==e&&(e=1);null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);var f=b*a._12+c*a._22+d*a._32+e*a._42,g=b*a._13+c*a._23+d*a._33+e*a._43,h=b*a._14+c*a._24+d*a._34+e*a._44;this.nx=b=b*a._11+c*a._21+d*a._31+e*a._41;this.ny=f;this.nz=g;this.d=-h},normalize:function(){var a=1/Math.sqrt(this.nx*this.nx+this.ny*this.ny+this.nz*this.nz);this.nx*=a;
this.ny*=a;this.nz*=a;this.d*=a},toString:function(){return"Plane{"+n.string(new wa(this.nx,this.ny,this.nz))+","+L.fmt(this.d)+"}"},distance:function(a){return this.nx*a.x+this.ny*a.y+this.nz*a.z-this.d},side:function(a){return 0<=this.nx*a.x+this.ny*a.y+this.nz*a.z-this.d},project:function(a){var b=this.nx*a.x+this.ny*a.y+this.nz*a.z-this.d;return new wa(a.x-b*this.nx,a.y-b*this.ny,a.z-b*this.nz)},projectTo:function(a,b){var c=this.nx*a.x+this.ny*a.y+this.nz*a.z-this.d;b.x=a.x-c*this.nx;b.y=a.y-
c*this.ny;b.z=a.z-c*this.nz},__class__:pa};var wa=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c};r["h3d.col.Point"]=wa;wa.__name__="h3d.col.Point";wa.prototype={scale:function(a){this.x*=a;this.y*=a;this.z*=a},inFrustum:function(a,b){return a.hasPoint(this)},set:function(a,b,c){this.x=a;this.y=b;this.z=c},multiply:function(a){return new wa(this.x*a,this.y*a,this.z*a)},sub:function(a){return new wa(this.x-a.x,this.y-a.y,this.z-a.z)},add:function(a){return new wa(this.x+
a.x,this.y+a.y,this.z+a.z)},cross:function(a){return new wa(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*a.y-this.y*a.x)},equals:function(a){return this.x==a.x&&this.y==a.y?this.z==a.z:!1},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},setLength:function(a){var b=this.x*this.x+this.y*this.y+this.z*this.z,b=1/Math.sqrt(b);this.x*=b;this.y*=b;this.z*=b;this.x*=a;this.y*=a;this.z*=a},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},dot:function(a){return this.x*
a.x+this.y*a.y+this.z*a.z},distanceSq:function(a){var b=a.x-this.x,c=a.y-this.y;a=a.z-this.z;return b*b+c*c+a*a},distance:function(a){var b=a.x-this.x,c=a.y-this.y;a=a.z-this.z;return Math.sqrt(b*b+c*c+a*a)},normalize:function(){var a=this.x*this.x+this.y*this.y+this.z*this.z,a=1E-10>a?0:1/Math.sqrt(a);this.x*=a;this.y*=a;this.z*=a;return this},normalizeFast:function(){var a=this.x*this.x+this.y*this.y+this.z*this.z,a=1/Math.sqrt(a);this.x*=a;this.y*=a;this.z*=a;return this},lerp:function(a,b,c){var d=
a.x,e=a.y,e=e+c*(b.y-e);a=a.z;a+=c*(b.z-a);this.x=d+c*(b.x-d);this.y=e;this.z=a},transform:function(a){var b=this.x*a._12+this.y*a._22+this.z*a._32+a._42,c=this.x*a._13+this.y*a._23+this.z*a._33+a._43;this.x=this.x*a._11+this.y*a._21+this.z*a._31+a._41;this.y=b;this.z=c},transform3x3:function(a){var b=this.x*a._12+this.y*a._22+this.z*a._32,c=this.x*a._13+this.y*a._23+this.z*a._33;this.x=this.x*a._11+this.y*a._21+this.z*a._31;this.y=b;this.z=c},toVector:function(){return new B(this.x,this.y,this.z)},
clone:function(){return new wa(this.x,this.y,this.z)},load:function(a){this.x=a.x;this.y=a.y;this.z=a.z},toString:function(){return"Point{"+L.fmt(this.x)+","+L.fmt(this.y)+","+L.fmt(this.z)+"}"},__class__:wa};var pe=function(){this.next=null};r["h3d.col.TriPlane"]=pe;pe.__name__="h3d.col.TriPlane";pe.__interfaces__=[cc];pe.prototype={init:function(a,b,c){this.p0x=a.x;this.p0y=a.y;this.p0z=a.z;var d=b.x-a.x,e=b.y-a.y;b=b.z-a.z;null==b&&(b=0);null==e&&(e=0);null==d&&(d=0);var f=c.x-a.x,g=c.y-a.y,h=
c.z-a.z;null==h&&(h=0);null==g&&(g=0);null==f&&(f=0);c=f;var k=e*h-b*g,l=b*c-d*h,f=d*g-e*c;null==f&&(f=0);null==l&&(l=0);null==k&&(k=0);this.d=k*a.x+l*a.y+f*a.z;this.nx=k;this.ny=l;this.nz=f;this.d1x=d;this.d1y=e;this.d1z=b;this.d2x=c;this.d2y=g;this.d2z=h;this.dot00=d*d+e*e+b*b;this.dot01=d*c+e*g+b*h;this.dot11=c*c+g*g+h*h;this.invDenom=1/(this.dot00*this.dot11-this.dot01*this.dot01)},clone:function(){var a=new pe;a.p0x=this.p0x;a.p0y=this.p0y;a.p0z=this.p0z;a.d1x=this.d1x;a.d1y=this.d1y;a.d1z=this.d1z;
a.d2x=this.d2x;a.d2y=this.d2y;a.d2z=this.d2z;a.dot00=this.dot00;a.dot01=this.dot01;a.dot11=this.dot11;a.invDenom=this.invDenom;a.nx=this.nx;a.ny=this.ny;a.nz=this.nz;a.d=this.d;null!=this.next&&(a.next=this.next.clone());return a},load:function(a){this.p0x=a.p0x;this.p0y=a.p0y;this.p0z=a.p0z;this.d1x=a.d1x;this.d1y=a.d1y;this.d1z=a.d1z;this.d2x=a.d2x;this.d2y=a.d2y;this.d2z=a.d2z;this.dot00=a.dot00;this.dot01=a.dot01;this.dot11=a.dot11;this.invDenom=a.invDenom;this.nx=a.nx;this.ny=a.ny;this.nz=a.nz;
this.d=a.d},transform:function(a){var b=this.p0x,c=this.p0y,d=this.p0z;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);var e=this.d1x+this.p0x,f=this.d1y+this.p0y,g=this.d1z+this.p0z;null==g&&(g=0);null==f&&(f=0);null==e&&(e=0);var h=g,g=this.d2x+this.p0x,k=this.d2y+this.p0y,l=this.d2z+this.p0z;null==l&&(l=0);null==k&&(k=0);null==g&&(g=0);var m=l,l=b*a._12+c*a._22+d*a._32+a._42,t=b*a._13+c*a._23+d*a._33+a._43,b=b*a._11+c*a._21+d*a._31+a._41,c=l,d=t,x=e*a._12+f*a._22+h*a._32+a._42,t=e*a._13+f*a._23+h*
a._33+a._43,e=e*a._11+f*a._21+h*a._31+a._41,l=g*a._12+k*a._22+m*a._32+a._42,h=g*a._13+k*a._23+m*a._33+a._43,g=g*a._11+k*a._21+m*a._31+a._41;this.p0x=b;this.p0y=c;this.p0z=d;a=e-b;e=x-c;f=t-d;null==f&&(f=0);null==e&&(e=0);null==a&&(a=0);g-=b;l-=c;k=h-d;null==k&&(k=0);null==l&&(l=0);null==g&&(g=0);h=l;l=k;m=e*l-f*h;t=f*g-a*l;k=a*h-e*g;null==k&&(k=0);null==t&&(t=0);null==m&&(m=0);this.d=m*b+t*c+k*d;this.nx=m;this.ny=t;this.nz=k;this.d1x=a;this.d1y=e;this.d1z=f;this.d2x=g;this.d2y=h;this.d2z=l;this.dot00=
a*a+e*e+f*f;this.dot01=a*g+e*h+f*l;this.dot11=g*g+h*h+l*l;this.invDenom=1/(this.dot00*this.dot11-this.dot01*this.dot01)},contains:function(a){var b=a.x-this.p0x,c=a.y-this.p0y;a=a.z-this.p0z;null==a&&(a=0);null==c&&(c=0);null==b&&(b=0);var d=c,c=this.d1x*b+this.d1y*d+this.d1z*a;a=this.d2x*b+this.d2y*d+this.d2z*a;b=(this.dot11*c-this.dot01*a)*this.invDenom;c=(this.dot00*a-this.dot01*c)*this.invDenom;return 0<=b&&0<=c?1>b+c:!1},side:function(a){return 0<=this.nx*a.x+this.ny*a.y+this.nz*a.z-this.d},
inFrustum:function(a,b){throw new q("Not implemented");},inSphere:function(a){throw new q("Not implemented");},rayIntersection:function(a,b){var c=a.lx*this.nx+a.ly*this.ny+a.lz*this.nz;if(0<=c)return-1;c=(this.d-(a.px*this.nx+a.py*this.ny+a.pz*this.nz))/c;if(0>c)return-1;var d=a.px+a.lx*c-this.p0x,e=a.py+a.ly*c-this.p0y,f=a.pz+a.lz*c-this.p0z;null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);var g=f,f=this.d1x*d+this.d1y*e+this.d1z*g,e=this.d2x*d+this.d2y*e+this.d2z*g,d=(this.dot11*f-this.dot01*e)*this.invDenom,
f=(this.dot00*e-this.dot01*f)*this.invDenom;return!(0<=d&&0<=f&&1>d+f)?-1:c},isPointInTriangle:function(a,b,c){a-=this.p0x;b-=this.p0y;var d=c-this.p0z;null==d&&(d=0);null==b&&(b=0);null==a&&(a=0);c=a;a=this.d1x*c+this.d1y*b+this.d1z*d;b=this.d2x*c+this.d2y*b+this.d2z*d;c=(this.dot11*a-this.dot01*b)*this.invDenom;a=(this.dot00*b-this.dot01*a)*this.invDenom;return 0<=c&&0<=a?1>c+a:!1},getPoints:function(){return[new wa(this.p0x,this.p0y,this.p0z),new wa(this.d1x+this.p0x,this.d1y+this.p0y,this.d1z+
this.p0z),new wa(this.d2x+this.p0x,this.d2y+this.p0y,this.d2z+this.p0z)]},__class__:pe};var Og=function(){};r["h3d.col.Polygon"]=Og;Og.__name__="h3d.col.Polygon";Og.__interfaces__=[cc];Og.prototype={addBuffers:function(a,b,c){null==c&&(c=3);for(var d=0,e=b.length/3|0;d<e;){var f=3*d++,g=new pe,h=b[f]*c,k=b[f+1]*c,l=b[f+2]*c,m=a[h],f=a[h+1],t=a[h+2];null==t&&(t=0);null==f&&(f=0);null==m&&(m=0);var h=m,x=a[k],m=a[k+1],C=a[k+2];null==C&&(C=0);null==m&&(m=0);null==x&&(x=0);var k=x,p=C,C=a[l],x=a[l+1],
l=a[l+2];null==l&&(l=0);null==x&&(x=0);null==C&&(C=0);var n=l;g.p0x=h;g.p0y=f;g.p0z=t;l=k-h;k=m-f;m=p-t;null==m&&(m=0);null==k&&(k=0);null==l&&(l=0);C-=h;x-=f;n-=t;null==n&&(n=0);null==x&&(x=0);null==C&&(C=0);var q=k*n-m*x,r=m*C-l*n,p=l*x-k*C;null==p&&(p=0);null==r&&(r=0);null==q&&(q=0);g.d=q*h+r*f+p*t;g.nx=q;g.ny=r;g.nz=p;g.d1x=l;g.d1y=k;g.d1z=m;g.d2x=C;g.d2y=x;g.d2z=n;g.dot00=l*l+k*k+m*m;g.dot01=l*C+k*x+m*n;g.dot11=C*C+x*x+n*n;g.invDenom=1/(g.dot00*g.dot11-g.dot01*g.dot01);g.next=this.triPlanes;
this.triPlanes=g}},isConvex:function(){return!0},clone:function(){var a=new Og;a.triPlanes=new pe;var b=this.triPlanes,c=new pe;c.p0x=b.p0x;c.p0y=b.p0y;c.p0z=b.p0z;c.d1x=b.d1x;c.d1y=b.d1y;c.d1z=b.d1z;c.d2x=b.d2x;c.d2y=b.d2y;c.d2z=b.d2z;c.dot00=b.dot00;c.dot01=b.dot01;c.dot11=b.dot11;c.invDenom=b.invDenom;c.nx=b.nx;c.ny=b.ny;c.nz=b.nz;c.d=b.d;if(null!=b.next){var b=b.next,d=new pe;d.p0x=b.p0x;d.p0y=b.p0y;d.p0z=b.p0z;d.d1x=b.d1x;d.d1y=b.d1y;d.d1z=b.d1z;d.d2x=b.d2x;d.d2y=b.d2y;d.d2z=b.d2z;d.dot00=b.dot00;
d.dot01=b.dot01;d.dot11=b.dot11;d.invDenom=b.invDenom;d.nx=b.nx;d.ny=b.ny;d.nz=b.nz;d.d=b.d;null!=b.next&&(d.next=b.next.clone());c.next=d}a.triPlanes=c;return a},transform:function(a){for(var b=this.triPlanes;null!=b;)b.transform(a),b=b.next},getPoints:function(){for(var a=[],b=this.triPlanes;null!=b;)a=a.concat(b.getPoints()),b=b.next;return a},getBounds:function(a){null==a&&(a=new Hb);a.xMin=1E20;a.xMax=-1E20;a.yMin=1E20;a.yMax=-1E20;a.zMin=1E20;a.zMax=-1E20;for(var b=this.triPlanes;null!=b;){var c=
b.p0x,d=b.p0y,e=b.p0z;c<a.xMin&&(a.xMin=c);c>a.xMax&&(a.xMax=c);d<a.yMin&&(a.yMin=d);d>a.yMax&&(a.yMax=d);e<a.zMin&&(a.zMin=e);e>a.zMax&&(a.zMax=e);c=b.d1x+b.p0x;d=b.d1y+b.p0y;e=b.d1z+b.p0z;c<a.xMin&&(a.xMin=c);c>a.xMax&&(a.xMax=c);d<a.yMin&&(a.yMin=d);d>a.yMax&&(a.yMax=d);e<a.zMin&&(a.zMin=e);e>a.zMax&&(a.zMax=e);c=b.d2x+b.p0x;d=b.d2y+b.p0y;e=b.d2z+b.p0z;c<a.xMin&&(a.xMin=c);c>a.xMax&&(a.xMax=c);d<a.yMin&&(a.yMin=d);d>a.yMax&&(a.yMax=d);e<a.zMin&&(a.zMin=e);e>a.zMax&&(a.zMax=e);b=b.next}return a},
contains:function(a){if(!this.isConvex())throw new q("Not implemented for concave polygon");for(var b=this.triPlanes;null!=b;){if(0<=b.nx*a.x+b.ny*a.y+b.nz*a.z-b.d)return!1;b=b.next}return!0},rayIntersection:function(a,b){for(var c=this.triPlanes,d=-1;null!=c;){var e=a.lx*c.nx+a.ly*c.ny+a.lz*c.nz;if(0<=e)e=-1;else if(e=(c.d-(a.px*c.nx+a.py*c.ny+a.pz*c.nz))/e,0>e)e=-1;else{var f=a.px+a.lx*e-c.p0x,g=a.py+a.ly*e-c.p0y,h=a.pz+a.lz*e-c.p0z;null==h&&(h=0);null==g&&(g=0);null==f&&(f=0);var k=h,h=c.d1x*f+
c.d1y*g+c.d1z*k,g=c.d2x*f+c.d2y*g+c.d2z*k,f=(c.dot11*h-c.dot01*g)*c.invDenom,h=(c.dot00*g-c.dot01*h)*c.invDenom,e=!(0<=f&&0<=h&&1>f+h)?-1:e}if(0<=e){if(!b)return e;if(0>d||e<d)d=e}c=c.next}return d},inFrustum:function(a,b){throw new q("Not implemented");},inSphere:function(a){throw new q("Not implemented");},__class__:Og};var Jf=function(){};r["h3d.col.PolygonBuffer"]=Jf;Jf.__name__="h3d.col.PolygonBuffer";Jf.__interfaces__=[cc];Jf.prototype={setData:function(a,b,c,d){null==d&&(d=-1);null==c&&(c=
0);this.buffer=a;this.indexes=b;this.startIndex=c;this.triCount=0<=d?d:(b.length-c)/3|0},contains:function(a){var b=this.startIndex,c=a.x,d=a.y;a=a.z;null==a&&(a=0);null==d&&(d=0);null==c&&(c=0);for(var e=0,f=this.triCount;e<f;){e++;var g=3*this.indexes[b++],h=this.buffer[g++],k=this.buffer[g++],g=this.buffer[g];null==g&&(g=0);null==k&&(k=0);null==h&&(h=0);var l=3*this.indexes[b++],m=this.buffer[l++],t=this.buffer[l++],l=this.buffer[l];null==l&&(l=0);null==t&&(t=0);null==m&&(m=0);var x=l,C=3*this.indexes[b++],
l=this.buffer[C++],p=this.buffer[C++],C=this.buffer[C];null==C&&(C=0);null==p&&(p=0);null==l&&(l=0);m-=h;t-=k;x-=g;null==x&&(x=0);null==t&&(t=0);null==m&&(m=0);l-=h;p-=k;C-=g;null==C&&(C=0);null==p&&(p=0);null==l&&(l=0);var n=C,C=t*n-x*p,x=x*l-m*n,m=m*p-t*l;null==m&&(m=0);null==x&&(x=0);null==C&&(C=0);t=C;l=x;if(t*c+l*d+m*a>=t*h+l*k+m*g)return!1}return!0},inFrustum:function(a,b){throw new q("Not implemented");},inSphere:function(a){throw new q("Not implemented");},rayIntersection:function(a,b){var c=
this.startIndex,d=a.lx,e=a.ly,f=a.lz;null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);var g=a.px,h=a.py,k=a.pz;null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);for(var l=-1,m=0,t=this.triCount;m<t;){m++;var x=3*this.indexes[c++],C=this.buffer[x++],p=this.buffer[x++],x=this.buffer[x];null==x&&(x=0);null==p&&(p=0);null==C&&(C=0);var n=3*this.indexes[c++],q=this.buffer[n++],r=this.buffer[n++],n=this.buffer[n];null==n&&(n=0);null==r&&(r=0);null==q&&(q=0);var s=n,u=3*this.indexes[c++],n=this.buffer[u++],xc=this.buffer[u++],
u=this.buffer[u];null==u&&(u=0);null==xc&&(xc=0);null==n&&(n=0);q-=C;r-=p;s-=x;null==s&&(s=0);null==r&&(r=0);null==q&&(q=0);n-=C;xc-=p;u-=x;null==u&&(u=0);null==xc&&(xc=0);null==n&&(n=0);var A=e*u-f*xc,y=f*n-d*u,w=d*xc-e*n;null==w&&(w=0);null==y&&(y=0);null==A&&(A=0);var v=w,w=q*A+r*y+s*v;if(!(1E-10>w)){var w=1/w,C=g-C,p=h-p,B=k-x;null==B&&(B=0);null==p&&(p=0);null==C&&(C=0);x=p;p=(C*A+x*y+B*v)*w;if(!(0>p||1<p))if(A=x*s-B*r,s=B*q-C*s,x=C*r-x*q,null==x&&(x=0),null==s&&(s=0),null==A&&(A=0),C=A,q=s,
r=(d*C+e*q+f*x)*w,!(0>r||1<p+r))if(C=(n*C+xc*q+u*x)*w,!(1E-10>C)){if(!b)return C;if(0>l||C<l)l=C}}}return l},__class__:Jf};var Mh=function(a,b){this.obj=a;this.col=b;var c=this.transform=new Jf,d=b.buffer,e=Array(d.length);Dk.blit(d,0,e,0,d.length);c.setData(e,b.indexes,b.startIndex,b.triCount)};r["h3d.col.SkinCollider"]=Mh;Mh.__name__="h3d.col.SkinCollider";Mh.__interfaces__=[cc,bc];Mh.prototype={contains:function(a){this.applyTransform();return this.transform.contains(a)},inFrustum:function(a,b){if(null!=
b)throw new q("Not implemented");this.applyTransform();return this.transform.inFrustum(a)},inSphere:function(a){throw new q("Not implemented");},rayIntersection:function(a,b){this.applyTransform();return this.transform.rayIntersection(a,b)},applyTransform:function(){if(this.obj.jointsUpdated||this.lastFrame!=this.obj.lastFrame){this.lastFrame=this.obj.lastFrame;this.obj.syncJoints();for(var a=0,b=0,c=this.obj.skinData.bonesPerVertex,d=0,e=this.obj.skinData.vertexCount;d<e;){d++;var f=0,g=0,h=0,k=
this.col.buffer[b],l=this.col.buffer[b+1],m=this.col.buffer[b+2];null==m&&(m=0);null==l&&(l=0);null==k&&(k=0);for(var t=0,x=c;t<x;){t++;var p=this.obj.skinData.vertexWeights[a];if(0==p)++a;else{var n=this.obj.skinData.vertexJoints[a++],q=k,r=l,s=m;null==s&&(s=0);null==r&&(r=0);null==q&&(q=0);var n=this.obj.currentPalette[n],u=q*n._12+r*n._22+s*n._32+n._42,H=q*n._13+r*n._23+s*n._33+n._43,q=q*n._11+r*n._21+s*n._31+n._41,r=u,s=H,f=f+q*p,g=g+r*p,h=h+s*p}}this.transform.buffer[b++]=f;this.transform.buffer[b++]=
g;this.transform.buffer[b++]=h}}},__class__:Mh};var If=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.r=d};r["h3d.col.Sphere"]=If;If.__name__="h3d.col.Sphere";If.__interfaces__=[cc];If.prototype={load:function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.r=d},getCenter:function(){return new wa(this.x,this.y,this.z)},contains:function(a){var b=
a.x-this.x,c=a.y-this.y;a=a.z-this.z;return b*b+c*c+a*a<this.r*this.r},rayIntersection:function(a,b){var c=a.px+a.lx,d=a.py+a.ly,e=a.pz+a.lz,f=a.lx*a.lx+a.ly*a.ly+a.lz*a.lz,g=2*a.lx*(this.x-c)+2*a.ly*(this.y-d)+2*a.lz*(this.z-e),c=g*g-4*f*(this.x*this.x+this.y*this.y+this.z*this.z+(c*c+d*d+e*e)-2*(this.x*c+this.y*d+this.z*e)-this.r*this.r);if(0>c)return-1;c=Math.sqrt(c);return 1-(-g+c)/(2*f)},inFrustum:function(a,b){return null!=b?this.inFrustumMatrix(a,b):a.hasSphere(this)},inFrustumMatrix:function(a,
b){var c=this.x,d=this.y,e=this.z,f=this.r,g=this.x,h=this.y,k=this.z;null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);var l=g*b._12+h*b._22+k*b._32+b._42,m=g*b._13+h*b._23+k*b._33+b._43;this.x=g=g*b._11+h*b._21+k*b._31+b._41;this.y=l;this.z=m;g=null;null==g&&(g=new B);g.x=Math.sqrt(b._11*b._11+b._12*b._12+b._13*b._13);g.y=Math.sqrt(b._21*b._21+b._22*b._22+b._23*b._23);g.z=Math.sqrt(b._31*b._31+b._32*b._32+b._33*b._33);0>b._11*(b._22*b._33-b._23*b._32)+b._12*(b._23*b._31-b._21*b._33)+b._13*(b._21*b._32-
b._22*b._31)&&(g.x*=-1,g.y*=-1,g.z*=-1);this.r*=Math.max(Math.max(g.x,g.y),g.z);g=a.hasSphere(this);this.x=c;this.y=d;this.z=e;this.r=f;return g},inSphere:function(a){var b=this.x,c=this.y,d=this.z;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);var e=a.x,f=a.y,g=a.z;null==g&&(g=0);null==f&&(f=0);null==e&&(e=0);b=e-b;c=f-c;d=g-d;return b*b+c*c+d*d<(a.r+this.r)*(a.r+this.r)},toString:function(){return"Sphere{"+n.string(new wa(this.x,this.y,this.z))+","+L.fmt(this.r)+"}"},__class__:If};var Ja=K["h3d.impl.Feature"]=
{__ename__:!0,__constructs__:"StandardDerivatives FloatTextures AllocDepthBuffer HardwareAccelerated MultipleRenderTargets Queries SRGBTextures ShaderModel3 BottomLeftCoords Wireframe InstancedRendering".split(" "),StandardDerivatives:{_hx_index:0,__enum__:"h3d.impl.Feature",toString:m},FloatTextures:{_hx_index:1,__enum__:"h3d.impl.Feature",toString:m},AllocDepthBuffer:{_hx_index:2,__enum__:"h3d.impl.Feature",toString:m},HardwareAccelerated:{_hx_index:3,__enum__:"h3d.impl.Feature",toString:m},MultipleRenderTargets:{_hx_index:4,
__enum__:"h3d.impl.Feature",toString:m},Queries:{_hx_index:5,__enum__:"h3d.impl.Feature",toString:m},SRGBTextures:{_hx_index:6,__enum__:"h3d.impl.Feature",toString:m},ShaderModel3:{_hx_index:7,__enum__:"h3d.impl.Feature",toString:m},BottomLeftCoords:{_hx_index:8,__enum__:"h3d.impl.Feature",toString:m},Wireframe:{_hx_index:9,__enum__:"h3d.impl.Feature",toString:m},InstancedRendering:{_hx_index:10,__enum__:"h3d.impl.Feature",toString:m}};Ja.__empty_constructs__=[Ja.StandardDerivatives,Ja.FloatTextures,
Ja.AllocDepthBuffer,Ja.HardwareAccelerated,Ja.MultipleRenderTargets,Ja.Queries,Ja.SRGBTextures,Ja.ShaderModel3,Ja.BottomLeftCoords,Ja.Wireframe,Ja.InstancedRendering];var Tk=K["h3d.impl.QueryKind"]={__ename__:!0,__constructs__:["TimeStamp","Samples"],TimeStamp:{_hx_index:0,__enum__:"h3d.impl.QueryKind",toString:m},Samples:{_hx_index:1,__enum__:"h3d.impl.QueryKind",toString:m}};Tk.__empty_constructs__=[Tk.TimeStamp,Tk.Samples];var Ek=K["h3d.impl.RenderFlag"]={__ename__:!0,__constructs__:["CameraHandness"],
CameraHandness:{_hx_index:0,__enum__:"h3d.impl.RenderFlag",toString:m}};Ek.__empty_constructs__=[Ek.CameraHandness];var ic=function(a){this.id=ic.UID++;this.names=a};r["h3d.impl.InputNames"]=ic;ic.__name__="h3d.impl.InputNames";ic.get=function(a){var b=a.join("|"),c=ic.CACHE,c=null!=Q[b]?c.getReserved(b):c.h[b];null==c&&(c=new ic(a.slice()),a=ic.CACHE,null!=Q[b]?a.setReserved(b,c):a.h[b]=c);return c};ic.prototype={__class__:ic};var Nh=function(){};r["h3d.impl.Driver"]=Nh;Nh.__name__="h3d.impl.Driver";
Nh.prototype={hasFeature:function(a){return!1},setRenderFlag:function(a,b){},isSupportedFormat:function(a){return!1},isDisposed:function(){return!0},dispose:function(){},begin:function(a){},log:function(a){},generateMipMaps:function(a){throw new q("Mipmaps auto generation is not supported on this platform");},getNativeShaderCode:function(a){return null},logImpl:function(a){},clear:function(a,b,c){},captureRenderBuffer:function(a){},capturePixels:function(a,b,c,d){throw new q("Can't capture pixels on this platform");
},getDriverName:function(a){return"Not available"},init:function(a,b){},resize:function(a,b){},selectShader:function(a){return!1},selectMaterial:function(a){},uploadShaderBuffers:function(a,b){},getShaderInputNames:function(){return null},selectBuffer:function(a){},selectMultiBuffers:function(a){},draw:function(a,b,c){},drawInstanced:function(a,b){},setRenderZone:function(a,b,c,d){},setRenderTarget:function(a,b,c){},setRenderTargets:function(a){},allocDepthBuffer:function(a){return null},disposeDepthBuffer:function(a){},
getDefaultDepthBuffer:function(){return null},present:function(){},end:function(){},setDebug:function(a){},allocTexture:function(a){return null},allocIndexes:function(a,b){return null},allocVertexes:function(a){return null},allocInstanceBuffer:function(a,b){},disposeTexture:function(a){},disposeIndexes:function(a){},disposeVertexes:function(a){},disposeInstanceBuffer:function(a){},uploadIndexBuffer:function(a,b,c,d,e){},uploadIndexBytes:function(a,b,c,d,e){},uploadVertexBuffer:function(a,b,c,d,e){},
uploadVertexBytes:function(a,b,c,d,e){},uploadTextureBitmap:function(a,b,c,d){},uploadTexturePixels:function(a,b,c,d){},readVertexBytes:function(a,b,c,d,e){throw new q("Driver does not allow to read vertex bytes");},readIndexBytes:function(a,b,c,d,e){throw new q("Driver does not allow to read index bytes");},copyTexture:function(a,b){return!1},allocQuery:function(a){return null},deleteQuery:function(a){},beginQuery:function(a){},endQuery:function(a){},queryResultAvailable:function(a){return!0},queryResult:function(a){return 0},
__class__:Nh};var sj=function(a,b,c){this.s=a;this.vertex=b;this.shader=c};r["h3d.impl._GlDriver.CompiledShader"]=sj;sj.__name__="h3d.impl._GlDriver.CompiledShader";sj.prototype={__class__:sj};var tj=function(){};r["h3d.impl._GlDriver.CompiledAttribute"]=tj;tj.__name__="h3d.impl._GlDriver.CompiledAttribute";tj.prototype={__class__:tj};var uj=function(){};r["h3d.impl._GlDriver.CompiledProgram"]=uj;uj.__name__="h3d.impl._GlDriver.CompiledProgram";uj.prototype={__class__:uj};var W=function(a){null==
a&&(a=0);this.features=new af;this.maxCompressedTexturesSupport=0;this.rightHanded=this.hasMultiIndirect=!1;this.firstShader=!0;this.boundTextures=[];this.curTargets=[];var b=[];b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);b.push(0);this.currentDivisor=
b;this.curColorMask=-1;this.lastActiveIndex=0;this.curStEnabled=!1;this.curMatBits=this.curStOpBits=this.curStMaskBits=-1;this.maxIdxCurAttribs=0;this.curAttribs=[];this.canvas=db.getInstance().canvas;a={alpha:!1,stencil:!0,antialias:0<a};W.ALLOW_WEBGL2&&(this.gl=this.canvas.getContext("webgl2",a));null==this.gl&&(this.gl=Fk.getContextWebGL(this.canvas,a));if(null==this.gl)throw new q("Could not acquire GL context");"undefined"!=typeof WebGLDebugUtils&&(this.gl=WebGLDebugUtils.makeDebugContext(this.gl),
this.glDebug=!0);this.commonFB=this.gl.createFramebuffer();this.programs=new na;this.defStencil=new ja;a=this.gl.getParameter(7938);b=new uf("ES ([0-9]+\\.[0-9]+)","");b.match(a)&&(this.glES=parseFloat(b.matched(1)));a=new uf("[0-9]+\\.[0-9]+","");b=this.gl.getParameter(35724);a.match(b)&&(this.glES=parseFloat(a.matched(0)),this.shaderVersion=Math.round(100*parseFloat(a.matched(0))));this.drawMode=4;this.makeFeatures();this.hasFeature(Ja.InstancedRendering)&&3>this.glES&&(a=this.gl.getExtension("ANGLE_instanced_arrays"),
this.gl.vertexAttribDivisor=z(a,a.vertexAttribDivisorANGLE),this.gl.drawElementsInstanced=z(a,a.drawElementsInstancedANGLE));qe.UNROLL_LOOPS=!this.hasFeature(Ja.ShaderModel3)};r["h3d.impl.GlDriver"]=W;W.__name__="h3d.impl.GlDriver";W.__super__=Nh;W.prototype=J(Nh.prototype,{setRenderFlag:function(a,b){this.rightHanded=0<b},logImpl:function(a){console.log(a)},setDebug:function(a){this.debug=a},begin:function(a){this.frame=a;this.resetStream();this.gl.useProgram(null);this.curBuffer=this.curShader=
null},getShaderInputNames:function(){return this.curShader.inputs},getNativeShaderCode:function(a){return"// vertex:\n"+yb.compile(a.vertex.data)+"// fragment:\n"+yb.compile(a.fragment.data)},getDriverName:function(a){var b=this.gl.getParameter(7937),b=a?b+(" GLv"+n.string(this.gl.getParameter(7938))):b.split("/").shift(),b=b.split("WebGL ").join("");return"OpenGL "+b},compileShader:function(a,b){var c=this.gl.createShader(b.vertex?35633:35632);null==b.code&&(b.code=a.run(b.data),b.data.funs=null);
this.gl.shaderSource(c,b.code);this.gl.compileShader(c);this.gl.getShaderInfoLog(c);if(1!=this.gl.getShaderParameter(c,35713)){for(var c=this.gl.getShaderInfoLog(c),d=n.parseInt(v.substr(c,9,null)),d=null==d?null:b.code.split("\n")[d-1],d=null==d?"":"("+Qa.trim(d)+")",e=b.code.split("\n"),f=0,g=e.length;f<g;){var h=f++;e[h]=h+1+"\t"+e[h]}throw new q("An error occurred compiling the shaders: "+c+d+"\n\n"+e.join("\n"));}return new sj(c,b.vertex,b)},initShader:function(a,b,c){var d=b.vertex?"vertex":
"fragment";b.globals=this.gl.getUniformLocation(a.p,d+"Globals");b.params=this.gl.getUniformLocation(a.p,d+"Params");b.textures=[];for(var e=0,f=null,g=0,h="",k=c.textures;null!=k;){var l=k.type;17==l._hx_index&&(l=u.TSampler2D);if(l!=f){f=l;switch(l._hx_index){case 10:g=3553;h="Textures";break;case 11:g=35866;h="TexturesArray";break;case 12:g=34067;h="TexturesCube";break;default:throw new q("Unsupported texture type "+n.string(l));}e=0}b.textures.push({u:this.gl.getUniformLocation(a.p,d+h+"["+e+
"]"),t:f,mode:g});++e;k=k.next}if(0<c.bufferCount){d=[];e=0;for(f=c.bufferCount;e<f;)g=e++,d.push(this.gl.getUniformBlockIndex(a.p,"uniform_buffer"+g));b.buffers=d;d=0;for(c=c.bufferCount;d<c;)e=d++,this.gl.uniformBlockBinding(a.p,b.buffers[e],e)}},selectShader:function(a){var b=this.programs.h[a.id];if(null==b){var b=new uj,c=new yb;c.glES=this.glES;c.version=this.shaderVersion;b.vertex=this.compileShader(c,a.vertex);b.fragment=this.compileShader(c,a.fragment);b.p=this.gl.createProgram();this.gl.attachShader(b.p,
b.vertex.s);this.gl.attachShader(b.p,b.fragment.s);var d=null;try{this.gl.linkProgram(b.p),1!=this.gl.getProgramParameter(b.p,35714)&&(d=this.gl.getProgramInfoLog(b.p))}catch(e){throw $.lastException=e,new q("Shader linkage error: "+n.string(e instanceof q?e.val:e)+" ("+this.getDriverName(!1)+")");}this.gl.deleteShader(b.vertex.s);this.gl.deleteShader(b.fragment.s);if(null!=d)throw this.gl.deleteProgram(b.p),new q("Program linkage failure: "+d+"\nVertex=\n"+a.vertex.code+"\n\nFragment=\n"+a.fragment.code);
this.firstShader=!1;this.initShader(b,b.vertex,a.vertex);this.initShader(b,b.fragment,a.fragment);d=[];b.attribs=[];b.hasAttribIndex=[];for(var f=b.stride=0,g=a.vertex.data.vars;f<g.length;){var h=g[f];++f;if(1==h.kind._hx_index){var k=5126,l;l=h.type;switch(l._hx_index){case 3:l=1;break;case 5:l=l.size;break;case 9:l=l.size;k=5120;break;default:throw new q("assert "+n.string(h.type));}var m=this.gl.getAttribLocation(b.p,c.varNames.h.hasOwnProperty(h.id)?c.varNames.h[h.id]:h.name);if(!(0>m)){var t=
new tj;t.type=k;t.size=l;t.index=m;t.offset=b.stride;t.divisor=0;if(null!=h.qualifiers){k=0;for(m=h.qualifiers;k<m.length;){var x=m[k];++k;9==x._hx_index&&(t.divisor=x.v)}}b.attribs.push(t);b.hasAttribIndex[t.index]=!0;d.push(h.name)}b.stride+=l}}b.inputs=ic.get(d);this.programs.h[a.id]=b}if(this.curShader==b)return!1;this.gl.useProgram(b.p);a=0;for(c=b.attribs;a<c.length;)d=c[a],++a,this.curAttribs[d.index]||(this.gl.enableVertexAttribArray(d.index),this.curAttribs[d.index]=!0,this.maxIdxCurAttribs<
d.index&&(this.maxIdxCurAttribs=d.index));c=a=0;for(d=this.maxIdxCurAttribs+1;c<d;)f=c++,this.curAttribs[f]&&!b.hasAttribIndex[f]?(this.gl.disableVertexAttribArray(f),this.curAttribs[f]=!1):this.curAttribs[f]&&(a=f);this.maxIdxCurAttribs=a;this.curShader=b;this.curBuffer=null;b=0;for(a=this.boundTextures.length;b<a;)c=b++,this.boundTextures[c]=null;return!0},uploadShaderBuffers:function(a,b){this.uploadBuffer(this.curShader.vertex,a.vertex,b);this.uploadBuffer(this.curShader.fragment,a.fragment,b)},
uploadBuffer:function(a,b,c){switch(c){case 0:null!=a.globals&&(b=b.globals.subarray(0,4*a.shader.globalsSize),this.gl.uniform4fv(a.globals,b));break;case 1:null!=a.params&&(b=b.params.subarray(0,4*a.shader.paramsSize),this.gl.uniform4fv(a.params,b));break;case 2:c=0;for(var d=a.textures.length;c<d;){var e=c++,f=b.tex[e],g=a.textures[e];if(null==f||null==f.t&&null==f.realloc)switch(g.t._hx_index){case 10:f=Xb.loadingTextureColor;f=S.fromColor(f,(f>>>24)/255);break;case 12:f=S.defaultCubeTexture();
break;default:throw new q("Missing texture");}null!=f&&(null==f.t&&null!=f.realloc)&&(f.alloc(),f.realloc());f.set_lastFrame(this.frame);if(null!=g.u){e=a.vertex?e:this.curShader.vertex.textures.length+e;if(this.boundTextures[e]!=f.t){this.boundTextures[e]=f.t;var h=this.getBindType(f);if(h!=g.mode)throw new q("Texture format mismatch: "+n.string(f)+" should be "+n.string(g.t));this.gl.activeTexture(33984+e);this.gl.uniform1i(g.u,e);this.gl.bindTexture(h,f.t.t);this.lastActiveIndex=e}var h=f.mipMap._hx_index,
k=f.filter._hx_index,e=f.wrap._hx_index,l=h|k<<3|e<<6;l!=f.t.bits&&(f.t.bits=l,f=W.TFILTERS[h][k],g=g.mode,this.gl.texParameteri(g,10240,f[0]),this.gl.texParameteri(g,10241,f[1]),f=W.TWRAP[e],this.gl.texParameteri(g,10242,f),this.gl.texParameteri(g,10243,f))}}break;case 3:if(null!=a.buffers){c=0;for(a=a.buffers.length;c<a;)d=c++,this.gl.bindBufferBase(35345,d,b.buffers[d].buffer.vbuf.b)}}},selectMaterial:function(a){var b=a.bits;if(null==this.curTarget==this.rightHanded)switch(a.culling._hx_index){case 1:b=
b&-4|2;break;case 2:b=b&-4|1}this.selectMaterialBits(b);this.curColorMask!=a.colorMask&&(b=a.colorMask,this.gl.colorMask(0!=(b&1),0!=(b&2),0!=(b&4),0!=(b&8)),this.curColorMask=b);b=this.defStencil;null==a.stencil?this.curStEnabled&&(this.gl.disable(2960),this.curStEnabled=!1):(b=a.stencil,this.curStEnabled||(this.gl.enable(2960),this.curStEnabled=!0));this.selectStencilBits(b.opBits,b.maskBits)},selectMaterialBits:function(a){var b=a^this.curMatBits;0>this.curMatBits&&(b=-1);if(0!=b){this.drawMode=
0!=(a&268435456)?3:4;if(0!=(b&3)){var c=a&3;0==c?this.gl.disable(2884):((0>this.curMatBits||0==(this.curMatBits&3))&&this.gl.enable(2884),this.gl.cullFace(W.FACES[c]))}if(0!=(b&4194240)){var c=a>>6&15,d=a>>10&15,e=a>>14&15,f=a>>18&15;c==e&&d==f?0==c&&1==d?this.gl.disable(3042):((0>this.curMatBits||0==(this.curMatBits>>6&15)&&1==(this.curMatBits>>10&15))&&this.gl.enable(3042),this.gl.blendFunc(W.BLEND[c],W.BLEND[d])):((0>this.curMatBits||0==(this.curMatBits>>6&15)&&1==(this.curMatBits>>10&15))&&this.gl.enable(3042),
this.gl.blendFuncSeparate(W.BLEND[c],W.BLEND[d],W.BLEND[e],W.BLEND[f]))}0!=(b&264241152)&&(c=a>>22&7,d=a>>25&7,c==d?this.gl.blendEquation(W.OP[c]):this.gl.blendEquationSeparate(W.OP[c],W.OP[d]));0!=(b&4)&&this.gl.depthMask(0!=(a>>2&1));0!=(b&56)&&(b=a>>3&7,0==b?this.gl.disable(2929):((0>this.curMatBits||0==(this.curMatBits>>3&7))&&this.gl.enable(2929),this.gl.depthFunc(W.COMPARE[b])));this.curMatBits=a}},selectStencilBits:function(a,b){var c=a^this.curStOpBits,d=b^this.curStMaskBits;0!=(c|d)&&(0!=
(c&4088)&&this.gl.stencilOpSeparate(W.FACES[2],W.STENCIL_OP[a>>6&7],W.STENCIL_OP[a>>9&7],W.STENCIL_OP[a>>3&7]),0!=(c&16744448)&&this.gl.stencilOpSeparate(W.FACES[1],W.STENCIL_OP[a>>18&7],W.STENCIL_OP[a>>21&7],W.STENCIL_OP[a>>15&7]),0!=(c&7|d&16711935)&&this.gl.stencilFuncSeparate(W.FACES[2],W.COMPARE[a&7],b>>16&255,b&255),0!=(c&28672|d&16711935)&&this.gl.stencilFuncSeparate(W.FACES[1],W.COMPARE[a>>12&7],b>>16&255,b&255),0!=(d&65280)&&(c=b>>8&255,this.gl.stencilMaskSeparate(W.FACES[2],c),this.gl.stencilMaskSeparate(W.FACES[1],
c)),this.curStOpBits=a,this.curStMaskBits=b)},clear:function(a,b,c){var d=0;null!=a&&(this.gl.colorMask(!0,!0,!0,!0),this.curColorMask=15,this.gl.clearColor(a.x,a.y,a.z,a.w),d|=16384);null!=b&&(this.gl.depthMask(!0),0<=this.curMatBits&&(this.curMatBits|=4),this.gl.clearDepth(b),d|=256);null!=c&&(this.selectStencilBits(this.defStencil.opBits,this.defStencil.maskBits),this.gl.clearStencil(c),d|=1024);0!=d&&this.gl.clear(d);null!=this.curTarget&&(this.curTarget.flags|=1<<V.WasCleared._hx_index)},resize:function(a,
b){""==this.canvas.style.width&&(this.canvas.style.width=(a/window.devicePixelRatio|0)+"px",this.canvas.style.height=(b/window.devicePixelRatio|0)+"px");this.canvas.width=a;this.canvas.height=b;this.bufferWidth=a;this.bufferHeight=b;this.gl.viewport(0,0,a,b);null!=this.defaultDepth&&(this.disposeDepthBuffer(this.defaultDepth),this.defaultDepth.width=this.bufferWidth,this.defaultDepth.height=this.bufferHeight,this.defaultDepth.b=this.allocDepthBuffer(this.defaultDepth))},getChannels:function(a){switch(a.internalFmt){case 6407:return 6407;
case 6408:return 6408;case 32856:return 32993;case 32857:return 6408;case 6403:case 33321:case 33325:case 33326:return 6403;case 33319:case 33323:case 33327:case 33328:return 33319;case 33777:case 33778:case 33779:return 6408;case 34837:case 34843:return 6407;case 35898:return 6407;case 35904:case 35905:return 6407;case 34836:case 34842:case 35906:case 35907:return 6408;default:throw new q("Invalid format "+a.internalFmt);}},isSupportedFormat:function(a){switch(a._hx_index){case 2:return!0;case 3:case 4:return this.hasFeature(Ja.FloatTextures);
case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 16:case 17:return 3<=this.glES;case 14:case 15:return this.hasFeature(Ja.SRGBTextures);case 18:return a.v<=this.maxCompressedTexturesSupport;default:return!1}},getBindType:function(a){var b=0!=(a.flags&1<<V.IsArray._hx_index);return 0!=(a.flags&1<<V.Cube._hx_index)?34067:b?35866:3553},allocTexture:function(a){W.outOfMemoryCheck&&this.gl.getError();var b=this.gl.createTexture(),c=this.getBindType(a),b={t:b,width:a.width,height:a.height,
internalFmt:6408,pixelFmt:5121,bits:-1,bind:c},d=a.format;switch(d._hx_index){case 1:b.internalFmt=32856;break;case 2:break;case 3:if(this.hasFeature(Ja.FloatTextures))b.pixelFmt=5131,b.internalFmt=34842;else throw new q("Unsupported texture format "+n.string(a.format));break;case 4:if(this.hasFeature(Ja.FloatTextures))b.internalFmt=34836,b.pixelFmt=5126;else throw new q("Unsupported texture format "+n.string(a.format));break;case 5:b.internalFmt=33321;break;case 6:b.internalFmt=33325;b.pixelFmt=
5131;break;case 7:b.internalFmt=33326;b.pixelFmt=5126;break;case 8:b.internalFmt=33323;break;case 9:b.internalFmt=33327;b.pixelFmt=5131;break;case 10:b.internalFmt=33328;b.pixelFmt=5126;break;case 11:b.internalFmt=6407;break;case 12:b.internalFmt=34843;b.pixelFmt=5131;break;case 13:b.internalFmt=34837;b.pixelFmt=5126;break;case 14:b.internalFmt=35905;break;case 15:b.internalFmt=35907;break;case 16:b.internalFmt=32857;b.pixelFmt=33640;break;case 17:b.internalFmt=35898;b.pixelFmt=35899;break;case 18:d=
d.v;if(d<=this.maxCompressedTexturesSupport){if(0!=(a.width&3)||0!=(a.height&3))throw new q("Compressed texture "+n.string(a)+" has size "+a.width+"x"+a.height+" - must be a multiple of 4");switch(d){case 1:b.internalFmt=33777;break;case 2:b.internalFmt=33778;break;case 3:b.internalFmt=33779;break;default:throw new q("Unsupported texture format "+n.string(a.format));}}else throw new q("Unsupported texture format "+n.string(a.format));break;default:throw new q("Unsupported texture format "+n.string(a.format));
}a.set_lastFrame(this.frame);a.flags&=-1-(1<<V.WasCleared._hx_index);this.gl.bindTexture(c,b.t);d=!1;if(0!=(a.flags&1<<V.Cube._hx_index))for(c=0;6>c;){var e=c++;this.gl.texImage2D(W.CUBE_FACES[e],0,b.internalFmt,b.width,b.height,0,this.getChannels(b),b.pixelFmt,null);if(W.outOfMemoryCheck)if(e=this.gl.getError(),1285==e)e=d=!0;else{if(0!=e)throw new q("Failed to alloc texture "+n.string(a.format)+"(error "+e+")");e=!1}else e=!1;if(e)break}else if(0!=(a.flags&1<<V.IsArray._hx_index)?this.gl.texImage3D(35866,
0,b.internalFmt,b.width,b.height,a.get_layerCount(),0,this.getChannels(b),b.pixelFmt,null):18==a.format._hx_index||this.gl.texImage2D(c,0,b.internalFmt,b.width,b.height,0,this.getChannels(b),b.pixelFmt,null),W.outOfMemoryCheck)if(c=this.gl.getError(),1285==c)d=!0;else if(0!=c)throw new q("Failed to alloc texture "+n.string(a.format)+"(error "+c+")");this.restoreBind();return d?(this.gl.deleteTexture(b.t),null):b},restoreBind:function(){var a=this.boundTextures[this.lastActiveIndex];null==a?this.gl.bindTexture(3553,
null):this.gl.bindTexture(a.bind,a.t)},allocDepthBuffer:function(a){var b=this.gl.createRenderbuffer();null==a.format&&(a.format=3<=this.glES?Oh.Depth24Stencil8:Oh.Depth16);var c;switch(a.format._hx_index){case 0:c=33189;break;case 1:if(3<=this.glES)c=33190;else throw new q("Unsupported depth format "+n.string(a.format));break;case 2:c=34041;break;default:throw new q("Unsupported depth format "+n.string(a.format));}this.gl.bindRenderbuffer(36161,b);this.gl.renderbufferStorage(36161,c,a.width,a.height);
this.gl.bindRenderbuffer(36161,null);return{r:b}},disposeDepthBuffer:function(a){null!=a.b&&null!=a.b.r&&(this.gl.deleteRenderbuffer(a.b.r),a.b=null)},getDefaultDepthBuffer:function(){if(null!=this.defaultDepth)return this.defaultDepth;this.defaultDepth=new Od(0,0);this.defaultDepth.width=this.bufferWidth;this.defaultDepth.height=this.bufferHeight;this.defaultDepth.b=this.allocDepthBuffer(this.defaultDepth);return this.defaultDepth},discardError:function(){W.outOfMemoryCheck&&this.gl.getError()},
allocVertexes:function(a){W.outOfMemoryCheck&&this.gl.getError();var b=this.gl.createBuffer();this.gl.bindBuffer(34962,b);if(0==a.size*a.stride)throw new q("assert");this.gl.bufferData(34962,4*a.size*a.stride,0!=(a.flags&1<<ba.Dynamic._hx_index)?35048:35044);var c=W.outOfMemoryCheck&&1285==this.gl.getError();this.gl.bindBuffer(34962,null);return c?(this.gl.deleteBuffer(b),null):{b:b,stride:a.stride}},allocIndexes:function(a,b){W.outOfMemoryCheck&&this.gl.getError();var c=this.gl.createBuffer(),d=
b?4:2;this.gl.bindBuffer(34963,c);this.gl.bufferData(34963,a*d,35044);d=W.outOfMemoryCheck&&1285==this.gl.getError();this.gl.bindBuffer(34963,null);this.curIndexBuffer=null;return d?(this.gl.deleteBuffer(c),null):{b:c,is32:b}},disposeTexture:function(a){var b=a.t;if(null!=b){a.t=null;a=0;for(var c=this.boundTextures.length;a<c;){var d=a++;this.boundTextures[d]==b&&(this.boundTextures[d]=null)}this.gl.deleteTexture(b.t)}},disposeIndexes:function(a){this.gl.deleteBuffer(a.b)},disposeVertexes:function(a){this.gl.deleteBuffer(a.b)},
generateMipMaps:function(a){var b=this.getBindType(a);this.gl.bindTexture(b,a.t.t);this.gl.generateMipmap(b);this.restoreBind()},uploadTextureBitmap:function(a,b,c,d){a.format!=ha.RGBA||0!=(a.flags&1<<V.Cube._hx_index)?(b=b.getPixels(),this.uploadTexturePixels(a,b,c,d),b.dispose()):(d=b.ctx,this.gl.bindTexture(3553,a.t.t),this.gl.texImage2D(3553,c,a.t.internalFmt,this.getChannels(a.t),a.t.pixelFmt,d.getImageData(0,0,b.ctx.canvas.width,b.ctx.canvas.height)),this.restoreBind())},resetStream:function(){},
streamData:function(a,b,c){return a},uploadTexturePixels:function(a,b,c,d){var e=0!=(a.flags&1<<V.Cube._hx_index),f=this.getBindType(a);if(0!=(a.flags&1<<V.IsArray._hx_index))throw new q("TODO:texImage3D");d=e?W.CUBE_FACES[d]:3553;this.gl.bindTexture(f,a.t.t);b.convert(a.format);b.setFlip(!1);f=b.stride*b.height;switch(a.format._hx_index){case 4:case 7:case 10:case 13:f=new Float32Array(b.bytes.b.buffer,b.offset,f>>2);break;case 3:case 6:case 9:case 12:f=new Uint16Array(b.bytes.b.buffer,b.offset,
f>>1);break;case 16:case 17:f=new Uint32Array(b.bytes.b.buffer,b.offset,f>>2);break;default:f=new Uint8Array(b.bytes.b.buffer,b.offset,f)}18==a.format._hx_index?this.gl.compressedTexImage2D(d,c,a.t.internalFmt,b.width,b.height,0,f):this.gl.texImage2D(d,c,a.t.internalFmt,b.width,b.height,0,this.getChannels(a.t),a.t.pixelFmt,f);a.flags|=1<<V.WasCleared._hx_index;this.restoreBind()},uploadVertexBuffer:function(a,b,c,d,e){var f=a.stride;this.gl.bindBuffer(34962,a.b);a=new Float32Array(d.array.buffer,
4*e,c*f);this.gl.bufferSubData(34962,4*b*f,a);this.gl.bindBuffer(34962,null)},uploadVertexBytes:function(a,b,c,d,e){var f=a.stride;this.gl.bindBuffer(34962,a.b);a=new Uint8Array(d.b.bufferValue,4*e,4*c*f);this.gl.bufferSubData(34962,4*b*f,a);this.gl.bindBuffer(34962,null)},uploadIndexBuffer:function(a,b,c,d,e){var f=a.is32?2:1;this.gl.bindBuffer(34963,a.b);a=new Uint16Array(d);c=new Uint16Array(a.buffer,e<<f,c);this.gl.bufferSubData(34963,b<<f,c);this.gl.bindBuffer(34963,null);this.curIndexBuffer=
null},uploadIndexBytes:function(a,b,c,d,e){var f=a.is32?2:1;this.gl.bindBuffer(34963,a.b);a=new Uint8Array(d.b.bufferValue,e<<f,c<<f);this.gl.bufferSubData(34963,b<<f,a);this.gl.bindBuffer(34963,null);this.curIndexBuffer=null},updateDivisor:function(a){this.currentDivisor[a.index]!=a.divisor&&(this.currentDivisor[a.index]=a.divisor,this.gl.vertexAttribDivisor(a.index,a.divisor))},selectBuffer:function(a){if(a!=this.curBuffer)if(null!=this.curBuffer&&a.buffer==this.curBuffer.buffer&&0!=(a.buffer.flags&
1<<ba.RawFormat._hx_index)==(0!=(this.curBuffer.flags&1<<ba.RawFormat._hx_index)))this.curBuffer=a;else{if(null==this.curShader)throw new q("No shader selected");this.curBuffer=a;var b=a.buffer.vbuf;if(b.stride<this.curShader.stride)throw new q("Buffer stride ("+b.stride+") and shader stride ("+this.curShader.stride+") mismatch");this.gl.bindBuffer(34962,b.b);if(0!=(a.flags&1<<ba.RawFormat._hx_index)){a=0;for(var c=this.curShader.attribs;a<c.length;){var d=c[a];++a;this.gl.vertexAttribPointer(d.index,
d.size,d.type,!1,4*b.stride,4*d.offset);this.currentDivisor[d.index]!=d.divisor&&(this.currentDivisor[d.index]=d.divisor,this.gl.vertexAttribDivisor(d.index,d.divisor))}}else{a=8;c=0;for(d=this.curShader.attribs.length;c<d;){var e=c++,f=this.curShader.attribs[e],e=this.curShader.inputs.names[e];switch(e){case "normal":if(6>b.stride)throw new q("Buffer is missing NORMAL data, set it to RAW format ?");e=3;break;case "position":e=0;break;case "uv":if(8>b.stride)throw new q("Buffer is missing UV data, set it to RAW format ?");
e=6;break;default:var g=e,e=a;a+=f.size;if(a>b.stride)throw new q("Buffer is missing '"+g+"' data, set it to RAW format ?");}this.gl.vertexAttribPointer(f.index,f.size,f.type,!1,4*b.stride,4*e);this.currentDivisor[f.index]!=f.divisor&&(this.currentDivisor[f.index]=f.divisor,this.gl.vertexAttribDivisor(f.index,f.divisor))}}}},selectMultiBuffers:function(a){for(var b=0,c=this.curShader.attribs;b<c.length;){var d=c[b];++b;this.gl.bindBuffer(34962,a.buffer.buffer.vbuf.b);this.gl.vertexAttribPointer(d.index,
d.size,d.type,!1,4*a.buffer.buffer.stride,4*a.offset);this.currentDivisor[d.index]!=d.divisor&&(this.currentDivisor[d.index]=d.divisor,this.gl.vertexAttribDivisor(d.index,d.divisor));a=a.next}this.curBuffer=null},draw:function(a,b,c){a!=this.curIndexBuffer&&(this.curIndexBuffer=a,this.gl.bindBuffer(34963,a.b));a.is32?this.gl.drawElements(this.drawMode,3*c,5125,4*b):this.gl.drawElements(this.drawMode,3*c,5123,2*b)},allocInstanceBuffer:function(a,b){for(var c=[],d=0,e=a.commandCount;d<e;){var f=20*
d++,g=b.getInt32(f),h=b.getInt32(f+4),k=b.getInt32(f+8),l=b.getInt32(f+12),f=b.getInt32(f+16);if(0!=l||0!=f)throw new q("baseVertex and baseInstance must be zero on this platform");c.push(g);c.push(k);c.push(h)}a.data=c},disposeInstanceBuffer:function(a){a.data=null},drawInstanced:function(a,b){a!=this.curIndexBuffer&&(this.curIndexBuffer=a,this.gl.bindBuffer(34963,a.b));var c=b.data;if(null!=c)for(var d=0,e=0,f=c.length/3|0;e<f;){e++;var g=d++,h=d++;this.gl.drawElementsInstanced(this.drawMode,c[g],
a.is32?5125:5123,c[h],c[d++])}else this.gl.drawElementsInstanced(this.drawMode,b.indexCount,a.is32?5125:5123,0,b.commandCount)},end:function(){},present:function(){},isDisposed:function(){return this.gl.isContextLost()},setRenderZone:function(a,b,c,d){0==a&&0==b&&0>c&&0>d?this.gl.disable(3089):(this.gl.enable(3089),null==this.curTarget&&(b=this.bufferHeight-(b+d)),this.gl.scissor(a,b,c,d))},setDrawBuffers:function(a){3<=this.glES?this.gl.drawBuffers(W.CBUFFERS[a]):null!=this.mrtExt&&this.mrtExt.drawBuffersWEBGL(W.CBUFFERS[a])},
unbindTargets:function(){if(null!=this.curTarget&&1<this.numTargets){for(;1<this.numTargets;)this.gl.framebufferTexture2D(36160,36064+--this.numTargets,3553,null,0),this.curTargets[this.numTargets]=null;this.setDrawBuffers(1)}},capturePixels:function(a,b,c,d){var e,f,g;null!=d?(d.xMax>a.width&&(d.xMax=a.width),d.yMax>a.height&&(d.yMax=a.height),0>d.xMin&&(d.xMin=0),0>d.yMin&&(d.yMin=0),e=Ba.alloc(d.xMax-d.xMin>>c,d.yMax-d.yMin>>c,a.format),f=d.xMin,g=d.yMin):(e=Ba.alloc(a.width>>c,a.height>>c,a.format),
g=f=0);var h=this.curTarget;d=this.numTargets;var k=this.curTargetLayer,l=this.curTargetMip;if(1<d)for(var m=this.numTargets=1;m<d;){var t=m++;this.curTargets[t]==a&&this.gl.framebufferTexture2D(36160,36064+t,3553,null,0)}this.setRenderTarget(a,b,c);this.captureSubRenderBuffer(e,f,g);this.setRenderTarget(h,k,l);if(1<d){for(b=1;b<d;)c=b++,this.curTargets[c]==a&&this.gl.framebufferTexture2D(36160,36064+c,3553,a.t.t,0);this.setDrawBuffers(d);this.numTargets=d}return e},setRenderTarget:function(a,b,c){null==
c&&(c=0);null==b&&(b=0);this.unbindTargets();this.curTarget=a;if(null==a)this.gl.bindFramebuffer(36160,null),this.gl.viewport(0,0,this.bufferWidth,this.bufferHeight);else{if(null!=a.depthBuffer&&(a.depthBuffer.width!=a.width||a.depthBuffer.height!=a.height))throw new q("Invalid depth buffer size : does not match render target size");if(0<c&&1==this.glES)throw new q("Cannot render to mipLevel in WebGL1, use upload() instead");null==a.t&&a.alloc();if(0!=(a.flags&1<<V.MipMapped._hx_index)&&0==(a.flags&
1<<V.WasCleared._hx_index)){var d=this.getBindType(a);this.gl.bindTexture(d,a.t.t);this.gl.generateMipmap(d);this.restoreBind()}a.flags|=1<<V.WasCleared._hx_index;a.set_lastFrame(this.frame);this.curTargetLayer=b;this.curTargetMip=c;this.gl.bindFramebuffer(36160,this.commonFB);0!=(a.flags&1<<V.IsArray._hx_index)?this.gl.framebufferTextureLayer(36160,36064,a.t.t,c,b):this.gl.framebufferTexture2D(36160,36064,0!=(a.flags&1<<V.Cube._hx_index)?W.CUBE_FACES[b]:3553,a.t.t,c);null!=a.depthBuffer?(this.gl.framebufferRenderbuffer(36160,
36096,36161,a.depthBuffer.b.r),this.gl.framebufferRenderbuffer(36160,36128,36161,a.depthBuffer.hasStencil()?a.depthBuffer.b.r:null)):(this.gl.framebufferRenderbuffer(36160,36096,36161,null),this.gl.framebufferRenderbuffer(36160,36128,36161,null));this.gl.viewport(0,0,a.width>>c,a.height>>c);a=0;for(b=this.boundTextures.length;a<b;)c=a++,this.boundTextures[c]=null;if(this.glDebug&&(a=this.gl.checkFramebufferStatus(36160),36053!=a))throw new q("Invalid frame buffer: "+a);}},setRenderTargets:function(a){this.unbindTargets();
this.setRenderTarget(a[0]);if(!(2>a.length)){this.numTargets=a.length;for(var b=1,c=a.length;b<c;){var d=b++,e=a[d];null==e.t&&e.alloc();this.gl.framebufferTexture2D(36160,36064+d,3553,e.t.t,0);this.curTargets[d]=e;e.set_lastFrame(this.frame);e.flags|=1<<V.WasCleared._hx_index}this.setDrawBuffers(a.length)}},init:function(a,b){null==b&&(b=!1);var c=!1;"complete"==window.document.readyState?de.delay(function(){a(!1)},1):window.addEventListener("load",function(b){c||(c=!0,a(!1))})},hasFeature:function(a){return this.features.get(a)},
makeFeatures:function(){for(var a=0,b=Ja.__empty_constructs__.slice();a<b.length;){var c=b[a];++a;this.features.set(c,this.checkFeature(c))}null!=this.gl.getExtension("WEBGL_compressed_texture_s3tc")&&(this.maxCompressedTexturesSupport=3)},checkFeature:function(a){switch(a._hx_index){case 0:return 3<=this.glES?!0:null!=this.gl.getExtension("OES_standard_derivatives");case 1:return 3<=this.glES?null!=this.gl.getExtension("EXT_color_buffer_float")?null!=this.gl.getExtension("OES_texture_float_linear"):
!1:null!=this.gl.getExtension("OES_texture_float")&&null!=this.gl.getExtension("OES_texture_float_linear")&&null!=this.gl.getExtension("OES_texture_half_float")?null!=this.gl.getExtension("OES_texture_half_float_linear"):!1;case 4:return 3<=this.glES?!0:null==this.mrtExt?null!=(this.mrtExt=this.gl.getExtension("WEBGL_draw_buffers")):!0;case 6:return 3<=this.glES?!0:null!=this.gl.getExtension("EXT_sRGB");case 7:return 3<=this.glES?!0:!1;case 2:case 3:case 8:case 9:return!0;case 10:return 3<=this.glES?
!0:null!=this.gl.getExtension("ANGLE_instanced_arrays");default:return!1}},uploadTextureVideoElement:function(a,b,c,d){var e=0!=(a.flags&1<<V.Cube._hx_index),f=this.getBindType(a);if(0!=(a.flags&1<<V.IsArray._hx_index))throw new q("TODO:texImage3D");d=e?W.CUBE_FACES[d]:3553;this.gl.bindTexture(f,a.t.t);3<=this.glES?this.gl.texImage2D(d,c,a.t.internalFmt,b.videoWidth,b.videoHeight,0,this.getChannels(a.t),a.t.pixelFmt,b):this.gl.texImage2D(d,c,a.t.internalFmt,a.t.internalFmt,a.t.pixelFmt,b);this.restoreBind()},
captureRenderBuffer:function(a){this.captureSubRenderBuffer(a,0,0)},captureSubRenderBuffer:function(a,b,c){if(null==this.curTarget)throw new q("Can't capture main render buffer in GL");W.outOfMemoryCheck&&this.gl.getError();var d=a.bytes.b;switch(this.curTarget.format._hx_index){case 4:case 7:case 10:case 13:d=new Float32Array(d.buffer);break;case 3:case 6:case 9:case 12:d=new Uint16Array(d.buffer);break;case 16:case 17:d=new Uint32Array(d.buffer)}this.gl.readPixels(b,c,a.width,a.height,this.getChannels(this.curTarget.t),
this.curTarget.t.pixelFmt,d);b=this.gl.getError();if(0!=b)throw new q("Failed to capture pixels (error "+b+")");a.set_innerFormat(this.curTarget.format)},__class__:W});var Gk=function(){this.indexCount=this.triCount=0};r["h3d.impl.InstanceBuffer"]=Gk;Gk.__name__="h3d.impl.InstanceBuffer";Gk.prototype={setCommand:function(a,b){this.commandCount=a;this.indexCount=b;this.triCount=a*b/3|0},setBuffer:function(a,b){this.dispose();for(var c=0;c<a;){var d=c++,e=b.getInt32(20*d),d=b.getInt32(20*d+4);this.triCount+=
e*d/3|0}this.commandCount=a;this.indexCount=0;this.driver=X.CURRENT.driver;this.driver.allocInstanceBuffer(this,b)},dispose:function(){null!=this.data&&this.driver.disposeInstanceBuffer(this)},__class__:Gk};var Pg=function(a,b,c){this.pos=a;this.count=b;this.next=c};r["h3d.impl._ManagedBuffer.FreeCell"]=Pg;Pg.__name__="h3d.impl._ManagedBuffer.FreeCell";Pg.prototype={__class__:Pg};var Ph=function(a,b,c){this.flags=0;if(null!=c)for(var d=0;d<c.length;){var e=c[d];++d;this.flags|=1<<e._hx_index}this.size=
b;this.stride=a;this.freeList=new Pg(0,b,null);this.mem=X.CURRENT.mem;this.mem.allocManaged(this)};r["h3d.impl.ManagedBuffer"]=Ph;Ph.__name__="h3d.impl.ManagedBuffer";Ph.prototype={uploadVertexBuffer:function(a,b,c,d){null==d&&(d=0);this.mem.driver.uploadVertexBuffer(this.vbuf,a,b,c,d)},uploadVertexBytes:function(a,b,c,d){null==d&&(d=0);this.mem.driver.uploadVertexBytes(this.vbuf,a,b,c,d)},readVertexBytes:function(a,b,c,d){null==d&&(d=0);this.mem.driver.readVertexBytes(this.vbuf,a,b,c,d)},alloc:function(a,
b){var c=this.allocPosition(a,b);if(0>c)return null;var d=new hb(a,this.stride,[ba.NoAlloc]);d.position=c;d.buffer=this;return d},getFreeVertices:function(){for(var a=0,b=this.freeList;null!=b;)a+=b.count,b=b.next;return a},allocPosition:function(a,b){for(var c=this.freeList;null!=c;){if(c.count>=a){var d=(b-c.pos%b)%b;if(0==d)break;if(c.count>=a+d){c.next=new Pg(c.pos+d,c.count-d,c.next);c.count=d;c=c.next;break}}c=c.next}if(null==c)return-1;d=c.pos;c.pos+=a;c.count-=a;return d},allocBuffer:function(a){var b=
this.allocPosition(a.vertices,0!=(a.flags&1<<ba.Quads._hx_index)?4:0!=(a.flags&1<<ba.Triangles._hx_index)?3:1);if(0>b)return!1;a.position=b;a.buffer=this;return!0},freeBuffer:function(a){for(var b=null,c=this.freeList,d=a.vertices,e=a.position+d;null!=c;){if(c.pos==e){c.pos-=d;c.count+=d;null!=b&&b.pos+b.count==c.pos&&(b.count+=c.count,b.next=c.next);d=0;break}if(c.pos>e){null!=b&&b.pos+b.count==a.position?b.count+=d:(a=new Pg(a.position,d,c),null==b?this.freeList=a:b.next=a);d=0;break}b=c;c=c.next}if(0!=
d)throw new q("assert");this.freeList.count==this.size&&0==(this.flags&1<<ba.Managed._hx_index)&&this.dispose()},dispose:function(){this.mem.freeManaged(this)},isDisposed:function(){return null==this.vbuf},__class__:Ph};var oe=function(a){this.usedMemory=this.texMemory=this.bufferCount=0;this.driver=a};r["h3d.impl.MemoryManager"]=oe;oe.__name__="h3d.impl.MemoryManager";oe.prototype={init:function(){this.indexes=[];this.textures=[];this.buffers=[];this.depths=[];this.initIndexes()},initIndexes:function(){for(var a=
[],b=0;65533>b;){var c=b++;a.push(c)}this.triIndexes=md.alloc(a);a=[];for(b=0;16383>b;)c=b++<<2,a.push(c),a.push(c+1),a.push(c+2),a.push(c+2),a.push(c+1),a.push(c+3);a.push(65533);this.quadIndexes=md.alloc(a)},garbage:function(){},cleanManagedBuffers:function(){for(var a=1,b=this.buffers.length;a<b;)for(var c=a++,d=this.buffers[c],e=null;null!=d;)d.freeList.count==d.size?(d.dispose(),null==e?this.buffers[c]=d.next:e.next=d.next):e=d,d=d.next},allocManaged:function(a){if(null==a.vbuf){var b=4*a.size*
a.stride;if(0!=b){for(;4294967296<this.usedMemory+b||65536<=this.bufferCount||null==(a.vbuf=this.driver.allocVertexes(a));){if(this.driver.isDisposed())return;var c=this.usedMemory-this.freeMemorySize();this.garbage();this.cleanManagedBuffers();if(this.usedMemory-this.freeMemorySize()==c){if(65536<=this.bufferCount)throw new q("Too many buffers");throw new q("Memory full ("+Math.ceil(c/1024)+" KB,"+this.bufferCount+" buffers)");}}this.usedMemory+=b;this.bufferCount++}}},freeManaged:function(a){if(null!=
a.vbuf&&(this.driver.disposeVertexes(a.vbuf),a.vbuf=null,this.usedMemory-=4*a.size*a.stride,this.bufferCount--,0==(a.flags&1<<ba.Managed._hx_index)))for(var b=this.buffers[0],c=null;null!=b;){if(b==a){null==c?this.buffers[0]=a.next:c.next=a.next;break}c=b;b=b.next}},allocBuffer:function(a,b){var c=0!=(a.flags&1<<ba.Quads._hx_index)?65532:0!=(a.flags&1<<ba.Triangles._hx_index)?65533:65534;if(a.vertices>c){if(65534==c)throw new q("Cannot split buffer with "+a.vertices+" vertices if it's not Quads/Triangles");
var d=a.vertices-c;a.vertices=c;this.allocBuffer(a,b);for(c=a;null!=c.next;)c=c.next;for(var e=[],f=0,g=oe.ALL_FLAGS;f<g.length;){var h=g[f];++f;0!=(a.flags&1<<h._hx_index)&&e.push(h)}c.next=new hb(d,b,e)}else if(0==(a.flags&1<<ba.Managed._hx_index)){if(d=null,0!=(a.flags&1<<ba.Dynamic._hx_index)&&(null==d&&(d=[]),d.push(ba.Dynamic)),0!=(a.flags&1<<ba.UniformBuffer._hx_index)&&(null==d&&(d=[]),d.push(ba.UniformBuffer)),d=new Ph(b,a.vertices,d),d.next=this.buffers[0],this.buffers[0]=d,!d.allocBuffer(a))throw new q("assert");
}else{e=this.buffers[b];for(f=null;null!=e;){if(e.allocBuffer(a))return;f=e;e=e.next}g=0!=(a.flags&1<<ba.Triangles._hx_index)?3:0!=(a.flags&1<<ba.Quads._hx_index)?4:0;if(null==e&&0<g){for(c=d=a.vertices;2048<c;){e=this.buffers[b];c>>=1;c-=c%g;for(a.vertices=c;null!=e;){if(e.allocBuffer(a)){e=[];f=0;for(g=oe.ALL_FLAGS;f<g.length;)h=g[f],++f,0!=(a.flags&1<<h._hx_index)&&e.push(h);a.next=new hb(d-c,b,e);return}e=e.next}}a.vertices=d}e=new Ph(b,65533,[ba.Managed]);null==f?this.buffers[b]=e:f.next=e;if(!e.allocBuffer(a))throw new q("assert");
}},deleteIndexes:function(a){v.remove(this.indexes,a);this.driver.disposeIndexes(a.ibuf);a.ibuf=null;this.usedMemory-=a.count*(a.is32?4:2)},allocIndexes:function(a){a.ibuf=this.driver.allocIndexes(a.count,a.is32);this.indexes.push(a);this.usedMemory+=a.count*(a.is32?4:2)},bpp:function(a){return 4},cleanTextures:function(a){null==a&&(a=!0);this.textures.sort(z(this,this.sortByLRU));for(var b=0,c=this.textures;b<c.length;){var d=c[b];++b;if(!(null==d.realloc||null==d.t&&null==d.realloc))if(a||d.get_lastFrame()<
ea.frameCount-3600)return d.dispose(),!0}return!1},sortByLRU:function(a,b){return a.get_lastFrame()-b.get_lastFrame()},deleteTexture:function(a){v.remove(this.textures,a)&&(this.driver.disposeTexture(a),this.texMemory-=a.width*a.height*this.bpp(a))},allocTexture:function(a){this.cleanTextures(!1);a.t=this.driver.allocTexture(a);if(null==a.t){if(!this.driver.isDisposed()){if(!this.cleanTextures(!0))throw new q("Maximum texture memory reached");this.allocTexture(a)}}else this.textures.push(a),this.texMemory+=
a.width*a.height*this.bpp(a)},allocDepth:function(a){this.cleanTextures(!1);a.b=this.driver.allocDepthBuffer(a);if(null==a.b){if(!this.driver.isDisposed()){if(!this.cleanTextures(!0))throw new q("Maximum texture memory reached");this.allocDepth(a)}}else this.depths.push(a),this.texMemory+=4*a.width*a.height},deleteDepth:function(a){v.remove(this.depths,a)&&(this.driver.disposeDepthBuffer(a),this.texMemory-=4*a.width*a.height)},onContextLost:function(){this.dispose();this.initIndexes()},dispose:function(){null!=
this.triIndexes&&this.triIndexes.dispose();null!=this.quadIndexes&&this.quadIndexes.dispose();this.quadIndexes=this.triIndexes=null;for(var a=0,b=this.textures.slice();a<b.length;){var c=b[a];++a;c.dispose()}a=0;for(b=this.depths.slice();a<b.length;)c=b[a],++a,c.dispose();a=0;for(b=this.buffers.slice();a<b.length;){c=b[a];for(++a;null!=c;)c.dispose(),c=c.next}a=0;for(b=this.indexes.slice();a<b.length;)c=b[a],++a,c.dispose();this.buffers=[];this.indexes=[];this.textures=[];this.texMemory=this.usedMemory=
this.bufferCount=0},freeMemorySize:function(){for(var a=0,b=0,c=this.buffers;b<c.length;){var d=c[b];for(++b;null!=d;){for(var e=d.freeList;null!=e;)a+=4*e.count*d.stride,e=e.next;d=d.next}}return a},stats:function(){for(var a=0,b=0,c=0,d=0,e=this.buffers;d<e.length;){var f=e[d];for(++d;null!=f;){for(var a=a+4*f.stride*f.size,g=f.freeList;null!=g;)b+=4*g.count*f.stride,g=g.next;++c;f=f.next}}return{bufferCount:this.bufferCount,freeManagedMemory:b,managedMemory:a,totalMemory:this.usedMemory+this.texMemory,
textureCount:this.textures.length,textureMemory:this.texMemory}},allocStats:function(){return[]},__class__:oe};var Qh=K["h3d.impl.Step"]={__ename__:!0,__constructs__:["BeforeLighting","BeforeTonemappingFX","BeforeTonemapping","AfterTonemapping","AfterUI"],BeforeLighting:{_hx_index:0,__enum__:"h3d.impl.Step",toString:m},BeforeTonemappingFX:{_hx_index:1,__enum__:"h3d.impl.Step",toString:m},BeforeTonemapping:{_hx_index:2,__enum__:"h3d.impl.Step",toString:m},AfterTonemapping:{_hx_index:3,__enum__:"h3d.impl.Step",
toString:m},AfterUI:{_hx_index:4,__enum__:"h3d.impl.Step",toString:m}};Qh.__empty_constructs__=[Qh.BeforeLighting,Qh.BeforeTonemappingFX,Qh.BeforeTonemapping,Qh.AfterTonemapping,Qh.AfterUI];var vj=function(){};r["h3d.impl.RendererFX"]=vj;vj.__name__="h3d.impl.RendererFX";vj.__isInterface__=!0;vj.prototype={__class__:vj};var jj=function(a){this.position=0;this.ctx=a;this.cache=[];this.defaultFormat=S.nativeFormat;this.defaultDepthBuffer=Od.getDefault()};r["h3d.impl.TextureCache"]=jj;jj.__name__="h3d.impl.TextureCache";
jj.prototype={get:function(a){null==a&&(a=0);return this.cache[a]},getNamed:function(a){for(var b=0,c=this.position;b<c;){var d=b++;if(this.cache[d].name==a)return this.cache[d]}return null},set:function(a,b){this.cache[b]=a},begin:function(){for(;this.cache.length>this.position;){var a=this.cache.pop();null!=a&&a.dispose()}this.position=0},lookupTarget:function(a,b,c,d,e){for(var f=this.cache[this.position],g=this.position+1,h=this.cache.length;g<h;){var k=g++,l=this.cache[k];if(null!=l&&!(null==
l.t&&null==l.realloc)&&l.width==b&&l.height==c&&l.format==d&&e==(0!=(l.flags&1<<V.Cube._hx_index)))return this.cache[this.position]=l,this.cache[k]=f,l}null!=f&&f.name==a&&(f.dispose(),f=null);a=[V.Target];e&&a.push(V.Cube);b=new S(b,c,a,d);null!=f?this.cache.splice(this.position,0,b):this.cache[this.position]=b;return b},allocTarget:function(a,b,c,d,e,f){null==f&&(f=!1);null==d&&(d=!0);var g=this.cache[this.position];null==e&&(e=this.defaultFormat);if(null==g||null==g.t&&null==g.realloc||g.width!=
b||g.height!=c||g.format!=e||f!=(0!=(g.flags&1<<V.Cube._hx_index)))g=this.lookupTarget(a,b,c,e,f);g.depthBuffer=d?this.defaultDepthBuffer:null;g.setName(a);this.position++;return g},allocTargetScale:function(a,b,c,d){null==c&&(c=!0);var e=X.CURRENT;return this.allocTarget(a,Math.ceil(e.width*b),Math.ceil(e.height*b),c,d)},allocTileTarget:function(a,b,c,d){null==c&&(c=!1);return this.allocTarget(a,Math.ceil(b.width+b.x)-Math.floor(b.x),Math.ceil(b.height+b.y)-Math.floor(b.y),c,d)},dispose:function(){for(var a=
0,b=this.cache;a<b.length;){var c=b[a];++a;c.dispose()}this.cache=[]},__class__:jj};var Kf=function(){};r["hxd.impl.AnyProps"]=Kf;Kf.__name__="hxd.impl.AnyProps";Kf.prototype={set_props:function(a){this.props=a;this.refreshProps();return a},setDefaultProps:function(a){this.set_props(this.getDefaultProps(a))},getDefaultProps:function(a){return{}},refreshProps:function(){},__class__:Kf};var re=function(a){null!=a&&this.addPass(new O("default",null)).addShader(a)};r["h3d.mat.BaseMaterial"]=re;re.__name__=
"h3d.mat.BaseMaterial";re.__interfaces__=[bc];re.__super__=Kf;re.prototype=J(Kf.prototype,{addPass:function(a){for(var b=null,c=this.passes;null!=c;)b=c,c=c.nextPass;null==b?this.passes=a:b.nextPass=a;a.nextPass=null;return a},removePass:function(a){for(var b=null,c=this.passes;null!=c;){if(c==a)return null==b?this.passes=a.nextPass:b.nextPass=a.nextPass,a.nextPass=null,!0;b=c;c=c.nextPass}return!1},get_mainPass:function(){return this.passes},getPasses:function(){for(var a=this.passes,b=[];null!=
a;)b.push(a),a=a.nextPass;return b},getPass:function(a){for(var b=this.passes;null!=b;){if(b.name==a)return b;b=b.nextPass}return null},allocPass:function(a,b){null==b&&(b=!0);var c=this.getPass(a);if(null!=c)return c;c=new O(a,null,b?this.passes:null);this.addPass(c);return c},clone:function(a){null==a&&(a=new re);a.passes.load(this.passes);a.name=this.name;a.set_props(this.props);return a},__class__:re});var Nb=K["h3d.mat.Face"]={__ename__:!0,__constructs__:["None","Back","Front","Both"],None:{_hx_index:0,
__enum__:"h3d.mat.Face",toString:m},Back:{_hx_index:1,__enum__:"h3d.mat.Face",toString:m},Front:{_hx_index:2,__enum__:"h3d.mat.Face",toString:m},Both:{_hx_index:3,__enum__:"h3d.mat.Face",toString:m}};Nb.__empty_constructs__=[Nb.None,Nb.Back,Nb.Front,Nb.Both];var Z=K["h3d.mat.Blend"]={__ename__:!0,__constructs__:"One Zero SrcAlpha SrcColor DstAlpha DstColor OneMinusSrcAlpha OneMinusSrcColor OneMinusDstAlpha OneMinusDstColor ConstantColor ConstantAlpha OneMinusConstantColor OneMinusConstantAlpha SrcAlphaSaturate".split(" "),
One:{_hx_index:0,__enum__:"h3d.mat.Blend",toString:m},Zero:{_hx_index:1,__enum__:"h3d.mat.Blend",toString:m},SrcAlpha:{_hx_index:2,__enum__:"h3d.mat.Blend",toString:m},SrcColor:{_hx_index:3,__enum__:"h3d.mat.Blend",toString:m},DstAlpha:{_hx_index:4,__enum__:"h3d.mat.Blend",toString:m},DstColor:{_hx_index:5,__enum__:"h3d.mat.Blend",toString:m},OneMinusSrcAlpha:{_hx_index:6,__enum__:"h3d.mat.Blend",toString:m},OneMinusSrcColor:{_hx_index:7,__enum__:"h3d.mat.Blend",toString:m},OneMinusDstAlpha:{_hx_index:8,
__enum__:"h3d.mat.Blend",toString:m},OneMinusDstColor:{_hx_index:9,__enum__:"h3d.mat.Blend",toString:m},ConstantColor:{_hx_index:10,__enum__:"h3d.mat.Blend",toString:m},ConstantAlpha:{_hx_index:11,__enum__:"h3d.mat.Blend",toString:m},OneMinusConstantColor:{_hx_index:12,__enum__:"h3d.mat.Blend",toString:m},OneMinusConstantAlpha:{_hx_index:13,__enum__:"h3d.mat.Blend",toString:m},SrcAlphaSaturate:{_hx_index:14,__enum__:"h3d.mat.Blend",toString:m}};Z.__empty_constructs__=[Z.One,Z.Zero,Z.SrcAlpha,Z.SrcColor,
Z.DstAlpha,Z.DstColor,Z.OneMinusSrcAlpha,Z.OneMinusSrcColor,Z.OneMinusDstAlpha,Z.OneMinusDstColor,Z.ConstantColor,Z.ConstantAlpha,Z.OneMinusConstantColor,Z.OneMinusConstantAlpha,Z.SrcAlphaSaturate];var Ab=K["h3d.mat.Compare"]={__ename__:!0,__constructs__:"Always Never Equal NotEqual Greater GreaterEqual Less LessEqual".split(" "),Always:{_hx_index:0,__enum__:"h3d.mat.Compare",toString:m},Never:{_hx_index:1,__enum__:"h3d.mat.Compare",toString:m},Equal:{_hx_index:2,__enum__:"h3d.mat.Compare",toString:m},
NotEqual:{_hx_index:3,__enum__:"h3d.mat.Compare",toString:m},Greater:{_hx_index:4,__enum__:"h3d.mat.Compare",toString:m},GreaterEqual:{_hx_index:5,__enum__:"h3d.mat.Compare",toString:m},Less:{_hx_index:6,__enum__:"h3d.mat.Compare",toString:m},LessEqual:{_hx_index:7,__enum__:"h3d.mat.Compare",toString:m}};Ab.__empty_constructs__=[Ab.Always,Ab.Never,Ab.Equal,Ab.NotEqual,Ab.Greater,Ab.GreaterEqual,Ab.Less,Ab.LessEqual];var Yb=K["h3d.mat.StencilOp"]={__ename__:!0,__constructs__:"Keep Zero Replace Increment IncrementWrap Decrement DecrementWrap Invert".split(" "),
Keep:{_hx_index:0,__enum__:"h3d.mat.StencilOp",toString:m},Zero:{_hx_index:1,__enum__:"h3d.mat.StencilOp",toString:m},Replace:{_hx_index:2,__enum__:"h3d.mat.StencilOp",toString:m},Increment:{_hx_index:3,__enum__:"h3d.mat.StencilOp",toString:m},IncrementWrap:{_hx_index:4,__enum__:"h3d.mat.StencilOp",toString:m},Decrement:{_hx_index:5,__enum__:"h3d.mat.StencilOp",toString:m},DecrementWrap:{_hx_index:6,__enum__:"h3d.mat.StencilOp",toString:m},Invert:{_hx_index:7,__enum__:"h3d.mat.StencilOp",toString:m}};
Yb.__empty_constructs__=[Yb.Keep,Yb.Zero,Yb.Replace,Yb.Increment,Yb.IncrementWrap,Yb.Decrement,Yb.DecrementWrap,Yb.Invert];var Rh=K["h3d.mat.MipMap"]={__ename__:!0,__constructs__:["None","Nearest","Linear"],None:{_hx_index:0,__enum__:"h3d.mat.MipMap",toString:m},Nearest:{_hx_index:1,__enum__:"h3d.mat.MipMap",toString:m},Linear:{_hx_index:2,__enum__:"h3d.mat.MipMap",toString:m}};Rh.__empty_constructs__=[Rh.None,Rh.Nearest,Rh.Linear];var Jd=K["h3d.mat.Filter"]={__ename__:!0,__constructs__:["Nearest",
"Linear"],Nearest:{_hx_index:0,__enum__:"h3d.mat.Filter",toString:m},Linear:{_hx_index:1,__enum__:"h3d.mat.Filter",toString:m}};Jd.__empty_constructs__=[Jd.Nearest,Jd.Linear];var Ef=K["h3d.mat.Wrap"]={__ename__:!0,__constructs__:["Clamp","Repeat"],Clamp:{_hx_index:0,__enum__:"h3d.mat.Wrap",toString:m},Repeat:{_hx_index:1,__enum__:"h3d.mat.Wrap",toString:m}};Ef.__empty_constructs__=[Ef.Clamp,Ef.Repeat];var xa=K["h3d.mat.Operation"]={__ename__:!0,__constructs__:["Add","Sub","ReverseSub","Min","Max"],
Add:{_hx_index:0,__enum__:"h3d.mat.Operation",toString:m},Sub:{_hx_index:1,__enum__:"h3d.mat.Operation",toString:m},ReverseSub:{_hx_index:2,__enum__:"h3d.mat.Operation",toString:m},Min:{_hx_index:3,__enum__:"h3d.mat.Operation",toString:m},Max:{_hx_index:4,__enum__:"h3d.mat.Operation",toString:m}};xa.__empty_constructs__=[xa.Add,xa.Sub,xa.ReverseSub,xa.Min,xa.Max];var V=K["h3d.mat.TextureFlags"]={__ename__:!0,__constructs__:"Target Cube MipMapped ManualMipMapGen IsNPOT NoAlloc Dynamic AlphaPremultiplied WasCleared Loading Serialize IsArray".split(" "),
Target:{_hx_index:0,__enum__:"h3d.mat.TextureFlags",toString:m},Cube:{_hx_index:1,__enum__:"h3d.mat.TextureFlags",toString:m},MipMapped:{_hx_index:2,__enum__:"h3d.mat.TextureFlags",toString:m},ManualMipMapGen:{_hx_index:3,__enum__:"h3d.mat.TextureFlags",toString:m},IsNPOT:{_hx_index:4,__enum__:"h3d.mat.TextureFlags",toString:m},NoAlloc:{_hx_index:5,__enum__:"h3d.mat.TextureFlags",toString:m},Dynamic:{_hx_index:6,__enum__:"h3d.mat.TextureFlags",toString:m},AlphaPremultiplied:{_hx_index:7,__enum__:"h3d.mat.TextureFlags",
toString:m},WasCleared:{_hx_index:8,__enum__:"h3d.mat.TextureFlags",toString:m},Loading:{_hx_index:9,__enum__:"h3d.mat.TextureFlags",toString:m},Serialize:{_hx_index:10,__enum__:"h3d.mat.TextureFlags",toString:m},IsArray:{_hx_index:11,__enum__:"h3d.mat.TextureFlags",toString:m}};V.__empty_constructs__=[V.Target,V.Cube,V.MipMapped,V.ManualMipMapGen,V.IsNPOT,V.NoAlloc,V.Dynamic,V.AlphaPremultiplied,V.WasCleared,V.Loading,V.Serialize,V.IsArray];var Xb=function(){};r["h3d.mat.Defaults"]=Xb;Xb.__name__=
"h3d.mat.Defaults";Xb.get_shadowShader=function(){var a=Xb.shadowShader;null==a&&(a=new Qg,Xb.set_shadowShader(a),Xb.shadowShader.setPriority(-1));return a};Xb.set_shadowShader=function(a){return Xb.shadowShader=a};Xb.makeVolumeDecal=function(a){return new Lf(a.xMax-a.xMin,a.yMax-a.yMin)};var Oh=K["h3d.mat.DepthFormat"]={__ename__:!0,__constructs__:["Depth16","Depth24","Depth24Stencil8"],Depth16:{_hx_index:0,__enum__:"h3d.mat.DepthFormat",toString:m},Depth24:{_hx_index:1,__enum__:"h3d.mat.DepthFormat",
toString:m},Depth24Stencil8:{_hx_index:2,__enum__:"h3d.mat.DepthFormat",toString:m}};Oh.__empty_constructs__=[Oh.Depth16,Oh.Depth24,Oh.Depth24Stencil8];var Od=function(a,b,c){this.width=a;this.height=b;this.format=c;0<a&&this.alloc()};r["h3d.mat.DepthBuffer"]=Od;Od.__name__="h3d.mat.DepthBuffer";Od.getDefault=function(){return X.CURRENT.driver.getDefaultDepthBuffer()};Od.prototype={hasStencil:function(){switch(this.format._hx_index){case 0:case 1:return!1;case 2:return!0}},alloc:function(){X.CURRENT.mem.allocDepth(this)},
dispose:function(){null!=this.b&&(X.CURRENT.mem.deleteDepth(this),this.b=null)},isDisposed:function(){return null==this.b},__class__:Od};var Nf=function(a){this.mshader=new Mf;this.set_blendMode(ra.None);re.call(this,this.mshader);this.set_texture(a)};r["h3d.mat.Material"]=Nf;Nf.__name__="h3d.mat.Material";Nf.create=function(a){var b=uc.current.createMaterial();b.set_texture(a);b.set_props(b.getDefaultProps());return b};Nf.__super__=re;Nf.prototype=J(re.prototype,{get_specularPower:function(){return this.mshader.specularPower__},
set_specularPower:function(a){return this.mshader.specularPower__=a},get_specularAmount:function(){return this.mshader.specularAmount__},set_specularAmount:function(a){return this.mshader.specularAmount__=a},get_color:function(){return this.mshader.color__},set_color:function(a){return this.mshader.color__=a},get_shadows:function(){return this.castShadows?this.receiveShadows:!1},set_shadows:function(a){this.set_castShadows(a);this.set_receiveShadows(a);return a},set_castShadows:function(a){if(this.castShadows==
a)return a;null!=this.passes&&(a?this.addPass(new O("shadow",null,this.passes)).set_isStatic(this.staticShadows):this.removePass(this.getPass("shadow")));return this.castShadows=a},set_receiveShadows:function(a){if(a==this.receiveShadows)return a;if(null!=this.passes){var b=Xb.get_shadowShader();a?this.passes.addShader(b):this.passes.removeShader(b)}return this.receiveShadows=a},set_staticShadows:function(a){var b=this.getPass("shadow");null!=b&&b.set_isStatic(a);return this.staticShadows=a},clone:function(a){a=
null==a?new Nf:a;re.prototype.clone.call(this,a);a.set_castShadows(this.castShadows);a.set_receiveShadows(this.receiveShadows);a.set_texture(this.get_texture());a.set_specularTexture(this.get_specularTexture());a.set_normalMap(this.get_normalMap());if(null!=this.textureShader){var b=a.textureShader;b.constModified=!0;b.additive__=this.textureShader.additive__;b=a.textureShader;b.constModified=!0;b.killAlpha__=this.textureShader.killAlpha__;a.textureShader.killAlphaThreshold__=this.textureShader.killAlphaThreshold__}a.mshader.color__=
this.mshader.color__;a.set_blendMode(this.blendMode);return a},set_blendMode:function(a){if(null!=this.passes)switch(this.passes.setBlendMode(a),a._hx_index){case 0:this.passes.set_depthWrite(!0);this.passes.setPassName("default");break;case 1:this.passes.set_depthWrite(!0);this.passes.setPassName("alpha");break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:this.passes.set_depthWrite(!1),this.passes.setPassName("additive")}return this.blendMode=a},get_specularTexture:function(){return null==
this.specularShader?null:this.specularShader.texture__},get_texture:function(){return null==this.textureShader?null:this.textureShader.texture__},set_texture:function(a){null==a?null!=this.textureShader&&(this.passes.removeShader(this.textureShader),this.textureShader=null):(null==this.textureShader&&(this.textureShader=new Of,this.passes.addShader(this.textureShader)),this.textureShader.texture__=a);return a},get_normalMap:function(){return null==this.normalShader?null:this.normalShader.texture__},
set_normalMap:function(a){null==a?null!=this.normalShader&&(this.passes.removeShader(this.normalShader),this.normalShader=null):(null==this.normalShader&&(this.normalShader=new Pf,null!=this.textureShader?this.passes.addShaderAtIndex(this.normalShader,this.passes.getShaderIndex(this.textureShader)+1):this.passes.addShader(this.normalShader)),this.normalShader.texture__=a);return a},set_specularTexture:function(a){null==a?null!=this.specularShader&&(this.passes.removeShader(this.specularShader),this.specularShader=
null):(null==this.specularShader&&(this.specularShader=new Qf,this.passes.addShader(this.specularShader)),this.specularShader.texture__=a);return a},getDefaultModelProps:function(){var a=this.getDefaultProps();switch(this.blendMode._hx_index){case 0:break;case 1:a.kind="Alpha";break;case 2:a.kind="Add";a.culling=!1;a.shadows=!1;a.light=!1;break;default:throw new q("Unsupported HMD material "+n.string(this.blendMode));}return a},getDefaultProps:function(a){if(null==a)a={kind:"Opaque",shadows:!0,culling:!0,
light:!0};else switch(a){case "particles3D":case "trail3D":a={kind:"Alpha",shadows:!1,culling:!1,light:!0};break;case "ui":a={kind:"Alpha",shadows:!1,culling:!1,light:!1};break;default:a={kind:"Opaque",shadows:!0,culling:!0,light:!0}}return a},refreshProps:function(){if(!(null==this.props||null==this.passes)){var a=this.props;switch(a.kind){case "Add":this.set_blendMode(ra.Add);break;case "Alpha":this.set_blendMode(ra.Alpha);break;case "AlphaKill":case "Hidden":case "Opaque":this.set_blendMode(ra.None);
break;case "SoftAdd":this.set_blendMode(ra.SoftAdd)}var b=this.textureShader;null!=b&&(b.constModified=!0,b.killAlpha__="AlphaKill"==a.kind,b.killAlphaThreshold__=0.5);this.passes.set_culling("Hidden"==a.kind?Nb.Both:a.culling?Nb.Back:Nb.None);this.passes.set_enableLights(a.light);a=a.shadows;this.set_castShadows(a);this.set_receiveShadows(a);this.castShadows&&this.receiveShadows&&this.getPass("shadow").set_culling(this.passes.culling)}},__class__:Nf});var wj=function(){this.db=new ga};r["h3d.mat.MaterialDatabase"]=
wj;wj.__name__="h3d.mat.MaterialDatabase";wj.prototype={getFilePath:function(a){return a.entry.get_directory()+"/materials.props"},getModelData:function(a){if(null==a)return null;var b=this.db,c=a.entry.get_directory(),b=null!=Q[c]?b.getReserved(c):b.h[c];if(null!=b)return b.v;var b=this.getFilePath(a),d;try{d=JSON.parse(Pd.currentInstance.load(b).toText())}catch(e){if($.lastException=e,(e instanceof q?e.val:e)instanceof xj)d={};else throw e;}b=this.db;a=a.entry.get_directory();c={v:d};null!=Q[a]?
b.setReserved(a,c):b.h[a]=c;return d},saveData:function(a,b){var c=this.getFilePath(a);throw new q("Can't save material props database "+c);},loadMatProps:function(a,b){var c=this.getModelData(a.model);if(null==c)return c;c=c.materials;if(null==c)return c;c=ua.field(c,b.name);return null==c?c:ua.field(c,a.name)},saveMatProps:function(a,b){var c=["materials",b.name,a.name],d=this.getModelData(a.model);if(null!=d){for(var e=d,f=[],g=0,h=c.length-1;g<h;){var k=g++,l=ua.field(d,c[k]);null==l&&(l={},d[c[k]]=
l);f.push(d);d=l}g=c.pop();ua.deleteField(d,g);h=a.props;k=a.getDefaultProps();if(null==h||n.string(k)==n.string(h))for(;0<c.length;){d=c.pop();g=f.pop();if(0!=ua.fields(ua.field(g,d)).length)break;ua.deleteField(g,d)}else d[g]=h;this.getFilePath(a.model);0==ua.fields(e).length&&(e=null);this.saveData(a.model,e)}},__class__:wj};var uc=function(a){null==this.database&&(this.database=new wj);this.name=a};r["h3d.mat.MaterialSetup"]=uc;uc.__name__="h3d.mat.MaterialSetup";uc.prototype={createRenderer:function(){return new Sh},
createLightSystem:function(){return new Th},createMaterial:function(){return new Nf},getDefaults:function(a){null==this.emptyMat&&(this.emptyMat=this.createMaterial());return this.emptyMat.getDefaultProps(a)},loadMaterialProps:function(a){return this.database.loadMatProps(a,this)},saveMaterialProps:function(a){this.database.saveMatProps(a,this)},customMeshInit:function(a){},__class__:uc};var O=function(a,b,c){this.bits=this.layer=0;this.parentPass=c;this.shaders=b;this.setPassName(a);this.set_culling(Nb.Back);
a=Z.One;b=Z.Zero;this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b);this.depth(!0,Ab.Less);this.set_blendOp(this.set_blendAlphaOp(xa.Add));this.colorMask=15};r["h3d.mat.Pass"]=O;O.__name__="h3d.mat.Pass";O.__interfaces__=[bc];O.getEnableLights=function(a){return a&1};O.getDynamicParameters=function(a){return a>>1&1};O.getIsStatic=function(a){return a>>2&1};O.getBatchMode=function(a){return a>>3&1};O.getCulling=function(a){return a&3};O.getDepthWrite=function(a){return a>>
2&1};O.getDepthTest=function(a){return a>>3&7};O.getBlendSrc=function(a){return a>>6&15};O.getBlendDst=function(a){return a>>10&15};O.getBlendAlphaSrc=function(a){return a>>14&15};O.getBlendAlphaDst=function(a){return a>>18&15};O.getBlendOp=function(a){return a>>22&7};O.getBlendAlphaOp=function(a){return a>>25&7};O.getWireframe=function(a){return a>>28&1};O.getReserved=function(a){return a>>29&1};O.prototype={load:function(a){this.name=a.name;this.passId=a.passId;this.bits=a.bits;this.set_enableLights(a.enableLights);
this.set_dynamicParameters(a.dynamicParameters);this.set_culling(a.culling);this.set_depthWrite(a.depthWrite);this.set_depthTest(a.depthTest);this.set_blendSrc(a.blendSrc);this.set_blendDst(a.blendDst);this.set_blendOp(a.blendOp);this.set_blendAlphaSrc(a.blendAlphaSrc);this.set_blendAlphaDst(a.blendAlphaDst);this.set_blendAlphaOp(a.blendAlphaOp);this.colorMask=a.colorMask;null!=a.stencil&&(null==this.stencil&&(this.stencil=new ja),this.stencil.load(a.stencil))},setPassName:function(a){this.name=a;
this.passId=qa.allocID(a)},blend:function(a,b){this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b)},setBlendMode:function(a){switch(a._hx_index){case 0:a=Z.One;var b=Z.Zero;this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b);this.set_blendOp(xa.Add);this.set_blendAlphaOp(xa.Add);break;case 1:a=Z.SrcAlpha;b=Z.OneMinusSrcAlpha;this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b);
this.set_blendOp(xa.Add);this.set_blendAlphaOp(xa.Add);break;case 2:a=Z.SrcAlpha;b=Z.One;this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b);this.set_blendOp(xa.Add);this.set_blendAlphaOp(xa.Add);break;case 3:a=Z.One;b=Z.OneMinusSrcAlpha;this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b);this.set_blendOp(xa.Add);this.set_blendAlphaOp(xa.Add);break;case 4:a=Z.OneMinusDstColor;b=Z.One;this.set_blendSrc(a);this.set_blendAlphaSrc(a);
this.set_blendDst(b);this.set_blendAlphaDst(b);this.set_blendOp(xa.Add);this.set_blendAlphaOp(xa.Add);break;case 5:a=Z.DstColor;b=Z.Zero;this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b);this.set_blendOp(xa.Add);this.set_blendAlphaOp(xa.Add);break;case 6:a=Z.DstColor;b=Z.OneMinusSrcAlpha;this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b);this.set_blendOp(xa.Add);this.set_blendAlphaOp(xa.Add);break;case 7:a=Z.Zero;
b=Z.OneMinusSrcColor;this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b);this.set_blendOp(xa.Add);this.set_blendAlphaOp(xa.Add);break;case 8:a=Z.One;b=Z.OneMinusSrcColor;this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b);this.set_blendOp(xa.Add);this.set_blendAlphaOp(xa.Add);break;case 9:a=Z.SrcAlpha;b=Z.One;this.set_blendSrc(a);this.set_blendAlphaSrc(a);this.set_blendDst(b);this.set_blendAlphaDst(b);this.set_blendOp(xa.ReverseSub);
this.set_blendAlphaOp(xa.ReverseSub);break;case 10:this.set_blendSrc(Z.Zero);this.set_blendAlphaSrc(Z.Zero);this.set_blendDst(Z.Zero);this.set_blendAlphaDst(Z.Zero);this.set_blendAlphaSrc(Z.Zero);this.set_blendAlphaDst(Z.Zero);this.set_blendAlphaOp(xa.Max);this.set_blendOp(xa.Max);break;case 11:this.set_blendSrc(Z.Zero),this.set_blendAlphaSrc(Z.Zero),this.set_blendDst(Z.Zero),this.set_blendAlphaDst(Z.Zero),this.set_blendAlphaSrc(Z.Zero),this.set_blendAlphaDst(Z.Zero),this.set_blendAlphaOp(xa.Min),
this.set_blendOp(xa.Min)}},depth:function(a,b){this.set_depthWrite(a);this.set_depthTest(b)},setColorMask:function(a,b,c,d){this.colorMask=(a?1:0)|(b?2:0)|(c?4:0)|(d?8:0)},setColorChannel:function(a){switch(a._hx_index){case 1:this.setColorMask(!0,!1,!1,!1);break;case 2:this.setColorMask(!1,!0,!1,!1);break;case 3:this.setColorMask(!1,!1,!0,!1);break;case 4:this.setColorMask(!1,!1,!1,!0);break;default:throw new q("Unsupported channel "+n.string(a));}},addShader:function(a){if(null==a)return null;this.shaders=
Gb.addSort(a,this.shaders);return a},addShaderAtIndex:function(a,b){for(var c=null,d=this.shaders;0<b&&d!=this.parentShaders;)c=d,d=d.next,--b;null==c?this.shaders=new Gb(a,d):c.next=new Gb(a,d);return a},getShaderIndex:function(a){for(var b=0,c=this.shaders;c!=this.parentShaders;){if(c.s==a)return b;c=c.next;++b}return-1},removeShader:function(a){for(var b=this.shaders,c=null;null!=b;){if(b.s==a)return null==c?this.shaders=b.next:c.next=b.next,!0;c=b;b=b.next}return!1},getShader:function(a){for(var b=
this.shaders;b!=this.parentShaders;){var c=b.s,c=ia.__downcastCheck(c,a)?c:null;if(null!=c)return c;b=b.next}return null},getShaderByName:function(a){for(var b=this.shaders;b!=this.parentShaders;){if(b.s.shader.data.name==a)return b.s;b=b.next}return null},getShaders:function(){return new Cf(this.shaders,this.parentShaders)},getShadersRec:function(){if(null==this.parentPass||this.parentShaders==this.parentPass.shaders)return this.shaders;for(var a=this.shaders,b=null;null!=a&&a!=this.parentShaders;)b=
a,a=a.next;this.parentShaders=this.parentPass.shaders;null==b?this.shaders=this.parentShaders:b.next=this.parentShaders;return this.shaders},clone:function(){var a=new O(this.name,this.shaders.clone());a.bits=this.bits;a.set_enableLights(this.enableLights);null!=this.stencil&&(a.stencil=this.stencil.clone());return a},getDebugShaderCode:function(a,b){null==b&&(b=!0);var c=a.renderer.debugCompileShader(this);return b?"// vertex:\n"+aa.shaderToString(c.vertex.data,!0)+"\n\nfragment:\n"+aa.shaderToString(c.fragment.data,
!0):X.CURRENT.driver.getNativeShaderCode(c)},set_enableLights:function(a){this.flags=this.flags&-2|(a?1:0);return this.enableLights=a},set_dynamicParameters:function(a){this.flags=this.flags&-3|(a?1:0)<<1;return this.dynamicParameters=a},set_isStatic:function(a){this.flags=this.flags&-5|(a?1:0)<<2;return this.isStatic=a},set_batchMode:function(a){this.flags=this.flags&-9|(a?1:0)<<3;return this.batchMode=a},set_culling:function(a){this.bits=this.bits&-4|a._hx_index;return this.culling=a},set_depthWrite:function(a){this.bits=
this.bits&-5|(a?1:0)<<2;return this.depthWrite=a},set_depthTest:function(a){this.bits=this.bits&-57|a._hx_index<<3;return this.depthTest=a},set_blendSrc:function(a){this.bits=this.bits&-961|a._hx_index<<6;return this.blendSrc=a},set_blendDst:function(a){this.bits=this.bits&-15361|a._hx_index<<10;return this.blendDst=a},set_blendAlphaSrc:function(a){this.bits=this.bits&-245761|a._hx_index<<14;return this.blendAlphaSrc=a},set_blendAlphaDst:function(a){this.bits=this.bits&-3932161|a._hx_index<<18;return this.blendAlphaDst=
a},set_blendOp:function(a){this.bits=this.bits&-29360129|a._hx_index<<22;return this.blendOp=a},set_blendAlphaOp:function(a){this.bits=this.bits&-234881025|a._hx_index<<25;return this.blendAlphaOp=a},set_wireframe:function(a){this.bits=this.bits&-268435457|(a?1:0)<<28;return this.wireframe=a},set_reserved:function(a){this.bits=this.bits&-536870913|(a?1:0)<<29;return this.reserved=a},loadFlags:function(a){this.flags=a;this.set_enableLights(0!=(this.flags&1));this.set_dynamicParameters(0!=(this.flags>>
1&1));this.set_isStatic(0!=(this.flags>>2&1));this.set_batchMode(0!=(this.flags>>3&1))},loadBits:function(a){this.bits=a;this.set_culling(Fa.createEnumIndex(Nb,this.bits&3));this.set_depthWrite(0!=(this.bits>>2&1));this.set_depthTest(Fa.createEnumIndex(Ab,this.bits>>3&7));this.set_blendSrc(Fa.createEnumIndex(Z,this.bits>>6&15));this.set_blendDst(Fa.createEnumIndex(Z,this.bits>>10&15));this.set_blendAlphaSrc(Fa.createEnumIndex(Z,this.bits>>14&15));this.set_blendAlphaDst(Fa.createEnumIndex(Z,this.bits>>
18&15));this.set_blendOp(Fa.createEnumIndex(xa,this.bits>>22&7));this.set_blendAlphaOp(Fa.createEnumIndex(xa,this.bits>>25&7));this.set_wireframe(0!=(this.bits>>28&1));this.set_reserved(0!=(this.bits>>29&1))},__class__:O};var ja=function(){this.maskBits=this.opBits=0;this.setOp(Yb.Keep,Yb.Keep,Yb.Keep);this.setFunc(Ab.Always)};r["h3d.mat.Stencil"]=ja;ja.__name__="h3d.mat.Stencil";ja.__interfaces__=[bc];ja.getReadMask=function(a){return a&255};ja.getWriteMask=function(a){return a>>8&255};ja.getReference=
function(a){return a>>16&255};ja.getFrontTest=function(a){return a&7};ja.getFrontPass=function(a){return a>>3&7};ja.getFrontSTfail=function(a){return a>>6&7};ja.getFrontDPfail=function(a){return a>>9&7};ja.getBackTest=function(a){return a>>12&7};ja.getBackPass=function(a){return a>>15&7};ja.getBackSTfail=function(a){return a>>18&7};ja.getBackDPfail=function(a){return a>>21&7};ja.prototype={setFront:function(a,b,c){this.set_frontSTfail(a);this.set_frontDPfail(b);this.set_frontPass(c)},setBack:function(a,
b,c){this.set_backSTfail(a);this.set_backDPfail(b);this.set_backPass(c)},setOp:function(a,b,c){this.setFront(a,b,c);this.setBack(a,b,c)},setFunc:function(a,b,c,d){null==d&&(d=255);null==c&&(c=255);null==b&&(b=0);this.set_frontTest(this.set_backTest(a));this.set_reference(b);this.set_readMask(c);this.set_writeMask(d)},clone:function(){var a=new ja;a.opBits=this.opBits;a.maskBits=this.maskBits;return a},load:function(a){this.opBits=a.opBits;this.maskBits=a.maskBits},set_readMask:function(a){this.maskBits=
this.maskBits&-256|a&255;return this.readMask=a},set_writeMask:function(a){this.maskBits=this.maskBits&-65281|(a&255)<<8;return this.writeMask=a},set_reference:function(a){this.maskBits=this.maskBits&-16711681|(a&255)<<16;return this.reference=a},set_frontTest:function(a){this.opBits=this.opBits&-8|a._hx_index;return this.frontTest=a},set_frontPass:function(a){this.opBits=this.opBits&-57|a._hx_index<<3;return this.frontPass=a},set_frontSTfail:function(a){this.opBits=this.opBits&-449|a._hx_index<<
6;return this.frontSTfail=a},set_frontDPfail:function(a){this.opBits=this.opBits&-3585|a._hx_index<<9;return this.frontDPfail=a},set_backTest:function(a){this.opBits=this.opBits&-28673|a._hx_index<<12;return this.backTest=a},set_backPass:function(a){this.opBits=this.opBits&-229377|a._hx_index<<15;return this.backPass=a},set_backSTfail:function(a){this.opBits=this.opBits&-1835009|a._hx_index<<18;return this.backSTfail=a},set_backDPfail:function(a){this.opBits=this.opBits&-14680065|a._hx_index<<21;
return this.backDPfail=a},loadOpBits:function(a){this.opBits=a;this.set_frontTest(Fa.createEnumIndex(Ab,this.opBits&7));this.set_frontPass(Fa.createEnumIndex(Yb,this.opBits>>3&7));this.set_frontSTfail(Fa.createEnumIndex(Yb,this.opBits>>6&7));this.set_frontDPfail(Fa.createEnumIndex(Yb,this.opBits>>9&7));this.set_backTest(Fa.createEnumIndex(Ab,this.opBits>>12&7));this.set_backPass(Fa.createEnumIndex(Yb,this.opBits>>15&7));this.set_backSTfail(Fa.createEnumIndex(Yb,this.opBits>>18&7));this.set_backDPfail(Fa.createEnumIndex(Yb,
this.opBits>>21&7))},loadMaskBits:function(a){this.maskBits=a;this.set_readMask(this.maskBits&255);this.set_writeMask(this.maskBits>>8&255);this.set_reference(this.maskBits>>16&255)},__class__:ja};var ha=K["hxd.PixelFormat"]={__ename__:!0,__constructs__:"ARGB BGRA RGBA RGBA16F RGBA32F R8 R16F R32F RG8 RG16F RG32F RGB8 RGB16F RGB32F SRGB SRGB_ALPHA RGB10A2 RG11B10UF S3TC".split(" "),ARGB:{_hx_index:0,__enum__:"hxd.PixelFormat",toString:m},BGRA:{_hx_index:1,__enum__:"hxd.PixelFormat",toString:m},RGBA:{_hx_index:2,
__enum__:"hxd.PixelFormat",toString:m},RGBA16F:{_hx_index:3,__enum__:"hxd.PixelFormat",toString:m},RGBA32F:{_hx_index:4,__enum__:"hxd.PixelFormat",toString:m},R8:{_hx_index:5,__enum__:"hxd.PixelFormat",toString:m},R16F:{_hx_index:6,__enum__:"hxd.PixelFormat",toString:m},R32F:{_hx_index:7,__enum__:"hxd.PixelFormat",toString:m},RG8:{_hx_index:8,__enum__:"hxd.PixelFormat",toString:m},RG16F:{_hx_index:9,__enum__:"hxd.PixelFormat",toString:m},RG32F:{_hx_index:10,__enum__:"hxd.PixelFormat",toString:m},
RGB8:{_hx_index:11,__enum__:"hxd.PixelFormat",toString:m},RGB16F:{_hx_index:12,__enum__:"hxd.PixelFormat",toString:m},RGB32F:{_hx_index:13,__enum__:"hxd.PixelFormat",toString:m},SRGB:{_hx_index:14,__enum__:"hxd.PixelFormat",toString:m},SRGB_ALPHA:{_hx_index:15,__enum__:"hxd.PixelFormat",toString:m},RGB10A2:{_hx_index:16,__enum__:"hxd.PixelFormat",toString:m},RG11B10UF:{_hx_index:17,__enum__:"hxd.PixelFormat",toString:m},S3TC:(s=function(a){return{_hx_index:18,v:a,__enum__:"hxd.PixelFormat",toString:m}},
s.__params__=["v"],s)};ha.__empty_constructs__=[ha.ARGB,ha.BGRA,ha.RGBA,ha.RGBA16F,ha.RGBA32F,ha.R8,ha.R16F,ha.R32F,ha.RG8,ha.RG16F,ha.RG32F,ha.RGB8,ha.RGB16F,ha.RGB32F,ha.SRGB,ha.SRGB_ALPHA,ha.RGB10A2,ha.RG11B10UF];var S=function(a,b,c,d){this.mem=X.CURRENT.mem;null==d&&(d=S.nativeFormat);this.id=++S.UID;this.format=d;this.flags=0;if(null!=c)for(d=0;d<c.length;){var e=c[d];++d;this.flags|=1<<e._hx_index}for(d=c=1;c<a;)c<<=1;for(;d<b;)d<<=1;if(c!=a||d!=b)this.flags|=1<<V.IsNPOT._hx_index;0!=(this.flags&
1<<V.Target._hx_index)&&(this.realloc=function(){});this.width=a;this.height=b;this.set_mipMap(0!=(this.flags&1<<V.MipMapped._hx_index)?Rh.Nearest:Rh.None);this.set_filter(Jd.Linear);this.set_wrap(Ef.Clamp);this.bits&=32767;0==(this.flags&1<<V.NoAlloc._hx_index)&&this.alloc()};r["h3d.mat.Texture"]=S;S.__name__="h3d.mat.Texture";S.fromBitmap=function(a){var b=new S(a.ctx.canvas.width,a.ctx.canvas.height);b.uploadBitmap(a);return b};S.fromPixels=function(a){var b=new S(a.width,a.height);b.uploadPixels(a);
return b};S.fromColor=function(a,b){null==b&&(b=1);var c=X.CURRENT,d=255*b|0;0>d?d=0:255<d&&(d=255);var d=a&16777215|d<<24,e=c.textureColorCache.h[d];if(null!=e)return e;var f=new S(1,1,null);f.clear(a,b);f.realloc=function(){f.clear(a,b)};return c.textureColorCache.h[d]=f};S.genDisc=function(a,b,c){null==c&&(c=1);return S.genTexture(0,a,b,c)};S.genTexture=function(a,b,c,d){var e=X.CURRENT;d=255*d|0;0>d?d=0:255<d&&(d=255);c=c&16777215|d<<24;d=(b<<16|a)+","+c;var f=S.genTextureKeys,f=null!=Q[d]?f.getReserved(d):
f.h[d],g=null==f?null:e.resCache.h[f.__id__];if(null!=g)return g;if(null==f){var f={},h=S.genTextureKeys;null!=Q[d]?h.setReserved(d,f):h.h[d]=f}g=new S(b,b,[V.Target]);g.realloc=function(){S.drawGenTexture(g,c,a)};S.drawGenTexture(g,c,a);e.resCache.set(f,g);return g};S.drawGenTexture=function(a,b,c){var d=new pb(new Rf),e=X.CURRENT,f=d.shader;f.constModified=!0;f.mode__=c;c=d.shader.color__;c.x=(b>>16&255)/255;c.y=(b>>8&255)/255;c.z=(b&255)/255;c.w=(b>>>24)/255;e.pushTarget(a);d.render();e.popTarget()};
S.defaultCubeTexture=function(){var a=X.CURRENT,b=a.resCache.h[S.__id__];if(null!=b)return b;b=new S(1,1,[V.Cube]);b.clear(2105376);b.realloc=function(){b.clear(2105376)};a.resCache.set(S,b);return b};S.genChecker=function(a){var b=X.CURRENT,c=S.checkerTextureKeys.h[a],d=null==c?null:b.resCache.h[c.__id__];if(null!=d&&!(null==d.t&&null==d.realloc))return d;null==c&&(c={},S.checkerTextureKeys.h[a]=c);var e=new S(a,a,[V.NoAlloc]);e.realloc=function(){S.allocChecker(e,a)};b.resCache.set(c,e);return e};
S.genNoise=function(a){var b=X.CURRENT,c=S.noiseTextureKeys.h[a],d=null==c?null:b.resCache.h[c.__id__];if(null!=d&&!(null==d.t&&null==d.realloc))return d;null==c&&(c={},S.noiseTextureKeys.h[a]=c);var e=new S(a,a,[V.NoAlloc]);e.realloc=function(){S.allocNoise(e,a)};b.resCache.set(c,e);return e};S.allocNoise=function(a,b){for(var c=new ud(b,b),d=0;d<b;)for(var e=d++,f=0,g=b;f<g;){var h=f++,k=n.random(256);c.setPixel(e,h,-16777216|k|k<<8|k<<16)}a.uploadBitmap(c);c.ctx=null;c.pixel=null};S.allocChecker=
function(a,b){var c=new ud(b,b);c.clear(-1);for(var d=0,e=b>>1;d<e;)for(var f=d++,g=0,h=b>>1;g<h;){var k=g++;c.setPixel(f,k,-16777216);c.setPixel(f+(b>>1),k+(b>>1),-16777216)}a.uploadBitmap(c);c.ctx=null;c.pixel=null};S.prototype={set_lastFrame:function(a){this._lastFrame!=S.PREVENT_AUTO_DISPOSE&&(this._lastFrame=a);return this._lastFrame},get_lastFrame:function(){return this._lastFrame},get_layerCount:function(){return 0!=(this.flags&1<<V.Cube._hx_index)?6:1},alloc:function(){null==this.t&&this.mem.allocTexture(this)},
isSRGB:function(){switch(this.format._hx_index){case 14:case 15:return!0;default:return!1}},checkAlloc:function(){null==this.t&&null!=this.realloc&&(this.alloc(),this.realloc())},clone:function(){this.checkAlloc();if(null==this.t)throw new q("Can't clone disposed texture");var a=this.get_lastFrame();this.preventAutoDispose();var b=[],c=V.Target;0!=(this.flags&1<<c._hx_index)&&b.push(c);c=V.Cube;0!=(this.flags&1<<c._hx_index)&&b.push(c);c=V.MipMapped;0!=(this.flags&1<<c._hx_index)&&b.push(c);c=V.IsArray;
0!=(this.flags&1<<c._hx_index)&&b.push(c);b=new S(this.width,this.height,b,this.format);b.name=this.name;0!=(this.flags&1<<V.Cube._hx_index)?Qd.run(this,b):vc.run(this,b);this.set_lastFrame(a);return b},preventAutoDispose:function(){this.set_lastFrame(S.PREVENT_AUTO_DISPOSE)},waitLoad:function(a){0==(this.flags&1<<V.Loading._hx_index)?a():(null==this.waitLoads&&(this.waitLoads=[]),this.waitLoads.push(a))},toString:function(){var a=this.name;null==this.name&&(a="Texture_"+this.id);return a+"("+this.width+
"x"+this.height+")"},setName:function(a){this.name=a},set_mipMap:function(a){this.bits=this.bits&-4|a._hx_index;return this.mipMap=a},set_filter:function(a){this.bits=this.bits&-25|a._hx_index<<3;return this.filter=a},set_wrap:function(a){this.bits=this.bits&-193|a._hx_index<<6;return this.wrap=a},isDisposed:function(){return null==this.t?null==this.realloc:!1},resize:function(a,b){this.dispose();for(var c=1,d=1;c<a;)c<<=1;for(;d<b;)d<<=1;this.flags=c!=a||d!=b?this.flags|1<<V.IsNPOT._hx_index:this.flags&
-1-(1<<V.IsNPOT._hx_index);this.width=a;this.height=b;0==(this.flags&1<<V.NoAlloc._hx_index)&&this.alloc()},clearF:function(a,b,c,d,e){null==e&&(e=-1);null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.alloc();if(0==(this.flags&1<<V.Target._hx_index))throw new q("Texture should be target");var f=X.CURRENT;a=new B(a,b,c,d);if(0>e){e=0;for(b=this.get_layerCount();e<b;)c=e++,f.pushTarget(this,c),f.clearF(a),f.popTarget()}else f.pushTarget(this,e),f.clearF(a),f.popTarget()},clear:function(a,
b,c){null==c&&(c=-1);null==b&&(b=1);this.alloc();if(1!=this.width||1!=this.height){var d=X.CURRENT;a|=(255*(0>b?0:1<b?1:b)|0)<<24;if(0>c){c=0;for(var e=this.get_layerCount();c<e;){var f=c++;d.pushTarget(this,f);d.clear(a);d.popTarget()}}else d.pushTarget(this,c),d.clear(a),d.popTarget()}else{var d=Ba.alloc(this.width,this.height,S.nativeFormat),e=0,f=a&255,g=a>>8&255;a=a>>16&255;b=255*b|0;0>b?b=0:255<b&&(b=255);switch(S.nativeFormat._hx_index){case 1:var h=a;a=f;f=h;break;case 2:break;default:throw new q("TODO");
}for(var h=0,k=this.width*this.height;h<k;)h++,d.bytes.b[e++]=a,d.bytes.b[e++]=g,d.bytes.b[e++]=f,d.bytes.b[e++]=b;if(0>c){c=0;for(e=this.get_layerCount();c<e;)f=c++,this.uploadPixels(d,0,f)}else this.uploadPixels(d,0,c);d.dispose()}},checkSize:function(a,b,c){if(a!=this.width>>c||b!=this.height>>c)throw new q("Invalid upload size : "+a+"x"+b+" should be "+(this.width>>c)+"x"+(this.height>>c));},checkMipMapGen:function(a,b){0==a&&(0!=(this.flags&1<<V.MipMapped._hx_index)&&0==(this.flags&1<<V.ManualMipMapGen._hx_index)&&
(0==(this.flags&1<<V.Cube._hx_index)||5==b))&&this.mem.driver.generateMipMaps(this)},uploadBitmap:function(a,b,c){null==c&&(c=0);null==b&&(b=0);this.alloc();var d=a.ctx.canvas.width,e=a.ctx.canvas.height;if(d!=this.width>>b||e!=this.height>>b)throw new q("Invalid upload size : "+d+"x"+e+" should be "+(this.width>>b)+"x"+(this.height>>b));this.mem.driver.uploadTextureBitmap(this,a,b,c);this.flags|=1<<V.WasCleared._hx_index;this.checkMipMapGen(b,c)},uploadPixels:function(a,b,c){null==c&&(c=0);null==
b&&(b=0);this.alloc();var d=a.width,e=a.height;if(d!=this.width>>b||e!=this.height>>b)throw new q("Invalid upload size : "+d+"x"+e+" should be "+(this.width>>b)+"x"+(this.height>>b));this.mem.driver.uploadTexturePixels(this,a,b,c);this.flags|=1<<V.WasCleared._hx_index;this.checkMipMapGen(b,c)},dispose:function(){null!=this.t&&this.mem.deleteTexture(this)},swapTexture:function(a){this.checkAlloc();a.checkAlloc();if(null==this.t&&null==this.realloc||null==a.t&&null==a.realloc)throw new q("One of the two texture is disposed");
var b=this.t;this.t=a.t;a.t=b},capturePixels:function(a,b,c){null==b&&(b=0);null==a&&(a=0);var d=this.get_lastFrame();this.preventAutoDispose();a=this.mem.driver.capturePixels(this,a,b,c);this.set_lastFrame(d);return a},__class__:S};var Uh=function(a,b,c,d,e){this.layers=c;null==d&&(d=[]);d.push(V.IsArray);S.call(this,a,b,d,e)};r["h3d.mat.TextureArray"]=Uh;Uh.__name__="h3d.mat.TextureArray";Uh.__super__=S;Uh.prototype=J(S.prototype,{get_layerCount:function(){return this.layers},clone:function(){var a=
this.get_lastFrame();this.preventAutoDispose();var b=new Uh(this.width,this.height,this.layers,null,this.format);vc.run(this,b);this.set_lastFrame(a);return b},toString:function(){return S.prototype.toString.call(this)+"["+this.layers+"]"},__class__:Uh});var Vh=function(a){this.name=a};r["h3d.pass.Base"]=Vh;Vh.__name__="h3d.pass.Base";Vh.prototype={compileShader:function(a){throw new q("Not implemented for this pass");},setContext:function(a){this.ctx=a},dispose:function(){},draw:function(a,b){},
__class__:Vh};var pb=function(a,b){this.shader=a;this.shaders=new Gb(a);this.manager=new td(b);this.pass=new O("screenfx",new Gb(a));this.pass.set_culling(Nb.None);this.pass.depth(!1,Ab.Always)};r["h3d.pass.ScreenFx"]=pb;pb.__name__="h3d.pass.ScreenFx";pb.run=function(a,b,c){var d=X.CURRENT;d.pushTarget(b,c);(new pb(a)).render();d.popTarget()};pb.prototype={get_engine:function(){null==this._engine&&(this._engine=X.CURRENT);return this._engine},copy:function(a,b){vc.run(a,b)},setGlobals:function(a){var b=
0;for(a=a.sharedGlobals;b<a.length;){var c=a[b];++b;this.manager.globals.map.h[c.gid]=c.value}},addShader:function(a){this.shaders=Gb.addSort(a,this.shaders);return this.pass.addShader(a)},removeShader:function(a){for(var b=null,c=this.shaders;null!=c;){if(c.s==a)return null==b?this.shaders=c.next:b.next=c.next,!0;b=c;c=c.next}return!1},getShader:function(a){for(var b=this.shaders;null!=b;){var c=b.s,b=b.next,c=ia.__downcastCheck(c,a)?c:null;if(null!=c)return c}return null},render:function(){null==
this.primitive&&(this.primitive=se.get());this.shader.flipY__=this.get_engine().driver.hasFeature(Ja.BottomLeftCoords)&&null!=this.get_engine().getCurrentTarget()?-1:1;var a=this.manager.compileShaders(this.shaders);this.get_engine().selectMaterial(this.pass);this.get_engine().selectShader(a);if(null==this.buffers)this.buffers=new Fg(a);else{var b=this.buffers;b.vertex.grow(a.vertex);b.fragment.grow(a.fragment)}this.manager.fillGlobals(this.buffers,a);this.manager.fillParams(this.buffers,a,this.shaders);
this.get_engine().uploadShaderBuffers(this.buffers,0);this.get_engine().uploadShaderBuffers(this.buffers,1);this.get_engine().uploadShaderBuffers(this.buffers,2);this.primitive.render(this.get_engine())},dispose:function(){},__class__:pb};var Rg=function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=1);null==a&&(a=1);this.cubeDir=[P.L([0,0,-1,0,0,-1,0,0,1,0,0,0]),P.L([0,0,1,0,0,-1,0,0,-1,0,0,0]),P.L([1,0,0,0,0,0,1,0,0,1,0,0]),P.L([1,0,0,0,0,0,-1,0,0,-1,0,0]),P.L([1,0,0,0,0,-1,0,0,0,1,0,0]),P.L([-1,
0,0,0,0,-1,0,0,0,0,-1,0])];pb.call(this,new Sf);this.set_radius(a);this.set_quality(d);this.set_gain(b);this.set_linear(c)};r["h3d.pass.Blur"]=Rg;Rg.__name__="h3d.pass.Blur";Rg.__super__=pb;Rg.prototype=J(pb.prototype,{set_radius:function(a){if(this.radius==a)return a;this.values=null;return this.radius=a},set_quality:function(a){if(this.quality==a)return a;this.values=null;return this.quality=a},set_gain:function(a){if(this.gain==a)return a;this.values=null;return this.gain=a},set_linear:function(a){if(this.linear==
a)return a;this.values=null;return this.linear=a},gauss:function(a,b){if(0>=b)return 0==a?1:0;var c=b*b;return Math.pow(2.718281828459,-(a*a)/(2*c))/Math.sqrt(2*Math.PI*c)},calcValues:function(){this.values=[];this.offsets=[];var a=0,b=this.quality,b=0.7*(0>b?0:1<b?1:b)+0.3,c;if(0<this.radius){var d=this.radius-1;c=Math.ceil((1>d?1:d)*b/2)}else c=0;var d=Math.sqrt(this.radius),e=0;for(c+=1;e<c;){var f=e++,g=2*f,h=0==f?0:2*f-1,k=this.gauss(g,d),l=this.gauss(h,d),m=k+l;this.values[f]=m;this.offsets[f]=
0==f?0:(k*g+l*h)/(m*f*Math.sqrt(b));a+=m;0<f&&(a+=m)}for(d=this.values[0]*(0.01/b);2<this.values.length;){e=this.values[this.values.length-1];if(e>d)break;a-=2*e;this.values.pop()}a/=this.gain;d=0;for(e=this.values.length;d<e;)c=d++,this.values[c]/=a;if(0<this.linear){a=this.gain/(2*this.values.length-1);d=0;for(e=this.values.length;d<e;)c=d++,f=this.values[c],this.values[c]=f+this.linear*(a-f),f=this.offsets[c],this.offsets[c]=f+this.linear*((0==c?0:(2*c-0.5)/(c*b))-f)}},getKernelSize:function(){null==
this.values&&this.calcValues();return 0>=this.radius?0:2*this.values.length-1},apply:function(a,b,c){if(0>=this.radius&&null==this.shader.fixedColor__)null!=c&&vc.run(b,c);else{null==c&&(c=b);null==this.values&&this.calcValues();var d=0!=(b.flags&1<<V.Cube._hx_index),e=d?6:1;a=a.textures.allocTarget(b.name+"BlurTmp",b.width,b.height,!1,b.format,d);var f=this.shader;f.constModified=!0;f.Quality__=this.values.length;this.shader.values__=this.values;this.shader.offsets__=this.offsets;d?(this.shader.cubeTexture__=
b,f=this.shader,f.constModified=!0,f.isCube__=!0):(this.shader.texture__=b,f=this.shader,f.constModified=!0,f.isCube__=!1);var f=this.shader.pixel__,g=1/b.width,h=0;null==h&&(h=0);null==g&&(g=0);f.x=g;f.y=h;f.z=0;f.w=1;for(f=0;f<e;)g=f++,this.get_engine().pushTarget(a,g),d&&(this.shader.cubeDir__=this.cubeDir[g]),this.render(),this.get_engine().popTarget();d?this.shader.cubeTexture__=a:this.shader.texture__=a;a=this.shader.pixel__;f=0;b=1/b.height;null==b&&(b=0);null==f&&(f=0);a.x=f;a.y=b;a.z=0;a.w=
1;b=c.depthBuffer;c.depthBuffer=null;for(a=0;a<e;)f=a++,this.get_engine().pushTarget(c,f),d&&(this.shader.cubeDir__=this.cubeDir[f]),this.render(),this.get_engine().popTarget();c.depthBuffer=b}},__class__:Rg});var T=function(){this.priority=0;this.initialize()};r["hxsl.Shader"]=T;T.__name__="hxsl.Shader";T.prototype={initialize:function(){this.constModified=!0;if(null==this.shader){var a=ia.getClass(this);this.shader=a._SHADER;if(null==this.shader){for(var b=a;null!=b&&null==b.SRC;)b=b.__super__;
if(null==b)throw new q(a.__name__+" has no shader source");this.shader=b._SHADER;null==this.shader&&(this.shader=new qe(b.SRC),b._SHADER=this.shader)}}},setPriority:function(a){this.priority=a},getParamValue:function(a){throw new q("assert");},getParamFloatValue:function(a){throw new q("assert");},updateConstants:function(a){throw new q("assert");},updateConstantsFinal:function(a){for(var b=this.shader.consts;null!=b;){if(0!=b.globalId){var c=a.map.h[b.globalId],d=b.v.type;switch(d._hx_index){case 1:d=
c;if(0!=d>>>b.bits)throw new q("Constant "+b.v.name+" is outside range ("+d+" > "+((1<<b.bits)-1)+")");this.constBits|=d<<b.pos;break;case 2:c&&(this.constBits|=1<<b.pos);break;case 17:d=d.size;if(null==c){b=b.next;continue}var e=c.channel;if(null==c.texture)e=rb.Unknown;else if(null==e||e==rb.Unknown)switch(d){case 1:if(c.texture.format==S.nativeFormat)e=rb.PackedFloat;else throw new q("Constant "+b.v.name+" does not define channel select value");break;case 3:if(c.texture.format==S.nativeFormat)e=
rb.PackedNormal;else throw new q("Constant "+b.v.name+" does not define channel select value");break;default:throw new q("Constant "+b.v.name+" does not define channel select value");}this.constBits|=(a.allocChannelID(c.texture)<<3|e._hx_index)<<b.pos;break;default:throw new q("assert");}}b=b.next}a=this.shader;b=this.constBits;d=a.instanceCache.h[b];this.instance=null==d?a.makeInstance(b):d},clone:function(){return this},toString:function(){return ia.getClass(this).__name__},__class__:T};var Pa=
function(){this.flipY__=0;T.call(this)};r["h3d.shader.ScreenShader"]=Pa;Pa.__name__="h3d.shader.ScreenShader";Pa.__super__=T;Pa.prototype=J(T.prototype,{get_flipY:function(){return this.flipY__},set_flipY:function(a){return this.flipY__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){return 0==a?this.flipY__:null},getParamFloatValue:function(a){return 0==a?this.flipY__:0},clone:function(){var a=Object.create(Pa.prototype);a.shader=this.shader;
a.flipY__=this.flipY__;return a},__class__:Pa});var Tf=function(){this.color__=new B;Pa.call(this)};r["h3d.pass._Border.BorderShader"]=Tf;Tf.__name__="h3d.pass._Border.BorderShader";Tf.__super__=Pa;Tf.prototype=J(Pa.prototype,{get_color:function(){return this.color__},set_color:function(a){return this.color__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.flipY__;case 1:return this.color__}return null},getParamFloatValue:function(a){return 0==
a?this.flipY__:0},clone:function(){var a=Object.create(Tf.prototype);a.shader=this.shader;a.flipY__=this.flipY__;a.color__=this.color__;return a},__class__:Tf});var Sg=function(a,b,c){null==c&&(c=1);pb.call(this,new Tf);var d=Ob._new(0);if(d.pos==d.array.length){var e=d.array.length<<1;128>e&&(e=128);e=new Float32Array(e);e.set(d.array);d.array=e}d.array[d.pos++]=2*(0/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-
2*(0/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*(a/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*(0/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*(0/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),
d.array=e);d.array[d.pos++]=1-2*(c/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*(a/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*(c/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*(0/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=
new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*(0/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*(c/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*(0/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*(0/a)-1;d.pos==d.array.length&&(e=
d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*(b/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*(c/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*(b/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*
(0/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*((b-c)/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*(a/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*((b-c)/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),
d.array=e);d.array[d.pos++]=2*(0/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*(b/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*(a/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*(b/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=
new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*((a-c)/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*(0/b);d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*(a/a)-1;d.pos==d.array.length&&(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=1-2*(0/b);d.pos==d.array.length&&
(e=d.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(d.array),d.array=e);d.array[d.pos++]=2*((a-c)/a)-1;d.pos==d.array.length&&(c=d.array.length<<1,128>c&&(c=128),c=new Float32Array(c),c.set(d.array),d.array=c);d.array[d.pos++]=1-2*(b/b);d.pos==d.array.length&&(c=d.array.length<<1,128>c&&(c=128),c=new Float32Array(c),c.set(d.array),d.array=c);d.array[d.pos++]=2*(a/a)-1;d.pos==d.array.length&&(a=d.array.length<<1,128>a&&(a=128),a=new Float32Array(a),a.set(d.array),d.array=a);d.array[d.pos++]=
1-2*(b/b);this.primitive=new Wh({vbuf:d,stride:2,quads:!0},!0);b=this.shader.color__;e=c=a=d=1;null==e&&(e=1);null==c&&(c=0);null==a&&(a=0);null==d&&(d=0);b.x=d;b.y=a;b.z=c;b.w=e};r["h3d.pass.Border"]=Sg;Sg.__name__="h3d.pass.Border";Sg.__super__=pb;Sg.prototype=J(pb.prototype,{dispose:function(){pb.prototype.dispose.call(this);this.primitive.dispose()},__class__:Sg});var Uf=function(){this.layer__=0;Pa.call(this)};r["h3d.pass._Copy.ArrayCopyShader"]=Uf;Uf.__name__="h3d.pass._Copy.ArrayCopyShader";
Uf.__super__=Pa;Uf.prototype=J(Pa.prototype,{get_texture:function(){return this.texture__},set_texture:function(a){return this.texture__=a},get_layer:function(){return this.layer__},set_layer:function(a){return this.layer__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.flipY__;case 1:return this.texture__;case 2:return this.layer__}return null},getParamFloatValue:function(a){return 0==a?this.flipY__:0},clone:function(){var a=
Object.create(Uf.prototype);a.shader=this.shader;a.flipY__=this.flipY__;a.texture__=this.texture__;a.layer__=this.layer__;return a},__class__:Uf});var bf=function(){pb.call(this,new Uf)};r["h3d.pass.ArrayCopy"]=bf;bf.__name__="h3d.pass.ArrayCopy";bf.run=function(a,b,c,d,e,f){var g=X.CURRENT;if(!(null!=c&&null!=a&&(null==d||d==ra.None)&&null==e&&g.driver.copyTexture(a,c))){var h=g.resCache.h[bf.__id__];null==h&&(h=new bf,g.resCache.set(bf,h));h.apply(a,b,c,d,e,f)}};bf.__super__=pb;bf.prototype=J(pb.prototype,
{apply:function(a,b,c,d,e,f){null!=c&&this.get_engine().pushTarget(c,null!=f?f:0);this.shader.texture__=a;this.shader.layer__=b;if(null!=e){a=this.pass;this.pass=e;null!=d&&this.pass.setBlendMode(d);for(d=this.shaders;null!=d.next;)d=d.next;d.next=this.pass.shaders;this.render();this.pass=a;d.next=null}else this.pass.setBlendMode(null==d?ra.None:d),this.render();this.shader.texture__=null;this.shader.layer__=0;null!=c&&this.get_engine().popTarget()},__class__:bf});var Vf=function(){Pa.call(this)};
r["h3d.pass._Copy.CopyShader"]=Vf;Vf.__name__="h3d.pass._Copy.CopyShader";Vf.__super__=Pa;Vf.prototype=J(Pa.prototype,{get_texture:function(){return this.texture__},set_texture:function(a){return this.texture__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.flipY__;case 1:return this.texture__}return null},getParamFloatValue:function(a){return 0==a?this.flipY__:0},clone:function(){var a=Object.create(Vf.prototype);
a.shader=this.shader;a.flipY__=this.flipY__;a.texture__=this.texture__;return a},__class__:Vf});var vc=function(){pb.call(this,new Vf)};r["h3d.pass.Copy"]=vc;vc.__name__="h3d.pass.Copy";vc.run=function(a,b,c,d,e){var f=X.CURRENT;if(!(null!=b&&null!=a&&(null==c||c==ra.None)&&null==d&&f.driver.copyTexture(a,b))){var g=f.resCache.h[vc.__id__];null==g&&(g=new vc,f.resCache.set(vc,g));g.apply(a,b,c,d,e)}};vc.__super__=pb;vc.prototype=J(pb.prototype,{apply:function(a,b,c,d,e){null!=b&&this.get_engine().pushTarget(b,
null!=e?e:0);this.shader.texture__=a;if(null!=d){a=this.pass;this.pass=d;null!=c&&this.pass.setBlendMode(c);for(c=this.shaders;null!=c.next;)c=c.next;c.next=this.pass.shaders;this.render();this.pass=a;c.next=null}else this.pass.setBlendMode(null==c?ra.None:c),this.render();this.shader.texture__=null;null!=b&&this.get_engine().popTarget()},__class__:vc});var Wf=function(){this.mat__=new P;Pa.call(this)};r["h3d.pass._CubeCopy.CubeCopyShader"]=Wf;Wf.__name__="h3d.pass._CubeCopy.CubeCopyShader";Wf.__super__=
Pa;Wf.prototype=J(Pa.prototype,{get_texture:function(){return this.texture__},set_texture:function(a){return this.texture__=a},get_mat:function(){return this.mat__},set_mat:function(a){return this.mat__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.flipY__;case 1:return this.texture__;case 2:return this.mat__}return null},getParamFloatValue:function(a){return 0==a?this.flipY__:0},clone:function(){var a=Object.create(Wf.prototype);
a.shader=this.shader;a.flipY__=this.flipY__;a.texture__=this.texture__;a.mat__=this.mat__;return a},__class__:Wf});var Qd=function(){this.cubeDir=[P.L([0,0,-1,0,0,-1,0,0,1,0,0,0]),P.L([0,0,1,0,0,-1,0,0,-1,0,0,0]),P.L([1,0,0,0,0,0,1,0,0,1,0,0]),P.L([1,0,0,0,0,0,-1,0,0,-1,0,0]),P.L([1,0,0,0,0,-1,0,0,0,0,1,0]),P.L([-1,0,0,0,0,-1,0,0,0,0,-1,0])];pb.call(this,new Wf)};r["h3d.pass.CubeCopy"]=Qd;Qd.__name__="h3d.pass.CubeCopy";Qd.run=function(a,b,c,d){var e=X.CURRENT;if(!(null!=b&&null!=a&&(null==c||c==
ra.None)&&null==d&&e.driver.copyTexture(a,b))){var f=e.resCache.h[Qd.__id__];null==f&&(f=new Qd,e.resCache.set(Qd,f));f.apply(a,b,c,d)}};Qd.__super__=pb;Qd.prototype=J(pb.prototype,{apply:function(a,b,c,d){this.shader.texture__=a;for(a=0;6>a;){var e=a++;null!=b&&this.get_engine().pushTarget(b,e);this.shader.mat__=this.cubeDir[e];if(null!=d){e=this.pass;this.pass=d;null!=c&&this.pass.setBlendMode(c);for(var f=this.shaders;null!=f.next;)f=f.next;f.next=this.pass.shaders;this.render();this.pass=e;f.next=
null}else this.pass.setBlendMode(null==c?ra.None:c),this.render();null!=b&&this.get_engine().popTarget()}this.shader.texture__=null},__class__:Qd});var Ta=function(a){this.defaultSort=(s=new yj,z(s,s.sort));this.name=a;this.manager=new td(this.getOutputs());this.initGlobals()};r["h3d.pass.Default"]=Ta;Ta.__name__="h3d.pass.Default";Ta.__super__=Vh;Ta.prototype=J(Vh.prototype,{get_globals:function(){return this.manager.globals},getOutputs:function(){return[ec.Value("output.color")]},compileShader:function(a){var b=
new Xh;b.pass=a;this.setupShaders(new Xf(b));return this.manager.compileShaders(b.shaders,a.batchMode)},processShaders:function(a,b){for(var c=this.ctx.extraShaders;null!=c;)b=this.ctx.allocShaderList(c.s,b),c=c.next;return b},setupShaders:function(a){var b=!1;for(a=a.current;null!=a;){var c=a;a=a.next;var d=c.pass.getShadersRec(),d=this.processShaders(c,d);c.pass.enableLights&&null!=this.ctx.lightSystem&&(b||(this.ctx.lightSystem.initGlobals(this.manager.globals),b=!0),d=this.ctx.lightSystem.computeLight(c.obj,
d));c.shader=this.manager.compileShaders(d,c.pass.batchMode);c.shaders=d;var e=c.shader.fragment.textures;if(null==e)c.texture=0;else{var f=this.manager,g=!0;null==g&&(g=!1);if(null!=e.perObjectGlobal){g=f.globals.map.h[e.perObjectGlobal.gid];if(null==g)throw new q("Missing global value "+e.perObjectGlobal.path+" for shader "+f.shaderInfo(d,e.perObjectGlobal.path));e=17==e.type._hx_index?g.texture:g}else{for(f=e.instance;0<--f;)d=d.next;f=d.s.getParamValue(e.index);if(null==f&&!g)throw new q("Missing param value "+
n.string(d.s)+"."+e.name);e=f}c.texture=null==e?0:e.id}}},log:function(a){},drawObject:function(a){this.ctx.drawPass=a;this.ctx.engine.selectMaterial(a.pass);a.obj.draw(this.ctx)},draw:function(a,b){if(null!=a.current){for(var c=0,d=this.ctx.sharedGlobals;c<d.length;){var e=d[c];++c;this.manager.globals.map.h[e.gid]=e.value}this.setGlobals();this.setupShaders(a);null==b?this.defaultSort(a):b(a);this.ctx.currentManager=this.manager;c=this.ctx.shaderBuffers;d=null;for(e=a.current;null!=e;){var f=e,
e=e.next;this.manager.globals.map.h[this.globalModelView_id]=f.obj.absPos;if(f.shader.globals.h.hasOwnProperty(this.globalModelViewInverse_id)){var g=f.obj.getInvPos();this.manager.globals.map.h[this.globalModelViewInverse_id]=g}d!=f.shader&&(d=f.shader,this.ctx.engine.selectShader(f.shader),null==c?c=this.ctx.shaderBuffers=new Fg(f.shader):(g=f.shader,c.vertex.grow(g.vertex),c.fragment.grow(g.fragment)),this.manager.fillGlobals(c,f.shader),this.ctx.engine.uploadShaderBuffers(c,0));f.pass.dynamicParameters||
(this.manager.fillParams(c,f.shader,f.shaders),this.ctx.engine.uploadShaderBuffers(c,1),this.ctx.engine.uploadShaderBuffers(c,2),this.ctx.engine.uploadShaderBuffers(c,3));this.drawObject(f)}c=this.ctx;c.cachedPos=0;c.drawPass=null}},get_cameraView:function(){return this.manager.globals.map.h[this.cameraView_id]},set_cameraView:function(a){return this.manager.globals.map.h[this.cameraView_id]=a},get_cameraNear:function(){return this.manager.globals.map.h[this.cameraNear_id]},set_cameraNear:function(a){return this.manager.globals.map.h[this.cameraNear_id]=
a},get_cameraFar:function(){return this.manager.globals.map.h[this.cameraFar_id]},set_cameraFar:function(a){return this.manager.globals.map.h[this.cameraFar_id]=a},get_cameraProj:function(){return this.manager.globals.map.h[this.cameraProj_id]},set_cameraProj:function(a){return this.manager.globals.map.h[this.cameraProj_id]=a},get_cameraPos:function(){return this.manager.globals.map.h[this.cameraPos_id]},set_cameraPos:function(a){return this.manager.globals.map.h[this.cameraPos_id]=a},get_cameraProjDiag:function(){return this.manager.globals.map.h[this.cameraProjDiag_id]},
set_cameraProjDiag:function(a){return this.manager.globals.map.h[this.cameraProjDiag_id]=a},get_cameraProjFlip:function(){return this.manager.globals.map.h[this.cameraProjFlip_id]},set_cameraProjFlip:function(a){return this.manager.globals.map.h[this.cameraProjFlip_id]=a},get_cameraViewProj:function(){return this.manager.globals.map.h[this.cameraViewProj_id]},set_cameraViewProj:function(a){return this.manager.globals.map.h[this.cameraViewProj_id]=a},get_cameraInverseViewProj:function(){return this.manager.globals.map.h[this.cameraInverseViewProj_id]},
set_cameraInverseViewProj:function(a){return this.manager.globals.map.h[this.cameraInverseViewProj_id]=a},get_globalTime:function(){return this.manager.globals.map.h[this.globalTime_id]},set_globalTime:function(a){return this.manager.globals.map.h[this.globalTime_id]=a},get_pixelSize:function(){return this.manager.globals.map.h[this.pixelSize_id]},set_pixelSize:function(a){return this.manager.globals.map.h[this.pixelSize_id]=a},get_globalModelView:function(){return this.manager.globals.map.h[this.globalModelView_id]},
set_globalModelView:function(a){return this.manager.globals.map.h[this.globalModelView_id]=a},get_globalModelViewInverse:function(){return this.manager.globals.map.h[this.globalModelViewInverse_id]},set_globalModelViewInverse:function(a){return this.manager.globals.map.h[this.globalModelViewInverse_id]=a},initGlobals:function(){this.cameraView_id=qa.allocID("camera.view");this.cameraNear_id=qa.allocID("camera.zNear");this.cameraFar_id=qa.allocID("camera.zFar");this.cameraProj_id=qa.allocID("camera.proj");
this.cameraPos_id=qa.allocID("camera.position");this.cameraProjDiag_id=qa.allocID("camera.projDiag");this.cameraProjFlip_id=qa.allocID("camera.projFlip");this.cameraViewProj_id=qa.allocID("camera.viewProj");this.cameraInverseViewProj_id=qa.allocID("camera.inverseViewProj");this.globalTime_id=qa.allocID("global.time");this.pixelSize_id=qa.allocID("global.pixelSize");this.globalModelView_id=qa.allocID("global.modelView");this.globalModelViewInverse_id=qa.allocID("global.modelViewInverse")},setGlobals:function(){this.manager.globals.map.h[this.cameraView_id]=
this.ctx.camera.mcam;this.manager.globals.map.h[this.cameraNear_id]=this.ctx.camera.zNear;this.manager.globals.map.h[this.cameraFar_id]=this.ctx.camera.zFar;this.manager.globals.map.h[this.cameraProj_id]=this.ctx.camera.mproj;this.manager.globals.map.h[this.cameraPos_id]=this.ctx.camera.pos;var a=new B(this.ctx.camera.mproj._11,this.ctx.camera.mproj._22,this.ctx.camera.mproj._33,this.ctx.camera.mproj._44);this.manager.globals.map.h[this.cameraProjDiag_id]=a;a=this.ctx.engine.driver.hasFeature(Ja.BottomLeftCoords)&&
null!=this.ctx.engine.getCurrentTarget()?-1:1;this.manager.globals.map.h[this.cameraProjFlip_id]=a;this.manager.globals.map.h[this.cameraViewProj_id]=this.ctx.camera.m;a=this.ctx.camera.getInverseViewProj();this.manager.globals.map.h[this.cameraInverseViewProj_id]=a;this.manager.globals.map.h[this.globalTime_id]=this.ctx.time;a=new B(2/this.ctx.engine.width,2/this.ctx.engine.height);this.manager.globals.map.h[this.pixelSize_id]=a},__class__:Ta});var vd=function(a){this.pcfQuality=this.pcfScale=1;
this.bias=0.01;this.power=30;this.samplingKind=Tg.None;this.size=1024;this.mode=Db.None;this.enabled=!0;null==this.format&&(this.format=ha.R16F);X.CURRENT.driver.isSupportedFormat(this.format)||(this.format=S.nativeFormat);Ta.call(this,"shadow");this.light=a;this.blur=new Rg(5);this.blur.set_quality(0.5);a=this.blur.shader;a.constModified=!0;a.isDepth__=this.format==S.nativeFormat};r["h3d.pass.Shadows"]=vd;vd.__name__="h3d.pass.Shadows";vd.__super__=Ta;vd.prototype=J(Ta.prototype,{set_mode:function(a){if(a!=
Db.None)throw new q("Shadow mode "+n.string(a)+" not supported for "+n.string(this.light));return this.mode=a},set_enabled:function(a){return this.enabled=a},set_size:function(a){a!=this.size&&null!=this.staticTexture&&(this.staticTexture.dispose(),this.staticTexture=null);return this.size=a},dispose:function(){Ta.prototype.dispose.call(this);this.blur.dispose();null!=this.staticTexture&&this.staticTexture.dispose()},getShadowProj:function(){return this.lightCamera.m},getShadowTex:function(){return null},
isUsingWorldDist:function(){return!1},getOutputs:function(){return this.isUsingWorldDist()?[ec.Swiz(ec.Value("output.worldDist",1),[ca.X,ca.X,ca.X,ca.X])]:this.format==S.nativeFormat?[ec.PackFloat(ec.Value("output.depth"))]:[ec.Swiz(ec.Value("output.depth",1),[ca.X,ca.X,ca.X,ca.X])]},loadStaticData:function(a){return!1},saveStaticData:function(){return null},computeStatic:function(a){throw new q("Not implemented");},createDefaultShadowMap:function(){var a=S.fromColor(16777215);a.name="defaultShadowMap";
return a},syncShader:function(a){},filterPasses:function(a){if(this.ctx.computingStatic)switch(this.mode._hx_index){case 0:return!1;case 1:for(var b=null,c=null,d=a.discarded,e=a.lastDisc,f=a.current;null!=f;)!0==f.pass.isStatic?null==b?b=c=f:c=c.next=f:null==d?d=e=f:e=e.next=f,f=f.next;null!=c&&(c.next=null);null!=e&&(e.next=null);a.current=b;a.discarded=d;a.lastDisc=e;return!0;case 2:return!1;case 3:c=b=null;d=a.discarded;e=a.lastDisc;for(f=a.current;null!=f;)!0==f.pass.isStatic?null==b?b=c=f:c=
c.next=f:null==d?d=e=f:e=e.next=f,f=f.next;null!=c&&(c.next=null);null!=e&&(e.next=null);a.current=b;a.discarded=d;a.lastDisc=e;return!0}else switch(this.mode._hx_index){case 0:return!1;case 1:return null!=this.staticTexture?(a=this.staticTexture,a=null==a.t&&null==a.realloc):a=!0,a&&(this.staticTexture=this.createDefaultShadowMap()),this.syncShader(this.staticTexture),!1;case 2:return!0;case 3:return null!=this.staticTexture?(a=this.staticTexture,a=null==a.t&&null==a.realloc):a=!0,a&&(this.staticTexture=
this.createDefaultShadowMap()),!0}},cullPasses:function(a,b){for(var c=null,d=!0,e=null,f=null,g=a.discarded,h=a.lastDisc,k=a.current;null!=k;){var l=k.obj.cullingCollider;null==l?l=!0:(l!=c&&(c=l,d=b(l)),l=d);l?null==e?e=f=k:f=f.next=k:null==g?g=h=k:h=h.next=k;k=k.next}null!=f&&(f.next=null);null!=h&&(h.next=null);a.current=e;a.discarded=g;a.lastDisc=h},__class__:vd});var cf=function(a){this.mergePass=new pb(new Yf);vd.call(this,a);this.lightCamera=new Ig;this.lightCamera.orthoBounds=new Hb;this.shader=
this.dshader=new Zf;this.border=new Sg(this.size,this.size);this.customDepth=X.CURRENT.driver.hasFeature(Ja.AllocDepthBuffer);this.customDepth||(this.depth=Od.getDefault())};r["h3d.pass.DirShadowMap"]=cf;cf.__name__="h3d.pass.DirShadowMap";cf.__super__=vd;cf.prototype=J(vd.prototype,{set_mode:function(a){var b=this.dshader;b.constModified=!0;b.enable__=a!=Db.None;return this.mode=a},set_enabled:function(a){var b=this.dshader;b.constModified=!0;b.enable__=a&&this.mode!=Db.None;return this.enabled=
a},set_size:function(a){null!=this.border&&this.size!=a&&(this.border.dispose(),this.border=new Sg(a,a));return vd.prototype.set_size.call(this,a)},dispose:function(){vd.prototype.dispose.call(this);this.customDepth&&null!=this.depth&&this.depth.dispose();this.border.dispose()},getShadowTex:function(){return this.dshader.shadowMap__},calcShadowBounds:function(a){var b=a.orthoBounds,c=new P;this.ctx.scene.iterVisibleMeshes(function(d){if(null!=d.primitive&&d.material.castShadows){var e=d.primitive.getBounds();
if(!(e.xMin>e.xMax)){d=d.getAbsPos();c.multiply3x4(d,a.mcam);d=e.xMin;var f=e.yMin,g=e.zMin;null==g&&(g=0);null==f&&(f=0);null==d&&(d=0);var h=d*c._12+f*c._22+g*c._32+c._42,k=d*c._13+f*c._23+g*c._33+c._43;d=d*c._11+f*c._21+g*c._31+c._41;f=h;g=k;d<b.xMin&&(b.xMin=d);d>b.xMax&&(b.xMax=d);f<b.yMin&&(b.yMin=f);f>b.yMax&&(b.yMax=f);g<b.zMin&&(b.zMin=g);g>b.zMax&&(b.zMax=g);d=e.xMin;f=e.yMin;g=e.zMax;null==g&&(g=0);null==f&&(f=0);null==d&&(d=0);h=d*c._12+f*c._22+g*c._32+c._42;k=d*c._13+f*c._23+g*c._33+
c._43;d=d*c._11+f*c._21+g*c._31+c._41;f=h;g=k;d<b.xMin&&(b.xMin=d);d>b.xMax&&(b.xMax=d);f<b.yMin&&(b.yMin=f);f>b.yMax&&(b.yMax=f);g<b.zMin&&(b.zMin=g);g>b.zMax&&(b.zMax=g);d=e.xMin;f=e.yMax;g=e.zMin;null==g&&(g=0);null==f&&(f=0);null==d&&(d=0);h=d*c._12+f*c._22+g*c._32+c._42;k=d*c._13+f*c._23+g*c._33+c._43;d=d*c._11+f*c._21+g*c._31+c._41;f=h;g=k;d<b.xMin&&(b.xMin=d);d>b.xMax&&(b.xMax=d);f<b.yMin&&(b.yMin=f);f>b.yMax&&(b.yMax=f);g<b.zMin&&(b.zMin=g);g>b.zMax&&(b.zMax=g);d=e.xMin;f=e.yMax;g=e.zMax;
null==g&&(g=0);null==f&&(f=0);null==d&&(d=0);h=d*c._12+f*c._22+g*c._32+c._42;k=d*c._13+f*c._23+g*c._33+c._43;d=d*c._11+f*c._21+g*c._31+c._41;f=h;g=k;d<b.xMin&&(b.xMin=d);d>b.xMax&&(b.xMax=d);f<b.yMin&&(b.yMin=f);f>b.yMax&&(b.yMax=f);g<b.zMin&&(b.zMin=g);g>b.zMax&&(b.zMax=g);d=e.xMax;f=e.yMin;g=e.zMin;null==g&&(g=0);null==f&&(f=0);null==d&&(d=0);h=d*c._12+f*c._22+g*c._32+c._42;k=d*c._13+f*c._23+g*c._33+c._43;d=d*c._11+f*c._21+g*c._31+c._41;f=h;g=k;d<b.xMin&&(b.xMin=d);d>b.xMax&&(b.xMax=d);f<b.yMin&&
(b.yMin=f);f>b.yMax&&(b.yMax=f);g<b.zMin&&(b.zMin=g);g>b.zMax&&(b.zMax=g);d=e.xMax;f=e.yMin;g=e.zMax;null==g&&(g=0);null==f&&(f=0);null==d&&(d=0);h=d*c._12+f*c._22+g*c._32+c._42;k=d*c._13+f*c._23+g*c._33+c._43;d=d*c._11+f*c._21+g*c._31+c._41;f=h;g=k;d<b.xMin&&(b.xMin=d);d>b.xMax&&(b.xMax=d);f<b.yMin&&(b.yMin=f);f>b.yMax&&(b.yMax=f);g<b.zMin&&(b.zMin=g);g>b.zMax&&(b.zMax=g);d=e.xMax;f=e.yMax;g=e.zMin;null==g&&(g=0);null==f&&(f=0);null==d&&(d=0);h=d*c._12+f*c._22+g*c._32+c._42;k=d*c._13+f*c._23+g*c._33+
c._43;d=d*c._11+f*c._21+g*c._31+c._41;f=h;g=k;d<b.xMin&&(b.xMin=d);d>b.xMax&&(b.xMax=d);f<b.yMin&&(b.yMin=f);f>b.yMax&&(b.yMax=f);g<b.zMin&&(b.zMin=g);g>b.zMax&&(b.zMax=g);g=e.xMax;d=e.yMax;f=e.zMax;null==f&&(f=0);null==d&&(d=0);null==g&&(g=0);e=g;g=e*c._12+d*c._22+f*c._32+c._42;h=e*c._13+d*c._23+f*c._33+c._43;e=e*c._11+d*c._21+f*c._31+c._41;d=g;f=h;e<b.xMin&&(b.xMin=e);e>b.xMax&&(b.xMax=e);d<b.yMin&&(b.yMin=d);d>b.yMax&&(b.yMax=d);f<b.zMin&&(b.zMin=f);f>b.zMax&&(b.zMax=f)}}});if(this.mode==Db.Dynamic){for(var d=
new Hb,e=0,f=this.ctx.camera.getFrustumCorners();e<f.length;){var g=f[e];++e;var h=a.mcam,k=g.x*h._12+g.y*h._22+g.z*h._32+g.w*h._42,l=g.x*h._13+g.y*h._23+g.z*h._33+g.w*h._43,m=g.x*h._14+g.y*h._24+g.z*h._34+g.w*h._44;g.x=g.x*h._11+g.y*h._21+g.z*h._31+g.w*h._41;g.y=k;g.z=l;g.w=m;h=g.x;k=g.y;g=g.z;h<d.xMin&&(d.xMin=h);h>d.xMax&&(d.xMax=h);k<d.yMin&&(d.yMin=k);k>d.yMax&&(d.yMax=k);g<d.zMin&&(d.zMin=g);g>d.zMax&&(d.zMax=g)}d.zMin=b.zMin;b.intersection(b,d)}b.scaleCenter(1.01)},setGlobals:function(){vd.prototype.setGlobals.call(this);
if(this.mode!=Db.Mixed||this.ctx.computingStatic){var a=this.lightCamera.orthoBounds;a.xMin=1E20;a.xMax=-1E20;a.yMin=1E20;a.yMax=-1E20;a.zMin=1E20;a.zMax=-1E20;this.calcShadowBounds(this.lightCamera);this.lightCamera.update()}a=this.getShadowProj();this.manager.globals.map.h[this.cameraViewProj_id]=a},syncShader:function(a){var b=this.dshader;b.constModified=!0;b.shadowMap__=a;b=this.dshader;b.constModified=!0;b.shadowMapChannel__=this.format==S.nativeFormat?rb.PackedFloat:rb.R;this.dshader.shadowBias__=
this.bias;this.dshader.shadowPower__=this.power;this.dshader.shadowProj__=this.getShadowProj();b=this.dshader;b.constModified=!0;b.USE_ESM__=this.samplingKind==Tg.ESM;this.dshader.shadowPower__=this.power;b=this.dshader;b.constModified=!0;b.USE_PCF__=this.samplingKind==Tg.PCF;var b=this.dshader.shadowRes__,c=a.width;a=a.height;null==a&&(a=0);null==c&&(c=0);b.x=c;b.y=a;b.z=0;b.w=1;this.dshader.pcfScale__=this.pcfScale;a=this.dshader;a.constModified=!0;a.pcfQuality__=this.pcfQuality},saveStaticData:function(){if(this.mode!=
Db.Mixed&&this.mode!=Db.Static)return null;if(null==this.staticTexture)throw new q("Data not computed");var a=gj.run(this.staticTexture.capturePixels().bytes,9),b=new ie;b.addInt32(this.staticTexture.width);b.addFloat(this.lightCamera.pos.x);b.addFloat(this.lightCamera.pos.y);b.addFloat(this.lightCamera.pos.z);b.addFloat(this.lightCamera.target.x);b.addFloat(this.lightCamera.target.y);b.addFloat(this.lightCamera.target.z);b.addFloat(this.lightCamera.orthoBounds.xMin);b.addFloat(this.lightCamera.orthoBounds.yMin);
b.addFloat(this.lightCamera.orthoBounds.zMin);b.addFloat(this.lightCamera.orthoBounds.xMax);b.addFloat(this.lightCamera.orthoBounds.yMax);b.addFloat(this.lightCamera.orthoBounds.zMax);b.addInt32(a.length);b.add(a);return b.getBytes()},loadStaticData:function(a){if(this.mode!=Db.Mixed&&this.mode!=Db.Static||null==a)return!1;var b=new Vb(a);a=b.readInt32();if(a!=this.size)return!1;this.lightCamera.pos.x=b.readFloat();this.lightCamera.pos.y=b.readFloat();this.lightCamera.pos.z=b.readFloat();this.lightCamera.target.x=
b.readFloat();this.lightCamera.target.y=b.readFloat();this.lightCamera.target.z=b.readFloat();this.lightCamera.orthoBounds.xMin=b.readFloat();this.lightCamera.orthoBounds.yMin=b.readFloat();this.lightCamera.orthoBounds.zMin=b.readFloat();this.lightCamera.orthoBounds.xMax=b.readFloat();this.lightCamera.orthoBounds.yMax=b.readFloat();this.lightCamera.orthoBounds.zMax=b.readFloat();this.lightCamera.update();var c=b.readInt32(),b=new Ba(a,a,hj.run(b.read(c)),this.format);null!=this.staticTexture&&this.staticTexture.dispose();
this.staticTexture=new S(a,a,[V.Target],this.format);this.staticTexture.uploadPixels(b);this.staticTexture.name="staticTexture";this.staticTexture.preventAutoDispose();this.syncShader(this.staticTexture);return!0},draw:function(a,b){if(this.enabled&&this.filterPasses(a)){for(var c=null,d=!0,e=null,f=null,g=a.discarded,h=a.lastDisc,k=a.current;null!=k;){var l=k.obj.cullingCollider;null==l?l=!0:(l!=c&&(c=l,d=l.inFrustum(this.lightCamera.frustum)),l=d);l?null==e?e=f=k:f=f.next=k:null==g?g=h=k:h=h.next=
k;k=k.next}null!=f&&(f.next=null);null!=h&&(h.next=null);a.current=e;a.discarded=g;a.lastDisc=h;c=this.ctx.textures.allocTarget("dirShadowMap",this.size,this.size,!1,this.format);if(this.customDepth&&(null==this.depth||this.depth.width!=this.size||this.depth.height!=this.size||this.depth.isDisposed()))null!=this.depth&&this.depth.dispose(),this.depth=new Od(this.size,this.size);c.depthBuffer=this.depth;if(this.mode!=Db.Mixed||this.ctx.computingStatic)d=this.ctx.camera.target,e=null==this.light?this.ctx.lightSystem.shadowLight:
this.light,h=null==e?null:e.getShadowDirection(),null==h?(e=this.lightCamera.target,g=f=0,h=-1,null==h&&(h=0),null==g&&(g=0),null==f&&(f=0),e.x=f,e.y=g,e.z=h,e.w=1):(e=this.lightCamera.target,f=h.x,g=h.y,h=h.z,null==h&&(h=0),null==g&&(g=0),null==f&&(f=0),e.x=f,e.y=g,e.z=h,e.w=1,this.lightCamera.target.normalize()),this.lightCamera.target.x+=d.x,this.lightCamera.target.y+=d.y,this.lightCamera.target.z+=d.z,e=this.lightCamera.pos,e.x=d.x,e.y=d.y,e.z=d.z,e.w=d.w,this.lightCamera.update();this.ctx.engine.pushTarget(c);
this.ctx.engine.clear(16777215,1);vd.prototype.draw.call(this,a,b);null!=this.border&&this.border.render();this.ctx.engine.popTarget();this.mode==Db.Mixed&&!this.ctx.computingStatic&&(d=this.ctx.textures.allocTarget("mergedDirShadowMap",this.size,this.size,!1,this.format),this.mergePass.shader.texA__=c,this.mergePass.shader.texB__=this.staticTexture,this.ctx.engine.pushTarget(d),this.mergePass.render(),this.ctx.engine.popTarget(),c=d);0<this.blur.radius&&(this.mode!=Db.Mixed||!this.ctx.computingStatic)&&
this.blur.apply(this.ctx,c);this.syncShader(c)}},computeStatic:function(a){if(!(this.mode!=Db.Static&&this.mode!=Db.Mixed)){this.draw(a);a=this.staticTexture;this.staticTexture=this.dshader.shadowMap__.clone();this.staticTexture.name="StaticDirShadowMap";this.staticTexture.preventAutoDispose();var b=this.dshader;b.constModified=!0;b.shadowMap__=this.staticTexture;null!=a&&a.dispose()}},__class__:cf});var Yh=function(a,b){null==a&&(a=1024);null!=b&&(this.format=b);cf.call(this,null);this.set_size(a);
this.color=new B;this.set_mode(Db.Dynamic);this.shadowMapId=qa.allocID("shadow.map");this.shadowProjId=qa.allocID("shadow.proj");this.shadowColorId=qa.allocID("shadow.color");this.shadowPowerId=qa.allocID("shadow.power");this.shadowBiasId=qa.allocID("shadow.bias")};r["h3d.pass.DefaultShadowMap"]=Yh;Yh.__name__="h3d.pass.DefaultShadowMap";Yh.__super__=cf;Yh.prototype=J(cf.prototype,{draw:function(a,b){cf.prototype.draw.call(this,a,b);this.ctx.setGlobalID(this.shadowMapId,{texture:this.dshader.shadowMap__,
channel:this.format==S.nativeFormat?rb.PackedFloat:rb.R});this.ctx.setGlobalID(this.shadowProjId,this.getShadowProj());this.ctx.setGlobalID(this.shadowColorId,this.color);this.ctx.setGlobalID(this.shadowPowerId,this.power);this.ctx.setGlobalID(this.shadowBiasId,this.bias)},__class__:Yh});var $f=function(){this.viewport__=new B;this.colorID__=new B;T.call(this)};r["h3d.pass._HardwarePick.FixedColor"]=$f;$f.__name__="h3d.pass._HardwarePick.FixedColor";$f.__super__=T;$f.prototype=J(T.prototype,{get_colorID:function(){return this.colorID__},
set_colorID:function(a){return this.colorID__=a},get_viewport:function(){return this.viewport__},set_viewport:function(a){return this.viewport__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.colorID__;case 1:return this.viewport__}return null},getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create($f.prototype);a.shader=this.shader;a.colorID__=this.colorID__;a.viewport__=this.viewport__;return a},
__class__:$f});var Zh=function(){this.pickedIndex=-1;this.fixedColor=new $f;Ta.call(this,"hwpick");var a=this.material=new O(""),b=Z.One,c=Z.Zero;a.set_blendSrc(b);a.set_blendAlphaSrc(b);a.set_blendDst(c);a.set_blendAlphaDst(c);this.texOut=new S(3,3,[V.Target]);this.texOut.depthBuffer=new Od(3,3)};r["h3d.pass.HardwarePick"]=Zh;Zh.__name__="h3d.pass.HardwarePick";Zh.__super__=Ta;Zh.prototype=J(Ta.prototype,{dispose:function(){Ta.prototype.dispose.call(this);this.texOut.dispose();this.texOut.depthBuffer.dispose()},
getOutputs:function(){return[ec.Value("output.colorID")]},drawObject:function(a){Ta.prototype.drawObject.call(this,a);a=this.fixedColor.colorID__;var b=-16777216|++this.colorID;a.x=(b>>16&255)/255;a.y=(b>>8&255)/255;a.z=(b&255)/255;a.w=(b>>>24)/255},nextID:function(){var a=this.fixedColor.colorID__,b=-16777216|++this.colorID;a.x=(b>>16&255)/255;a.y=(b>>8&255)/255;a.z=(b&255)/255;a.w=(b>>>24)/255},draw:function(a,b){for(var c=a.current;null!=c;){var d=c,c=c.next;d.pass.bits&=-268435393;d.pass.bits|=
this.material.bits&268435392}this.colorID=0;c=this.fixedColor.colorID__;d=-16777216|++this.colorID;c.x=(d>>16&255)/255;c.y=(d>>8&255)/255;c.z=(d&255)/255;c.w=(d>>>24)/255;var c=this.fixedColor.viewport__,d=-(2*this.pickX/this.ctx.engine.width-1),e=2*this.pickY/this.ctx.engine.height-1,f=this.ctx.engine.width/this.texOut.width,g=this.ctx.engine.height/this.texOut.height;null==g&&(g=1);null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);c.x=d;c.y=e;c.z=f;c.w=g;this.ctx.engine.pushTarget(this.texOut);this.ctx.engine.clear(-16777216,
1);this.ctx.extraShaders=this.ctx.allocShaderList(this.fixedColor);Ta.prototype.draw.call(this,a,b);this.ctx.extraShaders=null;this.ctx.engine.popTarget();for(c=a.current;null!=c;)d=c,c=c.next,d.pass.set_blendSrc(d.pass.blendSrc),d.pass.set_blendDst(d.pass.blendDst),d.pass.set_blendOp(d.pass.blendOp),d.pass.set_blendAlphaSrc(d.pass.blendAlphaSrc),d.pass.set_blendAlphaDst(d.pass.blendAlphaDst),d.pass.set_blendAlphaOp(d.pass.blendAlphaOp),d.pass.colorMask=d.pass.colorMask;this.ctx.engine.clear(null,
null,0);c=this.texOut.capturePixels();this.pickedIndex=(c.getPixel(c.width>>1,c.height>>1)&16777215)-1},__class__:Zh});var $h=function(a){this.o=a};r["h3d.pass.PassListIterator"]=$h;$h.__name__="h3d.pass.PassListIterator";$h.prototype={hasNext:function(){return null!=this.o},next:function(){var a=this.o;this.o=this.o.next;return a},__class__:$h};var Xf=function(a){this.current=a;this.discarded=this.lastDisc=null};r["h3d.pass.PassList"]=Xf;Xf.__name__="h3d.pass.PassList";Xf.prototype={init:function(a){this.current=
a;this.discarded=this.lastDisc=null},reset:function(){null!=this.discarded&&(this.lastDisc.next=this.current,this.current=this.discarded,this.discarded=this.lastDisc=null)},save:function(){return this.lastDisc},load:function(a){this.lastDisc!=a&&(this.lastDisc.next=this.current,null==a?(this.current=this.discarded,this.discarded=null):(this.current=a.next,a.next=null),this.lastDisc=a)},isEmpty:function(){return null==this.current},clear:function(){if(null!=this.current){null==this.discarded?this.discarded=
this.current:this.lastDisc.next=this.current;for(var a=this.current;null!=a.next;)a=a.next;this.lastDisc=a;this.current=null}},sort:function(a){var b=this.current;if(null==b)a=null;else{for(var c=1,d,e=0,f=0,g,h,k,l;;){g=b;l=b=null;for(d=0;null!=g;){++d;h=g;f=e=0;for(k=c;f<k&&!(f++,++e,h=h.next,null==h););for(f=c;0<e||0<f&&null!=h;)0==e?(k=h,h=h.next,--f):0==f||null==h||0>=a(g,h)?(k=g,g=g.next,--e):(k=h,h=h.next,--f),null!=l?l.next=k:b=k,l=k;g=h}l.next=null;if(1>=d)break;c*=2}a=b}this.current=a},
filter:function(a){for(var b=null,c=null,d=this.discarded,e=this.lastDisc,f=this.current;null!=f;)a(f)?null==b?b=c=f:c=c.next=f:null==d?d=e=f:e=e.next=f,f=f.next;null!=c&&(c.next=null);null!=e&&(e.next=null);this.current=b;this.discarded=d;this.lastDisc=e},iterator:function(){return new $h(this.current)},getFiltered:function(){return new $h(this.discarded)},__class__:Xf};var Xh=function(){this.texture=0};r["h3d.pass.PassObject"]=Xh;Xh.__name__="h3d.pass.PassObject";Xh.prototype={__class__:Xh};var td=
function(a){this.shaderCache=wd.get();this.globals=new qa;this.currentOutput=new Gb(null);this.setOutput(a)};r["h3d.pass.ShaderManager"]=td;td.__name__="h3d.pass.ShaderManager";td.prototype={setOutput:function(a){null==a&&(a=[ec.Value("output.color")]);this.currentOutput.s=this.shaderCache.getLinkShader(a)},fillRec:function(a,b,c,d){switch(b._hx_index){case 1:return c[d]=a,1;case 3:return c[d]=a,1;case 5:var e=b.size;c[d++]=a.x;c[d++]=a.y;switch(e){case 3:c[d++]=a.z;break;case 4:c[d++]=a.z,c[d++]=
a.w}return e;case 6:return c[d++]=a._11,c[d++]=a._21,c[d++]=a._31,c[d++]=0,c[d++]=a._12,c[d++]=a._22,c[d++]=a._32,c[d++]=0,c[d++]=a._13,c[d++]=a._23,c[d++]=a._33,c[d++]=0,12;case 7:return c[d++]=a._11,c[d++]=a._21,c[d++]=a._31,c[d++]=a._41,c[d++]=a._12,c[d++]=a._22,c[d++]=a._32,c[d++]=a._42,c[d++]=a._13,c[d++]=a._23,c[d++]=a._33,c[d++]=a._43,c[d++]=a._14,c[d++]=a._24,c[d++]=a._34,c[d++]=a._44,16;case 8:return c[d++]=a._11,c[d++]=a._21,c[d++]=a._31,c[d++]=a._41,c[d++]=a._12,c[d++]=a._22,c[d++]=a._32,
c[d++]=a._42,c[d++]=a._13,c[d++]=a._23,c[d++]=a._33,c[d++]=a._43,12;case 13:for(var e=b.vl,f=b=0;f<e.length;){var g=e[f];++f;b+=this.fillRec(ua.field(a,g.name),g.type,c,d+b)}return b;case 15:switch(f=b.size,e=b.t,e._hx_index){case 3:if(0==f._hx_index){e=f.v;b=0;for(f=a.length<e?a.length:e;b<f;)g=b++,c[d++]=a[g];return e}throw new q("assert "+n.string(b));case 5:if(4==e.size)if(1==e.t._hx_index){if(0==f._hx_index){e=f.v;for(b=0;b<e;){f=b++;f=a[f];if(null==f)break;c[d++]=f.x;c[d++]=f.y;c[d++]=f.z;c[d++]=
f.w}return 4*e}}else{if(0==f._hx_index){b=f.v;for(g=f=0;g<b;){var h=g++,h=a[h];if(null==h)break;f=this.fillRec(h,e,c,d);d+=f}return b*f}}else if(0==f._hx_index){b=f.v;for(g=f=0;g<b;){h=g++;h=a[h];if(null==h)break;f=this.fillRec(h,e,c,d);d+=f}return b*f}throw new q("assert "+n.string(b));case 8:if(0==f._hx_index){e=f.v;for(b=0;b<e;){f=b++;f=a[f];if(null==f)break;c[d++]=f._11;c[d++]=f._21;c[d++]=f._31;c[d++]=f._41;c[d++]=f._12;c[d++]=f._22;c[d++]=f._32;c[d++]=f._42;c[d++]=f._13;c[d++]=f._23;c[d++]=
f._33;c[d++]=f._43}return 12*e}throw new q("assert "+n.string(b));default:if(0==f._hx_index){b=f.v;for(g=f=0;g<b;){h=g++;h=a[h];if(null==h)break;f=this.fillRec(h,e,c,d);d+=f}return b*f}throw new q("assert "+n.string(b));}default:throw new q("assert "+n.string(b));}},shaderInfo:function(a,b){for(var c=b.split(".").pop();null!=a;){for(var d=0,e=a.s.instance.shader.vars;d<e.length;){var f=e[d];++d;if(f.name==c)return a.s.toString()}a=a.next}return"(not found)"},getPtr:function(a){return a},getParamValue:function(a,
b,c){null==c&&(c=!1);if(null!=a.perObjectGlobal){c=this.globals.map.h[a.perObjectGlobal.gid];if(null==c)throw new q("Missing global value "+a.perObjectGlobal.path+" for shader "+this.shaderInfo(b,a.perObjectGlobal.path));return 17==a.type._hx_index?c.texture:c}for(var d=a.instance;0<--d;)b=b.next;d=b.s.getParamValue(a.index);if(null==d&&!c)throw new q("Missing param value "+n.string(b.s)+"."+a.name);return d},fillGlobals:function(a,b){for(var c=b.vertex,d=c.globals,e=a.vertex.globals;null!=d;){var f=
this.globals.map.h[d.gid];if(null==f){if("__consts__"==d.path){this.fillRec(c.consts,d.type,e,d.pos);d=d.next;continue}throw new q("Missing global value "+d.path);}this.fillRec(f,d.type,e,d.pos);d=d.next}c=b.fragment;d=c.globals;for(e=a.fragment.globals;null!=d;){f=this.globals.map.h[d.gid];if(null==f){if("__consts__"==d.path){this.fillRec(c.consts,d.type,e,d.pos);d=d.next;continue}throw new q("Missing global value "+d.path);}this.fillRec(f,d.type,e,d.pos);d=d.next}},fillParams:function(a,b,c){for(var d=
-1,e=null,f=a.vertex,g=b.vertex,h=g.params,k=f.params;null!=h;){var l;if(null==h.perObjectGlobal){if(h.type==u.TFloat){l=h.instance;if(d!=l){e=c;for(d=l;0<--l;)e=e.next;e=e.s}k[h.pos]=e.getParamFloatValue(h.index);h=h.next;continue}l=h.instance;if(d!=l){e=c;for(d=l;0<--l;)e=e.next;e=e.s}l=e.getParamValue(h.index);if(null==l)throw new q("Missing param value "+n.string(e)+"."+h.name);}else if(null!=h.perObjectGlobal){l=this.globals.map.h[h.perObjectGlobal.gid];if(null==l)throw new q("Missing global value "+
h.perObjectGlobal.path+" for shader "+this.shaderInfo(c,h.perObjectGlobal.path));l=17==h.type._hx_index?l.texture:l}else{l=c;for(var m=h.instance;0<--m;)l=l.next;m=l.s.getParamValue(h.index);if(null==m)throw new q("Missing param value "+n.string(l.s)+"."+h.name);l=m}this.fillRec(l,h.type,k,h.pos);h=h.next}h=0;for(k=g.textures;null!=k;){l=f.tex;var m=h++,t=!td.STRICT;null==t&&(t=!1);if(null!=k.perObjectGlobal){t=this.globals.map.h[k.perObjectGlobal.gid];if(null==t)throw new q("Missing global value "+
k.perObjectGlobal.path+" for shader "+this.shaderInfo(c,k.perObjectGlobal.path));t=17==k.type._hx_index?t.texture:t}else{for(var x=c,p=k.instance;0<--p;)x=x.next;p=x.s.getParamValue(k.index);if(null==p&&!t)throw new q("Missing param value "+n.string(x.s)+"."+k.name);t=p}l[m]=t;k=k.next}g=g.buffers;for(h=0;null!=g;){k=!td.STRICT;null==k&&(k=!1);if(null!=g.perObjectGlobal){k=this.globals.map.h[g.perObjectGlobal.gid];if(null==k)throw new q("Missing global value "+g.perObjectGlobal.path+" for shader "+
this.shaderInfo(c,g.perObjectGlobal.path));k=17==g.type._hx_index?k.texture:k}else{l=c;for(m=g.instance;0<--m;)l=l.next;m=l.s.getParamValue(g.index);if(null==m&&!k)throw new q("Missing param value "+n.string(l.s)+"."+g.name);k=m}f.buffers[h++]=k;g=g.next}a=a.fragment;b=b.fragment;f=b.params;for(g=a.params;null!=f;){if(null==f.perObjectGlobal){if(f.type==u.TFloat){h=f.instance;if(d!=h){e=c;for(d=h;0<--h;)e=e.next;e=e.s}g[f.pos]=e.getParamFloatValue(f.index);f=f.next;continue}h=f.instance;if(d!=h){e=
c;for(d=h;0<--h;)e=e.next;e=e.s}h=e.getParamValue(f.index);if(null==h)throw new q("Missing param value "+n.string(e)+"."+f.name);}else if(null!=f.perObjectGlobal){h=this.globals.map.h[f.perObjectGlobal.gid];if(null==h)throw new q("Missing global value "+f.perObjectGlobal.path+" for shader "+this.shaderInfo(c,f.perObjectGlobal.path));h=17==f.type._hx_index?h.texture:h}else{h=c;for(k=f.instance;0<--k;)h=h.next;k=h.s.getParamValue(f.index);if(null==k)throw new q("Missing param value "+n.string(h.s)+
"."+f.name);h=k}this.fillRec(h,f.type,g,f.pos);f=f.next}d=0;for(e=b.textures;null!=e;){f=a.tex;g=d++;h=!td.STRICT;null==h&&(h=!1);if(null!=e.perObjectGlobal){h=this.globals.map.h[e.perObjectGlobal.gid];if(null==h)throw new q("Missing global value "+e.perObjectGlobal.path+" for shader "+this.shaderInfo(c,e.perObjectGlobal.path));h=17==e.type._hx_index?h.texture:h}else{k=c;for(l=e.instance;0<--l;)k=k.next;l=k.s.getParamValue(e.index);if(null==l&&!h)throw new q("Missing param value "+n.string(k.s)+"."+
e.name);h=l}f[g]=h;e=e.next}d=b.buffers;for(e=0;null!=d;){b=!td.STRICT;null==b&&(b=!1);if(null!=d.perObjectGlobal){b=this.globals.map.h[d.perObjectGlobal.gid];if(null==b)throw new q("Missing global value "+d.perObjectGlobal.path+" for shader "+this.shaderInfo(c,d.perObjectGlobal.path));b=17==d.type._hx_index?b.texture:b}else{f=c;for(g=d.instance;0<--g;)f=f.next;g=f.s.getParamValue(d.index);if(null==g&&!b)throw new q("Missing param value "+n.string(f.s)+"."+d.name);b=g}a.buffers[e++]=b;d=d.next}},
compileShaders:function(a,b){null==b&&(b=!1);this.globals.maxChannels=0;for(var c=a;null!=c;){var d=c.s,c=c.next;d.updateConstants(this.globals)}this.currentOutput.next=a;c=this.shaderCache.link(this.currentOutput,b);this.currentOutput.next=null;return c},__class__:td};var Db=K["h3d.pass.RenderMode"]={__ename__:!0,__constructs__:["None","Static","Dynamic","Mixed"],None:{_hx_index:0,__enum__:"h3d.pass.RenderMode",toString:m},Static:{_hx_index:1,__enum__:"h3d.pass.RenderMode",toString:m},Dynamic:{_hx_index:2,
__enum__:"h3d.pass.RenderMode",toString:m},Mixed:{_hx_index:3,__enum__:"h3d.pass.RenderMode",toString:m}};Db.__empty_constructs__=[Db.None,Db.Static,Db.Dynamic,Db.Mixed];var Tg=K["h3d.pass.ShadowSamplingKind"]={__ename__:!0,__constructs__:["None","PCF","ESM"],None:{_hx_index:0,__enum__:"h3d.pass.ShadowSamplingKind",toString:m},PCF:{_hx_index:1,__enum__:"h3d.pass.ShadowSamplingKind",toString:m},ESM:{_hx_index:2,__enum__:"h3d.pass.ShadowSamplingKind",toString:m}};Tg.__empty_constructs__=[Tg.None,Tg.PCF,
Tg.ESM];var yj=function(){this.shaderCount=this.textureCount=1;this.shaderIdMap=[];this.textureIdMap=[]};r["h3d.pass.SortByMaterial"]=yj;yj.__name__="h3d.pass.SortByMaterial";yj.prototype={sort:function(a){for(var b=this.shaderCount,c=this.textureCount,d=a.current;null!=d;){var e=d,d=d.next;if(this.shaderIdMap[e.shader.id]<b||null==this.shaderIdMap[e.shader.id])this.shaderIdMap[e.shader.id]=this.shaderCount++;if(this.textureIdMap[e.texture]<c||null==this.textureIdMap[e.shader.id])this.textureIdMap[e.texture]=
this.textureCount++}b=a.current;if(null==b)b=null;else for(var c=1,f=e=0,g,h,k,l;;){g=b;l=b=null;for(d=0;null!=g;){++d;h=g;f=e=0;for(k=c;f<k&&!(f++,++e,h=h.next,null==h););for(f=c;0<e||0<f&&null!=h;)0==e?(k=h,h=h.next,--f):(0==f||null==h?k=!0:(k=this.shaderIdMap[g.shader.id]-this.shaderIdMap[h.shader.id],k=0>=(0!=k?k:this.textureIdMap[g.texture]-this.textureIdMap[h.texture])),k?(k=g,g=g.next,--e):(k=h,h=h.next,--f)),null!=l?l.next=k:b=k,l=k;g=h}l.next=null;if(1>=d)break;c*=2}a.current=b},__class__:yj};
var Gc=function(a,b){null==b&&(b=!1);this.isStatic=!0;this.hasTangents=!1;this.refCount=this.bufPos=this.idxPos=this.startIndex=0;this.isRaw=b;this.buffers=[];this.allIndexes=[];this.bounds=new Hb;this.stride=a;if(3>a)throw new q("Minimum stride = 3");};r["h3d.prim.BigPrimitive"]=Gc;Gc.__name__="h3d.prim.BigPrimitive";Gc.__super__=Pb;Gc.prototype=J(Pb.prototype,{begin:function(a,b){this.startIndex=this.bufPos/this.stride|0;if(65535<=this.startIndex+a){if(65535<=a)throw new q("Too many vertices in begin()");
this.flush()}if(null==this.tmpBuf&&(this.tmpBuf=Gc.PREV_BUFFER,null==this.tmpBuf?this.tmpBuf=Ob._new(0):Gc.PREV_BUFFER=null,this.isStatic))for(var c=this.tmpBuf,d=c.pos,e=65535*this.stride;d<e;){d++;if(c.pos==c.array.length){var f=c.array.length<<1;128>f&&(f=128);f=new Float32Array(f);f.set(c.array);c.array=f}c.array[c.pos++]=0}if(!this.isStatic){c=this.tmpBuf;d=c.pos;for(e=a*this.stride+this.bufPos;d<e;)d++,c.pos==c.array.length&&(f=c.array.length<<1,128>f&&(f=128),f=new Float32Array(f),f.set(c.array),
c.array=f),c.array[c.pos++]=0}null==this.tmpIdx&&(this.tmpIdx=Gc.PREV_INDEX,null==this.tmpIdx?this.tmpIdx=[]:Gc.PREV_INDEX=null);if(this.idxPos+b>this.tmpIdx.length){c=0==this.tmpIdx.length?1024:this.tmpIdx.length;for(d=this.idxPos+b;c<d;)c<<=1;for(d=this.tmpIdx;d.length<c;)d.push(0)}},addPoint:function(a,b,c){this.tmpBuf.array[this.bufPos++]=a;this.tmpBuf.array[this.bufPos++]=b;this.tmpBuf.array[this.bufPos++]=c;var d=this.bounds;a<d.xMin&&(d.xMin=a);a>d.xMax&&(d.xMax=a);b<d.yMin&&(d.yMin=b);b>d.yMax&&
(d.yMax=b);c<d.zMin&&(d.zMin=c);c>d.zMax&&(d.zMax=c)},addBounds:function(a,b,c){var d=this.bounds;a<d.xMin&&(d.xMin=a);a>d.xMax&&(d.xMax=a);b<d.yMin&&(d.yMin=b);b>d.yMax&&(d.yMax=b);c<d.zMin&&(d.zMin=c);c>d.zMax&&(d.zMax=c)},addVertexValue:function(a){this.tmpBuf.array[this.bufPos++]=a},addIndex:function(a){this.tmpIdx[this.idxPos++]=a+this.startIndex},triCount:function(){for(var a=0,b=0,c=this.allIndexes;b<c.length;){var d=c[b];++b;a+=d.count}a+=this.idxPos;return a/3|0},vertexCount:function(){for(var a=
0,b=0,c=this.buffers;b<c.length;){var d=c[b];++b;a+=d.vertices}return a+=this.bufPos/this.stride|0},flush:function(){if(null!=this.tmpBuf){if(0<this.bufPos&&0<this.idxPos){this.flushing=!0;var a=hb.ofSubFloats(this.tmpBuf,this.stride,this.bufPos/this.stride|0);this.isRaw&&(a.flags|=1<<ba.RawFormat._hx_index);this.buffers.push(a);a=md.alloc(this.tmpIdx,0,this.idxPos);this.allIndexes.push(a);this.flushing=!1}if(null==Gc.PREV_BUFFER||Gc.PREV_BUFFER.pos<this.tmpBuf.pos)Gc.PREV_BUFFER=this.tmpBuf;if(null==
Gc.PREV_INDEX||Gc.PREV_INDEX.length<this.tmpIdx.length)Gc.PREV_INDEX=this.tmpIdx;this.tmpIdx=this.tmpBuf=null;this.startIndex=this.idxPos=this.bufPos=0}},render:function(a){null!=this.tmpBuf&&this.flush();for(var b=0,c=this.buffers.length;b<c;){var d=b++;a.renderIndexed(this.buffers[d],this.allIndexes[d])}},getBounds:function(){return this.bounds},dispose:function(){this.clear()},clear:function(){if(this.flushing)throw new q("Cannot clear() BigPrimitive while it's flushing");var a=this.bounds;a.xMin=
1E20;a.xMax=-1E20;a.yMin=1E20;a.yMax=-1E20;a.zMin=1E20;a.zMax=-1E20;for(var a=0,b=this.buffers;a<b.length;){var c=b[a];++a;c.dispose()}a=0;for(b=this.allIndexes;a<b.length;)c=b[a],++a,c.dispose();this.buffers=[];this.allIndexes=[];this.idxPos=this.bufPos=0;this.tmpIdx=this.tmpBuf=null},add:function(a,b,c,d,e,f,g,h){null==h&&(h=-1);null==g&&(g=1);null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);this.addSub(a,b,0,0,a.pos/(0>h?this.stride:h)|0,b.length/3|0,c,d,e,f,g,h)},addSub:function(a,
b,c,d,e,f,g,h,k,l,m,t,p,n,r,s){null==r&&(r=1);null==n&&(n=0);null==p&&(p=0);null==t&&(t=-1);null==m&&(m=1);null==l&&(l=0);null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);0>t&&(t=this.stride);if(t<this.stride)throw new q("only stride >= "+this.stride+" allowed");this.begin(e,3*f);var u=this.startIndex,Eh=Math.cos(l);l=Math.sin(l);for(var gc=this.bufPos,H=this.tmpBuf,xc=0;xc<e;){var A=(xc++ +c)*t,y=a.array[A++],w=a.array[A++],v=a.array[A++];if(null!=s){var B=y,y=v;null==y&&(y=0);null==w&&(w=0);null==B&&
(B=0);var v=B,B=w,w=y,y=v*s._12+B*s._22+w*s._32+s._42,F=v*s._13+B*s._23+w*s._33+s._43,v=v*s._11+B*s._21+w*s._31+s._41,B=y,w=F;H.array[gc++]=v;H.array[gc++]=B;H.array[gc++]=w;y=this.bounds;v<y.xMin&&(y.xMin=v);v>y.xMax&&(y.xMax=v);B<y.yMin&&(y.yMin=B);B>y.yMax&&(y.yMax=B);w<y.zMin&&(y.zMin=w);w>y.zMax&&(y.zMax=w)}else B=g+(y*Eh-w*l)*m,w=h+(y*l+w*Eh)*m,v=k+v*m,H.array[gc++]=B,H.array[gc++]=w,H.array[gc++]=v,y=this.bounds,B<y.xMin&&(y.xMin=B),B>y.xMax&&(y.xMax=B),w<y.yMin&&(y.yMin=w),w>y.yMax&&(y.yMax=
w),v<y.zMin&&(y.zMin=v),v>y.zMax&&(y.zMax=v);6<=this.stride&&(y=a.array[A++],B=a.array[A++],v=a.array[A++],null!=s?(w=y,y=v,null==y&&(y=0),null==B&&(B=0),null==w&&(w=0),v=w,w=y,y=v*s._12+B*s._22+w*s._32,F=v*s._13+B*s._23+w*s._33,v=v*s._11+B*s._21+w*s._31,B=y,w=F,y=v*v+B*B+w*w,y=1/Math.sqrt(y),v*=y,B*=y,w*=y,H.array[gc++]=v,H.array[gc++]=B,H.array[gc++]=w):(w=y*Eh-B*l,B=y*l+B*Eh,H.array[gc++]=w,H.array[gc++]=B,H.array[gc++]=v));v=this.stride;if(this.hasTangents){F=a.array[A++];w=a.array[A++];B=a.array[A++];
if(null!=s){y=F;F=B;null==F&&(F=0);null==w&&(w=0);null==y&&(y=0);var B=y,y=F,F=B*B+w*w+y*y,G=B*s._12+w*s._22+y*s._32,z=B*s._13+w*s._23+y*s._33,B=B*s._11+w*s._21+y*s._31,w=G,y=z,G=B*B+w*w+y*y,G=1/Math.sqrt(G),B=B*G,w=w*G,y=y*G;0.5>F&&(B*=0.5,w*=0.5,y*=0.5);H.array[gc++]=B;H.array[gc++]=w;H.array[gc++]=y}else y=F*Eh-w*l,w=F*l+w*Eh,H.array[gc++]=y,H.array[gc++]=w,H.array[gc++]=B;v-=3}switch(v){case 3:case 6:continue;case 4:case 7:H.array[gc++]=a.array[A++]+p;break;case 5:case 8:case 9:case 10:H.array[gc++]=
a.array[A++]+p;H.array[gc++]=a.array[A++]+n;for(B=8;B<v;)B++,H.array[gc++]=a.array[A++];break;default:H.array[gc++]=a.array[A++]+p;H.array[gc++]=a.array[A++]+n;H.array[gc++]=a.array[A++]*r;H.array[gc++]=a.array[A++]*r;H.array[gc++]=a.array[A++]*r;for(B=11;B<v;)B++,H.array[gc++]=a.array[A++]}}this.bufPos=gc;u-=c;a=0;for(f*=3;a<f;)c=a++,c=b[c+3*d]+u,this.tmpIdx[this.idxPos++]=c},__class__:Gc});var Rd=function(){this.refCount=0};r["h3d.prim.MeshPrimitive"]=Rd;Rd.__name__="h3d.prim.MeshPrimitive";Rd.__super__=
Pb;Rd.prototype=J(Pb.prototype,{allocBuffer:function(a,b){return null},hasBuffer:function(a){if(null==this.bufferCache)return!1;var b=this.bufferCache;a=qa.allocID(a);return b.h.hasOwnProperty(a)},addBuffer:function(a,b,c){null==c&&(c=0);null==this.bufferCache&&(this.bufferCache=new na);a=qa.allocID(a);var d=this.bufferCache.h[a];null!=d&&d.dispose();d=this.bufferCache;b=new Hg(b,c);d.h[a]=b;this.layouts=null},dispose:function(){Pb.prototype.dispose.call(this);if(null!=this.bufferCache)for(var a=
this.bufferCache.iterator();a.hasNext();)a.next().dispose();this.layouts=this.bufferCache=null},getBuffers:function(a){null==this.bufferCache&&(this.bufferCache=new na);null==this.layouts&&(this.layouts=new na);var b=a.driver.getShaderInputNames(),c=this.layouts.h[b.id];if(null!=c)return c;for(var d=null,e=0,f=b.names;e<f.length;){var g=f[e];++e;var h=qa.allocID(g),k=this.bufferCache.h[h];if(null==k){k=this.allocBuffer(a,g);if(null==k)throw new q("Buffer "+g+" is not available");this.bufferCache.h[h]=
k}k=new Hg(k.buffer,k.offset);null==d?c=d=k:d=d.next=k}return this.layouts.h[b.id]=c},render:function(a){(null==this.indexes||this.indexes.isDisposed())&&this.alloc(a);a.renderMultiBuffers(this.getBuffers(a),this.indexes)},__class__:Rd});var Ug=function(a,b,c){this.bufferAliases=new ga;this.refCount=0;this.data=a;this.dataPosition=b;this.lib=c};r["h3d.prim.HMDModel"]=Ug;Ug.__name__="h3d.prim.HMDModel";Ug.__super__=Rd;Ug.prototype=J(Rd.prototype,{triCount:function(){return this.data.get_indexCount()/
3|0},vertexCount:function(){return this.data.vertexCount},getBounds:function(){return this.data.bounds},selectMaterial:function(a){this.curMaterial=a},getDataBuffers:function(a,b,c){return this.lib.getBuffers(this.data,a,b,c)},loadSkin:function(a){this.lib.loadSkin(this.data,a)},addAlias:function(a,b,c){null==c&&(c=0);var d=this.bufferAliases;b={realName:b,offset:c};null!=Q[a]?d.setReserved(a,b):d.h[a]=b},alloc:function(a){this.dispose();this.buffer=new hb(this.data.vertexCount,this.data.vertexStride);
a=this.lib.resource.entry;a.open();a.skip(this.dataPosition+this.data.vertexPosition);var b=4*this.data.vertexCount*this.data.vertexStride,c=new N(new ArrayBuffer(b));a.read(c,0,b);this.buffer.uploadBytes(c,0,this.data.vertexCount);this.indexCount=0;this.indexesTriPos=[];for(var c=0,d=this.data.indexCounts;c<d.length;){var e=d[c];++c;this.indexesTriPos.push(this.indexCount/3|0);this.indexCount+=e}this.indexes=new md(this.indexCount);a.skip(this.data.indexPosition-(this.data.vertexPosition+b));b=new N(new ArrayBuffer(2*
this.indexCount));a.read(b,0,2*this.indexCount);this.indexes.uploadBytes(b,0,this.indexCount);a.close();b=a=0;for(c=this.data.vertexFormat;b<c.length;)d=c[b],++b,this.addBuffer(d.name,this.buffer,a),a+=d.format&7;null!=this.normalsRecomputed&&this.recomputeNormals(this.normalsRecomputed);for(a=this.bufferAliases.keys();a.hasNext();){b=a.next();c=this.bufferAliases;c=null!=Q[b]?c.getReserved(b):c.h[b];d=this.bufferCache;e=qa.allocID(c.realName);d=d.h[e];if(null==d)throw new q("Buffer "+c.realName+
" not found for alias "+b);if(d.offset+c.offset>d.buffer.buffer.stride)throw new q("Alias "+b+" for buffer "+c.realName+" outside stride");this.addBuffer(b,d.buffer,d.offset+c.offset)}},recomputeNormals:function(a){null==a&&(a="normal");for(var b=this.lib.getBuffers(this.data,[new gd("position",3)]),c=[],d=[],e=0,f=this.data.vertexCount;e<f;){for(var g=e++,h=!1,k=b.vertexes[3*g],l=b.vertexes[3*g+1],g=b.vertexes[3*g+2],m=0,t=d.length;m<t;){var p=m++,n=d[p];if(n.x==k&&n.y==l&&n.z==g){c.push(p);h=!0;
break}}h||(c.push(d.length),d.push(new wa(k,l,g)))}e=[];f=0;for(b=b.indexes;f<b.length;)h=b[f],++f,e.push(c[h]);d=new ai(d,e);d.addNormals();b=Ob._new(0);e=b.pos;for(f=3*this.data.vertexCount;e<f;)e++,b.pos==b.array.length&&(h=b.array.length<<1,128>h&&(h=128),h=new Float32Array(h),h.set(b.array),b.array=h),b.array[b.pos++]=0;f=e=0;for(h=this.data.vertexCount;f<h;)k=f++,k=d.normals[c[k]],b.array[e++]=k.x,b.array[e++]=k.y,b.array[e++]=k.z;c=hb.ofFloats(b,3);this.addBuffer(a,c,0);this.normalsRecomputed=
a},render:function(a){0>this.curMaterial?Rd.prototype.render.call(this,a):((null==this.indexes||this.indexes.isDisposed())&&this.alloc(a),a.renderMultiBuffers(this.getBuffers(a),this.indexes,this.indexesTriPos[this.curMaterial],this.data.indexCounts[this.curMaterial]/3|0),this.curMaterial=-1)},initCollider:function(a){var b=this.lib.getBuffers(this.data,[new gd("position",3)]);a.setData(b.vertexes,b.indexes);if(null==this.collider){var b=this.data.bounds,c=b.xMax-b.xMin,d=b.yMax-b.yMin,e=b.zMax-b.zMin,
b=new If(0.5*(b.xMin+b.xMax),0.5*(b.yMin+b.yMax),0.5*(b.zMin+b.zMax),0.5*Math.sqrt(c*c+d*d+e*e));this.collider=new Lg(b,a)}},getCollider:function(){if(null!=this.collider)return this.collider;var a=new Jf;a.source={entry:this.lib.resource.entry,geometryName:null};for(var b=0,c=this.lib.header.models;b<c.length;){var d=c[b];++b;if(this.lib.header.geometries[d.geometry]==this.data){a.source.geometryName=d.name;break}}this.initCollider(a);return this.collider},__class__:Ug});var se=function(){this.refCount=
0};r["h3d.prim.Plane2D"]=se;se.__name__="h3d.prim.Plane2D";se.get=function(){var a=X.CURRENT,b=a.resCache.h[se.__id__];null==b&&(b=new se,a.resCache.set(se,b));return b};se.__super__=Pb;se.prototype=J(Pb.prototype,{triCount:function(){return 2},vertexCount:function(){return 4},alloc:function(a){a=Ob._new(0);if(a.pos==a.array.length){var b=a.array.length<<1;128>b&&(b=128);b=new Float32Array(b);b.set(a.array);a.array=b}a.array[a.pos++]=-1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=
new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=-1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=0;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=-1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),
b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=0;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=0;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),
b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=-1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),
b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=1;a.pos==a.array.length&&(b=a.array.length<<1,128>b&&(b=128),b=new Float32Array(b),b.set(a.array),a.array=b);a.array[a.pos++]=0;this.buffer=hb.ofFloats(a,4,[ba.Quads,ba.RawFormat])},render:function(a){(null==this.buffer||this.buffer.isDisposed())&&this.alloc(a);a.renderBuffer(this.buffer,a.mem.quadIndexes,2,0,
-1)},__class__:se});var ai=function(a,b){this.translatedX=this.translatedY=this.translatedZ=0;this.scaled=1;this.refCount=0;this.points=a;this.idx=b};r["h3d.prim.Polygon"]=ai;ai.__name__="h3d.prim.Polygon";ai.__super__=Rd;ai.prototype=J(Rd.prototype,{getBounds:function(){for(var a=new Hb,b=0,c=this.points;b<c.length;){var d=c[b];++b;d.x<a.xMin&&(a.xMin=d.x);d.x>a.xMax&&(a.xMax=d.x);d.y<a.yMin&&(a.yMin=d.y);d.y>a.yMax&&(a.yMax=d.y);d.z<a.zMin&&(a.zMin=d.z);d.z>a.zMax&&(a.zMax=d.z)}return a},alloc:function(a){this.dispose();
var b=3;a=["position"];var c=[0];null!=this.normals&&(a.push("normal"),c.push(b),b+=3);null!=this.tangents&&(a.push("tangent"),c.push(b),b+=3);null!=this.uvs&&(a.push("uv"),c.push(b),b+=2);null!=this.colors&&(a.push("color"),c.push(b),b+=3);for(var d=Ob._new(0),e=0,f=this.points.length;e<f;){var g=e++,h=this.points[g],k=h.x;if(d.pos==d.array.length){var l=d.array.length<<1;128>l&&(l=128);l=new Float32Array(l);l.set(d.array);d.array=l}d.array[d.pos++]=k;k=h.y;d.pos==d.array.length&&(l=d.array.length<<
1,128>l&&(l=128),l=new Float32Array(l),l.set(d.array),d.array=l);d.array[d.pos++]=k;h=h.z;d.pos==d.array.length&&(k=d.array.length<<1,128>k&&(k=128),k=new Float32Array(k),k.set(d.array),d.array=k);d.array[d.pos++]=h;null!=this.normals&&(h=this.normals[g],k=h.x,d.pos==d.array.length&&(l=d.array.length<<1,128>l&&(l=128),l=new Float32Array(l),l.set(d.array),d.array=l),d.array[d.pos++]=k,k=h.y,d.pos==d.array.length&&(l=d.array.length<<1,128>l&&(l=128),l=new Float32Array(l),l.set(d.array),d.array=l),d.array[d.pos++]=
k,h=h.z,d.pos==d.array.length&&(k=d.array.length<<1,128>k&&(k=128),k=new Float32Array(k),k.set(d.array),d.array=k),d.array[d.pos++]=h);null!=this.tangents&&(h=this.tangents[g],k=h.x,d.pos==d.array.length&&(l=d.array.length<<1,128>l&&(l=128),l=new Float32Array(l),l.set(d.array),d.array=l),d.array[d.pos++]=k,k=h.y,d.pos==d.array.length&&(l=d.array.length<<1,128>l&&(l=128),l=new Float32Array(l),l.set(d.array),d.array=l),d.array[d.pos++]=k,h=h.z,d.pos==d.array.length&&(k=d.array.length<<1,128>k&&(k=128),
k=new Float32Array(k),k.set(d.array),d.array=k),d.array[d.pos++]=h);null!=this.uvs&&(h=this.uvs[g],k=h.u,d.pos==d.array.length&&(l=d.array.length<<1,128>l&&(l=128),l=new Float32Array(l),l.set(d.array),d.array=l),d.array[d.pos++]=k,h=h.v,d.pos==d.array.length&&(k=d.array.length<<1,128>k&&(k=128),k=new Float32Array(k),k.set(d.array),d.array=k),d.array[d.pos++]=h);null!=this.colors&&(g=this.colors[g],h=g.x,d.pos==d.array.length&&(k=d.array.length<<1,128>k&&(k=128),k=new Float32Array(k),k.set(d.array),
d.array=k),d.array[d.pos++]=h,h=g.y,d.pos==d.array.length&&(k=d.array.length<<1,128>k&&(k=128),k=new Float32Array(k),k.set(d.array),d.array=k),d.array[d.pos++]=h,g=g.z,d.pos==d.array.length&&(h=d.array.length<<1,128>h&&(h=128),h=new Float32Array(h),h.set(d.array),d.array=h),d.array[d.pos++]=g)}e=[];null==this.idx&&e.push(ba.Triangles);(null==this.normals||null!=this.tangents)&&e.push(ba.RawFormat);this.buffer=hb.ofFloats(d,b,e);b=0;for(d=a.length;b<d;)e=b++,this.addBuffer(a[e],this.buffer,c[e]);null!=
this.idx&&(this.indexes=md.alloc(this.idx))},unindex:function(){if(null!=this.idx&&this.points.length!=this.idx.length){for(var a=[],b=0,c=this.idx.length;b<c;){var d=b++,d=this.points[this.idx[d]];a.push(new wa(d.x,d.y,d.z))}if(null!=this.normals){b=[];c=0;for(d=this.idx.length;c<d;){var e=c++,e=this.normals[this.idx[e]];b.push(new wa(e.x,e.y,e.z))}this.normals=b}if(null!=this.tangents){b=[];c=0;for(d=this.idx.length;c<d;)e=c++,e=this.tangents[this.idx[e]],b.push(new wa(e.x,e.y,e.z));this.tangents=
b}if(null!=this.colors){b=[];c=0;for(d=this.idx.length;c<d;)e=c++,e=this.colors[this.idx[e]],b.push(new wa(e.x,e.y,e.z));this.colors=b}if(null!=this.uvs){b=[];c=0;for(d=this.idx.length;c<d;)e=c++,b.push(this.uvs[this.idx[e]].clone());this.uvs=b}this.points=a;this.idx=null}},translate:function(a,b,c){this.translatedX+=a;this.translatedY+=b;this.translatedZ+=c;for(var d=0,e=this.points;d<e.length;){var f=e[d];++d;f.x+=a;f.y+=b;f.z+=c}},scale:function(a){this.scaled*=a;for(var b=0,c=this.points;b<c.length;){var d=
c[b];++b;d.x*=a;d.y*=a;d.z*=a}},addNormals:function(){this.normals=[];for(var a=0,b=this.points.length;a<b;){var c=a++;this.normals[c]=new wa}b=a=0;for(c=this.triCount();b<c;){b++;var d,e,f;null==this.idx?(++a,d=a-1,++a,e=a-1,++a,f=a-1):(d=this.idx[a++],e=this.idx[a++],f=this.idx[a++]);var g=this.points[d],h=this.points[e],k=this.points[f],l=h.x-g.x,m=h.y-g.y,h=h.z-g.z;null==h&&(h=0);null==m&&(m=0);null==l&&(l=0);var t=k.x-g.x,p=k.y-g.y,n=k.z-g.z;null==n&&(n=0);null==p&&(p=0);null==t&&(t=0);g=t;k=
p;t=n;p=m*t-h*k;h=h*g-l*t;l=l*k-m*g;null==l&&(l=0);null==h&&(h=0);null==p&&(p=0);m=p;this.normals[d].x+=m;this.normals[d].y+=h;this.normals[d].z+=l;this.normals[e].x+=m;this.normals[e].y+=h;this.normals[e].z+=l;this.normals[f].x+=m;this.normals[f].y+=h;this.normals[f].z+=l}a=0;for(b=this.normals;a<b.length;)c=b[a],++a,c.normalize()},addTangents:function(){null==this.normals&&this.addNormals();null==this.uvs&&this.addUVs();this.tangents=[];for(var a=0,b=this.points.length;a<b;){var c=a++;this.tangents[c]=
new wa}b=a=0;for(c=this.triCount();b<c;){b++;var d,e,f;null==this.idx?(++a,d=a-1,++a,e=a-1,++a,f=a-1):(d=this.idx[a++],e=this.idx[a++],f=this.idx[a++]);var g=this.points[d],h=this.points[e],k=this.points[f],l=this.uvs[d],m=this.uvs[e],t=this.uvs[f],p=this.normals[d],n=h.x-g.x,q=h.y-g.y,h=h.z-g.z;null==h&&(h=0);null==q&&(q=0);null==n&&(n=0);var r=k.x-g.x,s=k.y-g.y,u=k.z-g.z;null==u&&(u=0);null==s&&(s=0);null==r&&(r=0);g=r;k=s;s=u;t=t.v-l.v;n*=t;q*=t;h*=t;l=m.v-l.v;g*=l;k*=l;s*=l;l=new wa(n-g,q-k,h-
s);l=new wa(p.y*l.z-p.z*l.y,p.z*l.x-p.x*l.z,p.x*l.y-p.y*l.x);l.normalize();l=new wa(l.y*p.z-l.z*p.y,l.z*p.x-l.x*p.z,l.x*p.y-l.y*p.x);l.normalize();this.tangents[d].x+=l.x;this.tangents[d].y+=l.y;this.tangents[d].z+=l.z;this.tangents[e].x+=l.x;this.tangents[e].y+=l.y;this.tangents[e].z+=l.z;this.tangents[f].x+=l.x;this.tangents[f].y+=l.y;this.tangents[f].z+=l.z}a=0;for(b=this.tangents;a<b.length;)c=b[a],++a,c.normalize()},addUVs:function(){this.uvs=[];for(var a=0,b=this.points.length;a<b;){var c=a++;
this.uvs[c]=new bi(this.points[c].x,this.points[c].y)}},uvScale:function(a,b){if(null==this.uvs)throw new q("Missing UVs");for(var c=new zb,d=0,e=this.uvs;d<e.length;){var f=e[d];++d;null==c.h.__keys__[f.__id__]&&(c.set(f,!0),f.u*=a,f.v*=b)}},triCount:function(){var a=Rd.prototype.triCount.call(this);return 0!=a?a:(null==this.idx?this.points.length:this.idx.length)/3|0},vertexCount:function(){return this.points.length},getCollider:function(){for(var a=Array(3*this.points.length),b=Array(this.idx.length),
c=0,d=0,e=this.points;d<e.length;){var f=e[d];++d;a[c++]=f.x;a[c++]=f.y;a[c++]=f.z}c=0;for(d=this.idx.length;c<d;)e=c++,b[e]=this.idx[e];c=new Og;c.addBuffers(a,b);return c},render:function(a){(null==this.buffer||this.buffer.isDisposed())&&this.alloc(a);var b=this.getBuffers(a);null!=this.indexes?a.renderMultiBuffers(b,this.indexes):0!=(this.buffer.flags&1<<ba.Quads._hx_index)?a.renderMultiBuffers(b,a.mem.quadIndexes,0,this.triCount()):a.renderMultiBuffers(b,a.mem.triIndexes,0,this.triCount())},__class__:ai});
var Wh=function(a,b){null==b&&(b=!1);this.refCount=0;this.onContextLost=function(){return a};this.bounds=a.bounds;this.alloc(null);b||(this.onContextLost=null)};r["h3d.prim.RawPrimitive"]=Wh;Wh.__name__="h3d.prim.RawPrimitive";Wh.__super__=Pb;Wh.prototype=J(Pb.prototype,{alloc:function(a){if(null==this.onContextLost)throw new q("Cannot realloc "+n.string(this));a=this.onContextLost();var b=[];null==a.ibuf&&b.push(a.quads?ba.Quads:ba.Triangles);8>a.stride&&b.push(ba.RawFormat);this.buffer=hb.ofFloats(a.vbuf,
a.stride,b);this.vcount=this.buffer.vertices;this.tcount=null!=a.ibuf?a.ibuf.length/3|0:a.quads?this.vcount>>1:this.vcount/3|0;null!=a.ibuf?this.indexes=md.alloc(a.ibuf):null!=this.indexes&&(this.indexes.dispose(),this.indexes=null)},getBounds:function(){if(null==this.bounds)throw new q("Bounds not defined for "+n.string(this));return this.bounds},triCount:function(){return this.tcount},vertexCount:function(){return this.vcount},__class__:Wh});var bi=function(a,b){this.u=a;this.v=b};r["h3d.prim.UV"]=
bi;bi.__name__="h3d.prim.UV";bi.prototype={clone:function(){return new bi(this.u,this.v)},toString:function(){return"{"+L.fmt(this.u)+","+L.fmt(this.v)+"}"},__class__:bi};var ag=function(a,b,c,d,e,f,g){this.x=a;this.y=b;this.z=c;this.r=d;this.g=e;this.b=f;this.a=g};r["h3d.scene._Graphics.GPoint"]=ag;ag.__name__="h3d.scene._Graphics.GPoint";ag.prototype={__class__:ag};var ya=function(a){this.flags=0;this.absPos=new P;this.absPos.identity();this.x=0;this.flags|=1;this.y=0;this.flags|=1;this.z=0;this.flags|=
1;this.scaleX=1;this.flags|=1;this.scaleY=1;this.flags|=1;this.scaleZ=1;this.flags|=1;this.qRot=new Oe;this.flags=null!=this.follow?this.flags|1:this.flags&-2;this.flags|=2;this.children=[];null!=a&&a.addChild(this)};r["h3d.scene.Object"]=ya;ya.__name__="h3d.scene.Object";ya.__interfaces__=[bc];ya.prototype={set_cullingCollider:function(a){this.cullingCollider=a;this.flags&=-4097;return a},get_visible:function(){return 0!=(this.flags&2)},get_allocated:function(){return 0!=(this.flags&32)},get_posChanged:function(){return 0!=
(this.flags&1)},get_culled:function(){return 0!=(this.flags&4)},get_followPositionOnly:function(){return 0!=(this.flags&8)},get_lightCameraCenter:function(){return 0!=(this.flags&16)},get_alwaysSync:function(){return 0!=(this.flags&64)},get_inheritCulled:function(){return 0!=(this.flags&128)},get_ignoreBounds:function(){return 0!=(this.flags&512)},get_ignoreCollide:function(){return 0!=(this.flags&1024)},get_allowSerialize:function(){return 0==(this.flags&256)},get_ignoreParentTransform:function(){return 0!=
(this.flags&2048)},get_cullingColliderInherited:function(){return 0!=(this.flags&4096)},set_posChanged:function(a){this.flags=(a=a||null!=this.follow)?this.flags|1:this.flags&-2;return a},set_culled:function(a){this.flags=a?this.flags|4:this.flags&-5;return a},set_visible:function(a){this.flags=a?this.flags|2:this.flags&-3;return a},set_allocated:function(a){this.flags=a?this.flags|32:this.flags&-33;return a},set_followPositionOnly:function(a){this.flags=a?this.flags|8:this.flags&-9;return a},set_lightCameraCenter:function(a){this.flags=
a?this.flags|16:this.flags&-17;return a},set_alwaysSync:function(a){this.flags=a?this.flags|64:this.flags&-65;return a},set_ignoreBounds:function(a){this.flags=a?this.flags|512:this.flags&-513;return a},set_inheritCulled:function(a){this.flags=a?this.flags|128:this.flags&-129;return a},set_ignoreCollide:function(a){this.flags=a?this.flags|1024:this.flags&-1025;return a},set_allowSerialize:function(a){this.flags=(a=!a)?this.flags|256:this.flags&-257;return!a},set_ignoreParentTransform:function(a){this.flags=
a?this.flags|2048:this.flags&-2049;return a},set_cullingColliderInherited:function(a){this.flags=a?this.flags|4096:this.flags&-4097;return a},playAnimation:function(a){return this.currentAnimation=a.createInstance(this)},switchToAnimation:function(a){return this.currentAnimation=a},stopAnimation:function(a){null==a&&(a=!1);this.currentAnimation=null;if(a){a=0;for(var b=this.children;a<b.length;){var c=b[a];++a;c.stopAnimation(!0)}}},applyAnimationTransform:function(a){null==a&&(a=!0);if(null!=this.defaultTransform){var b=
this.defaultTransform,c=null;null==c&&(c=new B);c.x=Math.sqrt(b._11*b._11+b._12*b._12+b._13*b._13);c.y=Math.sqrt(b._21*b._21+b._22*b._22+b._23*b._23);c.z=Math.sqrt(b._31*b._31+b._32*b._32+b._33*b._33);0>b._11*(b._22*b._33-b._23*b._32)+b._12*(b._23*b._31-b._21*b._33)+b._13*(b._21*b._32-b._22*b._31)&&(c.x*=-1,c.y*=-1,c.z*=-1);b=c;this.scaleX=b.x;this.flags|=1;this.scaleY=b.y;this.flags|=1;this.scaleZ=b.z;this.flags|=1;this.qRot.initRotateMatrix(this.defaultTransform);this.x=this.defaultTransform._41;
this.flags|=1;this.y=this.defaultTransform._42;this.flags|=1;this.z=this.defaultTransform._43;this.flags|=1;this.defaultTransform=null;this.flags|=1}if(a){a=0;for(b=this.children;a<b.length;)c=b[a],++a,c.applyAnimationTransform()}},getObjectsCount:function(){for(var a=0,b=0,c=this.children;b<c.length;){var d=c[b];++b;a+=d.getObjectsCount()+1}return a},getMaterialByName:function(a){for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d=d.getMaterialByName(a);if(null!=d)return d}return null},find:function(a){var b=
a(this);if(null!=b)return b;for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d=d.find(a);if(null!=d)return d}return null},findAll:function(a,b){null==b&&(b=[]);var c=a(this);null!=c&&b.push(c);for(var c=0,d=this.children;c<d.length;){var e=d[c];++c;e.findAll(a,b)}return b},getMaterials:function(a){null==a&&(a=[]);for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.getMaterials(a)}return a},localToGlobal:function(a){this.syncPos();null==a&&(a=new B);var b=this.absPos,c=a.x*b._12+a.y*b._22+
a.z*b._32+a.w*b._42,d=a.x*b._13+a.y*b._23+a.z*b._33+a.w*b._43;a.x=a.x*b._11+a.y*b._21+a.z*b._31+a.w*b._41;a.y=c;a.z=d;return a},globalToLocal:function(a){var b=this.getInvPos(),c=a.x*b._12+a.y*b._22+a.z*b._32+a.w*b._42,d=a.x*b._13+a.y*b._23+a.z*b._33+a.w*b._43;a.x=a.x*b._11+a.y*b._21+a.z*b._31+a.w*b._41;a.y=c;a.z=d;return a},getInvPos:function(){this.syncPos();null==this.invPos&&(this.invPos=new P,this.invPos._44=0);0==this.invPos._44&&this.invPos.inverse3x4(this.absPos);return this.invPos},getBounds:function(a){null==
a&&(a=new Hb);null!=this.parent&&this.parent.syncPos();return this.getBoundsRec(a)},getBoundsRec:function(a){if(0!=(this.flags&1)){for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.flags|=1}this.flags=null!=this.follow?this.flags|1:this.flags&-2;this.calcAbsPos()}b=0;for(c=this.children;b<c.length;)d=c[b],++b,d.getBoundsRec(a);return a},getMeshes:function(a){null==a&&(a=[]);var b=this instanceof Da?this:null;null!=b&&a.push(b);for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.getMeshes(a)}return a},
getMeshByName:function(a){a=this.getObjectByName(a);return a instanceof Da?a:null},getObjectByName:function(a){if(this.name==a)return this;for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d=d.getObjectByName(a);if(null!=d)return d}return null},clone:function(a){null==a&&(a=new ya);a.x=this.x;a.flags|=1;a.y=this.y;a.flags|=1;a.z=this.z;a.flags|=1;a.scaleX=this.scaleX;a.flags|=1;a.scaleY=this.scaleY;a.flags|=1;a.scaleZ=this.scaleZ;a.flags|=1;var b=a.qRot,c=this.qRot;b.x=c.x;b.y=c.y;b.z=c.z;b.w=
c.w;a.name=this.name;a.set_follow(this.follow);a.flags=0!=(this.flags&8)?a.flags|8:a.flags&-9;a.flags=0!=(this.flags&2)?a.flags|2:a.flags&-3;null!=this.defaultTransform&&(b=this.defaultTransform.clone(),a.defaultTransform=b,a.flags|=1);b=0;for(c=this.children;b<c.length;){var d=c[b];++b;d=d.clone();d.parent=a;a.children.push(d)}return a},addChild:function(a){this.addChildAt(a,this.children.length)},addChildAt:function(a,b){0>b&&(b=0);b>this.children.length&&(b=this.children.length);for(var c=this;null!=
c;){if(c==a)throw new q("Recursive addChild");c=c.parent}null!=a.parent&&(c=0!=(a.flags&32),a.flags&=-33,a.parent.removeChild(a),a.flags=c?a.flags|32:a.flags&-33);this.children.splice(b,0,a);if(0==(this.flags&32)&&0!=(a.flags&32))a.onRemove();a.parent=this;a.flags|=1;if(0!=(this.flags&32))if(0==(a.flags&32))a.onAdd();else a.onParentChanged()},iterVisibleMeshes:function(a){if(!(0==(this.flags&2)||0!=(this.flags&4)&&0!=(this.flags&128))){if(0==(this.flags&4)){var b=this instanceof Da?this:null;null!=
b&&a(b)}for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.iterVisibleMeshes(a)}}},onParentChanged:function(){for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.onParentChanged()}},onAdd:function(){this.flags|=32;for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.onAdd()}},onRemove:function(){this.flags&=-33;for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.onRemove()}},removeChild:function(a){if(v.remove(this.children,a)){if(0!=(a.flags&32))a.onRemove();a.parent=null;
a.flags|=1}},removeChildren:function(){for(;0<this.children.length;)this.removeChild(this.children[0])},remove:function(){null!=this.parent&&this.parent.removeChild(this)},getScene:function(){for(var a=this;null!=a.parent;)a=a.parent;return a instanceof ee?a:null},getAbsPos:function(){this.syncPos();return this.absPos},isMesh:function(){return null!=(this instanceof Da?this:null)},toMesh:function(){var a=this instanceof Da?this:null;if(null!=a)return a;throw new q(n.string(this)+" is not a Mesh");
},getCollider:function(){if(0!=(this.flags&1024))return null;var a=[],b=this.getGlobalCollider();null!=b&&a.push(b);for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d=d.getCollider();if(null!=d){var e=d instanceof Mg?d:null;if(null!=e){d=0;for(e=e.colliders;d<e.length;){var f=e[d];++d;a.push(f)}}else a.push(d)}}return 0==a.length?null:1==a.length?a[0]:new Mg(a)},getGlobalCollider:function(){if(0!=(this.flags&1024))return null;var a=this.getLocalCollider();return null==a?null:new fd(this,a)},
getLocalCollider:function(){return null},draw:function(a){},set_follow:function(a){this.flags|=1;return this.follow=a},calcAbsPos:function(){this.qRot.toMatrix(this.absPos);this.absPos._11*=this.scaleX;this.absPos._12*=this.scaleX;this.absPos._13*=this.scaleX;this.absPos._21*=this.scaleY;this.absPos._22*=this.scaleY;this.absPos._23*=this.scaleY;this.absPos._31*=this.scaleZ;this.absPos._32*=this.scaleZ;this.absPos._33*=this.scaleZ;this.absPos._41=this.x;this.absPos._42=this.y;this.absPos._43=this.z;
if(null!=this.follow)if(this.follow.syncPos(),0!=(this.flags&8)){var a=this.absPos,b=this.absPos,c=this.parent.absPos,d=b._11,e=b._12,f=b._13,g=b._21,h=b._22,k=b._23,l=b._31,m=b._32,t=b._33,p=b._41,n=b._42,b=b._43,q=c._11,r=c._12,s=c._13,u=c._21,y=c._22,w=c._23,A=c._31,B=c._32,v=c._33,F=c._41,G=c._42,c=c._43;a._11=d*q+e*u+f*A;a._12=d*r+e*y+f*B;a._13=d*s+e*w+f*v;a._14=0;a._21=g*q+h*u+k*A;a._22=g*r+h*y+k*B;a._23=g*s+h*w+k*v;a._24=0;a._31=l*q+m*u+t*A;a._32=l*r+m*y+t*B;a._33=l*s+m*w+t*v;a._34=0;a._41=
p*q+n*u+b*A+F;a._42=p*r+n*y+b*B+G;a._43=p*s+n*w+b*v+c;a._44=1;this.absPos._41=this.x+this.follow.absPos._41;this.absPos._42=this.y+this.follow.absPos._42;this.absPos._43=this.z+this.follow.absPos._43}else this.absPos.multiply3x4(this.absPos,this.follow.absPos);else null!=this.parent&&0==(this.flags&2048)&&(b=a=this.absPos,c=this.parent.absPos,d=b._11,e=b._12,f=b._13,g=b._21,h=b._22,k=b._23,l=b._31,m=b._32,t=b._33,p=b._41,n=b._42,b=b._43,q=c._11,r=c._12,s=c._13,u=c._21,y=c._22,w=c._23,A=c._31,B=c._32,
v=c._33,F=c._41,G=c._42,c=c._43,a._11=d*q+e*u+f*A,a._12=d*r+e*y+f*B,a._13=d*s+e*w+f*v,a._14=0,a._21=g*q+h*u+k*A,a._22=g*r+h*y+k*B,a._23=g*s+h*w+k*v,a._24=0,a._31=l*q+m*u+t*A,a._32=l*r+m*y+t*B,a._33=l*s+m*w+t*v,a._34=0,a._41=p*q+n*u+b*A+F,a._42=p*r+n*y+b*B+G,a._43=p*s+n*w+b*v+c,a._44=1);null!=this.defaultTransform&&(a=this.absPos,b=this.defaultTransform,c=this.absPos,d=b._11,e=b._12,f=b._13,g=b._21,h=b._22,k=b._23,l=b._31,m=b._32,t=b._33,p=b._41,n=b._42,b=b._43,q=c._11,r=c._12,s=c._13,u=c._21,y=c._22,
w=c._23,A=c._31,B=c._32,v=c._33,F=c._41,G=c._42,c=c._43,a._11=d*q+e*u+f*A,a._12=d*r+e*y+f*B,a._13=d*s+e*w+f*v,a._14=0,a._21=g*q+h*u+k*A,a._22=g*r+h*y+k*B,a._23=g*s+h*w+k*v,a._24=0,a._31=l*q+m*u+t*A,a._32=l*r+m*y+t*B,a._33=l*s+m*w+t*v,a._34=0,a._41=p*q+n*u+b*A+F,a._42=p*r+n*y+b*B+G,a._43=p*s+n*w+b*v+c,a._44=1);null!=this.invPos&&(this.invPos._44=0)},sync:function(a){},syncRec:function(a){if(null!=this.currentAnimation){for(var b=this.parent,c=a.elapsedTime;0<c&&null!=this.currentAnimation;)c=this.currentAnimation.update(c);
null!=this.currentAnimation&&(a.visibleFlag&&0!=(this.flags&2)&&0==(this.flags&4)||0!=(this.flags&64))&&this.currentAnimation.sync();if(null==this.parent&&null!=b)return}b=a.visibleFlag;if(0==(this.flags&2)||0!=(this.flags&4)&&0!=(this.flags&128))a.visibleFlag=!1;null!=a.cullingCollider&&(null==this.cullingCollider||0!=(this.flags&4096))?(this.set_cullingCollider(a.cullingCollider),this.flags|=4096):0!=(this.flags&4096)&&this.set_cullingCollider(null);c=a.cullingCollider;0!=(this.flags&128)&&(a.cullingCollider=
this.cullingCollider);var d=0!=(this.flags&1);d&&this.calcAbsPos();this.sync(a);this.flags=null!=this.follow?this.flags|1:this.flags&-2;this.lastFrame=a.frame;for(var e=0,f=this.children.length;e<f;){var g=this.children[e];if(null==g)break;g.lastFrame!=a.frame&&(d&&(g.flags|=1),g.syncRec(a));this.children[e]!=g?(e=0,f=this.children.length):++e}a.visibleFlag=b;a.cullingCollider=c},syncPos:function(){null!=this.parent&&this.parent.syncPos();if(0!=(this.flags&1)){this.flags=null!=this.follow?this.flags|
1:this.flags&-2;this.calcAbsPos();for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.flags|=1}}},emit:function(a){},emitRec:function(a){if(!(0==(this.flags&2)||0!=(this.flags&4)&&0!=(this.flags&128)&&!a.computingStatic)){if(0!=(this.flags&1)){null!=this.currentAnimation&&this.currentAnimation.sync();this.flags=null!=this.follow?this.flags|1:this.flags&-2;this.calcAbsPos();for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.flags|=1}}(0==(this.flags&4)||a.computingStatic)&&this.emit(a);
b=0;for(c=this.children;b<c.length;)d=c[b],++b,d.emitRec(a)}},set_x:function(a){this.x=a;this.flags|=1;return a},set_y:function(a){this.y=a;this.flags|=1;return a},set_z:function(a){this.z=a;this.flags|=1;return a},set_scaleX:function(a){this.scaleX=a;this.flags|=1;return a},set_scaleY:function(a){this.scaleY=a;this.flags|=1;return a},set_scaleZ:function(a){this.scaleZ=a;this.flags|=1;return a},set_defaultTransform:function(a){this.defaultTransform=a;this.flags|=1;return a},setPosition:function(a,
b,c){this.x=a;this.flags|=1;this.y=b;this.flags|=1;this.z=c;this.flags|=1;this.flags|=1},setTransform:function(a){var b=ya.tmpVec;null==b&&(b=new B);b.x=Math.sqrt(a._11*a._11+a._12*a._12+a._13*a._13);b.y=Math.sqrt(a._21*a._21+a._22*a._22+a._23*a._23);b.z=Math.sqrt(a._31*a._31+a._32*a._32+a._33*a._33);0>a._11*(a._22*a._33-a._23*a._32)+a._12*(a._23*a._31-a._21*a._33)+a._13*(a._21*a._32-a._22*a._31)&&(b.x*=-1,b.y*=-1,b.z*=-1);this.x=a._41;this.flags|=1;this.y=a._42;this.flags|=1;this.z=a._43;this.flags|=
1;this.scaleX=b.x;this.flags|=1;this.scaleY=b.y;this.flags|=1;this.scaleZ=b.z;this.flags|=1;ya.tmpMat.load(a);ya.tmpMat.prependScale(1/b.x,1/b.y,1/b.z);this.qRot.initRotateMatrix(ya.tmpMat);this.flags|=1},rotate:function(a,b,c){var d=new Oe;d.initRotation(a,b,c);this.qRot.multiply(d,this.qRot);this.flags|=1},setRotation:function(a,b,c){this.qRot.initRotation(a,b,c);this.flags|=1},setRotationAxis:function(a,b,c,d){this.qRot.initRotateAxis(a,b,c,d);this.flags|=1},setDirection:function(a){this.qRot.initDirection(a);
this.flags|=1},getDirection:function(){var a=this.qRot;return new B(1-2*(a.y*a.y+a.z*a.z),2*(a.x*a.y-a.z*a.w),2*(a.x*a.z+a.y*a.w))},getRotationQuat:function(){return this.qRot},setRotationQuat:function(a){this.qRot=a;this.flags|=1},scale:function(a){this.scaleX*=a;this.flags|=1;this.scaleY*=a;this.flags|=1;this.scaleZ*=a;this.flags|=1;this.flags|=1},setScale:function(a){this.scaleX=a;this.flags|=1;this.scaleY=a;this.flags|=1;this.scaleZ=a;this.flags|=1;this.flags|=1},toString:function(){return ia.getClass(this).__name__.split(".").pop()+
(null==this.name?"":"("+this.name+")")},getChildAt:function(a){return this.children[a]},getChildIndex:function(a){for(var b=0,c=this.children.length;b<c;){var d=b++;if(this.children[d]==a)return d}return-1},get_numChildren:function(){return this.children.length},iterator:function(){return new zj(this.children)},__class__:ya};var Da=function(a,b,c){ya.call(this,c);this.set_primitive(a);null==b&&(b=uc.current.createMaterial(),b.set_props(b.getDefaultProps()));this.material=b};r["h3d.scene.Mesh"]=Da;
Da.__name__="h3d.scene.Mesh";Da.__super__=ya;Da.prototype=J(ya.prototype,{getMeshMaterials:function(){return[this.material]},getBoundsRec:function(a){a=ya.prototype.getBoundsRec.call(this,a);if(null==this.primitive||0!=(this.flags&512))return a;var b=this.primitive.getBounds(),c=new Hb;c.xMin=b.xMin;c.xMax=b.xMax;c.yMin=b.yMin;c.yMax=b.yMax;c.zMin=b.zMin;c.zMax=b.zMax;c.transform(this.absPos);c.xMin<a.xMin&&(a.xMin=c.xMin);c.xMax>a.xMax&&(a.xMax=c.xMax);c.yMin<a.yMin&&(a.yMin=c.yMin);c.yMax>a.yMax&&
(a.yMax=c.yMax);c.zMin<a.zMin&&(a.zMin=c.zMin);c.zMax>a.zMax&&(a.zMax=c.zMax);return a},clone:function(a){a=null==a?new Da(null,this.material):a;a.set_primitive(this.primitive);a.material=this.material.clone();ya.prototype.clone.call(this,a);return a},getLocalCollider:function(){return this.primitive.getCollider()},draw:function(a){this.primitive.render(a.engine)},emit:function(a){for(var b=this.material.passes;null!=b;)a.emitPass(b,this).index=0,b=b.nextPass},getMaterialByName:function(a){return null!=
this.material&&this.material.name==a?this.material:ya.prototype.getMaterialByName.call(this,a)},getMaterials:function(a){null==a&&(a=[]);null!=this.material&&0>a.indexOf(this.material)&&a.push(this.material);return ya.prototype.getMaterials.call(this,a)},onAdd:function(){ya.prototype.onAdd.call(this);null!=this.primitive&&this.primitive.incref()},onRemove:function(){null!=this.primitive&&this.primitive.decref();ya.prototype.onRemove.call(this)},set_primitive:function(a){a!=this.primitive&&0!=(this.flags&
32)&&(null!=this.primitive&&this.primitive.decref(),null!=a&&a.incref());return this.primitive=a},__class__:Da});var ci=function(a){this.curX=this.curY=this.curZ=this.curR=this.lineSize=0;this.bprim=new Gc(12);this.bprim.isStatic=!1;Da.call(this,this.bprim,null,a);this.tmpPoints=[];this.lineShader=new bg;this.lineShader.setPriority(-100);a=this.material;a.set_castShadows(!1);a.set_receiveShadows(!1);this.material.passes.set_enableLights(!1);this.material.passes.addShader(this.lineShader);a=new cg;
a.setPriority(-100);this.material.passes.addShader(a);this.material.passes.set_culling(Nb.None)};r["h3d.scene.Graphics"]=ci;ci.__name__="h3d.scene.Graphics";ci.__super__=Da;ci.prototype=J(Da.prototype,{onRemove:function(){Da.prototype.onRemove.call(this);this.bprim.clear()},set_is3D:function(a){if(this.is3D==a)return a;a?this.material.passes.removeShader(this.lineShader):this.material.passes.addShader(this.lineShader);this.bprim.clear();this.tmpPoints=[];return this.is3D=a},flushLine:function(){var a=
this.tmpPoints,b=a.length-1,c=a[b],d=a[0],e=d.x==c.x&&d.y==c.y&&d.z==c.z,f=a.length;if(e)d!=c&&(--f,--b,c=a[b]);else{var g=a[b-1];null==g&&(g=d);a.push(new ag(2*c.x-g.x,2*c.y-g.y,2*c.z-g.z,0,0,0,0));g=a[1];null==g&&(g=d);c=new ag(2*d.x-g.x,2*d.y-g.y,2*d.z-g.z,0,0,0,0)}for(var h=g=this.bprim.vertexCount(),k=0,l=0,m=f;l<m;){var t=l++,p=a[(t+1)%a.length],n=c.y-d.y,q=d.x-c.x,r=1/Math.sqrt(n*n+q*q),c=d.y-p.y,s=p.x-d.x,u=1/Math.sqrt(c*c+s*s),c=n*r+c*u,s=q*r+s*u,u=1/Math.sqrt(c*c+s*s),c=c*u,s=s*u,n=0.5*
this.lineSize/(c*n*r+s*q*r),c=c*n,s=s*n,n=t<f-1||e;this.bprim.begin(2,n?6:0);q=this.bprim;q.tmpBuf.array[q.bufPos++]=d.x+c;q=this.bprim;q.tmpBuf.array[q.bufPos++]=d.y+s;q=this.bprim;q.tmpBuf.array[q.bufPos++]=d.z;q=this.bprim;q.tmpBuf.array[q.bufPos++]=0;q=this.bprim;q.tmpBuf.array[q.bufPos++]=0;q=this.bprim;q.tmpBuf.array[q.bufPos++]=1;q=this.bprim;q.tmpBuf.array[q.bufPos++]=0;q=this.bprim;q.tmpBuf.array[q.bufPos++]=k;q=this.bprim;q.tmpBuf.array[q.bufPos++]=d.r;q=this.bprim;q.tmpBuf.array[q.bufPos++]=
d.g;q=this.bprim;q.tmpBuf.array[q.bufPos++]=d.b;q=this.bprim;q.tmpBuf.array[q.bufPos++]=d.a;q=this.bprim;q.tmpBuf.array[q.bufPos++]=d.x-c;c=this.bprim;c.tmpBuf.array[c.bufPos++]=d.y-s;c=this.bprim;c.tmpBuf.array[c.bufPos++]=d.z;c=this.bprim;c.tmpBuf.array[c.bufPos++]=0;c=this.bprim;c.tmpBuf.array[c.bufPos++]=0;c=this.bprim;c.tmpBuf.array[c.bufPos++]=1;c=this.bprim;c.tmpBuf.array[c.bufPos++]=1;c=this.bprim;c.tmpBuf.array[c.bufPos++]=k;c=this.bprim;c.tmpBuf.array[c.bufPos++]=d.r;c=this.bprim;c.tmpBuf.array[c.bufPos++]=
d.g;c=this.bprim;c.tmpBuf.array[c.bufPos++]=d.b;c=this.bprim;c.tmpBuf.array[c.bufPos++]=d.a;k=1-k;n&&(t=t==b?g-h:2,n=this.bprim,n.tmpIdx[n.idxPos++]=n.startIndex,n=this.bprim,n.tmpIdx[n.idxPos++]=1+n.startIndex,n=this.bprim,n.tmpIdx[n.idxPos++]=t+n.startIndex,n=this.bprim,n.tmpIdx[n.idxPos++]=t+n.startIndex,n=this.bprim,n.tmpIdx[n.idxPos++]=1+n.startIndex,n=this.bprim,n.tmpIdx[n.idxPos++]=t+1+n.startIndex);h+=2;c=d;d=p}},flush:function(){0!=this.tmpPoints.length&&this.is3D&&(this.flushLine(),this.tmpPoints=
[])},sync:function(a){Da.prototype.sync.call(this,a);this.flush();this.bprim.flush()},draw:function(a){this.flush();this.bprim.flush();Da.prototype.draw.call(this,a)},clear:function(){this.flush();this.bprim.clear()},lineStyle:function(a,b,c){null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);this.flush();0<a&&this.lineSize!=a&&(this.lineSize=a,this.is3D||(this.lineShader.width__=this.lineSize));this.setColor(b,c)},setColor:function(a,b){null==b&&(b=1);this.curA=b;this.curR=(a>>16&255)/255;this.curG=(a>>
8&255)/255;this.curB=(a&255)/255},drawLine:function(a,b){this.moveTo(a.x,a.y,a.z);this.lineTo(b.x,b.y,b.z)},moveTo:function(a,b,c){this.is3D?(this.flush(),this.lineTo(a,b,c)):(this.curX=a,this.curY=b,this.curZ=c)},addVertex:function(a,b,c,d,e,f,g){this.tmpPoints.push(new ag(a,b,c,d,e,f,g))},lineTo:function(a,b,c){if(this.is3D)this.tmpPoints.push(new ag(a,b,c,this.curR,this.curG,this.curB,this.curA));else{this.bprim.begin(4,6);var d=a-this.curX,e=b-this.curY,f=c-this.curZ,g=this.curX,h=this.curY,k=
this.curZ,l=this.bprim.bounds;g<l.xMin&&(l.xMin=g);g>l.xMax&&(l.xMax=g);h<l.yMin&&(l.yMin=h);h>l.yMax&&(l.yMax=h);k<l.zMin&&(l.zMin=k);k>l.zMax&&(l.zMax=k);g=this.bprim.bounds;a<g.xMin&&(g.xMin=a);a>g.xMax&&(g.xMax=a);b<g.yMin&&(g.yMin=b);b>g.yMax&&(g.yMax=b);c<g.zMin&&(g.zMin=c);c>g.zMax&&(g.zMax=c);g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curX;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curY;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curZ;g=this.bprim;g.tmpBuf.array[g.bufPos++]=d;g=this.bprim;
g.tmpBuf.array[g.bufPos++]=e;g=this.bprim;g.tmpBuf.array[g.bufPos++]=f;g=this.bprim;g.tmpBuf.array[g.bufPos++]=0;g=this.bprim;g.tmpBuf.array[g.bufPos++]=0;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curR;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curG;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curB;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curA;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curX;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curY;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curZ;
g=this.bprim;g.tmpBuf.array[g.bufPos++]=d;g=this.bprim;g.tmpBuf.array[g.bufPos++]=e;g=this.bprim;g.tmpBuf.array[g.bufPos++]=f;g=this.bprim;g.tmpBuf.array[g.bufPos++]=0;g=this.bprim;g.tmpBuf.array[g.bufPos++]=1;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curR;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curG;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curB;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curA;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curX;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curY;
g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curZ;g=this.bprim;g.tmpBuf.array[g.bufPos++]=d;g=this.bprim;g.tmpBuf.array[g.bufPos++]=e;g=this.bprim;g.tmpBuf.array[g.bufPos++]=f;g=this.bprim;g.tmpBuf.array[g.bufPos++]=1;g=this.bprim;g.tmpBuf.array[g.bufPos++]=0;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curR;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curG;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curB;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curA;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curX;
g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curY;g=this.bprim;g.tmpBuf.array[g.bufPos++]=this.curZ;g=this.bprim;g.tmpBuf.array[g.bufPos++]=d;d=this.bprim;d.tmpBuf.array[d.bufPos++]=e;e=this.bprim;e.tmpBuf.array[e.bufPos++]=f;f=this.bprim;f.tmpBuf.array[f.bufPos++]=1;f=this.bprim;f.tmpBuf.array[f.bufPos++]=1;f=this.bprim;f.tmpBuf.array[f.bufPos++]=this.curR;f=this.bprim;f.tmpBuf.array[f.bufPos++]=this.curG;f=this.bprim;f.tmpBuf.array[f.bufPos++]=this.curB;f=this.bprim;f.tmpBuf.array[f.bufPos++]=this.curA;
f=this.bprim;f.tmpIdx[f.idxPos++]=f.startIndex;f=this.bprim;f.tmpIdx[f.idxPos++]=1+f.startIndex;f=this.bprim;f.tmpIdx[f.idxPos++]=2+f.startIndex;f=this.bprim;f.tmpIdx[f.idxPos++]=2+f.startIndex;f=this.bprim;f.tmpIdx[f.idxPos++]=3+f.startIndex;f=this.bprim;f.tmpIdx[f.idxPos++]=1+f.startIndex;this.curX=a;this.curY=b;this.curZ=c}},__class__:ci});var di=function(a,b){this.hitPoint=new B;this.mouseDownButton=-1;this.cancelEvents=this.propagateEvents=!1;ya.call(this,b);this.shape=a;this.set_cursor(Uc.Button)};
r["h3d.scene.Interactive"]=di;di.__name__="h3d.scene.Interactive";di.__interfaces__=[Cg];di.__super__=ya;di.prototype=J(ya.prototype,{onAdd:function(){this.scene=this.getScene();null!=this.scene&&this.scene.addEventTarget(this);ya.prototype.onAdd.call(this)},onRemove:function(){null!=this.scene&&(this.scene.removeEventTarget(this),this.scene=null);ya.prototype.onRemove.call(this)},preventClick:function(){this.mouseDownButton=-1},getInteractiveScene:function(){return this.scene},handleEvent:function(a){this.propagateEvents&&
(a.propagate=!0);this.cancelEvents&&(a.cancel=!0);switch(a.kind._hx_index){case 0:if(this.enableRightButton||0==a.button)this.mouseDownButton=a.button,this.onPush(a);break;case 1:if(this.enableRightButton||0==a.button)if(this.onRelease(a),this.mouseDownButton==a.button)this.onClick(a);this.mouseDownButton=-1;break;case 2:this.onMove(a);break;case 3:this.onOver(a);break;case 4:this.onOut(a);break;case 5:this.onWheel(a);break;case 6:this.onFocus(a);break;case 7:this.onFocusLost(a);break;case 8:this.onKeyDown(a);
break;case 9:this.onKeyUp(a);break;case 10:if(this.enableRightButton||0==a.button)if(this.onRelease(a),this.mouseDownButton==a.button)this.onReleaseOutside(a);this.mouseDownButton=-1;break;case 11:this.onTextInput(a);break;case 12:this.onCheck(a)}},set_cursor:function(a){this.cursor=a;null!=this.scene&&null!=this.scene.events&&this.scene.events.updateCursor(this);return a},focus:function(){null==this.scene||null==this.scene.events||this.scene.events.focus(this)},blur:function(){this.hasFocus()&&this.scene.events.blur()},
isOver:function(){return null!=this.scene&&null!=this.scene.events?-1!=this.scene.events.overList.indexOf(this):!1},hasFocus:function(){return null!=this.scene&&null!=this.scene.events?this.scene.events.currentFocus==this:!1},onOver:function(a){},onOut:function(a){},onPush:function(a){},onRelease:function(a){},onReleaseOutside:function(a){},onClick:function(a){},onMove:function(a){},onWheel:function(a){},onFocus:function(a){},onFocusLost:function(a){},onKeyUp:function(a){},onKeyDown:function(a){},
onCheck:function(a){},onTextInput:function(a){},__class__:di});var Aj=function(a,b){this.priority=0;this.cullingDistance=-1;ya.call(this,b);this.shader=a};r["h3d.scene.Light"]=Aj;Aj.__name__="h3d.scene.Light";Aj.__super__=ya;Aj.prototype=J(ya.prototype,{get_color:function(){return new B},set_color:function(a){return a},get_enableSpecular:function(){return!1},set_enableSpecular:function(a){if(a)throw new q("Not implemented for this light");return!1},emit:function(a){a.emitLight(this)},getShadowDirection:function(){return null},
__class__:Aj});var dg=function(){this.drawPasses=0;this.ambientLight=new B(1,1,1)};r["h3d.scene.LightSystem"]=dg;dg.__name__="h3d.scene.LightSystem";dg.prototype={initGlobals:function(a){},cullLights:function(){for(var a=this.ctx.lights,b=null,c=new If;null!=a;)c.x=a.absPos._41,c.y=a.absPos._42,c.z=a.absPos._43,c.r=a.cullingDistance,0<a.cullingDistance&&!this.ctx.computingStatic&&!this.ctx.camera.frustum.hasSphere(c)?null==b?this.ctx.lights=a.next:b.next=a.next:(this.lightCount++,a.objectDistance=
0,b=a),a=a.next},initLights:function(a){this.lightCount=0;this.ctx=a;this.cullLights();if(null==this.shadowLight||0==(this.shadowLight.flags&32))for(a=a.lights;null!=a;){if(null!=a.getShadowDirection()){this.shadowLight=a;break}a=a.next}},computeLight:function(a,b){return b},__class__:dg};var fc=function(a,b,c){Da.call(this,a,null==b?null:b[0],c);this.materials=null==b?[this.material]:b};r["h3d.scene.MultiMaterial"]=fc;fc.__name__="h3d.scene.MultiMaterial";fc.__super__=Da;fc.prototype=J(Da.prototype,
{getMeshMaterials:function(){return this.materials.slice()},clone:function(a){a=null==a?new fc(null,this.materials):a;a.materials=[];for(var b=0,c=this.materials;b<c.length;){var d=c[b];++b;a.materials.push(null==d?null:d.clone())}Da.prototype.clone.call(this,a);a.material=a.materials[0];return a},emit:function(a){for(var b=0,c=this.materials.length;b<c;){var d=b++,e=this.materials[d];if(null!=e){null==d&&(d=0);for(e=e.passes;null!=e;)a.emitPass(e,this).index=d,e=e.nextPass}}},getMaterialByName:function(a){for(var b=
0,c=this.materials;b<c.length;){var d=c[b];++b;if(null!=d&&d.name==a)return d}return Da.prototype.getMaterialByName.call(this,a)},getMaterials:function(a){null==a&&(a=[]);for(var b=0,c=this.materials;b<c.length;){var d=c[b];++b;null!=d&&0>a.indexOf(d)&&a.push(d)}b=0;for(c=this.children;b<c.length;)d=c[b],++b,d.getMaterials(a);return a},draw:function(a){1<this.materials.length&&this.primitive.selectMaterial(a.drawPass.index);Da.prototype.draw.call(this,a)},__class__:fc});var Rb={};r["h3d.scene._Object.ObjectFlags_Impl_"]=
Rb;Rb.__name__="h3d.scene._Object.ObjectFlags_Impl_";Rb._new=function(a){return a};Rb.toInt=function(a){return a};Rb.has=function(a,b){return 0!=(a&b)};Rb.set=function(a,b,c){return c};var Bj=function(a,b){this.gid=a;this.value=b};r["h3d.scene._RenderContext.SharedGlobal"]=Bj;Bj.__name__="h3d.scene._RenderContext.SharedGlobal";Bj.prototype={__class__:Bj};var ei=function(){Id.call(this);this.cachedShaderList=[];this.cachedPassObjects=[]};r["h3d.scene.RenderContext"]=ei;ei.__name__="h3d.scene.RenderContext";
ei.__super__=Id;ei.prototype=J(Id.prototype,{emit:function(a,b,c){null==c&&(c=0);for(a=a.passes;null!=a;)this.emitPass(a,b).index=c,a=a.nextPass},start:function(){this.sharedGlobals=[];this.lights=this.passes=this.drawPass=this.lights=null;this.cachedPos=0;this.visibleFlag=!0;this.time+=this.elapsedTime;this.frame++},nextPass:function(){this.cachedPos=0;this.drawPass=null},getGlobal:function(a){a=qa.allocID(a);for(var b=0,c=this.sharedGlobals;b<c.length;){var d=c[b];++b;if(d.gid==a)return d.value}return null},
setGlobal:function(a,b){this.setGlobalID(qa.allocID(a),b)},setGlobalID:function(a,b){for(var c=0,d=this.sharedGlobals;c<d.length;){var e=d[c];++c;if(e.gid==a){e.value=b;return}}this.sharedGlobals.push(new Bj(a,b))},emitPass:function(a,b){var c=this.allocPool;null==c?(c=new Xh,c.nextAlloc=this.allocFirst,this.allocFirst=c):this.allocPool=c.nextAlloc;c.pass=a;c.obj=b;c.next=this.passes;return this.passes=c},allocShaderList:function(a,b){var c=this.cachedShaderList[this.cachedPos++];null==c&&(c=new Gb(null),
this.cachedShaderList[this.cachedPos-1]=c);c.s=a;c.next=b;return c},emitLight:function(a){a.next=this.lights;this.lights=a},uploadParams:function(){this.currentManager.fillParams(this.shaderBuffers,this.drawPass.shader,this.drawPass.shaders);this.engine.uploadShaderBuffers(this.shaderBuffers,1);this.engine.uploadShaderBuffers(this.shaderBuffers,2)},done:function(){this.drawPass=null;for(var a=this.allocFirst;null!=a&&a!=this.allocPool;)a.obj=null,a.pass=null,a.shader=null,a.shaders=null,a.next=null,
a.index=0,a.texture=0,a=a.nextAlloc;null!=this.allocPool&&(this.allocFirst=this.allocFirst.nextAlloc);this.allocPool=this.allocFirst;for(var a=0,b=this.cachedShaderList;a<b.length;){var c=b[a];++a;c.s=null;c.next=null}this.lights=this.passes=null},__class__:ei});var Cj=function(){this.passes=new Xf};r["h3d.scene.PassObjects"]=Cj;Cj.__name__="h3d.scene.PassObjects";Cj.prototype={__class__:Cj};var Hk=K["h3d.scene.RenderMode"]={__ename__:!0,__constructs__:["Default","LightProbe"],Default:{_hx_index:0,
__enum__:"h3d.scene.RenderMode",toString:m},LightProbe:{_hx_index:1,__enum__:"h3d.scene.RenderMode",toString:m}};Hk.__empty_constructs__=[Hk.Default,Hk.LightProbe];var Vc=function(){this.renderMode=Hk.Default;this.effects=[];this.hasSetTarget=!1;this.emptyPasses=new Xf;this.allPasses=[];this.passObjects=new ga;this.set_props(this.getDefaultProps());var a=z(this,this.depthSort);this.frontToBack=function(b){a(!0,b)};var b=z(this,this.depthSort);this.backToFront=function(a){b(!1,a)}};r["h3d.scene.Renderer"]=
Vc;Vc.__name__="h3d.scene.Renderer";Vc.__super__=Kf;Vc.prototype=J(Kf.prototype,{dispose:function(){for(var a=0,b=this.allPasses;a<b.length;){var c=b[a];++a;c.dispose()}a=0;for(b=this.effects;a<b.length;)c=b[a],++a,c.dispose();this.passObjects=new ga},mark:function(a){},getPass:function(a){for(var b=0,c=this.allPasses;b<c.length;){var d=c[b];++b;if(ia.__instanceof(d,a))return d}return null},getPassByName:function(a){for(var b=0,c=this.allPasses;b<c.length;){var d=c[b];++b;if(d.name==a)return d}return null},
debugCompileShader:function(a){var b=this.getPassByName(a.name);null==b&&(b=this.defaultPass);b.setContext(this.ctx);return b.compileShader(a)},hasFeature:function(a){return X.CURRENT.driver.hasFeature(a)},getDefaultLight:function(a){return a},getLightSystem:function(){return this.ctx.scene.lightSystem},time:function(a){},depthSort:function(a,b){for(var c=this.ctx.camera.m,d=b.current;null!=d;){var e=d,d=d.next;e.depth=(e.obj.absPos._41*c._13+e.obj.absPos._42*c._23+e.obj.absPos._43*c._33+c._43)/(e.obj.absPos._41*
c._14+e.obj.absPos._42*c._24+e.obj.absPos._43*c._34+c._44)}if(a)if(c=b.current,null==c)c=null;else for(var d=1,f=0,g=0,h,k,l,m;;){h=c;m=c=null;for(e=0;null!=h;){++e;k=h;g=f=0;for(l=d;g<l&&!(g++,++f,k=k.next,null==k););for(g=d;0<f||0<g&&null!=k;)0==f?(l=k,k=k.next,--g):0==g||null==k||0>=(h.pass.layer==k.pass.layer?h.depth>k.depth?1:-1:h.pass.layer-k.pass.layer)?(l=h,h=h.next,--f):(l=k,k=k.next,--g),null!=m?m.next=l:c=l,m=l;h=k}m.next=null;if(1>=e)break;d*=2}else if(c=b.current,null==c)c=null;else{d=
1;for(g=f=0;;){h=c;m=c=null;for(e=0;null!=h;){++e;k=h;g=f=0;for(l=d;g<l&&!(g++,++f,k=k.next,null==k););for(g=d;0<f||0<g&&null!=k;)0==f?(l=k,k=k.next,--g):0==g||null==k||0>=(h.pass.layer==k.pass.layer?h.depth>k.depth?-1:1:h.pass.layer-k.pass.layer)?(l=h,h=h.next,--f):(l=k,k=k.next,--g),null!=m?m.next=l:c=l,m=l;h=k}m.next=null;if(1>=e)break;d*=2}}b.current=c},clear:function(a,b,c){this.ctx.engine.clear(a,b,c)},allocTarget:function(a,b,c,d){null==c&&(c=1);null==b&&(b=!0);return this.ctx.textures.allocTarget(a,
Math.round(this.ctx.engine.width*c),Math.round(this.ctx.engine.height*c),b,d)},copy:function(a,b,c){vc.run(a,b,c)},setTarget:function(a){this.hasSetTarget&&this.ctx.engine.popTarget();this.ctx.engine.pushTarget(a);this.hasSetTarget=!0},setTargets:function(a){this.hasSetTarget&&this.ctx.engine.popTarget();this.ctx.engine.pushTargets(a);this.hasSetTarget=!0},resetTarget:function(){this.hasSetTarget&&(this.ctx.engine.popTarget(),this.hasSetTarget=!1)},has:function(a){var b=this.passObjects;return null!=
(null!=Q[a]?b.getReserved(a):b.h[a])},get:function(a){var b=this.passObjects;a=null!=Q[a]?b.getReserved(a):b.h[a];if(null==a)return this.emptyPasses;a.rendered=!0;return a.passes},draw:function(a){this.defaultPass.draw(this.get(a))},render:function(){throw new q("Not implemented");},computeStatic:function(){throw new q("Not implemented");},start:function(){},process:function(a){this.hasSetTarget=!1;for(var b=0,c=this.allPasses;b<c.length;){var d=c[b];++b;d.setContext(this.ctx)}for(b=0;b<a.length;){c=
a[b];++b;var d=c.name,e=this.passObjects;null!=Q[d]?e.setReserved(d,c):e.h[d]=c}this.ctx.textures.begin();this.ctx.computingStatic?this.computeStatic():this.render();this.resetTarget();for(b=0;b<a.length;)c=a[b],++b,c=c.name,d=this.passObjects,null!=Q[c]?d.setReserved(c,null):d.h[c]=null},__class__:Vc});var ee=function(a,b){null==b&&(b=!0);null==a&&(a=!0);ya.call(this,null);this.window=db.getInstance();this.eventListeners=[];this.hitInteractives=[];this.interactives=[];this.camera=new Ig;var c=X.CURRENT;
null!=c&&(this.camera.screenRatio=c.width/c.height);this.ctx=new ei;a&&this.set_renderer(uc.current.createRenderer());b&&(this.lightSystem=uc.current.createLightSystem())};r["h3d.scene.Scene"]=ee;ee.__name__="h3d.scene.Scene";ee.__interfaces__=[Gg,wf];ee.__super__=ya;ee.prototype=J(ya.prototype,{setEvents:function(a){this.events=a},addEventListener:function(a){this.eventListeners.push(a)},removeEventListener:function(a){for(var b=0,c=this.eventListeners;b<c.length;){var d=c[b];++b;if(ua.compareMethods(d,
a))return v.remove(this.eventListeners,d),!0}return!1},dispatchListeners:function(a){for(var b=0,c=this.eventListeners;b<c.length;){var d=c[b];++b;d(a);if(!a.propagate)break}},set_renderer:function(a){this.renderer=a;null!=a&&(a.ctx=this.ctx);return a},sortHitPointByCameraDistance:function(a,b){return a.hitPoint.w>b.hitPoint.w?-1:1},dispatchEvent:function(a,b){b.handleEvent(a)},isInteractiveVisible:function(a){for(;a!=this;){if(null==a||0==(a.flags&2))return!1;a=a.parent}return!0},handleEvent:function(a,
b){if(0==this.interactives.length)return null;if(0==this.hitInteractives.length){var c=2*(a.relX/this.window.get_width()-0.5),d=2*-(a.relY/this.window.get_height()-0.5),e=this.camera.unproject(c,d,0),c=this.camera.unproject(c,d,1),f=e.x,d=e.y,g=e.z;null==g&&(g=0);null==d&&(d=0);null==f&&(f=0);var e=f,f=c.x,h=c.y,c=c.z;null==c&&(c=0);null==h&&(h=0);null==f&&(f=0);var k=c,c=new ld;c.px=e;c.py=d;c.pz=g;c.lx=f-e;c.ly=h-d;c.lz=k-g;c.normalize();for(var e=c.px,d=c.py,g=c.pz,f=c.lx,h=c.ly,k=c.lz,l=-2147483648,
m=0,t=this.interactives;m<t.length;){var p=t[m];++m;if(!(p.priority<l)){for(var n=p;null!=n&&0!=(n.flags&2);)n=n.parent;if(null==n){var n=p.getInvPos(),q=c.px,r=c.py,s=c.pz;null==s&&(s=0);null==r&&(r=0);null==q&&(q=0);var u=q*n._12+r*n._22+s*n._32+1*n._42,y=q*n._13+r*n._23+s*n._33+1*n._43,q=q*n._11+r*n._21+s*n._31+1*n._41,r=u,s=y;c.px=q;c.py=r;c.pz=s;q=c.lx;r=c.ly;s=c.lz;null==s&&(s=0);null==r&&(r=0);null==q&&(q=0);u=q*n._12+r*n._22+s*n._32;y=q*n._13+r*n._23+s*n._33;q=q*n._11+r*n._21+s*n._31;r=u;
s=y;c.lx=q;c.ly=r;c.lz=s;c.normalize();if(c.lx!=c.lx)c.px=e,c.py=d,c.pz=g,c.lx=f,c.ly=h,c.lz=k;else if(q=p.shape.rayIntersection(c,p.bestMatch),0>q)c.px=e,c.py=d,c.pz=g,c.lx=f,c.ly=h,c.lz=k;else{r=c.px+q*c.lx;n=c.py+q*c.ly;q=c.pz+q*c.lz;null==q&&(q=0);null==n&&(n=0);null==r&&(r=0);c.px=e;c.py=d;c.pz=g;c.lx=f;c.ly=h;c.lz=k;p.hitPoint.x=r;p.hitPoint.y=n;p.hitPoint.z=q;if(p.priority>l){for(;0<this.hitInteractives.length;)this.hitInteractives.pop();l=p.priority}this.hitInteractives.push(p)}}}}if(0==this.hitInteractives.length)return null;
if(1<this.hitInteractives.length){l=0;for(m=this.hitInteractives;l<m.length;){t=m[l];++l;n=t.invPos;p=0;null!=t.preciseShape&&(q=c.px,r=c.py,s=c.pz,null==s&&(s=0),null==r&&(r=0),null==q&&(q=0),u=q*n._12+r*n._22+s*n._32+1*n._42,y=q*n._13+r*n._23+s*n._33+1*n._43,q=q*n._11+r*n._21+s*n._31+1*n._41,r=u,s=y,c.px=q,c.py=r,c.pz=s,q=c.lx,r=c.ly,s=c.lz,null==s&&(s=0),null==r&&(r=0),null==q&&(q=0),u=q*n._12+r*n._22+s*n._32,y=q*n._13+r*n._23+s*n._33,q=q*n._11+r*n._21+s*n._31,r=u,s=y,c.lx=q,c.ly=r,c.lz=s,c.normalize(),
r=t.preciseShape.rayIntersection(c,t.bestMatch),0<r?(n=c.px+r*c.lx,q=c.py+r*c.ly,r=c.pz+r*c.lz,null==r&&(r=0),null==q&&(q=0),null==n&&(n=0),t.hitPoint.x=n,t.hitPoint.y=q,t.hitPoint.z=r):p=1,c.px=e,c.py=d,c.pz=g,c.lx=f,c.ly=h,c.lz=k);s=t.hitPoint;n=s.x;q=s.y;r=s.z;s=s.w;null==s&&(s=1);null==r&&(r=0);null==q&&(q=0);null==n&&(n=0);var s=1,u=t.absPos,y=n*u._12+q*u._22+r*u._32+s*u._42,w=n*u._13+q*u._23+r*u._33+s*u._43,n=n*u._11+q*u._21+r*u._31+s*u._41,q=y,r=w,u=this.camera.m,r=(n*u._13+q*u._23+r*u._33+
s*u._43)*(1/(n*u._14+q*u._24+r*u._34+s*u._44));t.hitPoint.w=r+p}this.hitInteractives.sort(z(this,this.sortHitPointByCameraDistance))}this.hitInteractives.unshift(null)}for(;0<this.hitInteractives.length;){c=this.hitInteractives.pop();if(null==c)break;a.relX=c.hitPoint.x;a.relY=c.hitPoint.y;a.relZ=c.hitPoint.z;c.handleEvent(a);if(a.cancel)a.cancel=!1,a.propagate=!1;else{if(!a.propagate)for(;0<this.hitInteractives.length;)this.hitInteractives.pop();return c}}return null},clone:function(a){a=null==a?
new ee:a;a.camera=this.camera.clone();ya.prototype.clone.call(this,a);return a},dispose:function(){if(0!=(this.flags&32))this.onRemove();null!=this.hardwarePass&&(this.hardwarePass.dispose(),this.hardwarePass=null);this.ctx.dispose();null!=this.renderer&&(this.renderer.dispose(),this.set_renderer(new Vc))},addEventTarget:function(a){if(0<=this.interactives.indexOf(a))throw new q("assert");this.interactives.push(a)},removeEventTarget:function(a){if(v.remove(this.interactives,a)){if(null!=this.events)this.events.onRemove(a);
v.remove(this.hitInteractives,a)}},setElapsedTime:function(a){this.ctx.elapsedTime=a},hardwarePick:function(a,b){var c=this,d=X.CURRENT;this.camera.screenRatio=d.width/d.height;this.camera.update();this.ctx.camera=this.camera;this.ctx.engine=d;this.ctx.scene=this;this.ctx.start();var e=this.camera.rayFromScreen(a,b),f,g,h,k,l,m;h=e.px;g=e.py;f=e.pz;m=e.lx;l=e.ly;k=e.lz;this.iterVisibleMeshes(function(a){if(null!=a.primitive){var b=a.getInvPos(),d=e.px,t=e.py,n=e.pz;null==n&&(n=0);null==t&&(t=0);null==
d&&(d=0);var p=d*b._12+t*b._22+n*b._32+1*b._42,q=d*b._13+t*b._23+n*b._33+1*b._43,d=d*b._11+t*b._21+n*b._31+1*b._41;e.px=d;e.py=p;e.pz=q;d=e.lx;t=e.ly;n=e.lz;null==n&&(n=0);null==t&&(t=0);null==d&&(d=0);p=d*b._12+t*b._22+n*b._32;q=d*b._13+t*b._23+n*b._33;d=d*b._11+t*b._21+n*b._31;e.lx=d;e.ly=p;e.lz=q;e.normalize();0<=a.primitive.getBounds().rayIntersection(e,!1)&&c.ctx.emitPass(a.material.passes,a);e.px=h;e.py=g;e.pz=f;e.lx=m;e.ly=l;e.lz=k}});var d=this.ctx.lightSystem=null,t=new Xf(this.ctx.passes);
if(null!=t.current){var n=this.hardwarePass;null==n&&(this.hardwarePass=n=new Zh);var p=this.ctx,q={texture:S.fromColor(267386880,0)};p.setGlobalID(qa.allocID("depthMap"),q);n.pickX=a;n.pickY=b;n.setContext(this.ctx);n.draw(t);if(0<=n.pickedIndex)for(t=t.current;null!=t;)if(p=t,t=t.next,0==n.pickedIndex--){d=p.obj;break}}this.ctx.done();this.ctx.camera=null;this.ctx.engine=null;this.ctx.scene=null;return d},syncOnly:function(a){var b=X.CURRENT;this.setElapsedTime(a);a=b.getCurrentTarget();this.camera.screenRatio=
null==a?b.width/b.height:a.width/a.height;this.camera.update();this.ctx.camera=this.camera;this.ctx.engine=b;this.ctx.scene=this;this.ctx.start();this.syncRec(this.ctx);this.ctx.camera=null;this.ctx.engine=null;this.ctx.scene=null},computeStatic:function(){var a=this.ctx.elapsedTime;this.ctx.elapsedTime=0;this.ctx.computingStatic=!0;this.render(X.CURRENT);this.ctx.computingStatic=!1;this.ctx.elapsedTime=a},render:function(a){if(0==(this.flags&32))this.onAdd();var b=a.getCurrentTarget();this.camera.screenRatio=
null==b?a.width/a.height:b.width/b.height;this.camera.update();this.camera.rightHanded&&a.driver.setRenderFlag(Ek.CameraHandness,1);this.ctx.camera=this.camera;this.ctx.engine=a;this.ctx.scene=this;this.ctx.start();this.renderer.start();this.syncRec(this.ctx);this.emitRec(this.ctx);b=this.ctx.passes;if(null==b)b=null;else for(var c=1,d,e=0,f=0,g,h,k,l;;){g=b;l=b=null;for(d=0;null!=g;){++d;h=g;f=e=0;for(k=c;f<k&&!(f++,++e,h=h.next,null==h););for(f=c;0<e||0<f&&null!=h;)0==e?(k=h,h=h.next,--f):0==f||
null==h||0>=g.pass.passId-h.pass.passId?(k=g,g=g.next,--e):(k=h,h=h.next,--f),null!=l?l.next=k:b=k,l=k;g=h}l.next=null;if(1>=d)break;c*=2}this.ctx.passes=b;c=this.ctx.passes;d=[];for(b=-1;null!=c;){g=c.pass.passId;e=c;for(h=null;null!=e&&e.pass.passId==g;)h=e,e=e.next;h.next=null;g=this.ctx.cachedPassObjects[++b];null==g&&(g=new Cj,this.ctx.cachedPassObjects[b]=g);g.name=c.pass.name;h=g.passes;h.current=c;h.discarded=h.lastDisc=null;d.push(g);c=e}null!=this.lightSystem&&(this.ctx.lightSystem=this.lightSystem,
this.lightSystem.initLights(this.ctx));this.renderer.process(d);this.camera.rightHanded&&a.driver.setRenderFlag(Ek.CameraHandness,0);this.ctx.done();this.ctx.scene=null;this.ctx.camera=null;this.ctx.engine=null;for(a=0;a<b;)c=a++,c=this.ctx.cachedPassObjects[c],c.name=null,c=c.passes,c.current=null,c.discarded=c.lastDisc=null},serializeScene:function(){throw new q("You need -lib hxbit to serialize the scene data");},__class__:ee});var Gf=function(a,b){ya.call(this,null);this.name=b.name;this.parent=
this.skin=a;this.index=b.index};r["h3d.scene.Joint"]=Gf;Gf.__name__="h3d.scene.Joint";Gf.__super__=ya;Gf.prototype=J(ya.prototype,{getObjectByName:function(a){var b=this.skin.getSkinData(),c=b.namedJoints;a=null!=Q[a]?c.getReserved(a):c.h[a];if(null==a)return null;b=b.allJoints[this.index];if(b.index!=this.index)throw new q("assert");for(c=a.parent;null!=c;){if(c==b)return b=new Gf(this.skin,a),b.parent=this,b;c=c.parent}return null},syncPos:function(){for(var a=this.parent;null!=a;){if(0!=(a.flags&
1)){null==this.skin.jointsAbsPosInv&&(this.skin.jointsAbsPosInv=new P,this.skin.jointsAbsPosInv.zero());0==this.skin.jointsAbsPosInv._44&&this.skin.jointsAbsPosInv.inverse3x4(this.parent.absPos);this.parent.syncPos();this.lastFrame=-1;break}a=a.parent}this.lastFrame!=this.skin.lastFrame&&(this.lastFrame=this.skin.lastFrame,this.absPos.load(this.skin.currentAbsPose[this.index]),null!=this.skin.jointsAbsPosInv&&0!=this.skin.jointsAbsPosInv._44&&(this.absPos.multiply3x4(this.absPos,this.skin.jointsAbsPosInv),
this.absPos.multiply3x4(this.absPos,this.parent.absPos)))},__class__:Gf});var Vg=function(a,b,c){fc.call(this,null,b,c);null!=a&&this.setSkinData(a)};r["h3d.scene.Skin"]=Vg;Vg.__name__="h3d.scene.Skin";Vg.__super__=fc;Vg.prototype=J(fc.prototype,{clone:function(a){a=null==a?new Vg(null,this.materials.slice()):a;fc.prototype.clone.call(this,a);a.setSkinData(this.skinData);a.currentRelPose=this.currentRelPose.slice();return a},getBoundsRec:function(a){a=fc.prototype.getBoundsRec.call(this,a);var b=
this.primitive.getBounds(),c=new Hb;c.xMin=b.xMin;c.xMax=b.xMax;c.yMin=b.yMin;c.yMax=b.yMax;c.zMin=b.zMin;c.zMax=b.zMax;b=this.skinData.allJoints[0];if(null!=b&&null==b.parent){var d=this.absPos.clone(),e=this.currentRelPose[b.index];null!=e?d.multiply3x4(e,d):d.multiply3x4(b.defMat,d);null!=b.transPos&&d.multiply3x4(b.transPos,d);c.transform(d)}else c.transform(this.absPos);c.xMin<a.xMin&&(a.xMin=c.xMin);c.xMax>a.xMax&&(a.xMax=c.xMax);c.yMin<a.yMin&&(a.yMin=c.yMin);c.yMax>a.yMax&&(a.yMax=c.yMax);
c.zMin<a.zMin&&(a.zMin=c.zMin);c.zMax>a.zMax&&(a.zMax=c.zMax);return a},getObjectByName:function(a){if(null!=this.skinData&&this.skinData.name==a)return this;var b=fc.prototype.getObjectByName.call(this,a);return null!=b?b:null!=this.skinData&&(b=this.skinData.namedJoints,a=null!=Q[a]?b.getReserved(a):b.h[a],null!=a)?new Gf(this,a):null},getLocalCollider:function(){throw new q("Not implemented");},getGlobalCollider:function(){var a=ia.__cast(this.primitive.getCollider(),Lg);ia.__cast(this.primitive,
Ug).loadSkin(this.skinData);return new Mh(this,ia.__cast(a.b,Jf))},calcAbsPos:function(){fc.prototype.calcAbsPos.call(this);this.jointsUpdated=!0},getSkinData:function(){return this.skinData},setSkinData:function(a,b){null==b&&(b=!0);this.skinData=a;this.jointsUpdated=!0;this.set_primitive(a.primitive);if(b){for(var c=!1,d=0,e=this.materials;d<e.length;){var f=e[d];++d;if(null!=f&&null!=f.get_normalMap()){c=!0;break}}this.skinShader=c?new eg:new fg;c=0;if(null!=this.skinData.splitJoints){d=0;for(e=
this.skinData.splitJoints;d<e.length;)f=e[d],++d,f.joints.length>c&&(c=f.joints.length)}else c=this.skinData.boundJoints.length;this.skinShader.MaxBones__<c&&(d=this.skinShader,d.constModified=!0,d.MaxBones__=c);c=0;for(d=this.materials;c<d.length;)e=d[c],++c,null!=e&&(null!=e.get_normalMap()?e.passes.addShaderAtIndex(this.skinShader,e.passes.getShaderIndex(e.normalShader)+1):e.passes.addShader(this.skinShader),null!=this.skinData.splitJoints&&e.passes.set_dynamicParameters(!0))}this.currentRelPose=
[];this.currentAbsPose=[];this.currentPalette=[];this.paletteChanged=!0;c=0;for(d=this.skinData.allJoints;c<d.length;)++c,this.currentAbsPose.push(P.I());c=0;for(d=this.skinData.boundJoints.length;c<d;)c++,this.currentPalette.push(P.I());if(null!=this.skinData.splitJoints){this.splitPalette=[];c=0;for(d=this.skinData.splitJoints;c<d.length;){var g=d[c];++c;for(var e=this.splitPalette,f=[],h=0,g=g.joints;h<g.length;){var k=g[h];++h;f.push(this.currentPalette[k.bindIndex])}e.push(f)}}else this.splitPalette=
null},sync:function(a){(a.visibleFlag||0!=(this.flags&64))&&this.syncJoints()},syncJoints:function(){if(this.jointsUpdated){for(var a=0,b=this.skinData.allJoints;a<b.length;){var c=b[a];++a;var d=c.index,e=this.currentAbsPose[d],f=this.currentRelPose[d],d=c.bindIndex;null==f?f=c.defMat:c.retargetAnim&&(f._41=c.defMat._41,f._42=c.defMat._42,f._43=c.defMat._43);if(null==c.parent)var g=this.absPos,h=f._11,k=f._12,l=f._13,m=f._21,t=f._22,n=f._23,p=f._31,q=f._32,r=f._33,s=f._41,u=f._42,f=f._43,y=g._11,
w=g._12,A=g._13,B=g._21,v=g._22,F=g._23,G=g._31,z=g._32,I=g._33,J=g._41,K=g._42;else g=this.currentAbsPose[c.parent.index],h=f._11,k=f._12,l=f._13,m=f._21,t=f._22,n=f._23,p=f._31,q=f._32,r=f._33,s=f._41,u=f._42,f=f._43,y=g._11,w=g._12,A=g._13,B=g._21,v=g._22,F=g._23,G=g._31,z=g._32,I=g._33,J=g._41,K=g._42;g=g._43;e._11=h*y+k*B+l*G;e._12=h*w+k*v+l*z;e._13=h*A+k*F+l*I;e._14=0;e._21=m*y+t*B+n*G;e._22=m*w+t*v+n*z;e._23=m*A+t*F+n*I;e._24=0;e._31=p*y+q*B+r*G;e._32=p*w+q*v+r*z;e._33=p*A+q*F+r*I;e._34=0;
e._41=s*y+u*B+f*G+J;e._42=s*w+u*v+f*z+K;e._43=s*A+u*F+f*I+g;e._44=1;0<=d&&(d=this.currentPalette[d],u=c.transPos,c=u._11,h=u._12,k=u._13,l=u._21,m=u._22,t=u._23,n=u._31,p=u._32,q=u._33,r=u._41,s=u._42,u=u._43,f=e._11,g=e._12,y=e._13,w=e._21,A=e._22,B=e._23,v=e._31,F=e._32,G=e._33,z=e._41,I=e._42,e=e._43,d._11=c*f+h*w+k*v,d._12=c*g+h*A+k*F,d._13=c*y+h*B+k*G,d._14=0,d._21=l*f+m*w+t*v,d._22=l*g+m*A+t*F,d._23=l*y+m*B+t*G,d._24=0,d._31=n*f+p*w+q*v,d._32=n*g+p*A+q*F,d._33=n*y+p*B+q*G,d._34=0,d._41=r*f+
s*w+u*v+z,d._42=r*g+s*A+u*F+I,d._43=r*y+s*B+u*G+e,d._44=1)}this.skinShader.bonesMatrixes__=this.currentPalette;null!=this.jointsAbsPosInv&&(this.jointsAbsPosInv._44=0);this.jointsUpdated=!1}},emit:function(a){if(null==this.splitPalette)fc.prototype.emit.call(this,a);else for(var b=0,c=this.splitPalette.length;b<c;){var d=b++,e=this.materials[this.skinData.splitJoints[d].material];if(null!=e){null==d&&(d=0);for(e=e.passes;null!=e;)a.emitPass(e,this).index=d,e=e.nextPass}}if(this.showJoints){null==
this.jointsGraphics&&(this.jointsGraphics=new ci(this),this.jointsGraphics.material.passes.depth(!1,Ab.Always),this.jointsGraphics.material.passes.setPassName("add"));for(a=this;null!=a.parent;)a=a.parent;this.jointsGraphics.set_follow(a);a=this.jointsGraphics;a.clear();b=0;for(c=this.skinData.allJoints;b<c.length;){e=c[b];++b;var d=this.currentAbsPose[e.index],f=null==e.parent?this.absPos:this.currentAbsPose[e.parent.index];a.lineStyle(1,null==e.parent?-16776961:-256);a.moveTo(f._41,f._42,f._43);
a.lineTo(d._41,d._42,d._43)}}else null!=this.jointsGraphics&&(a=this.jointsGraphics,null!=a&&null!=a.parent&&a.parent.removeChild(a),this.jointsGraphics=null)},draw:function(a){if(null==this.splitPalette)fc.prototype.draw.call(this,a);else{var b=a.drawPass.index;this.skinShader.bonesMatrixes__=this.splitPalette[b];this.primitive.selectMaterial(b);a.uploadParams();this.primitive.render(a.engine)}},__class__:Vg});var Th=function(){this.perPixelLighting=!0;this.maxLightsPerObject=6;dg.call(this);var a=
this.ambientLight,b=0.5,c=0.5,d=0.5;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);a.x=b;a.y=c;a.z=d;a.w=1;this.ambientShader=new Wc;this.set_additiveLighting(!0)};r["h3d.scene.fwd.LightSystem"]=Th;Th.__name__="h3d.scene.fwd.LightSystem";Th.__super__=dg;Th.prototype=J(dg.prototype,{get_additiveLighting:function(){var a=this.ambientShader;return(a instanceof Wc?a:null).additive__},set_additiveLighting:function(a){var b=this.ambientShader,b=b instanceof Wc?b:null;b.constModified=!0;return b.additive__=
a},initLights:function(a){dg.prototype.initLights.call(this,a);if(this.lightCount<=this.maxLightsPerObject){var b=a.lights,c=z(this,this.sortLight);if(null==b)b=null;else for(var d=1,e,f=0,g=0,h,k,l,m;;){h=b;m=b=null;for(e=0;null!=h;){++e;k=h;g=f=0;for(l=d;g<l&&!(g++,++f,k=k.next,null==k););for(g=d;0<f||0<g&&null!=k;)0==f?(l=k,k=k.next,--g):0==g||null==k||0>=c(h,k)?(l=h,h=h.next,--f):(l=k,k=k.next,--g),null!=m?m.next=l:b=l,m=l;h=k}m.next=null;if(1>=e)break;d*=2}a.lights=b}},initGlobals:function(a){a.set("global.ambientLight",
this.ambientLight);a.set("global.perPixelLighting",this.perPixelLighting)},sortLight:function(a,b){var c=a.priority-b.priority;return 0!=c?-c:a.objectDistance<b.objectDistance?-1:1},computeLight:function(a,b){if(this.lightCount>this.maxLightsPerObject){for(var c=this.ctx.lights;null!=c;){if(0!=(a.flags&16))var d=c.absPos._41-this.ctx.camera.target.x,e=c.absPos._42-this.ctx.camera.target.y,f=c.absPos._43-this.ctx.camera.target.z;else d=c.absPos._41-a.absPos._41,e=c.absPos._42-a.absPos._42,f=c.absPos._43-
a.absPos._43;null==f&&(f=0);c.objectDistance=d*d+e*e+f*f;c=c.next}c=this.ctx.lights;d=z(this,this.sortLight);if(null==c)c=null;else for(var e=1,g=0,h=0,k,l,m,t;;){k=c;t=c=null;for(f=0;null!=k;){++f;l=k;h=g=0;for(m=e;h<m&&!(h++,++g,l=l.next,null==l););for(h=e;0<g||0<h&&null!=l;)0==g?(m=l,l=l.next,--h):0==h||null==l||0>=d(k,l)?(m=k,k=k.next,--g):(m=l,l=l.next,--h),null!=t?t.next=m:c=m,t=m;k=l}t.next=null;if(1>=f)break;e*=2}this.ctx.lights=c}b=this.ctx.allocShaderList(this.ambientShader,b);c=this.ctx.lights;
for(d=0;null!=c&&d++!=this.maxLightsPerObject;)b=this.ctx.allocShaderList(c.shader,b),c=c.next;return b},__class__:Th});var fi=function(){this.enableSky=!1;Ta.call(this,"depth");this.depthMapId=qa.allocID("depthMap")};r["h3d.scene.fwd.DepthPass"]=fi;fi.__name__="h3d.scene.fwd.DepthPass";fi.__super__=Ta;fi.prototype=J(Ta.prototype,{getOutputs:function(){return[ec.PackFloat(ec.Value("output.depth"))]},draw:function(a,b){var c=this.ctx.textures.allocTarget("depthMap",this.ctx.engine.width,this.ctx.engine.height,
!0);this.ctx.engine.pushTarget(c);this.ctx.engine.clear(this.enableSky?0:16711680,1);Ta.prototype.draw.call(this,a,b);this.ctx.engine.popTarget();this.ctx.setGlobalID(this.depthMapId,{texture:c})},__class__:fi});var gi=function(){Ta.call(this,"normal");this.normalMapId=qa.allocID("normalMap")};r["h3d.scene.fwd.NormalPass"]=gi;gi.__name__="h3d.scene.fwd.NormalPass";gi.__super__=Ta;gi.prototype=J(Ta.prototype,{getOutputs:function(){return[ec.PackNormal(ec.Value("output.normal"))]},draw:function(a,b){var c=
this.ctx.textures.allocTarget("normalMap",this.ctx.engine.width,this.ctx.engine.height);this.ctx.engine.pushTarget(c);this.ctx.engine.clear(8421504,1);Ta.prototype.draw.call(this,a,b);this.ctx.engine.popTarget();this.ctx.setGlobalID(this.normalMapId,c)},__class__:gi});var Sh=function(){this.shadow=new Yh(1024);this.normal=new gi;this.depth=new fi;Vc.call(this);this.defaultPass=new Ta("default");this.allPasses=[this.defaultPass,this.depth,this.normal,this.shadow]};r["h3d.scene.fwd.Renderer"]=Sh;Sh.__name__=
"h3d.scene.fwd.Renderer";Sh.__super__=Vc;Sh.prototype=J(Vc.prototype,{get_def:function(){return this.defaultPass},renderPass:function(a,b,c){a.draw(b,c)},getPassByName:function(a){return"alpha"==a||"additive"==a?this.defaultPass:Vc.prototype.getPassByName.call(this,a)},render:function(){this.has("shadow")&&this.renderPass(this.shadow,this.get("shadow"));this.has("depth")&&this.renderPass(this.depth,this.get("depth"));this.has("normal")&&this.renderPass(this.normal,this.get("normal"));this.renderPass(this.defaultPass,
this.get("default"));this.renderPass(this.defaultPass,this.get("alpha"),this.backToFront);this.renderPass(this.defaultPass,this.get("additive"))},__class__:Sh});var Wc=function(){T.call(this)};r["h3d.shader.AmbientLight"]=Wc;Wc.__name__="h3d.shader.AmbientLight";Wc.__super__=T;Wc.prototype=J(T.prototype,{get_additive:function(){return this.additive__},set_additive:function(a){this.constModified=!0;return this.additive__=a},updateConstants:function(a){this.constBits=0;this.additive__&&(this.constBits|=
2);this.updateConstantsFinal(a)},getParamValue:function(a){return 0==a?this.additive__:null},getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(Wc.prototype);a.shader=this.shader;a.additive__=this.additive__;return a},__class__:Wc});var Df=function(){this.viewport__=new B;this.halfPixelInverse__=new B;this.uvPos__=new B;this.filterMatrixB__=new B;this.filterMatrixA__=new B;this.absoluteMatrixB__=new B;this.absoluteMatrixA__=new B;this.color__=new B;this.zValue__=0;T.call(this)};
r["h3d.shader.Base2d"]=Df;Df.__name__="h3d.shader.Base2d";Df.__super__=T;Df.prototype=J(T.prototype,{get_zValue:function(){return this.zValue__},set_zValue:function(a){return this.zValue__=a},get_texture:function(){return this.texture__},set_texture:function(a){return this.texture__=a},get_isRelative:function(){return this.isRelative__},set_isRelative:function(a){this.constModified=!0;return this.isRelative__=a},get_color:function(){return this.color__},set_color:function(a){return this.color__=a},
get_absoluteMatrixA:function(){return this.absoluteMatrixA__},set_absoluteMatrixA:function(a){return this.absoluteMatrixA__=a},get_absoluteMatrixB:function(){return this.absoluteMatrixB__},set_absoluteMatrixB:function(a){return this.absoluteMatrixB__=a},get_filterMatrixA:function(){return this.filterMatrixA__},set_filterMatrixA:function(a){return this.filterMatrixA__=a},get_filterMatrixB:function(){return this.filterMatrixB__},set_filterMatrixB:function(a){return this.filterMatrixB__=a},get_hasUVPos:function(){return this.hasUVPos__},
set_hasUVPos:function(a){this.constModified=!0;return this.hasUVPos__=a},get_uvPos:function(){return this.uvPos__},set_uvPos:function(a){return this.uvPos__=a},get_killAlpha:function(){return this.killAlpha__},set_killAlpha:function(a){this.constModified=!0;return this.killAlpha__=a},get_pixelAlign:function(){return this.pixelAlign__},set_pixelAlign:function(a){this.constModified=!0;return this.pixelAlign__=a},get_halfPixelInverse:function(){return this.halfPixelInverse__},set_halfPixelInverse:function(a){return this.halfPixelInverse__=
a},get_viewport:function(){return this.viewport__},set_viewport:function(a){return this.viewport__=a},updateConstants:function(a){this.constBits=0;this.isRelative__&&(this.constBits|=1);this.hasUVPos__&&(this.constBits|=2);this.killAlpha__&&(this.constBits|=4);this.pixelAlign__&&(this.constBits|=8);this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.zValue__;case 1:return this.texture__;case 2:return this.isRelative__;case 3:return this.color__;case 4:return this.absoluteMatrixA__;
case 5:return this.absoluteMatrixB__;case 6:return this.filterMatrixA__;case 7:return this.filterMatrixB__;case 8:return this.hasUVPos__;case 9:return this.uvPos__;case 10:return this.killAlpha__;case 11:return this.pixelAlign__;case 12:return this.halfPixelInverse__;case 13:return this.viewport__}return null},getParamFloatValue:function(a){return 0==a?this.zValue__:0},clone:function(){var a=Object.create(Df.prototype);a.shader=this.shader;a.zValue__=this.zValue__;a.texture__=this.texture__;a.isRelative__=
this.isRelative__;a.color__=this.color__;a.absoluteMatrixA__=this.absoluteMatrixA__;a.absoluteMatrixB__=this.absoluteMatrixB__;a.filterMatrixA__=this.filterMatrixA__;a.filterMatrixB__=this.filterMatrixB__;a.hasUVPos__=this.hasUVPos__;a.uvPos__=this.uvPos__;a.killAlpha__=this.killAlpha__;a.pixelAlign__=this.pixelAlign__;a.halfPixelInverse__=this.halfPixelInverse__;a.viewport__=this.viewport__;return a},__class__:Df});var Mf=function(){this.specularColor__=new B;this.specularPower__=this.specularAmount__=
0;this.color__=new B;T.call(this);var a=this.color__,b=1,c=1,d=1;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);a.x=b;a.y=c;a.z=d;a.w=1;a=this.specularColor__;d=c=b=1;null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);a.x=b;a.y=c;a.z=d;a.w=1;this.specularPower__=50;this.specularAmount__=1};r["h3d.shader.BaseMesh"]=Mf;Mf.__name__="h3d.shader.BaseMesh";Mf.__super__=T;Mf.prototype=J(T.prototype,{get_color:function(){return this.color__},set_color:function(a){return this.color__=a},get_specularPower:function(){return this.specularPower__},
set_specularPower:function(a){return this.specularPower__=a},get_specularAmount:function(){return this.specularAmount__},set_specularAmount:function(a){return this.specularAmount__=a},get_specularColor:function(){return this.specularColor__},set_specularColor:function(a){return this.specularColor__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.color__;case 1:return this.specularPower__;case 2:return this.specularAmount__;
case 3:return this.specularColor__}return null},getParamFloatValue:function(a){switch(a){case 1:return this.specularPower__;case 2:return this.specularAmount__}return 0},clone:function(){var a=Object.create(Mf.prototype);a.shader=this.shader;a.color__=this.color__;a.specularPower__=this.specularPower__;a.specularAmount__=this.specularAmount__;a.specularColor__=this.specularColor__;return a},__class__:Mf});var Sf=function(){this.cubeDir__=new P;this.fixedColor__=new B;this.pixel__=new B;this.offsets__=
[];this.values__=[];this.Quality__=0;this.cameraInverseViewProj__=new P;Pa.call(this)};r["h3d.shader.Blur"]=Sf;Sf.__name__="h3d.shader.Blur";Sf.__super__=Pa;Sf.prototype=J(Pa.prototype,{get_cameraInverseViewProj:function(){return this.cameraInverseViewProj__},set_cameraInverseViewProj:function(a){return this.cameraInverseViewProj__=a},get_texture:function(){return this.texture__},set_texture:function(a){return this.texture__=a},get_depthTexture:function(){return this.depthTexture__},set_depthTexture:function(a){return this.depthTexture__=
a},get_Quality:function(){return this.Quality__},set_Quality:function(a){this.constModified=!0;return this.Quality__=a},get_isDepth:function(){return this.isDepth__},set_isDepth:function(a){this.constModified=!0;return this.isDepth__=a},get_values:function(){return this.values__},set_values:function(a){return this.values__=a},get_offsets:function(){return this.offsets__},set_offsets:function(a){return this.offsets__=a},get_pixel:function(){return this.pixel__},set_pixel:function(a){return this.pixel__=
a},get_hasFixedColor:function(){return this.hasFixedColor__},set_hasFixedColor:function(a){this.constModified=!0;return this.hasFixedColor__=a},get_smoothFixedColor:function(){return this.smoothFixedColor__},set_smoothFixedColor:function(a){this.constModified=!0;return this.smoothFixedColor__=a},get_fixedColor:function(){return this.fixedColor__},set_fixedColor:function(a){return this.fixedColor__=a},get_isDepthDependant:function(){return this.isDepthDependant__},set_isDepthDependant:function(a){this.constModified=
!0;return this.isDepthDependant__=a},get_hasNormal:function(){return this.hasNormal__},set_hasNormal:function(a){this.constModified=!0;return this.hasNormal__=a},get_normalTexture:function(){return this.normalTexture__},set_normalTexture:function(a){return this.normalTexture__=a},get_isCube:function(){return this.isCube__},set_isCube:function(a){this.constModified=!0;return this.isCube__=a},get_cubeTexture:function(){return this.cubeTexture__},set_cubeTexture:function(a){return this.cubeTexture__=
a},get_cubeDir:function(){return this.cubeDir__},set_cubeDir:function(a){return this.cubeDir__=a},updateConstants:function(a){this.constBits=0;var b=this.Quality__;if(0!=b>>>8)throw new q("Quality is out of range "+b+">255");this.constBits|=b;this.isDepth__&&(this.constBits|=256);this.hasFixedColor__&&(this.constBits|=512);this.smoothFixedColor__&&(this.constBits|=1024);this.isDepthDependant__&&(this.constBits|=2048);this.hasNormal__&&(this.constBits|=4096);this.isCube__&&(this.constBits|=8192);this.updateConstantsFinal(a)},
getParamValue:function(a){switch(a){case 0:return this.flipY__;case 1:return this.cameraInverseViewProj__;case 2:return this.texture__;case 3:return this.depthTexture__;case 4:return this.Quality__;case 5:return this.isDepth__;case 6:return this.values__;case 7:return this.offsets__;case 8:return this.pixel__;case 9:return this.hasFixedColor__;case 10:return this.smoothFixedColor__;case 11:return this.fixedColor__;case 12:return this.isDepthDependant__;case 13:return this.hasNormal__;case 14:return this.normalTexture__;
case 15:return this.isCube__;case 16:return this.cubeTexture__;case 17:return this.cubeDir__}return null},getParamFloatValue:function(a){return 0==a?this.flipY__:0},clone:function(){var a=Object.create(Sf.prototype);a.shader=this.shader;a.flipY__=this.flipY__;a.cameraInverseViewProj__=this.cameraInverseViewProj__;a.texture__=this.texture__;a.depthTexture__=this.depthTexture__;a.Quality__=this.Quality__;a.isDepth__=this.isDepth__;a.values__=this.values__;a.offsets__=this.offsets__;a.pixel__=this.pixel__;
a.hasFixedColor__=this.hasFixedColor__;a.smoothFixedColor__=this.smoothFixedColor__;a.fixedColor__=this.fixedColor__;a.isDepthDependant__=this.isDepthDependant__;a.hasNormal__=this.hasNormal__;a.normalTexture__=this.normalTexture__;a.isCube__=this.isCube__;a.cubeTexture__=this.cubeTexture__;a.cubeDir__=this.cubeDir__;return a},__class__:Sf});var hi=function(a){this.globals=new Float32Array(a.globalsSize<<2);this.params=new Float32Array(a.paramsSize<<2);this.tex=Array(a.texturesCount);this.buffers=
0<a.bufferCount?Array(a.bufferCount):null};r["h3d.shader.ShaderBuffers"]=hi;hi.__name__="h3d.shader.ShaderBuffers";hi.prototype={grow:function(a){var b=a.globalsSize<<2,c=a.paramsSize<<2,d=a.texturesCount;a=a.bufferCount;this.globals.length<b&&(this.globals=new Float32Array(b));this.params.length<c&&(this.params=new Float32Array(c));this.tex.length<d&&(this.tex=Array(d));if(0<a&&(null==this.buffers||this.buffers.length<a))this.buffers=Array(a)},__class__:hi};var Fg=function(a){this.vertex=new hi(a.vertex);
this.fragment=new hi(a.fragment)};r["h3d.shader.Buffers"]=Fg;Fg.__name__="h3d.shader.Buffers";Fg.prototype={grow:function(a){this.vertex.grow(a.vertex);this.fragment.grow(a.fragment)},__class__:Fg};var Sc=function(a){null==a&&(a=0);this.color__=new B;T.call(this);var b=this.color__;b.x=(a>>16&255)/255;b.y=(a>>8&255)/255;b.z=(a&255)/255;b.w=(a>>>24)/255};r["h3d.shader.ColorAdd"]=Sc;Sc.__name__="h3d.shader.ColorAdd";Sc.__super__=T;Sc.prototype=J(T.prototype,{get_color:function(){return this.color__},
set_color:function(a){return this.color__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){return 0==a?this.color__:null},getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(Sc.prototype);a.shader=this.shader;a.color__=this.color__;return a},__class__:Sc});var Ae=function(a){null==a&&(a=0);this.colorKey__=new B;T.call(this);var b=this.colorKey__;b.x=(a>>16&255)/255;b.y=(a>>8&255)/255;b.z=(a&255)/255;b.w=(a>>>24)/255};
r["h3d.shader.ColorKey"]=Ae;Ae.__name__="h3d.shader.ColorKey";Ae.__super__=T;Ae.prototype=J(T.prototype,{get_colorKey:function(){return this.colorKey__},set_colorKey:function(a){return this.colorKey__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){return 0==a?this.colorKey__:null},getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(Ae.prototype);a.shader=this.shader;a.colorKey__=this.colorKey__;return a},__class__:Ae});
var Tc=function(a){this.matrix__=new P;T.call(this);null!=a?this.matrix__.loadValues(a):this.matrix__.identity()};r["h3d.shader.ColorMatrix"]=Tc;Tc.__name__="h3d.shader.ColorMatrix";Tc.__super__=T;Tc.prototype=J(T.prototype,{get_matrix:function(){return this.matrix__},set_matrix:function(a){return this.matrix__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){return 0==a?this.matrix__:null},getParamFloatValue:function(a){return 0},clone:function(){var a=
Object.create(Tc.prototype);a.shader=this.shader;a.matrix__=this.matrix__;return a},__class__:Tc});var Zf=function(){this.poissonDiskVeryHigh__=[];this.poissonDiskHigh__=[];this.poissonDiskLow__=[];this.shadowBias__=0;this.shadowProj__=new P;this.shadowMapChannel__=rb.Unknown;this.shadowRes__=new B;this.shadowPower__=this.pcfQuality__=this.pcfScale__=0;T.call(this);this.poissonDiskLow__=[new B(-0.942,-0.399),new B(0.945,-0.768),new B(-0.094,-0.929),new B(0.344,0.293)];this.poissonDiskHigh__=[new B(-0.326,
-0.406),new B(-0.84,-0.074),new B(-0.696,0.457),new B(-0.203,0.621),new B(0.962,-0.195),new B(0.473,-0.48),new B(0.519,0.767),new B(0.185,-0.893),new B(0.507,0.064),new B(0.896,0.412),new B(-0.322,-0.933),new B(-0.792,-0.598)];this.poissonDiskVeryHigh__=[new B(-0.613392,0.617481),new B(0.170019,-0.040254),new B(-0.299417,0.791925),new B(0.64568,0.49321),new B(-0.651784,0.717887),new B(0.421003,0.02707),new B(-0.817194,-0.271096),new B(-0.705374,-0.668203),new B(0.97705,-0.108615),new B(0.063326,0.142369),
new B(0.203528,0.214331),new B(-0.667531,0.32609),new B(-0.098422,-0.295755),new B(-0.885922,0.215369),new B(0.566637,0.605213),new B(0.039766,-0.3961),new B(0.751946,0.453352),new B(0.078707,-0.715323),new B(-0.075838,-0.529344),new B(0.724479,-0.580798),new B(0.222999,-0.215125),new B(-0.467574,-0.405438),new B(-0.248268,-0.814753),new B(0.354411,-0.88757),new B(0.175817,0.382366),new B(0.487472,-0.063082),new B(-0.084078,0.898312),new B(0.488876,-0.783441),new B(0.470016,0.217933),new B(-0.69689,
-0.549791),new B(-0.149693,0.605762),new B(0.034211,0.97998),new B(0.503098,-0.308878),new B(-0.016205,-0.872921),new B(0.385784,-0.393902),new B(-0.146886,-0.859249),new B(0.643361,0.164098),new B(0.634388,-0.049471),new B(-0.688894,0.007843),new B(0.464034,-0.188818),new B(-0.44084,0.137486),new B(0.364483,0.511704),new B(0.034028,0.325968),new B(0.099094,-0.308023),new B(0.69396,-0.366253),new B(0.678884,-0.204688),new B(0.001801,0.780328),new B(0.145177,-0.898984),new B(0.062655,-0.611866),new B(0.315226,
-0.604297),new B(-0.780145,0.486251),new B(-0.371868,0.882138),new B(0.200476,0.49443),new B(-0.494552,-0.711051),new B(0.612476,0.705252),new B(-0.578845,-0.768792),new B(-0.772454,-0.090976),new B(0.50444,0.372295),new B(0.155736,0.065157),new B(0.391522,0.849605),new B(-0.620106,-0.328104),new B(0.789239,-0.419965),new B(-0.545396,0.538133),new B(-0.178564,-0.596057)]};r["h3d.shader.DirShadow"]=Zf;Zf.__name__="h3d.shader.DirShadow";Zf.__super__=T;Zf.prototype=J(T.prototype,{get_enable:function(){return this.enable__},
set_enable:function(a){this.constModified=!0;return this.enable__=a},get_USE_ESM:function(){return this.USE_ESM__},set_USE_ESM:function(a){this.constModified=!0;return this.USE_ESM__=a},get_shadowPower:function(){return this.shadowPower__},set_shadowPower:function(a){return this.shadowPower__=a},get_USE_PCF:function(){return this.USE_PCF__},set_USE_PCF:function(a){this.constModified=!0;return this.USE_PCF__=a},get_pcfQuality:function(){return this.pcfQuality__},set_pcfQuality:function(a){this.constModified=
!0;return this.pcfQuality__=a},get_pcfScale:function(){return this.pcfScale__},set_pcfScale:function(a){return this.pcfScale__=a},get_shadowRes:function(){return this.shadowRes__},set_shadowRes:function(a){return this.shadowRes__=a},get_shadowMap:function(){return this.shadowMap__},set_shadowMap:function(a){this.constModified=!0;return this.shadowMap__=a},get_shadowMapChannel:function(){return this.shadowMapChannel__},set_shadowMapChannel:function(a){this.constModified=!0;return this.shadowMapChannel__=
a},get_shadowProj:function(){return this.shadowProj__},set_shadowProj:function(a){return this.shadowProj__=a},get_shadowBias:function(){return this.shadowBias__},set_shadowBias:function(a){return this.shadowBias__=a},get_poissonDiskLow:function(){return this.poissonDiskLow__},set_poissonDiskLow:function(a){return this.poissonDiskLow__=a},get_poissonDiskHigh:function(){return this.poissonDiskHigh__},set_poissonDiskHigh:function(a){return this.poissonDiskHigh__=a},get_poissonDiskVeryHigh:function(){return this.poissonDiskVeryHigh__},
set_poissonDiskVeryHigh:function(a){return this.poissonDiskVeryHigh__=a},updateConstants:function(a){this.constBits=0;this.enable__&&(this.constBits|=1);this.USE_ESM__&&(this.constBits|=2);this.USE_PCF__&&(this.constBits|=4);var b=this.pcfQuality__;if(0!=b>>>8)throw new q("pcfQuality is out of range "+b+">255");this.constBits|=b<<3;if(null==this.shadowMap__)this.shadowMapChannel__=rb.Unknown;else if(this.shadowMapChannel__==rb.Unknown)if(this.shadowMap__.format==S.nativeFormat)this.shadowMapChannel__=
rb.PackedFloat;else throw new q("shadowMapChannel is not set");this.constBits|=(a.allocChannelID(this.shadowMap__)<<3|this.shadowMapChannel__._hx_index)<<11;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.enable__;case 1:return this.USE_ESM__;case 2:return this.shadowPower__;case 3:return this.USE_PCF__;case 4:return this.pcfQuality__;case 5:return this.pcfScale__;case 6:return this.shadowRes__;case 7:return this.shadowMap__;case 8:return this.shadowProj__;case 9:return this.shadowBias__;
case 10:return this.poissonDiskLow__;case 11:return this.poissonDiskHigh__;case 12:return this.poissonDiskVeryHigh__}return null},getParamFloatValue:function(a){switch(a){case 2:return this.shadowPower__;case 5:return this.pcfScale__;case 9:return this.shadowBias__}return 0},clone:function(){var a=Object.create(Zf.prototype);a.shader=this.shader;a.enable__=this.enable__;a.USE_ESM__=this.USE_ESM__;a.shadowPower__=this.shadowPower__;a.USE_PCF__=this.USE_PCF__;a.pcfQuality__=this.pcfQuality__;a.pcfScale__=
this.pcfScale__;a.shadowRes__=this.shadowRes__;a.shadowMap__=this.shadowMap__;a.shadowProj__=this.shadowProj__;a.shadowBias__=this.shadowBias__;a.poissonDiskLow__=this.poissonDiskLow__;a.poissonDiskHigh__=this.poissonDiskHigh__;a.poissonDiskVeryHigh__=this.poissonDiskVeryHigh__;return a},__class__:Zf});var Rf=function(){this.color__=new B;this.mode__=0;Pa.call(this)};r["h3d.shader.GenTexture"]=Rf;Rf.__name__="h3d.shader.GenTexture";Rf.__super__=Pa;Rf.prototype=J(Pa.prototype,{get_mode:function(){return this.mode__},
set_mode:function(a){this.constModified=!0;return this.mode__=a},get_color:function(){return this.color__},set_color:function(a){return this.color__=a},updateConstants:function(a){this.constBits=0;var b=this.mode__;if(0!=b>>>8)throw new q("mode is out of range "+b+">255");this.constBits|=b;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.flipY__;case 1:return this.mode__;case 2:return this.color__}return null},getParamFloatValue:function(a){return 0==a?this.flipY__:
0},clone:function(){var a=Object.create(Rf.prototype);a.shader=this.shader;a.flipY__=this.flipY__;a.mode__=this.mode__;a.color__=this.color__;return a},__class__:Rf});var bg=function(a,b){null==b&&(b=1);null==a&&(a=1.5);this.lengthScale__=this.width__=0;T.call(this);this.width__=a;this.lengthScale__=b};r["h3d.shader.LineShader"]=bg;bg.__name__="h3d.shader.LineShader";bg.__super__=T;bg.prototype=J(T.prototype,{get_lengthScale:function(){return this.lengthScale__},set_lengthScale:function(a){return this.lengthScale__=
a},get_width:function(){return this.width__},set_width:function(a){return this.width__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.lengthScale__;case 1:return this.width__}return null},getParamFloatValue:function(a){switch(a){case 0:return this.lengthScale__;case 1:return this.width__}return 0},clone:function(){var a=Object.create(bg.prototype);a.shader=this.shader;a.lengthScale__=this.lengthScale__;a.width__=
this.width__;return a},__class__:bg});var Yf=function(){Pa.call(this)};r["h3d.shader.MinMaxShader"]=Yf;Yf.__name__="h3d.shader.MinMaxShader";Yf.__super__=Pa;Yf.prototype=J(Pa.prototype,{get_texA:function(){return this.texA__},set_texA:function(a){return this.texA__=a},get_texB:function(){return this.texB__},set_texB:function(a){return this.texB__=a},get_isMax:function(){return this.isMax__},set_isMax:function(a){this.constModified=!0;return this.isMax__=a},updateConstants:function(a){this.constBits=
0;this.isMax__&&(this.constBits|=1);this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.flipY__;case 1:return this.texA__;case 2:return this.texB__;case 3:return this.isMax__}return null},getParamFloatValue:function(a){return 0==a?this.flipY__:0},clone:function(){var a=Object.create(Yf.prototype);a.shader=this.shader;a.flipY__=this.flipY__;a.texA__=this.texA__;a.texB__=this.texB__;a.isMax__=this.isMax__;return a},__class__:Yf});var Wg=function(){this.mat__=new P;Pa.call(this)};
r["h3d.shader.CubeMinMaxShader"]=Wg;Wg.__name__="h3d.shader.CubeMinMaxShader";Wg.__super__=Pa;Wg.prototype=J(Pa.prototype,{get_texA:function(){return this.texA__},set_texA:function(a){return this.texA__=a},get_texB:function(){return this.texB__},set_texB:function(a){return this.texB__=a},get_isMax:function(){return this.isMax__},set_isMax:function(a){this.constModified=!0;return this.isMax__=a},get_mat:function(){return this.mat__},set_mat:function(a){return this.mat__=a},updateConstants:function(a){this.constBits=
0;this.isMax__&&(this.constBits|=1);this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.flipY__;case 1:return this.texA__;case 2:return this.texB__;case 3:return this.isMax__;case 4:return this.mat__}return null},getParamFloatValue:function(a){return 0==a?this.flipY__:0},clone:function(){var a=Object.create(Wg.prototype);a.shader=this.shader;a.flipY__=this.flipY__;a.texA__=this.texA__;a.texB__=this.texB__;a.isMax__=this.isMax__;a.mat__=this.mat__;return a},__class__:Wg});
var Pf=function(a){T.call(this);this.texture__=a};r["h3d.shader.NormalMap"]=Pf;Pf.__name__="h3d.shader.NormalMap";Pf.__super__=T;Pf.prototype=J(T.prototype,{get_texture:function(){return this.texture__},set_texture:function(a){return this.texture__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){return 0==a?this.texture__:null},getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(Pf.prototype);a.shader=this.shader;a.texture__=
this.texture__;return a},__class__:Pf});var Qg=function(){T.call(this)};r["h3d.shader.Shadow"]=Qg;Qg.__name__="h3d.shader.Shadow";Qg.__super__=T;Qg.prototype=J(T.prototype,{updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){return null},getParamFloatValue:function(a){return 0},__class__:Qg});var Ff=function(){this.smoothing__=0.041666666666666664;this.alphaCutoff__=0.5;this.channel__=0;T.call(this)};r["h3d.shader.SignedDistanceField"]=Ff;Ff.__name__=
"h3d.shader.SignedDistanceField";Ff.__super__=T;Ff.prototype=J(T.prototype,{get_channel:function(){return this.channel__},set_channel:function(a){this.constModified=!0;return this.channel__=a},get_alphaCutoff:function(){return this.alphaCutoff__},set_alphaCutoff:function(a){return this.alphaCutoff__=a},get_smoothing:function(){return this.smoothing__},set_smoothing:function(a){return this.smoothing__=a},updateConstants:function(a){this.constBits=0;var b=this.channel__;if(0!=b>>>8)throw new q("channel is out of range "+
b+">255");this.constBits|=b;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.channel__;case 1:return this.alphaCutoff__;case 2:return this.smoothing__}return null},getParamFloatValue:function(a){switch(a){case 1:return this.alphaCutoff__;case 2:return this.smoothing__}return 0},clone:function(){var a=Object.create(Ff.prototype);a.shader=this.shader;a.channel__=this.channel__;a.alphaCutoff__=this.alphaCutoff__;a.smoothing__=this.smoothing__;return a},__class__:Ff});
var nd=function(){this.bonesMatrixes__=[];this.MaxBones__=0;T.call(this);this.constModified=!0;this.MaxBones__=34};r["h3d.shader.SkinBase"]=nd;nd.__name__="h3d.shader.SkinBase";nd.__super__=T;nd.prototype=J(T.prototype,{get_MaxBones:function(){return this.MaxBones__},set_MaxBones:function(a){this.constModified=!0;return this.MaxBones__=a},get_bonesMatrixes:function(){return this.bonesMatrixes__},set_bonesMatrixes:function(a){return this.bonesMatrixes__=a},updateConstants:function(a){this.constBits=
0;var b=this.MaxBones__;if(0!=b>>>8)throw new q("MaxBones is out of range "+b+">255");this.constBits|=b;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.MaxBones__;case 1:return this.bonesMatrixes__}return null},getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(nd.prototype);a.shader=this.shader;a.MaxBones__=this.MaxBones__;a.bonesMatrixes__=this.bonesMatrixes__;return a},__class__:nd});var fg=function(){nd.call(this)};r["h3d.shader.Skin"]=
fg;fg.__name__="h3d.shader.Skin";fg.__super__=nd;fg.prototype=J(nd.prototype,{updateConstants:function(a){this.constBits=0;var b=this.MaxBones__;if(0!=b>>>8)throw new q("MaxBones is out of range "+b+">255");this.constBits|=b;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.MaxBones__;case 1:return this.bonesMatrixes__}return null},getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(fg.prototype);a.shader=this.shader;a.MaxBones__=this.MaxBones__;
a.bonesMatrixes__=this.bonesMatrixes__;return a},__class__:fg});var eg=function(){nd.call(this)};r["h3d.shader.SkinTangent"]=eg;eg.__name__="h3d.shader.SkinTangent";eg.__super__=nd;eg.prototype=J(nd.prototype,{updateConstants:function(a){this.constBits=0;var b=this.MaxBones__;if(0!=b>>>8)throw new q("MaxBones is out of range "+b+">255");this.constBits|=b;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.MaxBones__;case 1:return this.bonesMatrixes__}return null},
getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(eg.prototype);a.shader=this.shader;a.MaxBones__=this.MaxBones__;a.bonesMatrixes__=this.bonesMatrixes__;return a},__class__:eg});var Qf=function(a){T.call(this);this.texture__=a};r["h3d.shader.SpecularTexture"]=Qf;Qf.__name__="h3d.shader.SpecularTexture";Qf.__super__=T;Qf.prototype=J(T.prototype,{get_texture:function(){return this.texture__},set_texture:function(a){return this.texture__=a},updateConstants:function(a){this.constBits=
0;this.updateConstantsFinal(a)},getParamValue:function(a){return 0==a?this.texture__:null},getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(Qf.prototype);a.shader=this.shader;a.texture__=this.texture__;return a},__class__:Qf});var Of=function(a){this.killAlphaThreshold__=0;T.call(this);this.texture__=a;this.killAlphaThreshold__=Xb.defaultKillAlphaThreshold};r["h3d.shader.Texture"]=Of;Of.__name__="h3d.shader.Texture";Of.__super__=T;Of.prototype=J(T.prototype,{get_additive:function(){return this.additive__},
set_additive:function(a){this.constModified=!0;return this.additive__=a},get_killAlpha:function(){return this.killAlpha__},set_killAlpha:function(a){this.constModified=!0;return this.killAlpha__=a},get_specularAlpha:function(){return this.specularAlpha__},set_specularAlpha:function(a){this.constModified=!0;return this.specularAlpha__=a},get_killAlphaThreshold:function(){return this.killAlphaThreshold__},set_killAlphaThreshold:function(a){return this.killAlphaThreshold__=a},get_texture:function(){return this.texture__},
set_texture:function(a){return this.texture__=a},updateConstants:function(a){this.constBits=0;this.additive__&&(this.constBits|=1);this.killAlpha__&&(this.constBits|=2);this.specularAlpha__&&(this.constBits|=4);this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.additive__;case 1:return this.killAlpha__;case 2:return this.specularAlpha__;case 3:return this.killAlphaThreshold__;case 4:return this.texture__}return null},getParamFloatValue:function(a){return 3==a?this.killAlphaThreshold__:
0},clone:function(){var a=Object.create(Of.prototype);a.shader=this.shader;a.additive__=this.additive__;a.killAlpha__=this.killAlpha__;a.specularAlpha__=this.specularAlpha__;a.killAlphaThreshold__=this.killAlphaThreshold__;a.texture__=this.texture__;return a},__class__:Of});var Fc=function(a,b,c,d){null==d&&(d=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);this.uvScale__=new B;this.uvDelta__=new B;T.call(this);var e=this.uvDelta__;null==b&&(b=0);null==a&&(a=0);e.x=a;e.y=b;e.z=0;e.w=1;e=this.uvScale__;
null==d&&(d=0);null==c&&(c=0);e.x=c;e.y=d;e.z=0;e.w=1};r["h3d.shader.UVDelta"]=Fc;Fc.__name__="h3d.shader.UVDelta";Fc.__super__=T;Fc.prototype=J(T.prototype,{get_uvDelta:function(){return this.uvDelta__},set_uvDelta:function(a){return this.uvDelta__=a},get_uvScale:function(){return this.uvScale__},set_uvScale:function(a){return this.uvScale__=a},updateConstants:function(a){this.constBits=0;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.uvDelta__;case 1:return this.uvScale__}return null},
getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(Fc.prototype);a.shader=this.shader;a.uvDelta__=this.uvDelta__;a.uvScale__=this.uvScale__;return a},__class__:Fc});var cg=function(){T.call(this)};r["h3d.shader.VertexColorAlpha"]=cg;cg.__name__="h3d.shader.VertexColorAlpha";cg.__super__=T;cg.prototype=J(T.prototype,{get_additive:function(){return this.additive__},set_additive:function(a){this.constModified=!0;return this.additive__=a},updateConstants:function(a){this.constBits=
0;this.additive__&&(this.constBits|=1);this.updateConstantsFinal(a)},getParamValue:function(a){return 0==a?this.additive__:null},getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(cg.prototype);a.shader=this.shader;a.additive__=this.additive__;return a},__class__:cg});var Lf=function(a,b){this.isCentered__=!0;this.tangent__=new B;this.normal__=new B;this.scale__=new B;T.call(this);var c=this.normal__,d=0,e=0,f=1;null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);c.x=d;c.y=e;c.z=
f;c.w=1;c=this.tangent__;d=1;f=e=0;null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);c.x=d;c.y=e;c.z=f;c.w=1;c=this.scale__;d=1/a;e=1/b;null==e&&(e=0);null==d&&(d=0);c.x=d;c.y=e;c.z=0;c.w=1};r["h3d.shader.VolumeDecal"]=Lf;Lf.__name__="h3d.shader.VolumeDecal";Lf.__super__=T;Lf.prototype=J(T.prototype,{get_scale:function(){return this.scale__},set_scale:function(a){return this.scale__=a},get_normal:function(){return this.normal__},set_normal:function(a){return this.normal__=a},get_tangent:function(){return this.tangent__},
set_tangent:function(a){return this.tangent__=a},get_isCentered:function(){return this.isCentered__},set_isCentered:function(a){this.constModified=!0;return this.isCentered__=a},updateConstants:function(a){this.constBits=0;this.isCentered__&&(this.constBits|=64);this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.scale__;case 1:return this.normal__;case 2:return this.tangent__;case 3:return this.isCentered__}return null},getParamFloatValue:function(a){return 0},clone:function(){var a=
Object.create(Lf.prototype);a.shader=this.shader;a.scale__=this.scale__;a.normal__=this.normal__;a.tangent__=this.tangent__;a.isCentered__=this.isCentered__;return a},__class__:Lf});var gg=K["haxe.StackItem"]={__ename__:!0,__constructs__:["CFunction","Module","FilePos","Method","LocalFunction"],CFunction:{_hx_index:0,__enum__:"haxe.StackItem",toString:m},Module:(s=function(a){return{_hx_index:1,m:a,__enum__:"haxe.StackItem",toString:m}},s.__params__=["m"],s),FilePos:(s=function(a,b,c,d){return{_hx_index:2,
s:a,file:b,line:c,column:d,__enum__:"haxe.StackItem",toString:m}},s.__params__=["s","file","line","column"],s),Method:(s=function(a,b){return{_hx_index:3,classname:a,method:b,__enum__:"haxe.StackItem",toString:m}},s.__params__=["classname","method"],s),LocalFunction:(s=function(a){return{_hx_index:4,v:a,__enum__:"haxe.StackItem",toString:m}},s.__params__=["v"],s)};gg.__empty_constructs__=[gg.CFunction];var $=function(){};r["haxe.CallStack"]=$;$.__name__="haxe.CallStack";$.getStack=function(a){if(null==
a)return[];var b=Error.prepareStackTrace;Error.prepareStackTrace=function(a,b){for(var e=[],f=0;f<b.length;){var g=b[f];++f;null!=$.wrapCallSite&&(g=$.wrapCallSite(g));var h=null,k=g.getFunctionName();if(null!=k){var l=k.lastIndexOf(".");0<=l&&(h=v.substr(k,0,l),k=v.substr(k,l+1,null),h=gg.Method(h,k))}k=g.getFileName();l=null==k?-1:k.indexOf("file:");null!=$.wrapCallSite&&0<l&&(k=v.substr(k,l+6,null));e.push(gg.FilePos(h,k,g.getLineNumber(),g.getColumnNumber()))}return e};a=$.makeStack(a.stack);
Error.prepareStackTrace=b;return a};$.callStack=function(){try{throw Error();}catch(a){$.lastException=a;var b=$.getStack(a);b.shift();return b}};$.exceptionStack=function(){return $.getStack($.lastException)};$.toString=function(a){for(var b=new Ib,c=0;c<a.length;){var d=a[c];++c;b.b+="\nCalled from ";$.itemToString(b,d)}return b.b};$.itemToString=function(a,b){switch(b._hx_index){case 0:a.b+="a C function";break;case 1:var c=b.m;a.b+="module ";a.b+=null==c?"null":""+c;break;case 2:var c=b.column,
d=b.line,e=b.file,f=b.s;null!=f&&($.itemToString(a,f),a.b+=" (");a.b+=null==e?"null":""+e;a.b+=" line ";a.b+=null==d?"null":""+d;null!=c&&(a.b+=" column ",a.b+=null==c?"null":""+c);null!=f&&(a.b+=")");break;case 3:c=b.method;d=b.classname;a.b+=n.string(null==d?"<unknown>":d);a.b+=".";a.b+=null==c?"null":""+c;break;case 4:c=b.v,a.b+="local function #",a.b+=null==c?"null":""+c}};$.makeStack=function(a){if(null==a)return[];if("string"==typeof a){a=a.split("\n");"Error"==a[0]&&a.shift();for(var b=[],
c=new uf("^   at ([A-Za-z0-9_. ]+) \\(([^)]+):([0-9]+):([0-9]+)\\)$",""),d=0;d<a.length;){var e=a[d];++d;if(c.match(e)){var e=c.matched(1).split("."),f=e.pop(),g=c.matched(2),h=n.parseInt(c.matched(3)),k=n.parseInt(c.matched(4));b.push(gg.FilePos("Anonymous function"==f?gg.LocalFunction():"Global code"==f?null:gg.Method(e.join("."),f),g,h,k))}else b.push(gg.Module(Qa.trim(e)))}return b}return a};var Xc=function(){};r["haxe.IMap"]=Xc;Xc.__name__="haxe.IMap";Xc.__isInterface__=!0;Xc.prototype={__class__:Xc};
var te=function(){};r["haxe.EntryPoint"]=te;te.__name__="haxe.EntryPoint";te.processEvents=function(){for(;;){var a=te.pending.shift();if(null==a)break;a()}a=Sb.tick();return!Sb.hasEvents()&&0==te.threadCount?-1:a};te.run=function(){te.processEvents();var a=window;(a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame)(te.run)};var hd=function(a,b){null==a&&(a="");this.message=a;this.previous=b;this.stack=$.callStack();this.stack.shift()};r["haxe.Exception"]=hd;hd.__name__=
"haxe.Exception";hd.wrap=function(a,b){return a instanceof hd?a:new hd(n.string(a))};hd.wrapWithStack=function(a){return hd.wrap(a).setStack($.exceptionStack())};hd.prototype={toString:function(){for(var a="",b=this,c=null;null!=b;)a=null==c?"Exception: "+b.message+"\nStack:"+$.toString(b.stack)+a:"Exception: "+b.message+"\nStack:"+$.toString(Sd.subtract(b.stack,c.stack))+"\n\nNext "+a,c=b,b=b.previous;return a},setStack:function(a){this.stack=a;return this},__class__:hd};var Sd={};r["haxe._Exception.Stack_Impl_"]=
Sd;Sd.__name__="haxe._Exception.Stack_Impl_";Sd._new=function(){return $.callStack()};Sd.toString=function(a){return $.toString(a)};Sd.subtract=function(a,b){for(var c=-1,d=-1;++d<a.length;){for(var e=0,f=b.length;e<f;){var g=e++;if(Sd.equalItems(a[d],b[g])){if(0>c&&(c=d),++d,d>=a.length)break}else c=-1}if(0<=c)break}return 0<=c?a.slice(0,c):a};Sd.get=function(a,b){return a[b]};Sd.iterator=function(a){return new Dj(a)};Sd.equalItems=function(a,b){if(null==a)return null==b?!0:!1;switch(a._hx_index){case 0:return null==
b?!1:0==b._hx_index?!0:!1;case 1:return null==b?!1:1==b._hx_index?a.m==b.m:!1;case 2:if(null==b)return!1;if(2==b._hx_index){var c=a.s,d=a.line,e=a.column,f=b.column,g=b.line,h=b.s;return a.file==b.file&&d==g&&e==f?Sd.equalItems(c,h):!1}return!1;case 3:return null==b?!1:3==b._hx_index?(c=a.method,d=b.method,a.classname==b.classname?c==d:!1):!1;case 4:return null==b?!1:4==b._hx_index?a.v==b.v:!1}};var Dj=function(a){this.current=0;this.array=a};r["haxe._Exception.StackIterator"]=Dj;Dj.__name__="haxe._Exception.StackIterator";
Dj.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Dj};var Fb=function(){};r["haxe.Log"]=Fb;Fb.__name__="haxe.Log";Fb.formatOutput=function(a,b){var c=n.string(a);if(null==b)return c;var d=b.fileName+":"+b.lineNumber;if(null!=b.customParams)for(var e=0,f=b.customParams;e<f.length;){var g=f[e];++e;c+=", "+n.string(g)}return d+": "+c};Fb.trace=function(a,b){var c=Fb.formatOutput(a,b);"undefined"!=typeof console&&null!=
console.log&&console.log(c)};var Ej=function(a,b){this.isBlocking=!0;this.f=a;this.priority=b;this.nextRun=-Infinity};r["haxe.MainEvent"]=Ej;Ej.__name__="haxe.MainEvent";Ej.prototype={stop:function(){null!=this.f&&(this.f=null,this.nextRun=-Infinity,null==this.prev?Sb.pending=this.next:this.prev.next=this.next,null!=this.next&&(this.next.prev=this.prev))},__class__:Ej};var Sb=function(){};r["haxe.MainLoop"]=Sb;Sb.__name__="haxe.MainLoop";Sb.hasEvents=function(){for(var a=Sb.pending;null!=a;){if(a.isBlocking)return!0;
a=a.next}return!1};Sb.add=function(a,b){null==b&&(b=0);if(null==a)throw new q("Event function is null");var c=new Ej(a,b),d=Sb.pending;null!=d&&(d.prev=c);c.next=d;return Sb.pending=c};Sb.sortEvents=function(){var a=Sb.pending;if(null!=a){for(var b=1,c,d=0,e=0,f,g,h,k;;){f=a;k=a=null;for(c=0;null!=f;){++c;g=f;e=d=0;for(h=b;e<h&&!(e++,++d,g=g.next,null==g););for(e=b;0<d||0<e&&null!=g;)0==d?(h=g,g=g.next,--e):0==e||null==g||f.priority>g.priority||f.priority==g.priority&&f.nextRun<=g.nextRun?(h=f,f=
f.next,--d):(h=g,g=g.next,--e),null!=k?k.next=h:a=h,h.prev=k,k=h;f=g}k.next=null;if(1>=c)break;b*=2}a.prev=null;Sb.pending=a}};Sb.tick=function(){Sb.sortEvents();for(var a=Sb.pending,b=Date.now()/1E3,c=1E9;null!=a;){var d=a.next,e=a.nextRun-b;0>=e?(c=0,null!=a.f&&a.f()):c>e&&(c=e);a=d}return c};var de=function(a){var b=this;this.id=setInterval(function(){b.run()},a)};r["haxe.Timer"]=de;de.__name__="haxe.Timer";de.delay=function(a,b){var c=new de(b);c.run=function(){c.stop();a()};return c};de.prototype=
{stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:de};var ii=function(){};r["haxe._Unserializer.DefaultResolver"]=ii;ii.__name__="haxe._Unserializer.DefaultResolver";ii.prototype={resolveClass:function(a){return r[a]},resolveEnum:function(a){return K[a]},__class__:ii};var Tb=function(a){this.buf=a;this.length=a.length;this.pos=0;this.scache=[];this.cache=[];a=Tb.DEFAULT_RESOLVER;null==a&&(a=new ii,Tb.DEFAULT_RESOLVER=a);this.resolver=a};r["haxe.Unserializer"]=
Tb;Tb.__name__="haxe.Unserializer";Tb.initCodes=function(){for(var a=[],b=0,c=Tb.BASE64.length;b<c;){var d=b++;a[Tb.BASE64.charCodeAt(d)]=d}return a};Tb.run=function(a){return(new Tb(a)).unserialize()};Tb.prototype={readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var d=this.buf.charCodeAt(this.pos);if(d!=d)break;if(45==d){if(this.pos!=c)break;b=!0}else{if(48>d||57<d)break;a=10*a+(d-48)}this.pos++}b&&(a*=-1);return a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);
if(b!=b)break;if(43<=b&&58>b||101==b||69==b)this.pos++;else break}return parseFloat(v.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw new q("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw new q("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.buf.charCodeAt(this.pos++))throw new q("Invalid enum format");var c=this.readDigits();
if(0==c)return Fa.createEnum(a,b);for(var d=[];0<c--;)d.push(this.unserialize());return Fa.createEnum(a,b,d)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var a=this.unserialize(),b=this.resolver.resolveClass(a);if(null==b)throw new q("Class not found "+a);return b;case 66:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw new q("Enum not found "+a);return b;case 67:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw new q("Class not found "+
a);a=Object.create(b.prototype);this.cache.push(a);a.hxUnserialize(this);if(103!=this.buf.charCodeAt(this.pos++))throw new q("Invalid custom data");return a;case 77:a=new zb;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),a.set(b,this.unserialize());this.pos++;return a;case 82:a=this.readDigits();if(0>a||a>=this.scache.length)throw new q("Invalid string reference");return this.scache[a];case 97:a=[];for(this.cache.push(a);;){b=this.buf.charCodeAt(this.pos);if(104==
b){this.pos++;break}117==b?(this.pos++,b=this.readDigits(),a[a.length+b-1]=null):a.push(this.unserialize())}return a;case 98:a=new ga;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);){var b=this.unserialize(),c=this.unserialize();null!=Q[b]?a.setReserved(b,c):a.h[b]=c}this.pos++;return a;case 99:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw new q("Class not found "+a);a=Object.create(b.prototype);this.cache.push(a);this.unserializeObject(a);return a;case 100:return this.readFloat();
case 102:return!1;case 105:return this.readDigits();case 106:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw new q("Enum not found "+a);this.pos++;var c=this.readDigits(),d=b.__constructs__.slice()[c];if(null==d)throw new q("Unknown enum index "+a+"@"+c);a=this.unserializeEnum(b,d);this.cache.push(a);return a;case 107:return NaN;case 108:a=new Nc;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)a.add(this.unserialize());this.pos++;return a;case 109:return-Infinity;case 110:return null;
case 111:return a={},this.cache.push(a),this.unserializeObject(a),a;case 112:return Infinity;case 113:a=new na;this.cache.push(a);for(b=this.buf.charCodeAt(this.pos++);58==b;)b=this.readDigits(),c=this.unserialize(),a.h[b]=c,b=this.buf.charCodeAt(this.pos++);if(104!=b)throw new q("Invalid IntMap format");return a;case 114:a=this.readDigits();if(0>a||a>=this.cache.length)throw new q("Invalid reference");return this.cache[a];case 115:a=this.readDigits();d=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||
this.length-this.pos<a)throw new q("Invalid bytes length");var e=Tb.CODES;null==e&&(e=Tb.initCodes(),Tb.CODES=e);for(var f=this.pos,g=a&3,h=f+(a-g),b=new N(new ArrayBuffer(3*(a>>2)+(2<=g?g-1:0))),c=0;f<h;){var k=e[d.charCodeAt(f++)],l=e[d.charCodeAt(f++)];b.b[c++]=k<<2|l>>4;k=e[d.charCodeAt(f++)];b.b[c++]=l<<4|k>>2;l=e[d.charCodeAt(f++)];b.b[c++]=k<<6|l}2<=g&&(l=e[d.charCodeAt(f++)],h=e[d.charCodeAt(f++)],b.b[c++]=l<<2|h>>4,3==g&&(d=e[d.charCodeAt(f++)],b.b[c++]=h<<4|d>>2));this.pos+=a;this.cache.push(b);
return b;case 116:return!0;case 118:return 48<=this.buf.charCodeAt(this.pos)&&57>=this.buf.charCodeAt(this.pos)&&48<=this.buf.charCodeAt(this.pos+1)&&57>=this.buf.charCodeAt(this.pos+1)&&48<=this.buf.charCodeAt(this.pos+2)&&57>=this.buf.charCodeAt(this.pos+2)&&48<=this.buf.charCodeAt(this.pos+3)&&57>=this.buf.charCodeAt(this.pos+3)&&45==this.buf.charCodeAt(this.pos+4)?(a=v.strDate(v.substr(this.buf,this.pos,19)),this.pos+=19):a=new Date(this.readFloat()),this.cache.push(a),a;case 119:a=this.unserialize();
b=this.resolver.resolveEnum(a);if(null==b)throw new q("Enum not found "+a);a=this.unserializeEnum(b,this.unserialize());this.cache.push(a);return a;case 120:throw q.wrap(this.unserialize());case 121:a=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw new q("Invalid string length");b=v.substr(this.buf,this.pos,a);this.pos+=a;b=decodeURIComponent(b.split("+").join(" "));this.scache.push(b);return b;case 122:return 0}this.pos--;throw new q("Invalid char "+this.buf.charAt(this.pos)+
" at position "+this.pos);},__class__:Tb};var hg=function(){this.a1=1;this.a2=0};r["haxe.crypto.Adler32"]=hg;hg.__name__="haxe.crypto.Adler32";hg.read=function(a){var b=new hg,c=a.readByte(),d=a.readByte(),e=a.readByte();a=a.readByte();b.a1=e<<8|a;b.a2=c<<8|d;return b};hg.prototype={update:function(a,b,c){var d=this.a1,e=this.a2,f=b;for(b+=c;f<b;)c=f++,d=(d+a.b[c])%65521,e=(e+d)%65521;this.a1=d;this.a2=e},equals:function(a){return a.a1==this.a1?a.a2==this.a2:!1},__class__:hg};var N=function(a){this.length=
a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};r["haxe.io.Bytes"]=N;N.__name__="haxe.io.Bytes";N.ofString=function(a,b){if(b==Fj.RawNative){for(var c=new Uint8Array(a.length<<1),d=0,e=a.length;d<e;){var f=d++,g=a.charCodeAt(f);c[f<<1]=g&255;c[f<<1|1]=g>>8}return new N(c.buffer)}c=[];for(d=0;d<a.length;)e=a.charCodeAt(d++),55296<=e&&56319>=e&&(e=e-55232<<10|a.charCodeAt(d++)&1023),127>=e?c.push(e):(2047>=e?c.push(192|e>>6):(65535>=e?c.push(224|e>>12):(c.push(240|
e>>18),c.push(128|e>>12&63)),c.push(128|e>>6&63)),c.push(128|e&63));return new N((new Uint8Array(c)).buffer)};N.ofData=function(a){var b=a.hxBytes;return null!=b?b:new N(a)};N.prototype={blit:function(a,b,c,d){if(0>a||0>c||0>d||a+d>this.length||c+d>b.length)throw new q(Hc.OutsideBounds);0==c&&d==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+d),a)},fill:function(a,b,c){for(var d=0;d<b;)d++,this.b[a++]=c},getFloat:function(a){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,
this.b.byteLength));return this.data.getFloat32(a,!0)},setFloat:function(a,b){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength));this.data.setFloat32(a,b,!0)},getUInt16:function(a){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength));return this.data.getUint16(a,!0)},setUInt16:function(a,b){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength));this.data.setUint16(a,b,!0)},getInt32:function(a){null==
this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength));return this.data.getInt32(a,!0)},setInt32:function(a,b){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength));this.data.setInt32(a,b,!0)},getString:function(a,b,c){if(0>a||0>b||a+b>this.length)throw new q(Hc.OutsideBounds);null==c&&(c=Fj.UTF8);var d="",e=this.b,f=a;a+=b;switch(c._hx_index){case 0:for(;f<a;){c=e[f++];if(128>c){if(0==c)break}else if(224>c)c=(c&63)<<6|e[f++]&
127;else if(240>c)b=e[f++],c=(c&31)<<12|(b&127)<<6|e[f++]&127;else{b=e[f++];var g=e[f++];c=(c&15)<<18|(b&127)<<12|(g&127)<<6|e[f++]&127}d+=String.fromCodePoint(c)}break;case 1:for(;f<a;)c=e[f++]|e[f++]<<8,d+=String.fromCodePoint(c)}return d},toString:function(){return this.getString(0,this.length)},__class__:N};var Fj=K["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:m},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",
toString:m}};Fj.__empty_constructs__=[Fj.UTF8,Fj.RawNative];var od=function(){};r["haxe.crypto.Base64"]=od;od.__name__="haxe.crypto.Base64";od.encode=function(a,b){null==b&&(b=!0);var c=(new ji(od.BYTES)).encodeBytes(a).toString();if(b)switch(a.length%3){case 1:c+="==";break;case 2:c+="="}return c};od.decode=function(a,b){null==b&&(b=!0);if(b)for(;61==v.cca(a,a.length-1);)a=v.substr(a,0,-1);return(new ji(od.BYTES)).decodeBytes(N.ofString(a))};var ji=function(a){for(var b=a.length,c=1;b>1<<c;)++c;
if(8<c||b!=1<<c)throw new q("BaseCode : base length must be a power of two.");this.base=a;this.nbits=c};r["haxe.crypto.BaseCode"]=ji;ji.__name__="haxe.crypto.BaseCode";ji.prototype={encodeBytes:function(a){for(var b=this.nbits,c=this.base,d=8*a.length/b|0,e=new N(new ArrayBuffer(d+(0==8*a.length%b?0:1))),f=0,g=0,h=(1<<b)-1,k=0,l=0;l<d;){for(;g<b;)g+=8,f<<=8,f|=a.b[k++];g-=b;e.b[l++]=c.b[f>>g&h]}0<g&&(e.b[l++]=c.b[f<<b-g&h]);return e},initTable:function(){for(var a=[],b=0;256>b;){var c=b++;a[c]=-1}b=
0;for(c=this.base.length;b<c;){var d=b++;a[this.base.b[d]]=d}this.tbl=a},decodeBytes:function(a){var b=this.nbits;null==this.tbl&&this.initTable();for(var c=this.tbl,d=a.length*b>>3,e=new N(new ArrayBuffer(d)),f=0,g=0,h=0,k=0;k<d;){for(;8>g;){var g=g+b,f=f<<b,l=c[a.b[h++]];if(-1==l)throw new q("BaseCode : invalid encoded char");f|=l}g-=8;e.b[k++]=f>>g&255}return e},__class__:ji};var Td=function(){};r["haxe.crypto.Md5"]=Td;Td.__name__="haxe.crypto.Md5";Td.encode=function(a){var b=new Td;a=b.doEncode(Td.str2blks(a));
return b.hex(a)};Td.str2blks=function(a){var b=N.ofString(a),c=(b.length+8>>6)+1;a=[];for(var d=0,e=16*c;d<e;){var f=d++;a[f]=0}e=0;f=b.length;for(d=8*f;e<f;)a[e>>2]|=b.b[e]<<8*((d+e)%4),++e;a[e>>2]|=128<<8*((d+e)%4);b=16*c-2;a[b]=d&255;a[b]|=(d>>>8&255)<<8;a[b]|=(d>>>16&255)<<16;a[b]|=(d>>>24&255)<<24;return a};Td.prototype={bitOR:function(a,b){return(a>>>1|b>>>1)<<1|a&1|b&1},bitXOR:function(a,b){return(a>>>1^b>>>1)<<1|a&1^b&1},bitAND:function(a,b){return(a>>>1&b>>>1)<<1|a&1&b&1},addme:function(a,
b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535},hex:function(a){for(var b="",c=0;c<a.length;){var d=a[c];++c;b+="0123456789abcdef".charAt(d>>4&15)+"0123456789abcdef".charAt(d&15);b+="0123456789abcdef".charAt(d>>12&15)+"0123456789abcdef".charAt(d>>8&15);b+="0123456789abcdef".charAt(d>>20&15)+"0123456789abcdef".charAt(d>>16&15);b+="0123456789abcdef".charAt(d>>28&15)+"0123456789abcdef".charAt(d>>24&15)}return b},rol:function(a,b){return a<<b|a>>>32-b},cmn:function(a,b,c,d,e,f){return this.addme(this.rol(this.addme(this.addme(b,
a),this.addme(d,f)),e),c)},ff:function(a,b,c,d,e,f,g){return this.cmn(this.bitOR(this.bitAND(b,c),this.bitAND(~b,d)),a,b,e,f,g)},gg:function(a,b,c,d,e,f,g){return this.cmn(this.bitOR(this.bitAND(b,d),this.bitAND(c,~d)),a,b,e,f,g)},hh:function(a,b,c,d,e,f,g){return this.cmn(this.bitXOR(this.bitXOR(b,c),d),a,b,e,f,g)},ii:function(a,b,c,d,e,f,g){return this.cmn(this.bitXOR(c,this.bitOR(b,~d)),a,b,e,f,g)},doEncode:function(a){for(var b=1732584193,c=-271733879,d=-1732584194,e=271733878,f=0;f<a.length;)var g=
b,h=c,k=d,l=e,b=this.ff(b,c,d,e,a[f],7,-680876936),e=this.ff(e,b,c,d,a[f+1],12,-389564586),d=this.ff(d,e,b,c,a[f+2],17,606105819),c=this.ff(c,d,e,b,a[f+3],22,-1044525330),b=this.ff(b,c,d,e,a[f+4],7,-176418897),e=this.ff(e,b,c,d,a[f+5],12,1200080426),d=this.ff(d,e,b,c,a[f+6],17,-1473231341),c=this.ff(c,d,e,b,a[f+7],22,-45705983),b=this.ff(b,c,d,e,a[f+8],7,1770035416),e=this.ff(e,b,c,d,a[f+9],12,-1958414417),d=this.ff(d,e,b,c,a[f+10],17,-42063),c=this.ff(c,d,e,b,a[f+11],22,-1990404162),b=this.ff(b,
c,d,e,a[f+12],7,1804603682),e=this.ff(e,b,c,d,a[f+13],12,-40341101),d=this.ff(d,e,b,c,a[f+14],17,-1502002290),c=this.ff(c,d,e,b,a[f+15],22,1236535329),b=this.gg(b,c,d,e,a[f+1],5,-165796510),e=this.gg(e,b,c,d,a[f+6],9,-1069501632),d=this.gg(d,e,b,c,a[f+11],14,643717713),c=this.gg(c,d,e,b,a[f],20,-373897302),b=this.gg(b,c,d,e,a[f+5],5,-701558691),e=this.gg(e,b,c,d,a[f+10],9,38016083),d=this.gg(d,e,b,c,a[f+15],14,-660478335),c=this.gg(c,d,e,b,a[f+4],20,-405537848),b=this.gg(b,c,d,e,a[f+9],5,568446438),
e=this.gg(e,b,c,d,a[f+14],9,-1019803690),d=this.gg(d,e,b,c,a[f+3],14,-187363961),c=this.gg(c,d,e,b,a[f+8],20,1163531501),b=this.gg(b,c,d,e,a[f+13],5,-1444681467),e=this.gg(e,b,c,d,a[f+2],9,-51403784),d=this.gg(d,e,b,c,a[f+7],14,1735328473),c=this.gg(c,d,e,b,a[f+12],20,-1926607734),b=this.hh(b,c,d,e,a[f+5],4,-378558),e=this.hh(e,b,c,d,a[f+8],11,-2022574463),d=this.hh(d,e,b,c,a[f+11],16,1839030562),c=this.hh(c,d,e,b,a[f+14],23,-35309556),b=this.hh(b,c,d,e,a[f+1],4,-1530992060),e=this.hh(e,b,c,d,a[f+
4],11,1272893353),d=this.hh(d,e,b,c,a[f+7],16,-155497632),c=this.hh(c,d,e,b,a[f+10],23,-1094730640),b=this.hh(b,c,d,e,a[f+13],4,681279174),e=this.hh(e,b,c,d,a[f],11,-358537222),d=this.hh(d,e,b,c,a[f+3],16,-722521979),c=this.hh(c,d,e,b,a[f+6],23,76029189),b=this.hh(b,c,d,e,a[f+9],4,-640364487),e=this.hh(e,b,c,d,a[f+12],11,-421815835),d=this.hh(d,e,b,c,a[f+15],16,530742520),c=this.hh(c,d,e,b,a[f+2],23,-995338651),b=this.ii(b,c,d,e,a[f],6,-198630844),e=this.ii(e,b,c,d,a[f+7],10,1126891415),d=this.ii(d,
e,b,c,a[f+14],15,-1416354905),c=this.ii(c,d,e,b,a[f+5],21,-57434055),b=this.ii(b,c,d,e,a[f+12],6,1700485571),e=this.ii(e,b,c,d,a[f+3],10,-1894986606),d=this.ii(d,e,b,c,a[f+10],15,-1051523),c=this.ii(c,d,e,b,a[f+1],21,-2054922799),b=this.ii(b,c,d,e,a[f+8],6,1873313359),e=this.ii(e,b,c,d,a[f+15],10,-30611744),d=this.ii(d,e,b,c,a[f+6],15,-1560198380),c=this.ii(c,d,e,b,a[f+13],21,1309151649),b=this.ii(b,c,d,e,a[f+4],6,-145523070),e=this.ii(e,b,c,d,a[f+11],10,-1120210379),d=this.ii(d,e,b,c,a[f+2],15,718787259),
c=this.ii(c,d,e,b,a[f+9],21,-343485551),b=this.addme(b,g),c=this.addme(c,h),d=this.addme(d,k),e=this.addme(e,l),f=f+16;return[b,c,d,e]},__class__:Td};var ib=function(){};r["haxe.ds.ArraySort"]=ib;ib.__name__="haxe.ds.ArraySort";ib.sort=function(a,b){ib.rec(a,b,0,a.length)};ib.rec=function(a,b,c,d){var e=c+d>>1;if(12>d-c){if(!(d<=c))for(e=c+1;e<d;)for(var f=e++;f>c;){if(0>b(a[f],a[f-1]))ib.swap(a,f-1,f);else break;--f}}else ib.rec(a,b,c,e),ib.rec(a,b,e,d),ib.doMerge(a,b,c,e,d,e-c,d-e)};ib.doMerge=
function(a,b,c,d,e,f,g){var h,k,l,m;0==f||0==g||(2==f+g?0>b(a[d],a[c])&&ib.swap(a,d,c):(f>g?(l=f>>1,h=c+l,k=ib.lower(a,b,d,e,h),m=k-d):(m=g>>1,k=d+m,h=ib.upper(a,b,c,d,k),l=h-c),ib.rotate(a,b,h,d,k),d=h+m,ib.doMerge(a,b,c,h,d,l,m),ib.doMerge(a,b,d,k,e,f-l,g-m)))};ib.rotate=function(a,b,c,d,e){if(!(c==d||d==e))for(b=ib.gcd(e-c,d-c);0!=b--;){for(var f=a[c+b],g=d-c,h=c+b,k=c+b+g;k!=c+b;)a[h]=a[k],h=k,k=e-k>g?k+g:c+(g-(e-k));a[h]=f}};ib.gcd=function(a,b){for(;0!=b;){var c=a%b;a=b;b=c}return a};ib.upper=
function(a,b,c,d,e){d-=c;for(var f,g;0<d;)f=d>>1,g=c+f,0>b(a[e],a[g])?d=f:(c=g+1,d=d-f-1);return c};ib.lower=function(a,b,c,d,e){d-=c;for(var f,g;0<d;)f=d>>1,g=c+f,0>b(a[g],a[e])?(c=g+1,d=d-f-1):d=f;return c};ib.swap=function(a,b,c){var d=a[b];a[b]=a[c];a[c]=d};var Xg=function(){};r["haxe.ds.BalancedTree"]=Xg;Xg.__name__="haxe.ds.BalancedTree";Xg.__interfaces__=[Xc];Xg.prototype={set:function(a,b){this.root=this.setLoop(a,b,this.root)},get:function(a){for(var b=this.root;null!=b;){var c=this.compare(a,
b.key);if(0==c)return b.value;b=0>c?b.left:b.right}return null},iterator:function(){var a=[];this.iteratorLoop(this.root,a);return v.iter(a)},setLoop:function(a,b,c){if(null==c)return new Ub(null,a,b,null);var d=this.compare(a,c.key);if(0==d)return new Ub(c.left,a,b,c.right,null==c?0:c._height);if(0>d)return a=this.setLoop(a,b,c.left),this.balance(a,c.key,c.value,c.right);a=this.setLoop(a,b,c.right);return this.balance(c.left,c.key,c.value,a)},iteratorLoop:function(a,b){null!=a&&(this.iteratorLoop(a.left,
b),b.push(a.value),this.iteratorLoop(a.right,b))},balance:function(a,b,c,d){var e=null==a?0:a._height,f=null==d?0:d._height;return e>f+2?(e=a.left,f=a.right,(null==e?0:e._height)>=(null==f?0:f._height)?new Ub(a.left,a.key,a.value,new Ub(a.right,b,c,d)):new Ub(new Ub(a.left,a.key,a.value,a.right.left),a.right.key,a.right.value,new Ub(a.right.right,b,c,d))):f>e+2?(e=d.right,f=d.left,(null==e?0:e._height)>(null==f?0:f._height)?new Ub(new Ub(a,b,c,d.left),d.key,d.value,d.right):new Ub(new Ub(a,b,c,d.left.left),
d.left.key,d.left.value,new Ub(d.left.right,d.key,d.value,d.right))):new Ub(a,b,c,d,(e>f?e:f)+1)},compare:function(a,b){return ua.compare(a,b)},__class__:Xg};var Ub=function(a,b,c,d,e){null==e&&(e=-1);this.left=a;this.key=b;this.value=c;this.right=d;-1==e?(a=this.left,b=this.right,a=(null==a?0:a._height)>(null==b?0:b._height)?this.left:this.right,a=null==a?0:a._height,this._height=a+1):this._height=e};r["haxe.ds.TreeNode"]=Ub;Ub.__name__="haxe.ds.TreeNode";Ub.prototype={__class__:Ub};var af=function(){};
r["haxe.ds.EnumValueMap"]=af;af.__name__="haxe.ds.EnumValueMap";af.__interfaces__=[Xc];af.__super__=Xg;af.prototype=J(Xg.prototype,{compare:function(a,b){var c=a._hx_index-b._hx_index;if(0!=c)return c;var c=Fa.enumParameters(a),d=Fa.enumParameters(b);return 0==c.length&&0==d.length?0:this.compareArgs(c,d)},compareArgs:function(a,b){var c=a.length-b.length;if(0!=c)return c;for(var c=0,d=a.length;c<d;){var e=c++,e=this.compareArg(a[e],b[e]);if(0!=e)return e}return 0},compareArg:function(a,b){return ua.isEnumValue(a)&&
ua.isEnumValue(b)?this.compare(a,b):a instanceof Array&&b instanceof Array?this.compareArgs(a,b):ua.compare(a,b)},__class__:af});var na=function(){this.h={}};r["haxe.ds.IntMap"]=na;na.__name__="haxe.ds.IntMap";na.__interfaces__=[Xc];na.prototype={get:function(a){return this.h[a]},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)?a.push(b|0):null;return v.iter(a)},iterator:function(){return{ref:this.h,
it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref[a]}}},__class__:na};var Nc=function(){this.length=0};r["haxe.ds.List"]=Nc;Nc.__name__="haxe.ds.List";Nc.prototype={add:function(a){a=new ki(a,null);null==this.h?this.h=a:this.q.next=a;this.q=a;this.length++},push:function(a){this.h=a=new ki(a,this.h);null==this.q&&(this.q=a);this.length++},remove:function(a){for(var b=null,c=this.h;null!=c;){if(c.item==a)return null==b?this.h=c.next:b.next=
c.next,this.q==c&&(this.q=b),this.length--,!0;b=c;c=c.next}return!1},__class__:Nc};var ki=function(a,b){this.item=a;this.next=b};r["haxe.ds._List.ListNode"]=ki;ki.__name__="haxe.ds._List.ListNode";ki.prototype={__class__:ki};var zb=function(){this.h={__keys__:{}}};r["haxe.ds.ObjectMap"]=zb;zb.__name__="haxe.ds.ObjectMap";zb.__interfaces__=[Xc];zb.prototype={set:function(a,b){var c=a.__id__;null==c&&(c=a.__id__=kh.$haxeUID++);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[a.__id__]},
remove:function(a){a=a.__id__;if(null==this.h.__keys__[a])return!1;delete this.h[a];delete this.h.__keys__[a];return!0},keys:function(){var a=[],b;for(b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return v.iter(a)},__class__:zb};var pd=K["haxe.ds.Option"]={__ename__:!0,__constructs__:["Some","None"],Some:(s=function(a){return{_hx_index:0,v:a,__enum__:"haxe.ds.Option",toString:m}},s.__params__=["v"],s),None:{_hx_index:1,__enum__:"haxe.ds.Option",toString:m}};pd.__empty_constructs__=
[pd.None];var Gj=function(a,b){this.map=a;this.keys=b;this.index=0;this.count=b.length};r["haxe.ds._StringMap.StringMapIterator"]=Gj;Gj.__name__="haxe.ds._StringMap.StringMapIterator";Gj.prototype={hasNext:function(){return this.index<this.count},next:function(){var a=this.map,b=this.keys[this.index++];return null!=Q[b]?a.getReserved(b):a.h[b]},__class__:Gj};var ga=function(){this.h={}};r["haxe.ds.StringMap"]=ga;ga.__name__="haxe.ds.StringMap";ga.__interfaces__=[Xc];ga.prototype={get:function(a){return null!=
Q[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},existsReserved:function(a){return null==this.rh?!1:this.rh.hasOwnProperty("$"+a)},remove:function(a){if(null!=Q[a]){a="$"+a;if(null==this.rh||!this.rh.hasOwnProperty(a))return!1;delete this.rh[a]}else{if(!this.h.hasOwnProperty(a))return!1;delete this.h[a]}return!0},keys:function(){return v.iter(this.arrayKeys())},arrayKeys:function(){var a=
[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},copy:function(){for(var a=new ga,b=this.keys();b.hasNext();){var c=b.next(),d=null!=Q[c]?this.getReserved(c):this.h[c];null!=Q[c]?a.setReserved(c,d):a.h[c]=d}return a},__class__:ga};var Dk={};r["haxe.ds._Vector.Vector_Impl_"]=Dk;Dk.__name__="haxe.ds._Vector.Vector_Impl_";Dk.blit=function(a,b,c,d,e){if(a==c)if(b<d){b+=e;d+=e;for(c=0;c<e;)c++,--b,--d,a[d]=a[b]}else{if(b>
d)for(c=0;c<e;)c++,a[d]=a[b],++b,++d}else for(var f=0;f<e;){var g=f++;c[d+g]=a[b+g]}};var ie=function(){this.size=this.pos=0};r["haxe.io.BytesBuffer"]=ie;ie.__name__="haxe.io.BytesBuffer";ie.prototype={addByte:function(a){this.pos==this.size&&this.grow(1);this.view.setUint8(this.pos++,a)},add:function(a){this.pos+a.length>this.size&&this.grow(a.length);if(0!=this.size){var b=new Uint8Array(a.b.buffer,a.b.byteOffset,a.length);this.u8.set(b,this.pos);this.pos+=a.length}},addInt32:function(a){this.pos+
4>this.size&&this.grow(4);this.view.setInt32(this.pos,a,!0);this.pos+=4},addFloat:function(a){this.pos+4>this.size&&this.grow(4);this.view.setFloat32(this.pos,a,!0);this.pos+=4},addDouble:function(a){this.pos+8>this.size&&this.grow(8);this.view.setFloat64(this.pos,a,!0);this.pos+=8},addBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw new q(Hc.OutsideBounds);this.pos+c>this.size&&this.grow(c);0!=this.size&&(a=new Uint8Array(a.b.buffer,a.b.byteOffset+b,c),this.u8.set(a,this.pos),this.pos+=c)},
grow:function(a){var b=this.pos+a;for(a=0==this.size?16:this.size;a<b;)a=3*a>>1;var b=new ArrayBuffer(a),c=new Uint8Array(b);0<this.size&&c.set(this.u8);this.size=a;this.buffer=b;this.u8=c;this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new N(new ArrayBuffer(0));var a=new N(this.buffer);a.length=this.pos;return a},__class__:ie};var ig=function(){};r["haxe.io.Input"]=ig;ig.__name__="haxe.io.Input";ig.prototype={readByte:function(){throw new q("Not implemented");},readBytes:function(a,
b,c){var d=c,e=a.b;if(0>b||0>c||b+c>a.length)throw new q(Hc.OutsideBounds);try{for(;0<d;)e[b]=this.readByte(),++b,--d}catch(f){if($.lastException=f,!((f instanceof q?f.val:f)instanceof qd))throw f;}return c-d},set_bigEndian:function(a){return this.bigEndian=a},readFullBytes:function(a,b,c){for(;0<c;){var d=this.readBytes(a,b,c);if(0==d)throw new q(Hc.Blocked);b+=d;c-=d}},read:function(a){for(var b=new N(new ArrayBuffer(a)),c=0;0<a;){var d=this.readBytes(b,c,a);if(0==d)throw new q(Hc.Blocked);c+=d;
a-=d}return b},readUntil:function(a){for(var b=new ie,c;;){c=this.readByte();if(c==a)break;b.addByte(c)}return b.getBytes().toString()},readFloat:function(){return mc.i32ToFloat(this.readInt32())},readDouble:function(){var a=this.readInt32(),b=this.readInt32();return this.bigEndian?mc.i64ToDouble(b,a):mc.i64ToDouble(a,b)},readInt16:function(){var a=this.readByte(),b=this.readByte(),a=this.bigEndian?b|a<<8:a|b<<8;return 0!=(a&32768)?a-65536:a},readUInt16:function(){var a=this.readByte(),b=this.readByte();
return this.bigEndian?b|a<<8:a|b<<8},readUInt24:function(){var a=this.readByte(),b=this.readByte(),c=this.readByte();return this.bigEndian?c|b<<8|a<<16:a|b<<8|c<<16},readInt32:function(){var a=this.readByte(),b=this.readByte(),c=this.readByte(),d=this.readByte();return this.bigEndian?d|c<<8|b<<16|a<<24:a|b<<8|c<<16|d<<24},readString:function(a,b){var c=new N(new ArrayBuffer(a));this.readFullBytes(c,0,a);return c.getString(0,a,b)},__class__:ig};var Vb=function(a,b,c){null==b&&(b=0);null==c&&(c=a.length-
b);if(0>b||0>c||b+c>a.length)throw new q(Hc.OutsideBounds);this.b=a.b;this.pos=b;this.totlen=this.len=c};r["haxe.io.BytesInput"]=Vb;Vb.__name__="haxe.io.BytesInput";Vb.__super__=ig;Vb.prototype=J(ig.prototype,{set_position:function(a){0>a?a=0:a>this.totlen&&(a=this.totlen);this.len=this.totlen-a;return this.pos=a},readByte:function(){if(0==this.len)throw new q(new qd);this.len--;return this.b[this.pos++]},readBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw new q(Hc.OutsideBounds);if(0==this.len&&
0<c)throw new q(new qd);this.len<c&&(c=this.len);var d=this.b;a=a.b;for(var e=0,f=c;e<f;){var g=e++;a[b+g]=d[this.pos+g]}this.pos+=c;this.len-=c;return c},__class__:Vb});var li=function(){};r["haxe.io.Output"]=li;li.__name__="haxe.io.Output";li.prototype={writeByte:function(a){throw new q("Not implemented");},writeBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw new q(Hc.OutsideBounds);a=a.b;for(var d=c;0<d;)this.writeByte(a[b]),++b,--d;return c},flush:function(){},close:function(){},set_bigEndian:function(a){return this.bigEndian=
a},write:function(a){for(var b=a.length,c=0;0<b;){var d=this.writeBytes(a,c,b);if(0==d)throw new q(Hc.Blocked);c+=d;b-=d}},writeFullBytes:function(a,b,c){for(;0<c;){var d=this.writeBytes(a,b,c);b+=d;c-=d}},writeInt32:function(a){this.bigEndian?(this.writeByte(a>>>24),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(a&255)):(this.writeByte(a&255),this.writeByte(a>>8&255),this.writeByte(a>>16&255),this.writeByte(a>>>24))},writeString:function(a,b){var c=N.ofString(a,b);this.writeFullBytes(c,
0,c.length)},__class__:li};var pc=function(){this.b=new ie};r["haxe.io.BytesOutput"]=pc;pc.__name__="haxe.io.BytesOutput";pc.__super__=li;pc.prototype=J(li.prototype,{writeByte:function(a){this.b.addByte(a)},writeBytes:function(a,b,c){this.b.addBytes(a,b,c);return c},getBytes:function(){return this.b.getBytes()},__class__:pc});var qd=function(){};r["haxe.io.Eof"]=qd;qd.__name__="haxe.io.Eof";qd.prototype={toString:function(){return"Eof"},__class__:qd};var Hc=K["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked",
"Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:m},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:m},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:m},Custom:(s=function(a){return{_hx_index:3,e:a,__enum__:"haxe.io.Error",toString:m}},s.__params__=["e"],s)};Hc.__empty_constructs__=[Hc.Blocked,Hc.Overflow,Hc.OutsideBounds];var mc=function(){};r["haxe.io.FPHelper"]=mc;mc.__name__="haxe.io.FPHelper";mc.i32ToFloat=function(a){mc.helper.setInt32(0,
a,!0);return mc.helper.getFloat32(0,!0)};mc.i64ToDouble=function(a,b){mc.helper.setInt32(0,a,!0);mc.helper.setInt32(4,b,!0);return mc.helper.getFloat64(0,!0)};var ta=function(a){switch(a){case ".":case "..":this.dir=a;this.file="";return}var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this.dir=v.substr(a,0,c),a=v.substr(a,c+1,null),this.backslash=!0):c<b?(this.dir=v.substr(a,0,b),a=v.substr(a,b+1,null)):this.dir=null;b=a.lastIndexOf(".");-1!=b?(this.ext=v.substr(a,b+1,null),this.file=v.substr(a,
0,b)):(this.ext=null,this.file=a)};r["haxe.io.Path"]=ta;ta.__name__="haxe.io.Path";ta.directory=function(a){a=new ta(a);return null==a.dir?"":a.dir};ta.extension=function(a){a=new ta(a);return null==a.ext?"":a.ext};ta.withExtension=function(a,b){var c=new ta(a);c.ext=b;return c.toString()};ta.join=function(a){for(var b=[],c=0;c<a.length;){var d=a[c];++c;null!=d&&""!=d&&b.push(d)}if(0==b.length)return"";a=b[0];c=1;for(d=b.length;c<d;){var e=c++;a=ta.addTrailingSlash(a);a+=b[e]}return ta.normalize(a)};
ta.normalize=function(a){a=a.split("\\").join("/");if("/"==a)return"/";for(var b=[],c=0,d=a.split("/");c<d.length;){var e=d[c];++c;".."==e&&0<b.length&&".."!=b[b.length-1]?b.pop():""==e?(0<b.length||47==v.cca(a,0))&&b.push(e):"."!=e&&b.push(e)}a="";d=c=!1;e=0;for(b=b.join("/");e<b.length;){var f=b,g=e++,h=f.charCodeAt(g);55296<=h&&56319>=h&&(h=h-55232<<10|f.charCodeAt(g+1)&1023);f=h;65536<=f&&++e;switch(f){case 47:c?(c=!1,d&&(a+="/",d=!1),a+=String.fromCodePoint(f)):d=!0;break;case 58:a+=":";c=!0;
break;default:c=!1,d&&(a+="/",d=!1),a+=String.fromCodePoint(f)}}return a};ta.addTrailingSlash=function(a){if(0==a.length)return"/";var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");return b<c?c!=a.length-1?a+"\\":a:b!=a.length-1?a+"/":a};ta.prototype={toString:function(){return(null==this.dir?"":this.dir+(this.backslash?"\\":"/"))+this.file+(null==this.ext?"":"."+this.ext)},__class__:ta};var ma=K["haxe.macro.Binop"]={__ename__:!0,__constructs__:"OpAdd OpMult OpDiv OpSub OpAssign OpEq OpNotEq OpGt OpGte OpLt OpLte OpAnd OpOr OpXor OpBoolAnd OpBoolOr OpShl OpShr OpUShr OpMod OpAssignOp OpInterval OpArrow OpIn".split(" "),
OpAdd:{_hx_index:0,__enum__:"haxe.macro.Binop",toString:m},OpMult:{_hx_index:1,__enum__:"haxe.macro.Binop",toString:m},OpDiv:{_hx_index:2,__enum__:"haxe.macro.Binop",toString:m},OpSub:{_hx_index:3,__enum__:"haxe.macro.Binop",toString:m},OpAssign:{_hx_index:4,__enum__:"haxe.macro.Binop",toString:m},OpEq:{_hx_index:5,__enum__:"haxe.macro.Binop",toString:m},OpNotEq:{_hx_index:6,__enum__:"haxe.macro.Binop",toString:m},OpGt:{_hx_index:7,__enum__:"haxe.macro.Binop",toString:m},OpGte:{_hx_index:8,__enum__:"haxe.macro.Binop",
toString:m},OpLt:{_hx_index:9,__enum__:"haxe.macro.Binop",toString:m},OpLte:{_hx_index:10,__enum__:"haxe.macro.Binop",toString:m},OpAnd:{_hx_index:11,__enum__:"haxe.macro.Binop",toString:m},OpOr:{_hx_index:12,__enum__:"haxe.macro.Binop",toString:m},OpXor:{_hx_index:13,__enum__:"haxe.macro.Binop",toString:m},OpBoolAnd:{_hx_index:14,__enum__:"haxe.macro.Binop",toString:m},OpBoolOr:{_hx_index:15,__enum__:"haxe.macro.Binop",toString:m},OpShl:{_hx_index:16,__enum__:"haxe.macro.Binop",toString:m},OpShr:{_hx_index:17,
__enum__:"haxe.macro.Binop",toString:m},OpUShr:{_hx_index:18,__enum__:"haxe.macro.Binop",toString:m},OpMod:{_hx_index:19,__enum__:"haxe.macro.Binop",toString:m},OpAssignOp:(s=function(a){return{_hx_index:20,op:a,__enum__:"haxe.macro.Binop",toString:m}},s.__params__=["op"],s),OpInterval:{_hx_index:21,__enum__:"haxe.macro.Binop",toString:m},OpArrow:{_hx_index:22,__enum__:"haxe.macro.Binop",toString:m},OpIn:{_hx_index:23,__enum__:"haxe.macro.Binop",toString:m}};ma.__empty_constructs__=[ma.OpAdd,ma.OpMult,
ma.OpDiv,ma.OpSub,ma.OpAssign,ma.OpEq,ma.OpNotEq,ma.OpGt,ma.OpGte,ma.OpLt,ma.OpLte,ma.OpAnd,ma.OpOr,ma.OpXor,ma.OpBoolAnd,ma.OpBoolOr,ma.OpShl,ma.OpShr,ma.OpUShr,ma.OpMod,ma.OpInterval,ma.OpArrow,ma.OpIn];var Yg=K["haxe.macro.Unop"]={__ename__:!0,__constructs__:["OpIncrement","OpDecrement","OpNot","OpNeg","OpNegBits"],OpIncrement:{_hx_index:0,__enum__:"haxe.macro.Unop",toString:m},OpDecrement:{_hx_index:1,__enum__:"haxe.macro.Unop",toString:m},OpNot:{_hx_index:2,__enum__:"haxe.macro.Unop",toString:m},
OpNeg:{_hx_index:3,__enum__:"haxe.macro.Unop",toString:m},OpNegBits:{_hx_index:4,__enum__:"haxe.macro.Unop",toString:m}};Yg.__empty_constructs__=[Yg.OpIncrement,Yg.OpDecrement,Yg.OpNot,Yg.OpNeg,Yg.OpNegBits];var wc={};r["haxe.xml._Access.NodeAccess_Impl_"]=wc;wc.__name__="haxe.xml._Access.NodeAccess_Impl_";wc.resolve=function(a,b){var c=a.elementsNamed(b).next();if(null==c){if(a.nodeType==I.Document)c="Document";else{if(a.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+
ka.toString(a.nodeType));c=a.nodeName}throw new q(c+" is missing element "+b);}if(c.nodeType!=I.Document&&c.nodeType!=I.Element)throw new q("Invalid nodeType "+ka.toString(c.nodeType));return c};var Ya={};r["haxe.xml._Access.AttribAccess_Impl_"]=Ya;Ya.__name__="haxe.xml._Access.AttribAccess_Impl_";Ya.resolve=function(a,b){if(a.nodeType==I.Document)throw new q("Cannot access document attribute "+b);var c=a.get(b);if(null==c){if(a.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+
ka.toString(a.nodeType));throw new q(a.nodeName+" is missing attribute "+b);}return c};var Ik={};r["haxe.xml._Access.HasNodeAccess_Impl_"]=Ik;Ik.__name__="haxe.xml._Access.HasNodeAccess_Impl_";Ik.resolve=function(a,b){return a.elementsNamed(b).hasNext()};var Eb=function(a,b,c){this.xml=b;this.message=a;this.position=c;this.lineNumber=1;for(a=this.positionAtLine=0;a<c;){var d=a++,d=b.charCodeAt(d);10==d?(this.lineNumber++,this.positionAtLine=0):13!=d&&this.positionAtLine++}};r["haxe.xml.XmlParserException"]=
Eb;Eb.__name__="haxe.xml.XmlParserException";Eb.prototype={toString:function(){return ia.getClass(this).__name__+": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine},__class__:Eb};var Ad=function(){};r["haxe.xml.Parser"]=Ad;Ad.__name__="haxe.xml.Parser";Ad.parse=function(a,b){null==b&&(b=!1);var c=I.createDocument();Ad.doParse(a,b,0,c);return c};Ad.doParse=function(a,b,c,d){null==c&&(c=0);for(var e=null,f=1,g=1,h=null,k=0,l=0,m=0,t=a.charCodeAt(c),p=new Ib,r=1,s=-1;t==t;){switch(f){case 0:switch(t){case 9:case 10:case 13:case 32:break;
default:f=g;continue}break;case 1:if(60==t)f=0,g=2;else{k=c;f=13;continue}break;case 2:switch(t){case 33:if(91==a.charCodeAt(c+1)){c+=2;if("CDATA["!=v.substr(a,c,6).toUpperCase())throw new q(new Eb("Expected <![CDATA[",a,c));c+=5;f=17}else if(68==a.charCodeAt(c+1)||100==a.charCodeAt(c+1)){if("OCTYPE"!=v.substr(a,c+2,6).toUpperCase())throw new q(new Eb("Expected <!DOCTYPE",a,c));c+=8;f=16}else{if(45!=a.charCodeAt(c+1)||45!=a.charCodeAt(c+2))throw new q(new Eb("Expected \x3c!--",a,c));c+=2;f=15}k=c+
1;break;case 47:if(null==d)throw new q(new Eb("Expected node name",a,c));k=c+1;f=0;g=10;break;case 63:f=14;k=c;break;default:f=3;k=c;continue}break;case 3:if(!(97<=t&&122>=t||65<=t&&90>=t||48<=t&&57>=t||58==t||46==t||95==t||45==t)){if(c==k)throw new q(new Eb("Expected node name",a,c));e=I.createElement(v.substr(a,k,c-k));d.addChild(e);++l;f=0;g=4;continue}break;case 4:switch(t){case 47:f=11;break;case 62:f=9;break;default:f=5;k=c;continue}break;case 5:if(!(97<=t&&122>=t||65<=t&&90>=t||48<=t&&57>=
t||58==t||46==t||95==t||45==t)){if(k==c)throw new q(new Eb("Expected attribute name",a,c));h=v.substr(a,k,c-k);if(e.exists(h))throw new q(new Eb("Duplicate attribute ["+h+"]",a,c));f=0;g=6;continue}break;case 6:if(61==t)f=0,g=7;else throw new q(new Eb("Expected =",a,c));break;case 7:switch(t){case 34:case 39:p=new Ib;f=8;k=c+1;s=t;break;default:throw new q(new Eb('Expected "',a,c));}break;case 8:switch(t){case 38:r=c-k;p.b+=null==r?v.substr(a,k,null):v.substr(a,k,r);f=18;r=8;k=c+1;break;case 60:case 62:if(b)throw new q(new Eb("Invalid unescaped "+
String.fromCodePoint(t)+" in attribute value",a,c));t==s&&(g=c-k,p.b+=null==g?v.substr(a,k,null):v.substr(a,k,g),g=p.b,p=new Ib,e.set(h,g),f=0,g=4);break;default:t==s&&(g=c-k,p.b+=null==g?v.substr(a,k,null):v.substr(a,k,g),g=p.b,p=new Ib,e.set(h,g),f=0,g=4)}break;case 9:k=c=Ad.doParse(a,b,c,e);f=1;break;case 10:if(!(97<=t&&122>=t||65<=t&&90>=t||48<=t&&57>=t||58==t||46==t||95==t||45==t)){if(k==c)throw new q(new Eb("Expected node name",a,c));g=v.substr(a,k,c-k);if(null==d||0!=d.nodeType)throw new q(new Eb("Unexpected </"+
g+">, tag is not open",a,c));if(d.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(d.nodeType));if(g!=d.nodeName){if(d.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(d.nodeType));throw new q(new Eb("Expected </"+d.nodeName+">",a,c));}f=0;g=12;continue}break;case 11:if(62==t)f=1;else throw new q(new Eb("Expected >",a,c));break;case 12:if(62==t)return 0==l&&d.addChild(I.createPCData("")),c;throw new q(new Eb("Expected >",
a,c));case 13:60==t?(g=c-k,p.b+=null==g?v.substr(a,k,null):v.substr(a,k,g),g=I.createPCData(p.b),p=new Ib,d.addChild(g),++l,f=0,g=2):38==t&&(r=c-k,p.b+=null==r?v.substr(a,k,null):v.substr(a,k,r),f=18,r=13,k=c+1);break;case 14:63==t&&62==a.charCodeAt(c+1)&&(++c,t=v.substr(a,k+1,c-k-2),d.addChild(I.createProcessingInstruction(t)),++l,f=1);break;case 15:45==t&&(45==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2))&&(d.addChild(I.createComment(v.substr(a,k,c-k))),++l,c+=2,f=1);break;case 16:91==t?++m:93==t?--m:
62==t&&0==m&&(d.addChild(I.createDocType(v.substr(a,k,c-k))),++l,f=1);break;case 17:93==t&&(93==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2))&&(t=I.createCData(v.substr(a,k,c-k)),d.addChild(t),++l,c+=2,f=1);break;case 18:if(59==t){k=v.substr(a,k,c-k);if(35==k.charCodeAt(0))k=120==k.charCodeAt(1)?n.parseInt("0"+v.substr(k,1,k.length-1)):n.parseInt(v.substr(k,1,k.length-1)),p.b+=String.fromCodePoint(k);else if(t=Ad.escapes,null!=Q[k]?t.existsReserved(k):t.h.hasOwnProperty(k))t=Ad.escapes,k=null!=Q[k]?t.getReserved(k):
t.h[k],p.b+=n.string(k);else{if(b)throw new q(new Eb("Undefined entity: "+k,a,c));p.b+=n.string("&"+k+";")}k=c+1;f=r}else if(!(97<=t&&122>=t||65<=t&&90>=t||48<=t&&57>=t||58==t||46==t||95==t||45==t)&&35!=t){if(b)throw new q(new Eb("Invalid character in entity: "+String.fromCodePoint(t),a,c));p.b+=String.fromCodePoint(38);t=c-k;p.b+=null==t?v.substr(a,k,null):v.substr(a,k,t);--c;k=c+1;f=r}}t=a.charCodeAt(++c)}1==f&&(k=c,f=13);if(13==f){if(0==d.nodeType){if(d.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+
ka.toString(d.nodeType));throw new q(new Eb("Unclosed node <"+d.nodeName+">",a,c));}if(c!=k||0==l)b=c-k,p.b+=null==b?v.substr(a,k,null):v.substr(a,k,b),d.addChild(I.createPCData(p.b));return c}if(!b&&18==f&&13==r)return p.b+=String.fromCodePoint(38),b=c-k,p.b+=null==b?v.substr(a,k,null):v.substr(a,k,b),d.addChild(I.createPCData(p.b)),c;throw new q(new Eb("Unexpected end",a,c));};var og=function(a){this.output=new Ib;this.pretty=a};r["haxe.xml.Printer"]=og;og.__name__="haxe.xml.Printer";og.print=function(a,
b){null==b&&(b=!1);var c=new og(b);c.writeNode(a,"");return c.output.b};og.prototype={writeNode:function(a,b){switch(a.nodeType){case 0:this.output.b+=n.string(b+"<");if(a.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(a.nodeType));this.output.b+=n.string(a.nodeName);for(var c=a.attributes();c.hasNext();){var d=c.next();this.output.b+=n.string(" "+d+'="');d=Qa.htmlEscape(a.get(d),!0);this.output.b+=n.string(d);this.output.b+='"'}if(this.hasChildren(a)){this.output.b+=
">";this.pretty&&(this.output.b+="\n");if(a.nodeType!=I.Document&&a.nodeType!=I.Element)throw new q("Bad node type, expected Element or Document but found "+ka.toString(a.nodeType));for(c=v.iter(a.children);c.hasNext();)d=c.next(),this.writeNode(d,this.pretty?b+"\t":b);this.output.b+=n.string(b+"</");if(a.nodeType!=I.Element)throw new q("Bad node type, expected Element but found "+ka.toString(a.nodeType));this.output.b+=n.string(a.nodeName);this.output.b+=">"}else this.output.b+="/>";this.pretty&&
(this.output.b+="\n");break;case 1:if(a.nodeType==I.Document||a.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(a.nodeType));c=a.nodeValue;0!=c.length&&(c=b+Qa.htmlEscape(c),this.output.b+=n.string(c),this.pretty&&(this.output.b+="\n"));break;case 2:this.output.b+=n.string(b+"<![CDATA[");if(a.nodeType==I.Document||a.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(a.nodeType));this.output.b+=n.string(a.nodeValue);this.output.b+="]]\x3e";this.pretty&&
(this.output.b+="\n");break;case 3:if(a.nodeType==I.Document||a.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(a.nodeType));c=a.nodeValue;c=c.replace(/[\n\r\t]+/g,"");this.output.b+=null==b?"null":""+b;c=Qa.trim("\x3c!--"+c+"--\x3e");this.output.b+=n.string(c);this.pretty&&(this.output.b+="\n");break;case 4:if(a.nodeType==I.Document||a.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(a.nodeType));this.output.b+=n.string("<!DOCTYPE "+a.nodeValue+">");
this.pretty&&(this.output.b+="\n");break;case 5:if(a.nodeType==I.Document||a.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(a.nodeType));this.output.b+=n.string("<?"+a.nodeValue+"?>");this.pretty&&(this.output.b+="\n");break;case 6:if(a.nodeType!=I.Document&&a.nodeType!=I.Element)throw new q("Bad node type, expected Element or Document but found "+ka.toString(a.nodeType));for(c=v.iter(a.children);c.hasNext();)d=c.next(),this.writeNode(d,b)}},hasChildren:function(a){if(a.nodeType!=
I.Document&&a.nodeType!=I.Element)throw new q("Bad node type, expected Element or Document but found "+ka.toString(a.nodeType));for(a=v.iter(a.children);a.hasNext();){var b=a.next();switch(b.nodeType){case 0:case 1:return!0;case 2:case 3:if(b.nodeType==I.Document||b.nodeType==I.Element)throw new q("Bad node type, unexpected "+ka.toString(b.nodeType));if(0!=Qa.ltrim(b.nodeValue).length)return!0}}return!1},__class__:og};var gj=function(){};r["haxe.zip.Compress"]=gj;gj.__name__="haxe.zip.Compress";gj.run=
function(a,b){throw new q("Not implemented for this platform");};var Yc=K["haxe.zip.Huffman"]={__ename__:!0,__constructs__:["Found","NeedBit","NeedBits"],Found:(s=function(a){return{_hx_index:0,i:a,__enum__:"haxe.zip.Huffman",toString:m}},s.__params__=["i"],s),NeedBit:(s=function(a,b){return{_hx_index:1,left:a,right:b,__enum__:"haxe.zip.Huffman",toString:m}},s.__params__=["left","right"],s),NeedBits:(s=function(a,b){return{_hx_index:2,n:a,table:b,__enum__:"haxe.zip.Huffman",toString:m}},s.__params__=
["n","table"],s)};Yc.__empty_constructs__=[];var Hj=function(){};r["haxe.zip.HuffTools"]=Hj;Hj.__name__="haxe.zip.HuffTools";Hj.prototype={treeDepth:function(a){switch(a._hx_index){case 0:return 0;case 1:var b=a.right;a=this.treeDepth(a.left);b=this.treeDepth(b);return 1+(a<b?a:b);case 2:throw new q("assert");}},treeCompress:function(a){var b=this.treeDepth(a);if(0==b)return a;if(1==b){if(1==a._hx_index)return b=a.right,Yc.NeedBit(this.treeCompress(a.left),this.treeCompress(b));throw new q("assert");
}for(var c=[],d=0,e=1<<b;d<e;)d++,c.push(Yc.Found(-1));this.treeWalk(c,0,0,b,a);return Yc.NeedBits(b,c)},treeWalk:function(a,b,c,d,e){if(1==e._hx_index){var f=e.right,g=e.left;0<d?(this.treeWalk(a,b,c+1,d-1,g),this.treeWalk(a,b|1<<c,c+1,d-1,f)):a[b]=this.treeCompress(e)}else a[b]=this.treeCompress(e)},treeMake:function(a,b,c,d){if(d>b)throw new q("Invalid huffman");var e=c<<5|d;if(a.h.hasOwnProperty(e))return Yc.Found(a.h[e]);c<<=1;++d;return Yc.NeedBit(this.treeMake(a,b,c,d),this.treeMake(a,b,c|
1,d))},make:function(a,b,c,d){if(1==c)return Yc.NeedBit(Yc.Found(0),Yc.Found(0));var e=[],f=[];if(32<d)throw new q("Invalid huffman");for(var g=0;g<d;)g++,e.push(0),f.push(0);for(g=0;g<c;){var h=g++,h=a[h+b];if(h>=d)throw new q("Invalid huffman");e[h]++}for(var g=0,h=1,k=d-1;h<k;){var l=h++,g=g+e[l]<<1;f[l]=g}e=new na;for(g=0;g<c;)h=g++,k=a[h+b],0!=k&&(l=f[k-1],f[k-1]=l+1,e.h[l<<5|k]=h);return this.treeCompress(Yc.NeedBit(this.treeMake(e,d,0,1),this.treeMake(e,d,1,1)))},__class__:Hj};var Ij=function(a){this.buffer=
new N(new ArrayBuffer(65536));this.pos=0;a&&(this.crc=new hg)};r["haxe.zip._InflateImpl.Window"]=Ij;Ij.__name__="haxe.zip._InflateImpl.Window";Ij.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,0,32768);var a=new N(new ArrayBuffer(65536));this.pos-=32768;a.blit(0,this.buffer,32768,this.pos);this.buffer=a},addBytes:function(a,b,c){65536<this.pos+c&&this.slide();this.buffer.blit(this.pos,a,b,c);this.pos+=c},addByte:function(a){65536==this.pos&&this.slide();this.buffer.b[this.pos]=
a;this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){null!=this.crc&&this.crc.update(this.buffer,0,this.pos);return this.crc},__class__:Ij};var Na=K["haxe.zip._InflateImpl.State"]={__ename__:!0,__constructs__:"Head Block CData Flat Crc Dist DistOne Done".split(" "),Head:{_hx_index:0,__enum__:"haxe.zip._InflateImpl.State",toString:m},Block:{_hx_index:1,__enum__:"haxe.zip._InflateImpl.State",toString:m},CData:{_hx_index:2,__enum__:"haxe.zip._InflateImpl.State",
toString:m},Flat:{_hx_index:3,__enum__:"haxe.zip._InflateImpl.State",toString:m},Crc:{_hx_index:4,__enum__:"haxe.zip._InflateImpl.State",toString:m},Dist:{_hx_index:5,__enum__:"haxe.zip._InflateImpl.State",toString:m},DistOne:{_hx_index:6,__enum__:"haxe.zip._InflateImpl.State",toString:m},Done:{_hx_index:7,__enum__:"haxe.zip._InflateImpl.State",toString:m}};Na.__empty_constructs__=[Na.Head,Na.Block,Na.CData,Na.Flat,Na.Crc,Na.Dist,Na.DistOne,Na.Done];var Bb=function(a,b,c){null==c&&(c=!0);null==b&&
(b=!0);this.isFinal=!1;this.htools=new Hj;this.huffman=this.buildFixedHuffman();this.huffdist=null;this.dist=this.len=0;this.state=b?Na.Head:Na.Block;this.input=a;this.needed=this.nbits=this.bits=0;this.output=null;this.outpos=0;this.lengths=[];this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);
this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.window=new Ij(c)};r["haxe.zip.InflateImpl"]=Bb;Bb.__name__="haxe.zip.InflateImpl";Bb.run=function(a,b){null==b&&(b=65536);for(var c=new N(new ArrayBuffer(b)),d=new ie,e=new Bb(a);;){var f=e.readBytes(c,0,b);d.addBytes(c,0,f);if(f<b)break}return d.getBytes()};Bb.prototype={buildFixedHuffman:function(){if(null!=Bb.FIXED_HUFFMAN)return Bb.FIXED_HUFFMAN;
for(var a=[],b=0;288>b;){var c=b++;a.push(143>=c?8:255>=c?9:279>=c?7:8)}Bb.FIXED_HUFFMAN=this.htools.make(a,0,288,10);return Bb.FIXED_HUFFMAN},readBytes:function(a,b,c){this.needed=c;this.outpos=b;this.output=a;if(0<c)for(;this.inflateLoop(););return c-this.needed},getBits:function(a){for(;this.nbits<a;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var b=this.bits&(1<<a)-1;this.nbits-=a;this.bits>>=a;return b},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());
var a=1==(this.bits&1);this.nbits--;this.bits>>=1;return a},getRevBits:function(a){return 0==a?0:this.getBit()?1<<a-1|this.getRevBits(a-1):this.getRevBits(a-1)},resetBits:function(){this.nbits=this.bits=0},addBytes:function(a,b,c){this.window.addBytes(a,b,c);this.output.blit(this.outpos,a,b,c);this.needed-=c;this.outpos+=c},addByte:function(a){this.window.addByte(a);this.output.b[this.outpos]=a;this.needed--;this.outpos++},addDistOne:function(a){for(var b=this.window.getLastChar(),c=0;c<a;)c++,this.addByte(b)},
addDist:function(a,b){this.addBytes(this.window.buffer,this.window.pos-a,b)},applyHuffman:function(a){switch(a._hx_index){case 0:return a.i;case 1:var b=a.right;a=a.left;return this.applyHuffman(this.getBit()?b:a);case 2:return this.applyHuffman(a.table[this.getBits(a.n)])}},inflateLengths:function(a,b){for(var c=0,d=0;c<b;){var e=this.applyHuffman(this.huffman);switch(e){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:d=e;a[c]=
e;++c;break;case 16:e=c+3+this.getBits(2);if(e>b)throw new q("Invalid data");for(;c<e;)a[c]=d,++c;break;case 17:c+=3+this.getBits(3);if(c>b)throw new q("Invalid data");break;case 18:c+=11+this.getBits(7);if(c>b)throw new q("Invalid data");break;default:throw new q("Invalid data");}}},inflateLoop:function(){switch(this.state._hx_index){case 0:var a=this.input.readByte();if(8!=(a&15))throw new q("Invalid data");var b=this.input.readByte(),c=0!=(b&32);if(0!=((a<<8)+b)%31)throw new q("Invalid data");
if(c)throw new q("Unsupported dictionary");this.state=Na.Block;return!0;case 1:switch(this.isFinal=this.getBit(),this.getBits(2)){case 0:this.len=this.input.readUInt16();if(this.input.readUInt16()!=65535-this.len)throw new q("Invalid data");this.state=Na.Flat;a=this.inflateLoop();this.resetBits();return a;case 1:return this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.state=Na.CData,!0;case 2:for(var a=this.getBits(5)+257,b=this.getBits(5)+1,c=this.getBits(4)+4,d=0;d<c;){var e=d++;this.lengths[Bb.CODE_LENGTHS_POS[e]]=
this.getBits(3)}for(;19>c;)d=c++,this.lengths[Bb.CODE_LENGTHS_POS[d]]=0;this.huffman=this.htools.make(this.lengths,0,19,8);c=[];d=0;for(e=a+b;d<e;)d++,c.push(0);this.inflateLengths(c,a+b);this.huffdist=this.htools.make(c,a,b,16);this.huffman=this.htools.make(c,0,a,16);this.state=Na.CData;return!0;default:throw new q("Invalid data");}case 2:b=this.applyHuffman(this.huffman);if(256>b)return this.addByte(b),0<this.needed;if(256==b)this.state=this.isFinal?Na.Crc:Na.Block;else{b-=257;a=Bb.LEN_EXTRA_BITS_TBL[b];
if(-1==a)throw new q("Invalid data");this.len=Bb.LEN_BASE_VAL_TBL[b]+this.getBits(a);b=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);a=Bb.DIST_EXTRA_BITS_TBL[b];if(-1==a)throw new q("Invalid data");this.dist=Bb.DIST_BASE_VAL_TBL[b]+this.getBits(a);if(this.dist>this.window.available())throw new q("Invalid data");this.state=1==this.dist?Na.DistOne:Na.Dist}return!0;case 3:return a=this.len<this.needed?this.len:this.needed,b=this.input.read(a),this.len-=a,this.addBytes(b,0,a),
0==this.len&&(this.state=this.isFinal?Na.Crc:Na.Block),0<this.needed;case 4:a=this.window.checksum();if(null==a)return this.state=Na.Done,!0;b=hg.read(this.input);if(!a.equals(b))throw new q("Invalid CRC");this.state=Na.Done;return!0;case 5:for(;0<this.len&&0<this.needed;)a=this.len<this.dist?this.len:this.dist,a=this.needed<a?this.needed:a,this.addDist(this.dist,a),this.len-=a;0==this.len&&(this.state=Na.CData);return 0<this.needed;case 6:return a=this.len<this.needed?this.len:this.needed,this.addDistOne(a),
this.len-=a,0==this.len&&(this.state=Na.CData),0<this.needed;case 7:return!1}},__class__:Bb};var hj=function(){};r["haxe.zip.Uncompress"]=hj;hj.__name__="haxe.zip.Uncompress";hj.run=function(a,b){return Bb.run(new Vb(a),b)};var ud=function(a,b){if(!(-101==a&&-102==b)){var c=window.document.createElement("canvas");c.width=a;c.height=b;this.ctx=c.getContext("2d",null)}};r["hxd.BitmapData"]=ud;ud.__name__="hxd.BitmapData";ud.notImplemented=function(){throw new q("Not implemented");};ud.fromNative=function(a){var b=
new ud(-101,-102);b.ctx=a;return b};ud.prototype={clear:function(a){this.fill(0,0,this.ctx.canvas.width,this.ctx.canvas.height,a)},fill:function(a,b,c,d,e){this.ctx.fillStyle="rgba("+(e>>16&255)+", "+(e>>8&255)+", "+(e&255)+", "+(e>>>24)/255+")";this.ctx.fillRect(a,b,c,d)},draw:function(a,b,c,d,e,f,g,h){throw new q("Not implemented");},drawScaled:function(a,b,c,d,e,f,g,h,k,l,m){throw new q("Not implemented");},line:function(a,b,c,d,e){var f,g=d-b;if(0==c-a){if(d<b){var h=b;b=d;d=h}0>b&&(b=0);d>this.ctx.canvas.height-
1&&(d=this.ctx.canvas.height-1);for(var h=b,k=d+1;h<k;){var l=h++;this.setPixel(a,l,e)}}else if(0==g){c<a&&(h=a,a=c,c=h);0>a&&(a=0);c>this.ctx.canvas.width-1&&(c=this.ctx.canvas.width-1);h=a;for(k=c+1;h<k;)l=h++,this.setPixel(l,b,e)}else{var m,t,p,n;if(a<c){if(a>=this.ctx.canvas.width||0>c)return;h=1;m=0;p=this.ctx.canvas.width-1}else{if(c>=this.ctx.canvas.width||0>a)return;h=-1;c=-c;a=-a;m=1-this.ctx.canvas.width;p=0}if(b<d){if(b>=this.ctx.canvas.height||0>d)return;k=1;t=0;n=this.ctx.canvas.height-
1}else{if(d>=this.ctx.canvas.width||0>b)return;k=-1;d=-d;b=-b;t=1-this.ctx.canvas.height;n=0}f=c-a;var g=d-b,l=f<<1,q=g<<1,r=a,s=b;if(f>=g){var u=q-f,g=!1;if(b<t){b=l*(t-b)-f;var y=b/q,r=r+(y|0);if(r>p)return;r>=m&&(b-=y*q,u-=(b|0)+f,s=t,0<b&&(++r,u+=q),g=!0)}if(!g&&a<m){a=q*(m-a);s+=a/l|0;a%=l;if(s>n||s==n&&a>f)return;r=m;u+=a|0;a>=f&&(++s,u-=l)}d>n&&(n=l*(n-d)+f,d=n/q,c+=d|0,0==n-d*q&&--c);c>p?c=p+1:++c;-1==h&&(r=-r,c=-c);-1==k&&(s=-s);for(l-=q;r!=c;)this.setPixel(r,s,e),0<=u?(s+=k,u-=l):u+=q,r+=
h}else{u=l-g;f=!1;if(a<m){a=q*(m-a)-g;y=a/l;s+=y|0;if(s>n)return;s>=t&&(a-=y*l,u-=(a|0)+g,r=m,0<a&&(++s,u+=l),f=!0)}if(!f&&b<t){a=l*(t-b);r+=a/q|0;a%=q;if(r>p||r==p&&a>g)return;s=t;u+=a|0;a>=g&&(++r,u-=q)}c>p&&(p=q*(p-c)+g,c=p/l,d+=c|0,0==p-c*l&&--d);d>n?d=n+1:++d;-1==h&&(r=-r);-1==k&&(s=-s,d=-d);for(q-=l;s!=d;)this.setPixel(r,s,e),0<=u?(r+=h,u-=q):u+=l,s+=k}}},dispose:function(){this.pixel=this.ctx=null},clone:function(){return this.sub(0,0,this.ctx.canvas.width,this.ctx.canvas.height)},sub:function(a,
b,c,d){var e=window.document.createElement("canvas");e.width=c;e.height=d;e=e.getContext("2d",null);e.drawImage(this.ctx.canvas,a,b,c,d,0,0,c,d);return ud.fromNative(e)},lock:function(){null==this.lockImage&&(this.lockImage=this.ctx.getImageData(0,0,this.ctx.canvas.width,this.ctx.canvas.height))},unlock:function(){null!=this.lockImage&&(this.ctx.putImageData(this.lockImage,0,0),this.lockImage=null)},getPixel:function(a,b){var c=this.lockImage,d;null!=c?d=a+b*c.width<<2:(d=0,c=this.ctx.getImageData(a,
b,1,1));return c.data[d]<<16|c.data[d|1]<<8|c.data[d|2]|c.data[d|3]<<24},setPixel:function(a,b,c){var d=this.lockImage;null!=d?(a=a+b*d.width<<2,d.data[a]=c>>16&255,d.data[a|1]=c>>8&255,d.data[a|2]=c&255,d.data[a|3]=c>>>24&255):(d=this.pixel,null==d&&(this.pixel=d=this.ctx.createImageData(1,1)),d.data[0]=c>>16&255,d.data[1]=c>>8&255,d.data[2]=c&255,d.data[3]=c>>>24&255,this.ctx.putImageData(d,a,b))},get_width:function(){return this.ctx.canvas.width},get_height:function(){return this.ctx.canvas.height},
getPixels:function(){var a=this.ctx.canvas.width,b=this.ctx.canvas.height,c=this.ctx.getImageData(0,0,a,b).data.buffer;return new Ba(a,b,N.ofData(c),ha.RGBA)},setPixels:function(a){if(a.width!=this.ctx.canvas.width||a.height!=this.ctx.canvas.height)throw new q("Invalid pixels size");a.setFlip(!1);var b=this.ctx.createImageData(a.width,a.height);a.convert(ha.RGBA);for(var c=0,d=4*a.width*a.height;c<d;){var e=c++;b.data[e]=a.bytes.b[e]}this.ctx.putImageData(b,0,0)},toNative:function(){return this.ctx},
toPNG:function(){var a=this.getPixels(),b=a.toPNG();a.dispose();return b},__class__:ud};var Mb=function(){this.map=new na;for(var a=0;94>a;){var b=a++;this.map.h[65281+b]=33+b}for(a=192;199>a;)b=a++,this.map.h[b]=65;for(a=224;231>a;)b=a++,this.map.h[b]=97;for(a=200;204>a;)b=a++,this.map.h[b]=69;for(a=232;236>a;)b=a++,this.map.h[b]=101;for(a=204;208>a;)b=a++,this.map.h[b]=73;for(a=236;240>a;)b=a++,this.map.h[b]=105;for(a=210;215>a;)b=a++,this.map.h[b]=79;for(a=242;247>a;)b=a++,this.map.h[b]=111;for(a=
217;221>a;)b=a++,this.map.h[b]=85;for(a=249;253>a;)b=a++,this.map.h[b]=117;this.map.h[199]=67;this.map.h[231]=67;this.map.h[208]=68;this.map.h[222]=100;this.map.h[209]=78;this.map.h[241]=110;this.map.h[221]=89;this.map.h[253]=121;this.map.h[255]=121;this.map.h[8364]=69;this.map.h[12288]=32;this.map.h[160]=32;this.map.h[171]=34;this.map.h[187]=34;this.map.h[8220]=34;this.map.h[8221]=34;this.map.h[8216]=39;this.map.h[8217]=39;this.map.h[180]=39;this.map.h[8216]=39;this.map.h[8249]=60;this.map.h[8250]=
62;this.map.h[8211]=45};r["hxd.Charset"]=Mb;Mb.__name__="hxd.Charset";Mb.getDefault=function(){null==Mb.inst&&(Mb.inst=new Mb);return Mb.inst};Mb.prototype={resolveChar:function(a,b){for(var c=a;null!=c;){var d=b.h[c];if(null!=d)return d;c=this.map.h[c]}return null},isCJK:function(a){return 11904<=a&&42191>=a||63744<=a&&64255>=a?!0:131072<=a?262141>=a:!1},isSpace:function(a){return 32!=a?12288==a:!0},isBreakChar:function(a){return this.isSpace(a)?!0:this.isCJK(a)},__class__:Mb};var Uc=K["hxd.Cursor"]=
{__ename__:!0,__constructs__:"Default Button Move TextInput Hide Custom Callback".split(" "),Default:{_hx_index:0,__enum__:"hxd.Cursor",toString:m},Button:{_hx_index:1,__enum__:"hxd.Cursor",toString:m},Move:{_hx_index:2,__enum__:"hxd.Cursor",toString:m},TextInput:{_hx_index:3,__enum__:"hxd.Cursor",toString:m},Hide:{_hx_index:4,__enum__:"hxd.Cursor",toString:m},Custom:(s=function(a){return{_hx_index:5,custom:a,__enum__:"hxd.Cursor",toString:m}},s.__params__=["custom"],s),Callback:(s=function(a){return{_hx_index:6,
f:a,__enum__:"hxd.Cursor",toString:m}},s.__params__=["f"],s)};Uc.__empty_constructs__=[Uc.Default,Uc.Button,Uc.Move,Uc.TextInput,Uc.Hide];var mi=function(a,b,c,d){this.frames=a;this.speed=b;this.offsetX=c;this.offsetY=d;this.frameDelay=1/b;this.frameIndex=this.frameTime=0};r["hxd.CustomCursor"]=mi;mi.__name__="hxd.CustomCursor";mi.getNativeCursor=function(a){var b=new mi([],0,0,0);b.alloc=[a];return Uc.Custom(b)};mi.prototype={reset:function(){this.frameIndex=this.frameTime=0},update:function(a){a=
this.frameTime+a;for(var b=this.frameDelay,c=this.frameIndex;a>=b;)a-=b,++c;this.frameTime=a;c>=this.frames.length&&(c%=this.frames.length);return c!=this.frameIndex?this.frameIndex=c:-1},dispose:function(){for(var a=0,b=this.frames;a<b.length;){var c=b[a];++a;c.ctx=null;c.pixel=null}this.frames=[];null!=this.alloc&&(this.alloc=null)},__class__:mi};var la=K["hxd.EventKind"]={__ename__:!0,__constructs__:"EPush ERelease EMove EOver EOut EWheel EFocus EFocusLost EKeyDown EKeyUp EReleaseOutside ETextInput ECheck".split(" "),
EPush:{_hx_index:0,__enum__:"hxd.EventKind",toString:m},ERelease:{_hx_index:1,__enum__:"hxd.EventKind",toString:m},EMove:{_hx_index:2,__enum__:"hxd.EventKind",toString:m},EOver:{_hx_index:3,__enum__:"hxd.EventKind",toString:m},EOut:{_hx_index:4,__enum__:"hxd.EventKind",toString:m},EWheel:{_hx_index:5,__enum__:"hxd.EventKind",toString:m},EFocus:{_hx_index:6,__enum__:"hxd.EventKind",toString:m},EFocusLost:{_hx_index:7,__enum__:"hxd.EventKind",toString:m},EKeyDown:{_hx_index:8,__enum__:"hxd.EventKind",
toString:m},EKeyUp:{_hx_index:9,__enum__:"hxd.EventKind",toString:m},EReleaseOutside:{_hx_index:10,__enum__:"hxd.EventKind",toString:m},ETextInput:{_hx_index:11,__enum__:"hxd.EventKind",toString:m},ECheck:{_hx_index:12,__enum__:"hxd.EventKind",toString:m}};la.__empty_constructs__=[la.EPush,la.ERelease,la.EMove,la.EOver,la.EOut,la.EWheel,la.EFocus,la.EFocusLost,la.EKeyDown,la.EKeyUp,la.EReleaseOutside,la.ETextInput,la.ECheck];var sb=function(a,b,c){null==c&&(c=0);null==b&&(b=0);this.button=0;this.kind=
a;this.relX=b;this.relY=c};r["hxd.Event"]=sb;sb.__name__="hxd.Event";sb.prototype={toString:function(){var a=n.string(this.kind)+"["+(this.relX|0)+","+(this.relY|0)+"]",b;switch(this.kind._hx_index){case 0:case 1:case 10:b=",button="+this.button;break;case 2:case 3:case 4:case 6:case 7:case 12:b="";break;case 5:b=",wheelDelta="+this.wheelDelta;break;case 8:case 9:b=",keyCode="+this.keyCode;break;case 11:b=",charCode="+this.charCode}return a+b},__class__:sb};var Ob={};r["hxd._FloatBuffer.Float32Expand_Impl_"]=
Ob;Ob.__name__="hxd._FloatBuffer.Float32Expand_Impl_";Ob._new=function(a){return{pos:0,array:new Float32Array(new ArrayBuffer(a<<2))}};Ob.get_length=function(a){return a.pos};Ob.set_length=function(a,b){if(a.pos!=b){var c=new Float32Array(b);c.set(a.array);a.array=c}return a.pos=b};Ob.push=function(a,b){if(a.pos==a.array.length){var c=a.array.length<<1;128>c&&(c=128);c=new Float32Array(c);c.set(a.array);a.array=c}a.array[a.pos++]=b};Ob.get=function(a,b){return a.array[b]};Ob.set=function(a,b,c){return a.array[b]=
c};Ob.toF32Array=function(a){return a.array};Ob.toArray=function(a){for(var b=[],c=0,d=a.pos;c<d;){var e=c++;b.push(a.array[e])}return b};var Jj=function(a){this.b=a;this.len=this.b.pos;this.pos=0};r["hxd._FloatBuffer.InnerIterator"]=Jj;Jj.__name__="hxd._FloatBuffer.InnerIterator";Jj.prototype={hasNext:function(){return this.pos<this.len},next:function(){return this.b.array[this.pos++]},__class__:Jj};var Ud={};r["hxd._FloatBuffer.FloatBuffer_Impl_"]=Ud;Ud.__name__="hxd._FloatBuffer.FloatBuffer_Impl_";
Ud._new=function(a){null==a&&(a=0);return Ob._new(a)};Ud.push=function(a,b){if(a.pos==a.array.length){var c=a.array.length<<1;128>c&&(c=128);c=new Float32Array(c);c.set(a.array);a.array=c}a.array[a.pos++]=b};Ud.grow=function(a,b){for(var c=a.pos;c<b;){c++;if(a.pos==a.array.length){var d=a.array.length<<1;128>d&&(d=128);d=new Float32Array(d);d.set(a.array);a.array=d}a.array[a.pos++]=0}};Ud.resize=function(a,b){if(a.pos!=b){var c=new Float32Array(b);c.set(a.array);a.array=c}a.pos=b};Ud.arrayRead=function(a,
b){return a.array[b]};Ud.arrayWrite=function(a,b,c){return a.array[b]=c};Ud.getNative=function(a){return a};Ud.iterator=function(a){return new Jj(a)};Ud.get_length=function(a){return a.pos};var Kj=function(a){this.b=a;this.len=this.b.length;this.pos=0};r["hxd._IndexBuffer.InnerIterator"]=Kj;Kj.__name__="hxd._IndexBuffer.InnerIterator";Kj.prototype={hasNext:function(){return this.pos<this.len},next:function(){return this.b[this.pos++]},__class__:Kj};var Ic={};r["hxd._IndexBuffer.IndexBuffer_Impl_"]=
Ic;Ic.__name__="hxd._IndexBuffer.IndexBuffer_Impl_";Ic._new=function(a){null==a&&(a=0);return Array(a)};Ic.push=function(a,b){a.push(b)};Ic.grow=function(a,b){for(;a.length<b;)a.push(0)};Ic.arrayRead=function(a,b){return a[b]};Ic.arrayWrite=function(a,b,c){return a[b]=c};Ic.getNative=function(a){return a};Ic.iterator=function(a){return new Kj(a)};Ic.get_length=function(a){return a.length};var y=function(){};r["hxd.Key"]=y;y.__name__="hxd.Key";y.isDown=function(a){return 0<y.keyPressed[a]};y.getFrame=
function(){return ea.frameCount+1};y.isPressed=function(a){return y.keyPressed[a]==ea.frameCount+1-1};y.isReleased=function(a){return y.keyPressed[a]==-(ea.frameCount+1)+1};y.initialize=function(){y.initDone&&y.dispose();y.initDone=!0;y.keyPressed=[];db.getInstance().addEventTarget(y.onEvent)};y.dispose=function(){y.initDone&&(db.getInstance().removeEventTarget(y.onEvent),y.initDone=!1,y.keyPressed=[])};y.onEvent=function(a){switch(a.kind._hx_index){case 0:5>a.button&&(y.keyPressed[a.button]=ea.frameCount+
1);break;case 1:5>a.button&&(y.keyPressed[a.button]=-(ea.frameCount+1));break;case 5:y.keyPressed[0<a.wheelDelta?6:5]=ea.frameCount+1;break;case 8:if(!y.ALLOW_KEY_REPEAT&&0<y.keyPressed[a.keyCode])break;y.keyPressed[a.keyCode]=ea.frameCount+1;break;case 9:y.keyPressed[a.keyCode]=-(ea.frameCount+1)}};y.getKeyName=function(a){switch(a){case 0:return"MouseLeft";case 1:return"MouseRight";case 2:return"MouseMiddle";case 3:return"Mouse3";case 4:return"Mouse4";case 8:return"Backspace";case 9:return"Tab";
case 13:return"Enter";case 16:return"Shift";case 17:return"Ctrl";case 18:return"Alt";case 19:return"PauseBreak";case 20:return"CapsLock";case 27:return"Escape";case 32:return"Space";case 33:return"PageUp";case 34:return"PageDown";case 35:return"End";case 36:return"Home";case 37:return"Left";case 38:return"Up";case 39:return"Right";case 40:return"Down";case 45:return"Insert";case 46:return"Delete";case 91:return"LeftWindowKey";case 92:return"RightWindowKey";case 93:return"ContextMenu";case 106:return"NumPad*";
case 107:return"NumPad+";case 108:return"NumPadEnter";case 109:return"NumPad-";case 110:return"NumPad.";case 111:return"NumPad/";case 144:return"NumLock";case 145:return"ScrollLock";case 186:return"Semicolon";case 187:return"Equals";case 188:return"Comma";case 189:return"Minus";case 190:return"Period";case 191:return"Slash";case 192:return"Tilde";case 219:return"BracketLeft";case 220:return"Backslash";case 221:return"BacketRight";case 222:return"Quote";case 226:return"IntlBackslash";case 272:return"LShift";
case 273:return"LCtrl";case 274:return"LAlt";case 528:return"RShift";case 529:return"RCtrl";case 530:return"RAlt";default:return 48<=a&&57>=a?""+(a-48):96<=a&&105>=a?"NumPad"+(a-96):65<=a&&90>=a?String.fromCodePoint(65+a-65):112<=a&&135>=a?"F"+(a-112+1):null}};var L=function(){};r["hxd.Math"]=L;L.__name__="hxd.Math";L.get_POSITIVE_INFINITY=function(){return Infinity};L.get_NEGATIVE_INFINITY=function(){return-Infinity};L.get_NaN=function(){return NaN};L.isNaN=function(a){return isNaN(a)};L.fmt=function(a){var b;
0>a?(b=-1,a=-a):b=1;if(isNaN(a)||!isFinite(a))return a;var c=4-Math.log(a)/Math.log(10)|0;if(1>c)c=1;else if(10<=c)return 0;c=Math.pow(10,c);return Math.floor(a*c+0.49999)*b/c};L.floor=function(a){return Math.floor(a)};L.ceil=function(a){return Math.ceil(a)};L.round=function(a){return Math.round(a)};L.clamp=function(a,b,c){null==c&&(c=1);null==b&&(b=0);return a<b?b:a>c?c:a};L.pow=function(a,b){return Math.pow(a,b)};L.scaleTime=function(a,b){return Math.pow(a,b*ea.wantedFPS)};L.cos=function(a){return Math.cos(a)};
L.sin=function(a){return Math.sin(a)};L.tan=function(a){return Math.tan(a)};L.acos=function(a){return Math.acos(a)};L.asin=function(a){return Math.asin(a)};L.atan=function(a){return Math.atan(a)};L.sqrt=function(a){return Math.sqrt(a)};L.invSqrt=function(a){return 1/Math.sqrt(a)};L.atan2=function(a,b){return Math.atan2(a,b)};L.abs=function(a){return 0>a?-a:a};L.max=function(a,b){return a<b?b:a};L.min=function(a,b){return a>b?b:a};L.iabs=function(a){return 0>a?-a:a};L.imax=function(a,b){return a<b?
b:a};L.imin=function(a,b){return a>b?b:a};L.iclamp=function(a,b,c){return a<b?b:a>c?c:a};L.lerp=function(a,b,c){return a+c*(b-a)};L.bitCount=function(a){a-=a>>1&1431655765;a=(a&858993459)+(a>>2&858993459);return 16843009*(a+(a>>4)&252645135)>>24};L.isPOT=function(a){return 0==(a&a-1)};L.nextPOT=function(a){--a;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;return++a};L.distanceSq=function(a,b,c){null==c&&(c=0);return a*a+b*b+c*c};L.distance=function(a,b,c){null==c&&(c=0);null==c&&(c=0);return Math.sqrt(a*
a+b*b+c*c)};L.colorLerp=function(a,b,c){return((a>>>24)*(1-c)+(b>>>24)*c|0)<<24|((a>>16&255)*(1-c)+(b>>16&255)*c|0)<<16|((a>>8&255)*(1-c)+(b>>8&255)*c|0)<<8|(a&255)*(1-c)+(b&255)*c|0};L.angle=function(a){a%=6.283185307179586;3.141592653589793<a?a-=6.283185307179586:-3.141592653589793>=a&&(a+=6.283185307179586);return a};L.angleLerp=function(a,b,c){b=(b-a)%6.283185307179586;3.141592653589793<b?b-=6.283185307179586:-3.141592653589793>=b&&(b+=6.283185307179586);return a+b*c};L.angleMove=function(a,b,
c){var d;d=(b-a)%6.283185307179586;3.141592653589793<d?d-=6.283185307179586:-3.141592653589793>=d&&(d+=6.283185307179586);return d>-c&&d<c?b:a+(0>d?-c:c)};L.shuffle=function(a){for(var b=a.length,c=0;c<b;){c++;var d=n.random(b),e=n.random(b),f=a[d];a[d]=a[e];a[e]=f}};L.random=function(a){null==a&&(a=1);return Math.random()*a};L.srand=function(a){null==a&&(a=1);return(Math.random()-0.5)*2*a};L.b2f=function(a){return 0.00392156862745098*(a&255)};L.f2b=function(a){return 255*(0>a?0:1<a?1:a)|0};L.umod=
function(a,b){var c=a%b;return 0<=c?c:c+b};L.ufmod=function(a,b){var c=a%b;return 0<=c?c:c+b};L.degToRad=function(a){return 3.141592653589793*a/180};L.radToDeg=function(a){return 180*a/3.141592653589793};var Ua=K["hxd.Flags"]={__ename__:!0,__constructs__:["ReadOnly","AlphaPremultiplied","FlipY"],ReadOnly:{_hx_index:0,__enum__:"hxd.Flags",toString:m},AlphaPremultiplied:{_hx_index:1,__enum__:"hxd.Flags",toString:m},FlipY:{_hx_index:2,__enum__:"hxd.Flags",toString:m}};Ua.__empty_constructs__=[Ua.ReadOnly,
Ua.AlphaPremultiplied,Ua.FlipY];var ni={};r["hxd._Pixels.PixelsARGB_Impl_"]=ni;ni.__name__="hxd._Pixels.PixelsARGB_Impl_";ni.getPixel=function(a,b,c){a=a.bytes.getInt32((b+c*a.width<<2)+a.offset);return a>>>24|a>>8&65280|a<<8&16711680|a<<24};ni.setPixel=function(a,b,c,d){a.bytes.setInt32((b+c*a.width<<2)+a.offset,d>>>24|d>>8&65280|d<<8&16711680|d<<24)};ni.fromPixels=function(a){a.convert(ha.ARGB);a.setFlip(!1);return a};var jg={};r["hxd._Pixels.PixelsFloat_Impl_"]=jg;jg.__name__="hxd._Pixels.PixelsFloat_Impl_";
jg.getPixelF=function(a,b,c){switch(a.innerFormat._hx_index){case 4:return b=(b+c*a.width<<4)+a.offset,new B(a.bytes.getFloat(b),a.bytes.getFloat(b+4),a.bytes.getFloat(b+8),a.bytes.getFloat(b+12));case 7:return new B(a.bytes.getFloat((b+c*a.width<<2)+a.offset));default:return jg.invalidFormat(a),null}};jg.setPixelF=function(a,b,c,d){switch(a.innerFormat._hx_index){case 4:b=(b+c*a.width<<4)+a.offset;a.bytes.setFloat(b,d.x);a.bytes.setFloat(b+4,d.y);a.bytes.setFloat(b+8,d.z);a.bytes.setFloat(b+12,d.w);
break;case 7:a.bytes.setFloat((b+c*a.width<<2)+a.offset,d.x);break;default:jg.invalidFormat(a)}};jg.fromPixels=function(a){a.setFlip(!1);return a};jg.invalidFormat=function(a){throw new q("Unsupported format for this operation : "+n.string(a.innerFormat));};var kg={};r["hxd._Pixels.Channel_Impl_"]=kg;kg.__name__="hxd._Pixels.Channel_Impl_";kg.toInt=function(a){return a};kg.fromInt=function(a){return a};var Ba=function(a,b,c,d,e){null==e&&(e=0);this.width=a;this.height=b;this.bytes=c;this.set_innerFormat(d);
this.offset=e;a=0;null==a&&(a=0);this.flags=a};r["hxd.Pixels"]=Ba;Ba.__name__="hxd.Pixels";Ba.switchEndian=function(a){return a>>>24|a>>8&65280|a<<8&16711680|a<<24};Ba.switchBR=function(a){return a&-16711936|a<<16&16711680|a>>16&255};Ba.calcStride=function(a,b){var c;switch(b._hx_index){case 3:c=8;break;case 4:c=16;break;case 5:c=1;break;case 6:c=2;break;case 7:c=4;break;case 8:c=2;break;case 9:c=4;break;case 10:c=8;break;case 11:c=3;break;case 12:c=6;break;case 13:c=12;break;case 0:case 1:case 2:case 14:case 15:c=
4;break;case 16:c=4;break;case 17:c=4;break;case 18:c=b.v;if(1==c||4==c)return a>>1;c=1}return a*c};Ba.getChannelOffset=function(a,b){switch(a._hx_index){case 0:return[1,2,3,0][b];case 1:return[2,1,0,3][b];case 3:return 2*b;case 4:return 4*b;case 5:case 6:case 7:return 0==b?0:-1;case 8:case 9:case 10:return[0,Ba.calcStride(1,a),-1,-1][b];case 11:case 12:case 13:var c=Ba.calcStride(1,a);return[0,c,c<<1,-1][b];case 2:case 14:case 15:return b;case 16:case 17:throw new q("Bit packed format");case 18:throw new q("Not supported");
}};Ba.alloc=function(a,b,c){return new Ba(a,b,new N(new ArrayBuffer(b*Ba.calcStride(a,c))),c)};Ba.prototype={get_format:function(){return this.innerFormat},set_innerFormat:function(a){this.innerFormat=a;this.stride=Ba.calcStride(this.width,a);this.bytesPerPixel=Ba.calcStride(1,a);return a},invalidFormat:function(){throw new q("Unsupported format for this operation : "+n.string(this.innerFormat));},sub:function(a,b,c,d){if(0>a||0>b||a+c>this.width||b+d>this.height)throw new q("Pixels.sub() outside bounds");
for(var e=new N(new ArrayBuffer(d*this.stride)),f=Ba.calcStride(c,this.innerFormat),g=0,h=0;h<d;){var k=h++,k=b+k;e.blit(g,this.bytes,(a+(0!=(this.flags&1<<Ua.FlipY._hx_index)?this.height-1-k:k)*this.width)*this.bytesPerPixel+this.offset,f);g+=f}return new Ba(c,d,e,this.innerFormat)},yflip:function(a){return 0!=(this.flags&1<<Ua.FlipY._hx_index)?this.height-1-a:a},blit:function(a,b,c,d,e,f,g){if(0>a||0>b||a+f>this.width||b+g>this.height)throw new q("Pixels.blit() outside bounds");if(0>d||0>d||d+f>
c.width||e+g>c.height)throw new q("Pixels.blit() outside src bounds");0!=(this.flags&1<<Ua.ReadOnly._hx_index)&&this.copyInner();c.convert(this.innerFormat);var h=this.bytesPerPixel;if(0==h)throw new q("assert");f=Ba.calcStride(f,this.innerFormat);for(var k=0;k<g;){var l=k++,m=l+e,l=l+b;this.bytes.blit((a+(0!=(this.flags&1<<Ua.FlipY._hx_index)?this.height-1-l:l)*this.width)*h+this.offset,c.bytes,(d+(0!=(c.flags&1<<Ua.FlipY._hx_index)?c.height-1-m:m)*c.width)*h+c.offset,f)}},clear:function(a,b){null==
b&&(b=0);var c=b;0!=(this.flags&1<<Ua.ReadOnly._hx_index)&&this.copyInner();if((a&255)==(a>>8&255)&&(a&65535)==a>>>16&&0==c)this.bytes.fill(this.offset,this.width*this.height*this.bytesPerPixel,a&255);else{switch(this.innerFormat._hx_index){case 0:a=a>>>24|a>>8&65280|a<<8&16711680|a<<24;c=c>>>24|c>>8&65280|c<<8&16711680|c<<24;break;case 1:break;case 2:a=a&-16711936|a<<16&16711680|a>>16&255;c=c&-16711936|c<<16&16711680|c>>16&255;break;default:this.invalidFormat()}var d=this.offset;if(0==c)for(var c=
0,e=this.width*this.height;c<e;)c++,this.bytes.setInt32(d,a),d+=4;else for(var e=0,f=this.width*this.height;e<f;)e++,this.bytes.setInt32(d,a|this.bytes.getInt32(d)&c),d+=4}},toVector:function(){var a=Array(this.width*this.height),b=0,c=this.offset,d=0;0!=(this.flags&1<<Ua.FlipY._hx_index)&&(c+=(this.height-1)*this.width*this.bytesPerPixel,d=2*-this.width*this.bytesPerPixel);switch(this.innerFormat._hx_index){case 0:for(var e=0,f=this.height;e<f;){e++;for(var g=0,h=this.width;g<h;){g++;var k=this.bytes.getInt32(c);
a[b++]=k>>>24|k>>8&65280|k<<8&16711680|k<<24;c+=4}c+=d}break;case 1:e=0;for(f=this.height;e<f;){e++;g=0;for(h=this.width;g<h;)g++,a[b++]=this.bytes.getInt32(c),c+=4;c+=d}break;case 2:e=0;for(f=this.height;e<f;){e++;g=0;for(h=this.width;g<h;)g++,k=this.bytes.getInt32(c),a[b++]=k&-16711936|k<<16&16711680|k>>16&255,c+=4;c+=d}break;default:this.invalidFormat()}return a},makeSquare:function(a){for(var b=this.width,c=this.height,d=0==b?0:1,e=0==c?0:1;d<b;)d<<=1;for(;e<c;)e<<=1;if(b==d&&c==e)return this;
for(var f=this.bytesPerPixel,g=new N(new ArrayBuffer(d*e*f)),h=0,k=this.offset,l=0;l<c;){l++;g.blit(h,this.bytes,k,b*f);for(var h=h+b*f,k=k+b*f,m=0,t=(d-b)*f>>2;m<t;)m++,g.setInt32(h,0),h+=4}b=0;for(c=(e-c)*d*f>>2;b<c;)b++,g.setInt32(h,0),h+=4;if(a)return new Ba(d,e,g,this.innerFormat);this.bytes=g;this.width=d;this.height=e;return this},copyInner:function(){var a=this.bytes;this.bytes=new N(new ArrayBuffer(this.height*this.stride));this.bytes.blit(0,a,this.offset,this.height*this.stride);this.offset=
0;this.flags&=-1-(1<<Ua.ReadOnly._hx_index)},willChange:function(){0!=(this.flags&1<<Ua.ReadOnly._hx_index)&&this.copyInner()},setFlip:function(a){null==a&&(a=!1);if(0!=(this.flags&1<<Ua.FlipY._hx_index)!=a){0!=(this.flags&1<<Ua.ReadOnly._hx_index)&&this.copyInner();this.flags=a?this.flags|1<<Ua.FlipY._hx_index:this.flags&-1-(1<<Ua.FlipY._hx_index);0!=this.stride%4&&this.invalidFormat();a=0;for(var b=this.height>>1;a<b;)for(var c=a++,d=c*this.stride+this.offset,c=(this.height-1-c)*this.stride+this.offset,
e=0,f=this.stride>>2;e<f;){e++;var g=this.bytes.getInt32(d),h=this.bytes.getInt32(c);this.bytes.setInt32(d,h);this.bytes.setInt32(c,g);d+=4;c+=4}}},convert:function(a){if(this.innerFormat!=a){0!=(this.flags&1<<Ua.ReadOnly._hx_index)&&this.copyInner();var b=this.bytes.b,c=this.innerFormat;switch(c._hx_index){case 0:switch(a._hx_index){case 1:for(var c=0,d=this.width*this.height;c<d;){var e=(c++<<2)+this.offset,f=b[e],g=b[e+1],h=b[e+2],k=b[e+3];b[e++]=k;b[e++]=h;b[e++]=g;b[e]=f}break;case 2:c=0;for(d=
this.width*this.height;c<d;)e=(c++<<2)+this.offset,f=b[e],b[e]=b[e+1],b[e+1]=b[e+2],b[e+2]=b[e+3],b[e+3]=f;break;default:throw new q("Cannot convert from "+n.string(this.innerFormat)+" to "+n.string(a));}break;case 1:switch(a._hx_index){case 0:c=0;for(d=this.width*this.height;c<d;)e=(c++<<2)+this.offset,f=b[e],g=b[e+1],h=b[e+2],k=b[e+3],b[e++]=k,b[e++]=h,b[e++]=g,b[e]=f;break;case 2:c=0;for(d=this.width*this.height;c<d;)e=(c++<<2)+this.offset,f=b[e],b[e]=b[e+2],b[e+2]=f;break;default:throw new q("Cannot convert from "+
n.string(this.innerFormat)+" to "+n.string(a));}break;case 2:switch(a._hx_index){case 0:c=0;for(d=this.width*this.height;c<d;)e=(c++<<2)+this.offset,f=b[e+3],b[e+3]=b[e+2],b[e+2]=b[e+1],b[e+1]=b[e],b[e]=f;break;case 1:c=0;for(d=this.width*this.height;c<d;)e=(c++<<2)+this.offset,f=b[e],b[e]=b[e+2],b[e+2]=f;break;default:throw new q("Cannot convert from "+n.string(this.innerFormat)+" to "+n.string(a));}break;case 18:if(18==a._hx_index){if(c.v!=a.v)throw new q("Cannot convert from "+n.string(this.innerFormat)+
" to "+n.string(a));}else throw new q("Cannot convert from "+n.string(this.innerFormat)+" to "+n.string(a));break;default:throw new q("Cannot convert from "+n.string(this.innerFormat)+" to "+n.string(a));}this.set_innerFormat(a)}},getPixel:function(a,b){var c=(a+(0!=(this.flags&1<<Ua.FlipY._hx_index)?this.height-1-b:b)*this.width)*this.bytesPerPixel+this.offset;switch(this.innerFormat._hx_index){case 0:return c=this.bytes.getInt32(c),c>>>24|c>>8&65280|c<<8&16711680|c<<24;case 1:return this.bytes.getInt32(c);
case 2:return c=this.bytes.getInt32(c),c&-16711936|c<<16&16711680|c>>16&255;default:return this.invalidFormat(),0}},setPixel:function(a,b,c){a=(a+(0!=(this.flags&1<<Ua.FlipY._hx_index)?this.height-1-b:b)*this.width)*this.bytesPerPixel+this.offset;0!=(this.flags&1<<Ua.ReadOnly._hx_index)&&this.copyInner();switch(this.innerFormat._hx_index){case 0:this.bytes.setInt32(a,c>>>24|c>>8&65280|c<<8&16711680|c<<24);break;case 1:this.bytes.setInt32(a,c);break;case 2:this.bytes.setInt32(a,c&-16711936|c<<16&16711680|
c>>16&255);break;default:this.invalidFormat()}},dispose:function(){this.bytes=null},toPNG:function(a){null==a&&(a=9);this.setFlip(!1);0==this.innerFormat._hx_index?a=yc.build32ARGB(this.width,this.height,this.bytes,a):(this.convert(ha.BGRA),a=yc.build32BGRA(this.width,this.height,this.bytes,a));var b=new pc;(new ej(b)).write(a);return b.getBytes()},clone:function(){var a=new Ba(this.width,this.height,null,this.innerFormat);a.flags=this.flags;a.flags&=-1-(1<<Ua.ReadOnly._hx_index);if(null!=this.bytes){var b=
this.height*this.stride;a.bytes=new N(new ArrayBuffer(b));a.bytes.blit(0,this.bytes,this.offset,b)}return a},__class__:Ba};var Vi=function(a){this.defaultCursor=Uc.Default;this.enablePhysicalMouse=this.mouseCheckMove=!0;this.isOut=!1;this.onOver=new sb(la.EOver);this.onOut=new sb(la.EOut);this.checkPos=new sb(la.ECheck);this.focusLost=new sb(la.EFocusLost);this.lastTouch=0;this.overIndex=this.mouseX=this.mouseY=-1;this.scenes=[];this.pendingEvents=[];this.pushList=[];this.overList=[];this.overCandidates=
[];null==a&&(a=db.getInstance());this.window=a;a.addEventTarget(z(this,this.onEvent))};r["hxd.SceneEvents"]=Vi;Vi.__name__="hxd.SceneEvents";Vi.prototype={setMousePos:function(a,b){this.mouseX=a;this.mouseY=b},onRemove:function(a){a==this.currentFocus&&(this.currentFocus=null);if(0<=this.overIndex){var b=this.overList.indexOf(a);0<=b&&(v.remove(this.overList,a),b<this.overIndex&&this.overIndex--)}else v.remove(this.overList,a),this.selectCursor();v.remove(this.pushList,a)},addScene:function(a,b){a.setEvents(this);
null==b?this.scenes.push(a):this.scenes.splice(b,0,a)},removeScene:function(a){v.remove(this.scenes,a)&&a.setEvents(null)},dispose:function(){this.window.removeEventTarget(z(this,this.onEvent))},focus:function(a){if(this.currentFocus!=a)if(null==a)this.blur();else{if(null!=this.currentFocus&&(this.blur(),null!=this.currentFocus))return;var b=new sb(la.EFocus);a.handleEvent(b);b.cancel||(this.currentFocus=a)}},blur:function(){null!=this.currentFocus&&(this.focusLost.cancel=!1,this.currentFocus.handleEvent(this.focusLost),
this.focusLost.cancel||(this.currentFocus=null))},checkFocus:function(){if(null!=this.currentFocus){var a=this.currentFocus.getInteractiveScene();null==a?this.currentFocus=null:a.isInteractiveVisible(this.currentFocus)||this.blur()}},emitEvent:function(a){var b=a.relX,c=a.relY,d=0,e=!1,f=!1,g=!1,h=!1,k=!1,l=!1;this.overIndex=0;switch(a.kind._hx_index){case 0:h=k=!0;break;case 1:h=!0;break;case 5:case 8:case 9:case 11:if(null!=this.currentFocus&&(a.relX=a.relY=0,this.currentFocus.handleEvent(a),a.relX=
b,a.relY=c,!a.propagate))return;break;case 2:case 12:g=f=!0}for(var m=0,t=this.scenes;m<t.length;){var p=t[m];++m;for(var n=null;;){n=p.handleEvent(a,n);if(null==n){a.relX=b;a.relY=c;break}if(f){if(g){g=this.overList.indexOf(n);if(-1==g)this.overCandidates.length==d?this.overCandidates[d]={i:n,s:p,x:a.relX,y:a.relY,z:a.relZ}:(l=this.overCandidates[d],l.i=n,l.s=p,l.x=a.relX,l.y=a.relY,l.z=a.relZ),++d,this.overList.splice(this.overIndex++,0,n),l=!0;else{if(g<this.overIndex){for(;!(this.overList[g]=
this.overList[g+1],++g,!(g<this.overIndex)););this.overList[this.overIndex]=n;l=!0}else if(g>this.overIndex){for(;!(this.overList[g]=this.overList[g-1],--g,!(g>this.overIndex)););this.overList[this.overIndex]=n;l=!0}this.overIndex++}g=a.propagate}}else h&&(a.kind==la.EPush?this.pushList.push(n):v.remove(this.pushList,n)),k&&n==this.currentFocus&&(k=!1);a.relX=b;a.relY=c;if(!a.propagate){e=!0;break}a.propagate=!1}if(e)break}k&&null!=this.currentFocus&&this.blur();if(f){if(this.overIndex<this.overList.length){for(;this.overIndex<
this.overList.length;)this.overList.pop().handleEvent(this.onOut);l=!0}if(0!=d){f=0;for(h=this.onOver;!(k=this.overCandidates[f++],h.relX=k.x,h.relY=k.y,h.relZ=k.z,k.s.isInteractiveVisible(k.i)?k.i.handleEvent(h):v.remove(this.overList,k.i),k.i=null,k.s=null,!(f<d)););}}this.overIndex=-1;l&&this.selectCursor();!e&&a!=this.checkPos&&(a.kind==la.EPush?this.pushList.push(null):a.kind==la.ERelease&&v.remove(this.pushList,null),this.dispatchListeners(a));if(a.kind==la.ERelease&&0<this.pushList.length){d=
0;for(e=this.pushList;d<e.length;)l=e[d],++d,null==l?(a.kind=la.EReleaseOutside,this.dispatchListeners(a),a.kind=la.ERelease):(f=l.getInteractiveScene(),null!=f&&(a.kind=la.EReleaseOutside,f.dispatchEvent(a,l),a.kind=la.ERelease,a.relX=b,a.relY=c));this.pushList=[]}},checkEvents:function(){var a=this.pendingEvents,b=!this.mouseCheckMove,c=null==this.currentFocus;if(0<a.length){this.pendingEvents=[];for(var d=0;d<a.length;){var e=a[d];++d;var f=e.relX,g=e.relY;switch(e.kind._hx_index){case 0:case 1:this.mouseX=
e.relX;this.mouseY=e.relY;this.lastTouch=e.touchId;break;case 2:b=!0;this.mouseX=e.relX;this.mouseY=e.relY;this.lastTouch=e.touchId;break;case 3:this.isOut=!1;this.selectCursor();continue;case 4:this.isOut=!0;if(0<this.overList.length){for(e=this.overList.length-1;0<=e;)this.onOut.cancel=!1,this.overList[e].handleEvent(this.onOut),v.remove(this.overList,this.overList[e]),--e;this.selectCursor()}continue;case 5:case 8:case 9:case 11:c||(c=!0,this.checkFocus())}if(null!=this.currentDrag&&(null==this.currentDrag.ref||
this.currentDrag.ref==e.touchId))if(e.propagate=!0,e.cancel=!1,this.currentDrag.f(e),e.relX=f,e.relY=g,!e.propagate)continue;this.emitEvent(e)}}c||this.checkFocus();!b&&(!this.isOut&&null==this.currentDrag)&&(this.checkPos.relX=this.mouseX,this.checkPos.relY=this.mouseY,this.checkPos.touchId=this.lastTouch,this.checkPos.cancel=!1,this.checkPos.propagate=!1,this.emitEvent(this.checkPos))},startDrag:function(a,b,c){if(null!=this.currentDrag&&null!=this.currentDrag.onCancel)this.currentDrag.onCancel();
this.currentDrag={f:a,ref:null==c?null:c.touchId,onCancel:b}},stopDrag:function(){if(null!=this.currentDrag&&null!=this.currentDrag.onCancel)this.currentDrag.onCancel();this.currentDrag=null},getFocus:function(){return this.currentFocus},updateCursor:function(a){-1!=this.overList.indexOf(a)&&this.selectCursor()},set_defaultCursor:function(a){if(Fa.enumEq(a,this.defaultCursor))return a;this.defaultCursor=a;this.selectCursor();return a},selectCursor:function(){for(var a=this.defaultCursor,b=0,c=this.overList;b<
c.length;){var d=c[b];++b;if(null!=d.cursor){a=d.cursor;break}}6==a._hx_index?(a=a.f,a()):U.setCursor(a)},onEvent:function(a){(this.enablePhysicalMouse||a.kind!=la.EMove)&&this.pendingEvents.push(a)},dispatchListeners:function(a){var b=a.relX,c=a.relY;a.propagate=!0;for(var d=0,e=this.scenes;d<e.length;){var f=e[d];++d;a.cancel=!1;f.dispatchListeners(a);a.relX=b;a.relY=c;if(!a.propagate)break}},__class__:Vi};var nc=K["hxd.Platform"]={__ename__:!0,__constructs__:"IOS Android WebGL PC Console FlashPlayer".split(" "),
IOS:{_hx_index:0,__enum__:"hxd.Platform",toString:m},Android:{_hx_index:1,__enum__:"hxd.Platform",toString:m},WebGL:{_hx_index:2,__enum__:"hxd.Platform",toString:m},PC:{_hx_index:3,__enum__:"hxd.Platform",toString:m},Console:{_hx_index:4,__enum__:"hxd.Platform",toString:m},FlashPlayer:{_hx_index:5,__enum__:"hxd.Platform",toString:m}};nc.__empty_constructs__=[nc.IOS,nc.Android,nc.WebGL,nc.PC,nc.Console,nc.FlashPlayer];var Lh=K["hxd.SystemValue"]={__ename__:!0,__constructs__:["IsTouch","IsWindowed",
"IsMobile"],IsTouch:{_hx_index:0,__enum__:"hxd.SystemValue",toString:m},IsWindowed:{_hx_index:1,__enum__:"hxd.SystemValue",toString:m},IsMobile:{_hx_index:2,__enum__:"hxd.SystemValue",toString:m}};Lh.__empty_constructs__=[Lh.IsTouch,Lh.IsWindowed,Lh.IsMobile];var ea=function(){};r["hxd.Timer"]=ea;ea.__name__="hxd.Timer";ea.update=function(){ea.frameCount++;var a=Date.now()/1E3;ea.elapsedTime=a-ea.lastTimeStamp;ea.lastTimeStamp=a;ea.elapsedTime<ea.maxDeltaTime?(a=ea.elapsedTime,ea.currentDT=a+ea.smoothFactor*
(ea.currentDT-a)):ea.elapsedTime=1/ea.wantedFPS;ea.dt=ea.currentDT};ea.get_tmod=function(){return ea.dt*ea.wantedFPS};ea.set_tmod=function(a){ea.dt=a/ea.wantedFPS;return a};ea.fps=function(){return 1/ea.currentDT};ea.skip=function(){ea.lastTimeStamp=Date.now()/1E3};ea.reset=function(){ea.lastTimeStamp=Date.now()/1E3;ea.dt=ea.currentDT=1/ea.wantedFPS};var db=function(a,b){this.useScreenPixels=!0;this.curMouseX=this.curMouseY=0;var c=this,d=null!=a;this.eventTargets=new Nc;this.resizeEvents=new Nc;
if(null==a){a=window.document.getElementById("webgl");if(null==a)throw new q("Missing canvas #webgl");"1"==a.getAttribute("globalEvents")&&(b=!0)}this.canvas=a;this.propagateKeyEvents=b;var e=a.getAttribute("propagateKeyEvents");null!=e&&(this.propagateKeyEvents="0"!=e&&"false"!=e);this.element=(this.focused=b)?window:a;this.canvasPos=a.getBoundingClientRect();d?a.addEventListener("mousemove",z(this,this.onMouseMove)):window.addEventListener("mousemove",z(this,this.onMouseMove));this.element.addEventListener("mousedown",
z(this,this.onMouseDown));this.element.addEventListener("mouseup",z(this,this.onMouseUp));this.element.addEventListener("wheel",z(this,this.onMouseWheel));this.element.addEventListener("touchstart",z(this,this.onTouchStart));this.element.addEventListener("touchmove",z(this,this.onTouchMove));this.element.addEventListener("touchend",z(this,this.onTouchEnd));this.element.addEventListener("keydown",z(this,this.onKeyDown));this.element.addEventListener("keyup",z(this,this.onKeyUp));this.element.addEventListener("keypress",
z(this,this.onKeyPress));var f=z(this,this.onFocus);this.element.addEventListener("blur",function(){f(!1)});var g=z(this,this.onFocus);this.element.addEventListener("focus",function(){g(!0)});a.oncontextmenu=function(a){a.stopPropagation();a.preventDefault();return!1};b?(a.addEventListener("mousedown",function(a){c.onMouseDown(a);a.stopPropagation();a.preventDefault()}),this.element.addEventListener("contextmenu",function(a){a.stopPropagation();a.preventDefault();return!1})):(null==a.getAttribute("tabindex")&&
a.setAttribute("tabindex","1"),a.style.outline="none");this.curW=this.get_width();this.curH=this.get_height();this.timer=new de(100);this.timer.run=z(this,this.checkResize)};r["hxd.Window"]=db;db.__name__="hxd.Window";db.getInstance=function(){null==db.inst&&(db.inst=new db);return db.inst};db.prototype={checkResize:function(){this.canvasPos=this.canvas.getBoundingClientRect();var a=this.get_width(),b=this.get_height();if(this.curW!=a||this.curH!=b)this.curW=a,this.curH=b,this.onResize(null)},dispose:function(){this.timer.stop()},
onClose:function(){return!0},event:function(a){for(var b=this.eventTargets.h;null!=b;){var c=b.item,b=b.next;c(a)}},addEventTarget:function(a){this.eventTargets.add(a)},removeEventTarget:function(a){for(var b=this.eventTargets.h;null!=b;){var c=b.item,b=b.next;if(ua.compareMethods(c,a)){this.eventTargets.remove(c);break}}},addResizeEvent:function(a){this.resizeEvents.push(a)},removeResizeEvent:function(a){for(var b=this.resizeEvents.h;null!=b;){var c=b.item,b=b.next;if(ua.compareMethods(c,a)){this.resizeEvents.remove(a);
break}}},onResize:function(a){for(a=this.resizeEvents.h;null!=a;){var b=a.item;a=a.next;b()}},resize:function(a,b){},setFullScreen:function(a){var b=window.document,c=b.documentElement;b.fullscreenElement==c!=a&&(a?c.requestFullscreen():b.exitFullscreen())},setCurrent:function(){db.inst=this},getPixelRatio:function(){return this.useScreenPixels?window.devicePixelRatio:1},get_width:function(){return Math.round(this.canvasPos.width*this.getPixelRatio())},get_height:function(){return Math.round(this.canvasPos.height*
this.getPixelRatio())},get_mouseX:function(){return Math.round((this.curMouseX-this.canvasPos.left)*this.getPixelRatio())},get_mouseY:function(){return Math.round((this.curMouseY-this.canvasPos.top)*this.getPixelRatio())},get_mouseLock:function(){return!1},set_mouseLock:function(a){if(a)throw new q("Not implemented");return!1},get_vsync:function(){return!0},set_vsync:function(a){if(!a)throw new q("Can't disable vsync on this platform");return!0},onMouseDown:function(a){if(a.clientX!=this.curMouseX||
a.clientY!=this.curMouseY)this.onMouseMove(a);var b=new sb(la.EPush,this.get_mouseX(),this.get_mouseY());a=a.button;switch(a){case 1:a=2;break;case 2:a=1;break}b.button=a;this.event(b)},onMouseUp:function(a){if(a.clientX!=this.curMouseX||a.clientY!=this.curMouseY)this.onMouseMove(a);var b=new sb(la.ERelease,this.get_mouseX(),this.get_mouseY());a=a.button;switch(a){case 1:a=2;break;case 2:a=1;break}b.button=a;this.event(b)},onMouseMove:function(a){this.curMouseX=a.clientX;this.curMouseY=a.clientY;
this.event(new sb(la.EMove,this.get_mouseX(),this.get_mouseY()))},onMouseWheel:function(a){a.preventDefault();var b=new sb(la.EWheel,this.get_mouseX(),this.get_mouseY());b.wheelDelta=a.deltaY/120;this.event(b)},onTouchStart:function(a){a.preventDefault();var b,c,d=0;for(a=a.changedTouches;d<a.length;){var e=a[d];++d;b=Math.round((e.clientX-this.canvasPos.left)*this.getPixelRatio());c=Math.round((e.clientY-this.canvasPos.top)*this.getPixelRatio());b=new sb(la.EPush,b,c);b.touchId=e.identifier;this.event(b)}},
onTouchMove:function(a){a.preventDefault();var b,c,d=0;for(a=a.changedTouches;d<a.length;){var e=a[d];++d;b=Math.round((e.clientX-this.canvasPos.left)*this.getPixelRatio());c=Math.round((e.clientY-this.canvasPos.top)*this.getPixelRatio());b=new sb(la.EMove,b,c);b.touchId=e.identifier;this.event(b)}},onTouchEnd:function(a){a.preventDefault();var b,c,d=0;for(a=a.changedTouches;d<a.length;){var e=a[d];++d;b=Math.round((e.clientX-this.canvasPos.left)*this.getPixelRatio());c=Math.round((e.clientY-this.canvasPos.top)*
this.getPixelRatio());b=new sb(la.ERelease,b,c);b.touchId=e.identifier;this.event(b)}},onKeyUp:function(a){var b=new sb(la.EKeyUp,this.get_mouseX(),this.get_mouseY());b.keyCode=a.keyCode;this.event(b);this.propagateKeyEvents||(a.preventDefault(),a.stopPropagation())},onKeyDown:function(a){var b=new sb(la.EKeyDown,this.get_mouseX(),this.get_mouseY());b.keyCode=a.keyCode;this.event(b);if(!this.propagateKeyEvents){switch(b.keyCode){case 8:case 9:case 16:case 17:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:a.preventDefault()}a.stopPropagation()}},
onKeyPress:function(a){var b=new sb(la.ETextInput,this.get_mouseX(),this.get_mouseY());b.charCode=a.charCode;this.event(b);this.propagateKeyEvents||(a.preventDefault(),a.stopPropagation())},onFocus:function(a){this.event(new sb(a?la.EFocus:la.EFocusLost));this.focused=a},get_isFocused:function(){return this.focused},get_displayMode:function(){return null!=window.document.fullscreenElement?tc.Borderless:tc.Windowed},set_displayMode:function(a){var b=window.document,c=b.documentElement;if(b.fullscreenElement==
c==(a!=tc.Windowed))return tc.Windowed;a!=tc.Windowed?c.requestFullscreen():b.exitFullscreen();return a},get_title:function(){return window.document.title},set_title:function(a){return window.document.title=a},__class__:db};var U=function(){};r["hxd.System"]=U;U.__name__="hxd.System";U.timeoutTick=function(){};U.getCurrentLoop=function(){return U.loopFunc};U.setLoop=function(a){U.loopInit||(U.loopInit=!0,U.browserLoop());U.loopFunc=a};U.browserLoop=function(){var a=window;(a.requestAnimationFrame||
a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame)(U.browserLoop);null!=U.loopFunc&&U.loopFunc()};U.start=function(a){a()};U.setNativeCursor=function(a){if(!(null!=U.currentNativeCursor&&Fa.enumEq(a,U.currentNativeCursor))){U.currentNativeCursor=a;U.currentCustomCursor=null;var b=db.getInstance().canvas;if(null!=b){var c;switch(a._hx_index){case 0:c="default";break;case 1:c="pointer";break;case 2:c="move";break;case 3:c="text";break;case 4:c="none";break;case 5:a=a.custom;if(null==a.alloc){a.alloc=
[];c=0;for(var d=a.frames;c<d.length;){var e=d[c];++c;a.alloc.push('url("'+e.ctx.canvas.toDataURL("image/png")+'") '+a.offsetX+" "+a.offsetY+", default")}}1<a.frames.length&&(U.currentCustomCursor=a,a.reset());c=a.alloc[a.frameIndex];break;case 6:throw new q("assert");}b.style.cursor=c}}};U.getDeviceName=function(){return"Unknown"};U.getDefaultFrameRate=function(){return 60};U.getValue=function(a){switch(a._hx_index){case 0:return U.get_platform()!=nc.Android?U.get_platform()==nc.IOS:!0;case 1:return!0;
case 2:return U.get_platform()!=nc.Android?U.get_platform()==nc.IOS:!0}};U.exit=function(){};U.openURL=function(a){window.open(a,"_blank")};U.updateCursor=function(){if(null!=U.currentCustomCursor){var a=U.currentCustomCursor.update(ea.elapsedTime);if(-1!=a){var b=db.getInstance().canvas;null!=b&&(b.style.cursor=U.currentCustomCursor.alloc[a])}}};U.get_width=function(){return Math.round(window.document.body.clientWidth*window.devicePixelRatio)};U.get_height=function(){return Math.round(window.document.body.clientHeight*
window.devicePixelRatio)};U.get_lang=function(){return"en"};U.get_platform=function(){var a=window.navigator.userAgent.toLowerCase();return 0<=a.indexOf("android")?nc.Android:0<=a.indexOf("ipad")||0<=a.indexOf("iphone")||0<=a.indexOf("ipod")?nc.IOS:nc.PC};U.get_screenDPI=function(){return 72};U.get_allowTimeout=function(){return!1};U.set_allowTimeout=function(a){return!1};var tc=K["hxd.DisplayMode"]={__ename__:!0,__constructs__:["Windowed","Borderless","Fullscreen","FullscreenResize"],Windowed:{_hx_index:0,
__enum__:"hxd.DisplayMode",toString:m},Borderless:{_hx_index:1,__enum__:"hxd.DisplayMode",toString:m},Fullscreen:{_hx_index:2,__enum__:"hxd.DisplayMode",toString:m},FullscreenResize:{_hx_index:3,__enum__:"hxd.DisplayMode",toString:m}};tc.__empty_constructs__=[tc.Windowed,tc.Borderless,tc.Fullscreen,tc.FullscreenResize];var Lj=function(){};r["hxd.fmt.bfnt.FontParser"]=Lj;Lj.__name__="hxd.fmt.bfnt.FontParser";Lj.parse=function(a,b,c){var d=null,e=new Bg(null,0),f=e.glyphs;e.baseLine=0;var g=a.getInt32(0);
switch(g){case 54938946:var h=new Vb(a);h.set_position(h.pos+4);for(var k=0;h.pos<h.totlen;){var l=h.readByte(),m=h.readInt32(),p=h.pos;switch(l){case 1:e.size=e.initSize=h.readInt16();var r=h;r.set_position(r.pos+12);e.name=h.readUntil(0);break;case 2:e.lineHeight=h.readUInt16();e.baseLine=h.readUInt16();var s=h;s.set_position(s.pos+4);k=h.readUInt16();1!=k&&Fb.trace("Warning: BMF format only supports one page at the moment.",{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:224,className:"hxd.fmt.bfnt.FontParser",
methodName:"parse"});break;case 3:var u=h.readUntil(0);try{e.tilePath=u;var y=ta.join([ta.directory(b),u]),d=c(y)}catch(w){$.lastException=w;Fb.trace('Warning: Could not find referenced font texture at "'+u+'", trying to resolve same name as fnt!',{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:30,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"});e.tilePath=(new ta(b)).file+".png";var A=ta.withExtension(b,"png"),d=c(A)}break;case 4:for(var B=m/20|0;0<B;){var H=h.readInt32(),xc=h.readUInt16(),
F=h.readUInt16(),G=h.readUInt16(),z=h.readUInt16(),J=h.readInt16(),K=h.readInt16(),L=d.sub(xc,F,G,z,J,K),Q=new sd(L,h.readInt16());f.h[H]=Q;var N=h;N.set_position(N.pos+2);--B}break;case 5:for(var T=m/10|0;0<T;){var V=h.readInt32(),S=h.readInt32(),R=f.h[S];if(null!=R)R.addKerning(V,h.readInt16());else{var P=h;P.set_position(P.pos+2)}--T}}h.set_position(p+m)}break;case 1414415938:return(new Zg(new Vb(a))).read(function(a){try{e.tilePath=a;var f=ta.join([ta.directory(b),a]);d=c(f)}catch(g){$.lastException=
g,Fb.trace('Warning: Could not find referenced font texture at "'+a+'", trying to resolve same name as fnt!',{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:30,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"}),e.tilePath=(new ta(b)).file+".png",a=ta.withExtension(b,"png"),d=c(a)}return d});case 1836597052:case 1852794428:var O=I.parse(a.toString()).firstElement();if(O.nodeType!=I.Document&&O.nodeType!=I.Element)throw new q("Invalid nodeType "+ka.toString(O.nodeType));if(Ik.resolve(O,"info")){var X=
wc.resolve(O,"info");e.name=Ya.resolve(X,"face");var Y=Ya.resolve(wc.resolve(O,"info"),"size");e.size=e.initSize=n.parseInt(Y);var Z=Ya.resolve(wc.resolve(O,"common"),"lineHeight");e.lineHeight=n.parseInt(Z);var W=Ya.resolve(wc.resolve(O,"common"),"base");e.baseLine=n.parseInt(W);for(var U=wc.resolve(O,"pages").elements();U.hasNext();){var ca=U.next();if("0"==Ya.resolve(ca,"id")){var aa=Ya.resolve(ca,"file");try{e.tilePath=aa;var ea=ta.join([ta.directory(b),aa]),d=c(ea)}catch(ja){$.lastException=
ja;Fb.trace('Warning: Could not find referenced font texture at "'+aa+'", trying to resolve same name as fnt!',{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:30,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"});e.tilePath=(new ta(b)).file+".png";var ia=ta.withExtension(b,"png"),d=c(ia)}}else Fb.trace("Warning: BMF format only supports one page at the moment.",{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:66,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"})}for(var ma=wc.resolve(O,
"chars").elements();ma.hasNext();){for(var ba=ma.next(),qa=n.parseInt(Ya.resolve(ba,"x")),ga=n.parseInt(Ya.resolve(ba,"y")),la=n.parseInt(Ya.resolve(ba,"width")),da=n.parseInt(Ya.resolve(ba,"height")),pa=n.parseInt(Ya.resolve(ba,"xoffset")),na=n.parseInt(Ya.resolve(ba,"yoffset")),wa=d.sub(qa,ga,la,da,pa,na),Xa=new sd(wa,n.parseInt(Ya.resolve(ba,"xadvance"))),ha=wc.resolve(O,"kernings").elements();ha.hasNext();){var za=ha.next();Ya.resolve(za,"second")==Ya.resolve(ba,"id")&&Xa.addKerning(n.parseInt(Ya.resolve(za,
"first")),n.parseInt(Ya.resolve(za,"amount")))}var Ba=n.parseInt(Ya.resolve(ba,"id"));f.h[Ba]=Xa}}else{e.tilePath=(new ta(b)).file+".png";var ua=ta.withExtension(b,"png"),d=c(ua);e.name=Ya.resolve(O,"family");var Ha=Ya.resolve(O,"size");e.size=e.initSize=n.parseInt(Ha);var fa=Ya.resolve(O,"height");e.lineHeight=n.parseInt(fa);for(var Fa=[],xa=O.elements();xa.hasNext();){for(var D=xa.next(),ra=Ya.resolve(D,"rect").split(" "),ya=Ya.resolve(D,"offset").split(" "),Ea=d.sub(n.parseInt(ra[0]),n.parseInt(ra[1]),
n.parseInt(ra[2]),n.parseInt(ra[3]),n.parseInt(ya[0]),n.parseInt(ya[1])),Ma=new sd(Ea,n.parseInt(Ya.resolve(D,"width"))-1),sa=Ya.resolve(D,"code"),Da=Qa.startsWith(sa,"&#")?n.parseInt(v.substr(sa,2,sa.length-3)):v.cca(sa,0),Pa=D.elements();Pa.hasNext();){var Cb=Pa.next(),Ca=Ya.resolve(Cb,"id"),Sa=Qa.startsWith(Ca,"&#")?n.parseInt(v.substr(Ca,2,Ca.length-3)):v.cca(Ca,0),Ka=n.parseInt(Ya.resolve(Cb,"advance"));f.h.hasOwnProperty(Sa)?f.h[Sa].addKerning(Da,Ka):Fa.push({prev:Da,next:Sa,adv:Ka})}f.h[Da]=
Ma}for(var La=0;La<Fa.length;){var Ja=Fa[La];++La;var Na=f.h[Ja.next];null!=Na&&Na.addKerning(Ja.prev,Ja.adv)}}break;case 1868983913:for(var Ua=a.toString().split("\n"),Oa=new uf(' *?([0-9a-zA-Z]+)=("[^"]+"|.+?)(?:[ \r]|$)',""),Ga,yb=0,pb=0;pb<Ua.length;){var Aa=Ua[pb];++pb;Ga=Aa.indexOf(" ");switch(v.substr(Aa,0,Ga)){case "char":for(var fb=0,Ta=0,Ra=0,Ac=0,ab=0,bb=0,Za=0,db=0;Ga<Aa.length&&Oa.matchSub(Aa,Ga);){switch(Oa.matched(1)){case "height":var va=Oa.matched(2),ab=n.parseInt(34==v.cca(va,0)?
va.substring(1,va.length-1):va);break;case "id":var oa=Oa.matched(2),fb=n.parseInt(34==v.cca(oa,0)?oa.substring(1,oa.length-1):oa);break;case "width":var Va=Oa.matched(2),Ac=n.parseInt(34==v.cca(Va,0)?Va.substring(1,Va.length-1):Va);break;case "x":var $a=Oa.matched(2),Ta=n.parseInt(34==v.cca($a,0)?$a.substring(1,$a.length-1):$a);break;case "xadvance":var ob=Oa.matched(2),db=n.parseInt(34==v.cca(ob,0)?ob.substring(1,ob.length-1):ob);break;case "xoffset":var hb=Oa.matched(2),bb=n.parseInt(34==v.cca(hb,
0)?hb.substring(1,hb.length-1):hb);break;case "y":var Wa=Oa.matched(2),Ra=n.parseInt(34==v.cca(Wa,0)?Wa.substring(1,Wa.length-1):Wa);break;case "yoffset":var wb=Oa.matched(2),Za=n.parseInt(34==v.cca(wb,0)?wb.substring(1,wb.length-1):wb)}var Bb=Oa.matchedPos();Ga=Bb.pos+Bb.len}var xb=d.sub(Ta,Ra,Ac,ab,bb,Za),Gb=new sd(xb,db);f.h[fb]=Gb;break;case "common":for(;Ga<Aa.length&&Oa.matchSub(Aa,Ga);){switch(Oa.matched(1)){case "base":var Le=Oa.matched(2);e.baseLine=n.parseInt(34==v.cca(Le,0)?Le.substring(1,
Le.length-1):Le);break;case "lineHeight":var ib=Oa.matched(2);e.lineHeight=n.parseInt(34==v.cca(ib,0)?ib.substring(1,ib.length-1):ib);break;case "pages":var Ab=Oa.matched(2),yb=n.parseInt(34==v.cca(Ab,0)?Ab.substring(1,Ab.length-1):Ab);1!=yb&&Fb.trace("Warning: BMF format only supports one page at the moment.",{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:157,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"})}var Hb=Oa.matchedPos();Ga=Hb.pos+Hb.len}break;case "info":for(;Ga<Aa.length&&Oa.matchSub(Aa,
Ga);){switch(Oa.matched(1)){case "face":var Eb=Oa.matched(2);e.name=34==v.cca(Eb,0)?Eb.substring(1,Eb.length-1):Eb;break;case "size":var Db=Oa.matched(2);e.size=e.initSize=n.parseInt(34==v.cca(Db,0)?Db.substring(1,Db.length-1):Db)}var sb=Oa.matchedPos();Ga=sb.pos+sb.len}break;case "kerning":for(var jb=0,ub=0,tb=0;Ga<Aa.length&&Oa.matchSub(Aa,Ga);){switch(Oa.matched(1)){case "amount":var Ib=Oa.matched(2),tb=n.parseInt(34==v.cca(Ib,0)?Ib.substring(1,Ib.length-1):Ib);break;case "first":var Zb=Oa.matched(2),
jb=n.parseInt(34==v.cca(Zb,0)?Zb.substring(1,Zb.length-1):Zb);break;case "second":var Kb=Oa.matched(2),ub=n.parseInt(34==v.cca(Kb,0)?Kb.substring(1,Kb.length-1):Kb)}var Mb=Oa.matchedPos();Ga=Mb.pos+Mb.len}var Lb=f.h[ub];null!=Lb&&Lb.addKerning(jb,tb);break;case "page":for(;Ga<Aa.length&&Oa.matchSub(Aa,Ga);){if("file"==Oa.matched(1)){var qb=Oa.matched(2),rb=34==v.cca(qb,0)?qb.substring(1,qb.length-1):qb;try{e.tilePath=rb;var Rb=ta.join([ta.directory(b),rb]),d=c(Rb)}catch(dc){$.lastException=dc;Fb.trace('Warning: Could not find referenced font texture at "'+
rb+'", trying to resolve same name as fnt!',{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:30,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"});e.tilePath=(new ta(b)).file+".png";var Yb=ta.withExtension(b,"png"),d=c(Yb)}}var Tb=Oa.matchedPos();Ga=Tb.pos+Tb.len}}}break;default:throw new q("Unknown font signature "+Qa.hex(g,8));}if(null==f.h[32]){var kb=new sd(d.sub(0,0,0,0),e.size>>1);f.h[32]=kb}e.tile=d;if(0==e.baseLine){var Ob=0,zb=f.h[32];null!=zb&&(Ob=0.5*zb.t.height);var Bc=f.h[65];
null==Bc&&(Bc=f.h[97]);null==Bc&&(Bc=f.h[48]);e.baseLine=null==Bc?e.lineHeight-2-Ob:Bc.t.dy+Bc.t.height-Ob}var Sb=f.h[65533];null==Sb&&(Sb=f.h[9633]);null==Sb&&(Sb=f.h[63]);null!=Sb&&(e.defaultChar=Sb);return e};var Zg=function(a){this.i=a};r["hxd.fmt.bfnt.Reader"]=Zg;Zg.__name__="hxd.fmt.bfnt.Reader";Zg.parse=function(a,b){return(new Zg(new Vb(a))).read(b)};Zg.prototype={read:function(a){if("BFNT"!=this.i.readString(4)||0!=this.i.readByte())throw new q("Not a BFNT file!");var b=null,b=this.i.readByte();
if(1==b){b=new Bg(this.i.readString(this.i.readUInt16()),this.i.readInt16());b.tilePath=this.i.readString(this.i.readUInt16());a=b.tile=a(b.tilePath);b.lineHeight=this.i.readInt16();b.baseLine=this.i.readInt16();for(var c=this.i.readInt32(),d;;){d=this.i.readInt32();if(0==d)break;var e=a.sub(this.i.readUInt16(),this.i.readUInt16(),this.i.readUInt16(),this.i.readUInt16(),this.i.readInt16(),this.i.readInt16()),e=new sd(e,this.i.readInt16());b.glyphs.h[d]=e;d==c&&(b.defaultChar=e);for(;;){d=this.i.readInt32();
if(0==d)break;e.addKerning(d,this.i.readInt16())}}}else throw new q("Unknown BFNT version: "+b);return b},__class__:Zg};var Vd={};r["hxd.fmt.hmd._Data.GeometryDataFormat_Impl_"]=Vd;Vd.__name__="hxd.fmt.hmd._Data.GeometryDataFormat_Impl_";Vd._new=function(a){return a};Vd.getSize=function(a){return a&7};Vd.toInt=function(a){return a};Vd.toString=function(a){switch(a){case 1:return"DFloat";case 2:return"DVec2";case 3:return"DVec3";case 4:return"DVec4";case 9:return"DBytes4"}};Vd.fromInt=function(a){return a};
var oi=K["hxd.fmt.hmd.Property"]={__ename__:!0,__constructs__:["CameraFOVY","Unused_HasMaterialFlags","HasExtraTextures"],CameraFOVY:(s=function(a){return{_hx_index:0,v:a,__enum__:"hxd.fmt.hmd.Property",toString:m}},s.__params__=["v"],s),Unused_HasMaterialFlags:{_hx_index:1,__enum__:"hxd.fmt.hmd.Property",toString:m},HasExtraTextures:{_hx_index:2,__enum__:"hxd.fmt.hmd.Property",toString:m}};oi.__empty_constructs__=[oi.Unused_HasMaterialFlags,oi.HasExtraTextures];var $g=function(){};r["hxd.fmt.hmd.Position"]=
$g;$g.__name__="hxd.fmt.hmd.Position";$g.prototype={loadQuaternion:function(a){a.x=this.qx;a.y=this.qy;a.z=this.qz;a.w=this.get_qw()},get_qw:function(){var a=1-(this.qx*this.qx+this.qy*this.qy+this.qz*this.qz);return 0>a?-Math.sqrt(-a):Math.sqrt(a)},toMatrix:function(a){null==a&&(a=!1);var b=new P,c=$g.QTMP;c.x=this.qx;c.y=this.qy;c.z=this.qz;c.w=this.get_qw();c.toMatrix(b);a?(b.translate(this.x,this.y,this.z),b.scale(this.sx,this.sy,this.sz)):(b._11*=this.sx,b._12*=this.sx,b._13*=this.sx,b._21*=
this.sy,b._22*=this.sy,b._23*=this.sy,b._31*=this.sz,b._32*=this.sz,b._33*=this.sz,b.translate(this.x,this.y,this.z));return b},__class__:$g};var gd=function(a,b){this.name=a;this.format=b};r["hxd.fmt.hmd.GeometryFormat"]=gd;gd.__name__="hxd.fmt.hmd.GeometryFormat";gd.prototype={__class__:gd};var Mj=function(){};r["hxd.fmt.hmd.Geometry"]=Mj;Mj.__name__="hxd.fmt.hmd.Geometry";Mj.prototype={get_indexCount:function(){for(var a=0,b=0,c=this.indexCounts;b<c.length;){var d=c[b];++b;a+=d}return a},__class__:Mj};
var Nj=function(){};r["hxd.fmt.hmd.Material"]=Nj;Nj.__name__="hxd.fmt.hmd.Material";Nj.prototype={__class__:Nj};var Oj=function(){};r["hxd.fmt.hmd.SkinJoint"]=Oj;Oj.__name__="hxd.fmt.hmd.SkinJoint";Oj.prototype={__class__:Oj};var Pj=function(){};r["hxd.fmt.hmd.SkinSplit"]=Pj;Pj.__name__="hxd.fmt.hmd.SkinSplit";Pj.prototype={__class__:Pj};var Qj=function(){};r["hxd.fmt.hmd.Skin"]=Qj;Qj.__name__="hxd.fmt.hmd.Skin";Qj.prototype={__class__:Qj};var Rj=function(){};r["hxd.fmt.hmd.Model"]=Rj;Rj.__name__=
"hxd.fmt.hmd.Model";Rj.prototype={__class__:Rj};var Ka=K["hxd.fmt.hmd.AnimationFlag"]={__ename__:!0,__constructs__:"HasPosition HasRotation HasScale HasUV HasAlpha SingleFrame HasProps Reserved".split(" "),HasPosition:{_hx_index:0,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:m},HasRotation:{_hx_index:1,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:m},HasScale:{_hx_index:2,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:m},HasUV:{_hx_index:3,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:m},HasAlpha:{_hx_index:4,
__enum__:"hxd.fmt.hmd.AnimationFlag",toString:m},SingleFrame:{_hx_index:5,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:m},HasProps:{_hx_index:6,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:m},Reserved:{_hx_index:7,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:m}};Ka.__empty_constructs__=[Ka.HasPosition,Ka.HasRotation,Ka.HasScale,Ka.HasUV,Ka.HasAlpha,Ka.SingleFrame,Ka.HasProps,Ka.Reserved];var Sj=function(){};r["hxd.fmt.hmd.AnimationObject"]=Sj;Sj.__name__="hxd.fmt.hmd.AnimationObject";Sj.prototype=
{getStride:function(){var a=0;0!=(this.flags&1<<Ka.HasPosition._hx_index)&&(a+=3);0!=(this.flags&1<<Ka.HasRotation._hx_index)&&(a+=3);0!=(this.flags&1<<Ka.HasScale._hx_index)&&(a+=3);0!=(this.flags&1<<Ka.HasUV._hx_index)&&(a+=2);0!=(this.flags&1<<Ka.HasAlpha._hx_index)&&++a;0!=(this.flags&1<<Ka.HasProps._hx_index)&&(a+=this.props.length);return a},__class__:Sj};var Tj=function(){};r["hxd.fmt.hmd.AnimationEvent"]=Tj;Tj.__name__="hxd.fmt.hmd.AnimationEvent";Tj.prototype={__class__:Tj};var Uj=function(){};
r["hxd.fmt.hmd.Animation"]=Uj;Uj.__name__="hxd.fmt.hmd.Animation";Uj.prototype={__class__:Uj};var pi=function(){};r["hxd.fmt.hmd.Data"]=pi;pi.__name__="hxd.fmt.hmd.Data";pi.prototype={__class__:pi};var qi=function(a,b,c,d){this.size=a;this.offset=b;this.def=c;this.next=d};r["hxd.fmt.hmd._Library.FormatMap"]=qi;qi.__name__="hxd.fmt.hmd._Library.FormatMap";qi.prototype={__class__:qi};var Vj=function(){};r["hxd.fmt.hmd.GeometryBuffer"]=Vj;Vj.__name__="hxd.fmt.hmd.GeometryBuffer";Vj.prototype={__class__:Vj};
var Wj=function(a,b){this.tmp=new N(new ArrayBuffer(4));this.resource=a;this.header=b;this.cachedPrimitives=[];this.cachedAnimations=new ga;this.cachedSkin=new ga};r["hxd.fmt.hmd.Library"]=Wj;Wj.__name__="hxd.fmt.hmd.Library";Wj.prototype={getData:function(){var a=this.resource.entry,b=new N(new ArrayBuffer(a.get_size()-this.header.dataPosition));a.open();a.skip(this.header.dataPosition);a.read(b,0,b.length);a.close();return b},getDefaultFormat:function(a){var b=[new gd("position",3)],c=[null];3<
a&&(b.push(new gd("normal",3)),c.push(null));6<a&&(b.push(new gd("uv",2)),c.push(null));8<a&&(b.push(new gd("color",3)),c.push(new B(1,1,1)));if(11<a)throw new q("Unsupported stride");return{format:b,defs:c}},load:function(a,b,c){null==c&&(c=-1);var d=0,e=0,f=0;c=0>c?this.header.models:[this.header.models[c]];for(var g=Ob._new(0),h=[],k=0,l=-1,m=0;m<a.length;){var p=a[m];++m;k+=p.format&7}for(m=0;m<c.length;){var n=c[m];++m;p=this.header.geometries[n.geometry];if(null!=p){for(var r=0,s=n.materials;r<
s.length;){var u=s[r];++r;0>l&&(l=u);if(l!=u)throw new q("Models have several materials");}n=n.position.toMatrix();r=this.getBuffers(p,a,b);p=g.pos/k|0;s=0;for(u=r.vertexes.length/k|0;s<u;){var y=s++*k,d=r.vertexes[y++],e=r.vertexes[y++],f=r.vertexes[y++],w=d*n._12+e*n._22+f*n._32+1*n._42,A=d*n._13+e*n._23+f*n._33+1*n._43,d=d*n._11+e*n._21+f*n._31+1*n._41,e=w,f=A;g.pos==g.array.length&&(w=g.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(g.array),g.array=w);g.array[g.pos++]=d;g.pos==g.array.length&&
(d=g.array.length<<1,128>d&&(d=128),d=new Float32Array(d),d.set(g.array),g.array=d);g.array[g.pos++]=e;g.pos==g.array.length&&(e=g.array.length<<1,128>e&&(e=128),e=new Float32Array(e),e.set(g.array),g.array=e);g.array[g.pos++]=f;f=0;for(e=k-3;f<e;)f++,d=r.vertexes[y++],g.pos==g.array.length&&(w=g.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(g.array),g.array=w),g.array[g.pos++]=d}n=0;for(r=r.indexes;n<r.length;)s=r[n],++n,h.push(s+p)}}return{vertex:g,index:h}},getBuffers:function(a,b,
c,d){0==d&&1==a.indexCounts.length&&(d=null);for(var e=null,f=0,g=0,h=b.length;g<h;){for(var k=g++,l=b.length-1-k,k=b[l],m=k.format&7,n=0,p=!1,r=0,s=a.vertexFormat;r<s.length;){var u=s[r];++r;if(u.name==k.name){if((u.format&7)<m)throw new q("Requested "+k.name+" data has only "+(u.format&7)+" regs instead of "+m);p=!0;break}n+=u.format&7}if(p)e=new qi(m,n,null,e);else{l=null==c?null:c[l];if(null==l)throw new q("Missing required "+k.name);e=new qi(m,0,l,e)}f+=m}c=4*a.vertexCount*a.vertexStride;g=new N(new ArrayBuffer(c));
b=this.resource.entry;b.open();b.skip(this.header.dataPosition+a.vertexPosition);b.read(g,0,c);b.skip(a.indexPosition-(a.vertexPosition+c));if(null==d)c=2*a.get_indexCount();else{h=c=0;for(k=d;h<k;)m=h++,c+=a.indexCounts[m];b.skip(2*c);c=2*a.indexCounts[d]}h=new N(new ArrayBuffer(c));b.read(h,0,c);c=new Vj;if(null==d){c.vertexes=Array(f*a.vertexCount);d=Array(a.get_indexCount());c.indexes=d;f=d=0;for(k=a.vertexCount;f<k;){m=f++;for(l=e;null!=l;){if(null==l.def){n=m*a.vertexStride;p=0;for(r=l.size;p<
r;)s=p++,c.vertexes[d++]=g.getFloat(n+l.offset+s<<2)}else switch(l.size){case 1:c.vertexes[d++]=l.def.x;break;case 2:c.vertexes[d++]=l.def.x;c.vertexes[d++]=l.def.y;break;case 3:c.vertexes[d++]=l.def.x;c.vertexes[d++]=l.def.y;c.vertexes[d++]=l.def.z;break;default:c.vertexes[d++]=l.def.x,c.vertexes[d++]=l.def.y,c.vertexes[d++]=l.def.z,c.vertexes[d++]=l.def.w}l=l.next}}e=a=0;for(g=c.indexes.length;e<g;)d=e++,c.indexes[d]=h.b[a++]|h.b[a++]<<8}else{k=a.indexCounts[d];f=Array(a.vertexCount);d=Ob._new(0);
c.indexes=Array(k);l=m=k=0;for(n=c.indexes.length;l<n;){p=l++;r=h.b[k++]|h.b[k++]<<8;s=f[r];if(0==s){++m;s=m;f[r]=s;for(u=e;null!=u;){if(null==u.def)for(var y=r*a.vertexStride,w=0,A=u.size;w<A;){var B=w++,B=g.getFloat(y+u.offset+B<<2);if(d.pos==d.array.length){var v=d.array.length<<1;128>v&&(v=128);v=new Float32Array(v);v.set(d.array);d.array=v}d.array[d.pos++]=B}else switch(u.size){case 1:y=u.def.x;d.pos==d.array.length&&(w=d.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(d.array),d.array=
w);d.array[d.pos++]=y;break;case 2:y=u.def.x;d.pos==d.array.length&&(w=d.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(d.array),d.array=w);d.array[d.pos++]=y;y=u.def.y;d.pos==d.array.length&&(w=d.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(d.array),d.array=w);d.array[d.pos++]=y;break;case 3:y=u.def.x;d.pos==d.array.length&&(w=d.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(d.array),d.array=w);d.array[d.pos++]=y;y=u.def.y;d.pos==d.array.length&&(w=d.array.length<<
1,128>w&&(w=128),w=new Float32Array(w),w.set(d.array),d.array=w);d.array[d.pos++]=y;y=u.def.z;d.pos==d.array.length&&(w=d.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(d.array),d.array=w);d.array[d.pos++]=y;break;default:y=u.def.x,d.pos==d.array.length&&(w=d.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(d.array),d.array=w),d.array[d.pos++]=y,y=u.def.y,d.pos==d.array.length&&(w=d.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(d.array),d.array=w),d.array[d.pos++]=
y,y=u.def.z,d.pos==d.array.length&&(w=d.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(d.array),d.array=w),d.array[d.pos++]=y,y=u.def.w,d.pos==d.array.length&&(w=d.array.length<<1,128>w&&(w=128),w=new Float32Array(w),w.set(d.array),d.array=w),d.array[d.pos++]=y}u=u.next}}c.indexes[p]=s-1}a=[];e=0;for(g=d.pos;e<g;)h=e++,a.push(d.array[h]);c.vertexes=a}b.close();return c},makePrimitive:function(a){var b=this.cachedPrimitives[a];if(null!=b)return b;b=new Ug(this.header.geometries[a],this.header.dataPosition,
this);b.incref();return this.cachedPrimitives[a]=b},makeMaterial:function(a,b,c){b=this.header.materials[b];a=uc.current.createMaterial();a.name=b.name;null!=b.diffuseTexture&&(a.set_texture(c(b.diffuseTexture)),null==a.get_texture()&&a.set_texture(S.fromColor(16711935)));null!=b.specularTexture&&a.set_specularTexture(c(b.specularTexture));null!=b.normalMap&&a.set_normalMap(c(b.normalMap));a.set_blendMode(b.blendMode);a.model=this.resource;c=uc.current.loadMaterialProps(a);null==c&&(c=a.getDefaultModelProps());
a.set_props(c);return a},makeSkin:function(a){var b=a.name,c=this.cachedSkin,b=null!=Q[b]?c.getReserved(b):c.h[b];if(null!=b)return b;b=new rj(a.name,0,3);b.namedJoints=new ga;b.allJoints=[];b.boundJoints=[];b.rootJoints=[];for(var c=0,d=a.joints;c<d.length;){var e=d[c];++c;var f=new oj;f.name=e.name;f.index=b.allJoints.length;f.defMat=e.position.toMatrix();0<=e.bind&&(f.bindIndex=e.bind,f.transPos=e.transpos.toMatrix(!0),b.boundJoints[f.bindIndex]=f);0<=e.parent?(e=b.allJoints[e.parent],e.subs.push(f),
f.parent=e):b.rootJoints.push(f);b.allJoints.push(f);var e=f.name,g=b.namedJoints;null!=Q[e]?g.setReserved(e,f):g.h[e]=f}if(null!=a.split){b.splitJoints=[];c=0;for(d=a.split;c<d.length;){var h=d[c];++c;for(var f=b.splitJoints,e=h.materialIndex,g=[],k=0,h=h.joints;k<h.length;){var l=h[k];++k;g.push(b.allJoints[l])}f.push({material:e,joints:g})}}a=a.name;c=this.cachedSkin;null!=Q[a]?c.setReserved(a,b):c.h[a]=b;return b},getModelProperty:function(a,b,c){for(var d=0,e=this.header.models;d<e.length;){var f=
e[d];++d;if(f.name==a){if(null!=f.props){a=0;for(f=f.props;a<f.length;)if(d=f[a],++a,d._hx_index==b._hx_index)return Fa.enumParameters(d)[0]}return c}}if(null==c)throw new q("Model "+a+" not found");return c},makeObject:function(a){null==a&&(a=function(a){return S.fromColor(16711935)});if(0==this.header.models.length)throw new q("This file does not contain any model");for(var b=[],c=0,d=this.header.models;c<d.length;){var e=d[c];++c;var f;if(0>e.geometry)f=new ya;else if(f=this.makePrimitive(e.geometry),
null!=e.skin){var g=this.makeSkin(e.skin);g.primitive=f;f=[];for(var h=0,k=e.materials;h<k.length;){var l=k[h];++h;f.push(this.makeMaterial(e,l,a))}f=new Vg(g,f)}else if(1==e.materials.length)f=new Da(f,this.makeMaterial(e,e.materials[0],a));else{g=[];h=0;for(k=e.materials;h<k.length;)l=k[h],++h,g.push(this.makeMaterial(e,l,a));f=new fc(f,g)}f.name=e.name;g=e.position.toMatrix();f.defaultTransform=g;f.flags|=1;b.push(f);e=b[e.parent];null!=e&&e.addChild(f)}return b[0]},loadAnimation:function(a){var b=
this.cachedAnimations,c=null==a?"":a,b=null!=Q[c]?b.getReserved(c):b.h[c];if(null!=b)return b;b=null;if(null==a){if(0==this.header.animations.length)return null;b=this.header.animations[0]}else{for(var c=0,d=this.header.animations;c<d.length;){var e=d[c];++c;if(e.name==a){b=e;break}}if(null==b)throw new q("Animation "+a+" not found !");}c=2>=this.header.version?this.makeLinearAnimation(b):this.makeAnimation(b);c.speed=b.speed;c.loop=b.loop;null!=b.events&&c.setEvents(b.events);c.resourcePath=this.resource.entry.get_path();
b=b.name;d=this.cachedAnimations;null!=Q[b]?d.setReserved(b,c):d.h[b]=c;null==a&&(a=this.cachedAnimations,null!=Q[""]?a.setReserved("",c):a.h[""]=c);return c},makeAnimation:function(a){for(var b=new Hf(a.name,a.frames,a.sampling),c=0,d=[],e=[],f=0,g=a.objects;f<g.length;){var h=g[f];++f;var k=b.addObject(h.name,0),l=1;0!=(h.flags&1<<Ka.SingleFrame._hx_index)?(k.layout|=1<<da.SingleFrame._hx_index,d.push(k),l=0):e.push(k);0!=(h.flags&1<<Ka.HasPosition._hx_index)&&(k.layout|=1<<da.Position._hx_index,
c+=3*l);0!=(h.flags&1<<Ka.HasRotation._hx_index)&&(k.layout|=1<<da.Rotation._hx_index,c+=3*l);0!=(h.flags&1<<Ka.HasScale._hx_index)&&(k.layout|=1<<da.Scale._hx_index,c+=3*l);0!=(h.flags&1<<Ka.HasUV._hx_index)&&(k.layout|=1<<da.UV._hx_index,c+=2*l);0!=(h.flags&1<<Ka.HasAlpha._hx_index)&&(k.layout|=1<<da.Alpha._hx_index,c+=l);if(0!=(h.flags&1<<Ka.HasProps._hx_index))for(var m=0,n=h.props.length;m<n;){var p=m++,q=k;0<p&&(q=b.addObject(h.name,0),0==l?d.push(q):e.push(q));q.layout|=1<<da.Property._hx_index;
q.propName=h.props[p];c+=l}}for(g=f=0;g<d.length;)h=d[g],++g,h.dataOffset=f,f+=h.getStride();d=f;for(g=0;g<e.length;)h=e[g],++g,h.dataOffset=f,f+=h.getStride();e=this.resource.entry;e.open();e.skip(this.header.dataPosition+a.dataPosition);a=new N(new ArrayBuffer(4*(c*a.frames+d)));e.read(a,0,a.length);e.close();b.setData(new Float32Array(a.b.buffer),c);return b},makeLinearAnimation:function(a){var b=new Kg(a.name,a.frames,a.sampling),c=this.resource.entry;c.open();c.skip(this.header.dataPosition+
a.dataPosition);for(var d=0,e=a.objects;d<e.length;){var f=e[d];++d;var g=0!=(f.flags&1<<Ka.HasPosition._hx_index),h=0!=(f.flags&1<<Ka.HasRotation._hx_index),k=0!=(f.flags&1<<Ka.HasScale._hx_index);if(g||h||k){var l=a.frames;0!=(f.flags&1<<Ka.SingleFrame._hx_index)&&(l=1);var m=Array(l),n=4*((g?3:0)+(h?3:0)+(k?3:0))*l,p=new N(new ArrayBuffer(n));c.read(p,0,n);for(var q=n=0;q<l;){var r=q++,s=new nj;g?(s.tx=p.getFloat(n),n+=4,s.ty=p.getFloat(n),n+=4,s.tz=p.getFloat(n),n+=4):(s.tx=0,s.ty=0,s.tz=0);if(h){s.qx=
p.getFloat(n);n+=4;s.qy=p.getFloat(n);n+=4;s.qz=p.getFloat(n);var n=n+4,u=1-(s.qx*s.qx+s.qy*s.qy+s.qz*s.qz);s.qw=0>u?-Math.sqrt(-u):Math.sqrt(u)}else s.qx=0,s.qy=0,s.qz=0,s.qw=1;k?(s.sx=p.getFloat(n),n+=4,s.sy=p.getFloat(n),n+=4,s.sz=p.getFloat(n),n+=4):(s.sx=1,s.sy=1,s.sz=1);m[r]=s}b.addCurve(f.name,m,!0,h,k)}if(0!=(f.flags&1<<Ka.HasUV._hx_index)){g=Array(2*a.frames);k=8*a.frames;h=new N(new ArrayBuffer(k));c.read(h,0,k);k=0;for(m=g.length;k<m;)p=k++,g[p]=h.getFloat(4*p);b.addUVCurve(f.name,g)}if(0!=
(f.flags&1<<Ka.HasAlpha._hx_index)){g=Array(a.frames);k=4*a.frames;h=new N(new ArrayBuffer(k));c.read(h,0,k);k=0;for(m=g.length;k<m;)p=k++,g[p]=h.getFloat(4*p);b.addAlphaCurve(f.name,g)}if(0!=(f.flags&1<<Ka.HasProps._hx_index)){g=0;for(h=f.props;g<h.length;){k=h[g];++g;m=Array(a.frames);n=4*a.frames;p=new N(new ArrayBuffer(n));c.read(p,0,n);n=0;for(q=m.length;n<q;)l=n++,m[l]=p.getFloat(4*l);b.addPropCurve(f.name,k,m)}}}c.close();return b},loadSkin:function(a,b){if(null==b.vertexWeights){b.vertexCount=
a.vertexCount;var c=this.getBuffers(a,[new gd("weights",3)]).vertexes;b.vertexWeights=Array(b.vertexCount*b.bonesPerVertex);b.vertexJoints=Array(b.vertexCount*b.bonesPerVertex);for(var d=0,e=b.vertexWeights.length;d<e;){var f=d++;b.vertexWeights[f]=c[f]}c=this.getBuffers(a,[new gd("indexes",9)]).vertexes;e=d=0;for(f=b.vertexCount;e<f;){var g=e++,g=this.ftoint32(c[g]);b.vertexJoints[d++]=g&255;b.vertexJoints[d++]=g>>8&255;b.vertexJoints[d++]=g>>16&255}}},ftoint32:function(a){this.tmp.setFloat(0,a);
return this.tmp.getInt32(0)},__class__:Wj};var xd=function(a){this.i=a};r["hxd.fmt.hmd.Reader"]=xd;xd.__name__="hxd.fmt.hmd.Reader";xd.prototype={readProperty:function(){var a=this.i.readByte();switch(a){case 0:return oi.CameraFOVY(this.i.readFloat());case 1:throw new q("Obsolete HasMaterialFlags");case 2:return oi.HasExtraTextures;default:throw new q("Unknown property #"+a);}},readProps:function(){if(1==this.version)return null;var a=this.i.readByte();if(0==a)return null;for(var b=[],c=0;c<a;)c++,
b.push(this.readProperty());return b},readName:function(){var a=this.i.readByte();return 255==a?null:this.i.readString(a)},readCachedName:function(){var a=this.readName();if(null==a)return null;null==xd.HMD_STRINGS&&(xd.HMD_STRINGS=new ga);var b=xd.HMD_STRINGS,b=null!=Q[a]?b.getReserved(a):b.h[a];if(null!=b)return b;b=xd.HMD_STRINGS;null!=Q[a]?b.setReserved(a,a):b.h[a]=a;return a},readPosition:function(a){null==a&&(a=!0);var b=new $g;b.x=this.i.readFloat();b.y=this.i.readFloat();b.z=this.i.readFloat();
b.qx=this.i.readFloat();b.qy=this.i.readFloat();b.qz=this.i.readFloat();a?(b.sx=this.i.readFloat(),b.sy=this.i.readFloat(),b.sz=this.i.readFloat()):(b.sx=1,b.sy=1,b.sz=1);return b},readBounds:function(){var a=new Hb;a.xMin=this.i.readFloat();a.yMin=this.i.readFloat();a.zMin=this.i.readFloat();a.xMax=this.i.readFloat();a.yMax=this.i.readFloat();a.zMax=this.i.readFloat();return a},readSkin:function(){var a=this.readCachedName();if(null==a)return null;var b=new Qj;b.props=this.readProps();b.name=a;b.joints=
[];for(var a=0,c=this.i.readUInt16();a<c;){a++;var d=new Oj;d.props=this.readProps();d.name=this.readCachedName();var e=this.i.readUInt16(),f=0!=(e&32768);f&&(e&=32767);d.parent=e-1;d.position=this.readPosition(f);d.bind=this.i.readUInt16()-1;0<=d.bind&&(d.transpos=this.readPosition(f));b.joints.push(d)}a=this.i.readByte();if(0<a){b.split=[];for(c=0;c<a;){c++;d=new Pj;d.materialIndex=this.i.readByte();for(var e=[],f=0,g=this.i.readByte();f<g;)f++,e.push(this.i.readUInt16());d.joints=e;b.split.push(d)}}return b},
readHeader:function(){var a=new pi,b=this.i.readString(3);if("HMD"!=b){if(59==v.cca(b,0))throw new q("FBX was not converted to HMD");throw new q("Invalid HMD header "+encodeURIComponent(b));}this.version=this.i.readByte();if(3<this.version)throw new q("Can't read HMD v"+this.version);a.version=this.version;a.geometries=[];a.dataPosition=this.i.readInt32();a.props=this.readProps();for(var b=0,c=this.i.readInt32();b<c;){b++;var d=new Mj;d.props=this.readProps();d.vertexCount=this.i.readInt32();d.vertexStride=
this.i.readByte();for(var e=[],f=0,g=this.i.readByte();f<g;){f++;var h=this.readCachedName(),k=this.i.readByte();e.push(new gd(h,k))}d.vertexFormat=e;d.vertexPosition=this.i.readInt32();e=[];f=0;for(g=this.i.readByte();f<g;)f++,e.push(this.i.readInt32());d.indexCounts=e;d.indexPosition=this.i.readInt32();d.bounds=this.readBounds();a.geometries.push(d)}a.materials=[];b=0;for(c=this.i.readInt32();b<c;)b++,d=new Nj,d.props=this.readProps(),d.name=this.readName(),d.diffuseTexture=this.readName(),d.blendMode=
xd.BLEND[this.i.readByte()],this.i.readByte(),this.i.readFloat(),null!=d.props&&0<=d.props.indexOf(oi.HasExtraTextures)&&(d.specularTexture=this.readName(),d.normalMap=this.readName()),a.materials.push(d);a.models=[];b=0;for(c=this.i.readInt32();b<c;)if(b++,d=new Rj,d.props=this.readProps(),d.name=this.readCachedName(),d.parent=this.i.readInt32()-1,d.follow=this.readCachedName(),d.position=this.readPosition(),d.geometry=this.i.readInt32()-1,a.models.push(d),!(0>d.geometry)){d.materials=[];e=0;for(f=
this.i.readByte();e<f;)e++,d.materials.push(this.i.readInt32());d.skin=this.readSkin()}a.animations=[];b=0;for(c=this.i.readInt32();b<c;){b++;d=new Uj;d.props=this.readProps();d.name=this.readName();d.frames=this.i.readInt32();d.sampling=this.i.readFloat();d.speed=this.i.readFloat();e=this.i.readByte();d.loop=0!=(e&1);d.dataPosition=this.i.readInt32();d.objects=[];f=0;for(g=this.i.readInt32();f<g;)if(f++,h=new Sj,h.name=this.readCachedName(),k=this.i.readByte(),null==k&&(k=0),h.flags=k,d.objects.push(h),
0!=(h.flags&1<<Ka.HasProps._hx_index)){for(var k=[],l=0,m=this.i.readByte();l<m;)l++,k.push(this.readName());h.props=k}if(0!=(e&2)){d.events=[];e=0;for(f=this.i.readInt32();e<f;)e++,g=new Tj,g.frame=this.i.readInt32(),g.data=this.readCachedName(),d.events.push(g)}a.animations.push(d)}return a},read:function(){var a=this.readHeader();a.data=this.i.read(this.i.readInt32());return a},__class__:xd};var ri=function(){};r["hxd.fs.FileEntry"]=ri;ri.__name__="hxd.fs.FileEntry";ri.prototype={getSign:function(){return 0},
getBytes:function(){return null},getText:function(){return this.getBytes().toString()},open:function(){},skip:function(a){},readByte:function(){return 0},read:function(a,b,c){},close:function(){},load:function(a){if(this.get_isAvailable())null!=a&&a();else throw new q("load() not implemented");},loadBitmap:function(a){throw new q("loadBitmap() not implemented");},watch:function(a){},exists:function(a){return!1},get:function(a){return null},iterator:function(){return null},get_isAvailable:function(){return!0},
get_isDirectory:function(){return!1},get_size:function(){return 0},get_path:function(){throw new q("path() not implemented");},get_directory:function(){var a=this.get_path().split("/");a.pop();return a.join("/")},get_extension:function(){var a=this.name.split(".");return 1==a.length?"":a.pop().toLowerCase()},__class__:ri};var si=function(a,b){this.fullPath=a;this.name=a.split("/").pop();this.bytes=b};r["hxd.fs.BytesFileEntry"]=si;si.__name__="hxd.fs.BytesFileEntry";si.__super__=ri;si.prototype=J(ri.prototype,
{get_path:function(){return this.fullPath},getSign:function(){return this.bytes.b[0]|this.bytes.b[1]<<8|this.bytes.b[2]<<16|this.bytes.b[3]<<24},getBytes:function(){return this.bytes},open:function(){this.pos=0},skip:function(a){this.pos+=a},readByte:function(){return this.bytes.b[this.pos++]},read:function(a,b,c){a.blit(b,this.bytes,this.pos,c);this.pos+=c},close:function(){},load:function(a){de.delay(a,1)},loadBitmap:function(a){var b;switch(ta.extension(this.fullPath).toLowerCase()){case "gif":b=
"image/gif";break;case "jpeg":case "jpg":b="image/jpeg";break;case "png":b="image/png";break;default:throw new q("Cannot determine image encoding, try adding an extension to the resource path");}var c=new Image;c.onload=function(){a(c)};var d=od.encode(this.bytes);c.src="data:"+b+";base64,"+d},exists:function(a){return!1},get:function(a){return null},iterator:function(){return new Xj([])},get_size:function(){return this.bytes.length},__class__:si});var ti=function(){};r["hxd.fs.FileSystem"]=ti;ti.__name__=
"hxd.fs.FileSystem";ti.__isInterface__=!0;ti.prototype={__class__:ti};var ah=function(){};r["hxd.fs.BytesFileSystem"]=ah;ah.__name__="hxd.fs.BytesFileSystem";ah.__interfaces__=[ti];ah.prototype={getRoot:function(){throw new q("Not implemented");},getBytes:function(a){throw new q("Not implemented");},exists:function(a){return null!=this.getBytes(a)},get:function(a){var b=this.getBytes(a);if(null==b)throw new q("Resource not found '"+a+"'");return new si(a,b)},dispose:function(){},dir:function(a){throw new q("Not implemented");
},__class__:ah};var bh=function(a){this.f=a;a.open()};r["hxd.fs.FileInput"]=bh;bh.__name__="hxd.fs.FileInput";bh.__super__=ig;bh.prototype=J(ig.prototype,{skip:function(a){this.f.skip(a)},readByte:function(){return this.f.readByte()},readBytes:function(a,b,c){this.f.read(a,b,c);return c},close:function(){this.f.close()},__class__:bh});var ui={};r["hxd.fs._LoadedBitmap.LoadedBitmap_Impl_"]=ui;ui.__name__="hxd.fs._LoadedBitmap.LoadedBitmap_Impl_";ui._new=function(a){return a};ui.toBitmap=function(a){var b=
new ud(a.width,a.height);b.ctx.drawImage(a,0,0);return b};ui.toNative=function(a){return a};var xj=function(a){this.path=a};r["hxd.fs.NotFound"]=xj;xj.__name__="hxd.fs.NotFound";xj.prototype={toString:function(){return"Resource file not found '"+this.path+"'"},__class__:xj};var Yj={};r["hxd.impl._Allocator.BufferFlags_Impl_"]=Yj;Yj.__name__="hxd.impl._Allocator.BufferFlags_Impl_";Yj.toInt=function(a){return a};var Md=function(){};r["hxd.impl.Allocator"]=Md;Md.__name__="hxd.impl.Allocator";Md.set=
function(a){Md.inst=a};Md.get=function(){null==Md.inst&&(Md.inst=new Md);return Md.inst};Md.prototype={allocBuffer:function(a,b,c){var d;switch(c){case 0:d=[ba.Dynamic];break;case 1:d=[ba.UniformBuffer,ba.Dynamic]}return new hb(a,b,d)},disposeBuffer:function(a){a.dispose()},allocIndexBuffer:function(a){return new md(a)},disposeIndexBuffer:function(a){a.dispose()},onContextLost:function(){},allocFloats:function(a){null==a&&(a=0);return Ob._new(a)},disposeFloats:function(a){},allocIndexes:function(a){null==
a&&(a=0);return Array(a)},disposeIndexes:function(a){},__class__:Md};var Uk=function(){};r["hxd.impl.Api"]=Uk;Uk.__name__="hxd.impl.Api";Uk.downcast=function(a,b){return ia.__downcastCheck(a,b)?a:null};var Jk=function(a){this.i=0;this.a=a;this.l=this.a.length};r["hxd.impl.ArrayIterator"]=Jk;Jk.__name__="hxd.impl.ArrayIterator";Jk.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Jk};var Ih=function(a){this.i=0;this.a=a;this.l=this.a.length};r["hxd.impl.ArrayIterator_h2d_Object"]=
Ih;Ih.__name__="hxd.impl.ArrayIterator_h2d_Object";Ih.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Ih};var zj=function(a){this.i=0;this.a=a;this.l=this.a.length};r["hxd.impl.ArrayIterator_h3d_scene_Object"]=zj;zj.__name__="hxd.impl.ArrayIterator_h3d_scene_Object";zj.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:zj};var Xj=function(a){this.i=0;this.a=a;this.l=this.a.length};r["hxd.impl.ArrayIterator_hxd_fs_FileEntry"]=
Xj;Xj.__name__="hxd.impl.ArrayIterator_hxd_fs_FileEntry";Xj.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Xj};var Zj=function(a){this.i=0;this.a=a;this.l=this.a.length};r["hxd.impl.ArrayIterator_hxd_res_Any"]=Zj;Zj.__name__="hxd.impl.ArrayIterator_hxd_res_Any";Zj.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Zj};var ak=function(a){this.i=0;this.a=a;this.l=this.a.length};r["hxd.impl.ArrayIterator_hxd_snd_Channel"]=
ak;ak.__name__="hxd.impl.ArrayIterator_hxd_snd_Channel";ak.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:ak};var vi={};r["hxd.impl._UncheckedBytes.UncheckedBytes_Impl_"]=vi;vi.__name__="hxd.impl._UncheckedBytes.UncheckedBytes_Impl_";vi._new=function(a){return a};vi.get=function(a,b){return a[b]};vi.set=function(a,b,c){return a[b]=c};vi.fromBytes=function(a){return a.b};var Wi=function(a){this.url=a};r["hxd.net.BinaryLoader"]=Wi;Wi.__name__=
"hxd.net.BinaryLoader";Wi.prototype={onLoaded:function(a){},onProgress:function(a,b){},onError:function(a){throw new q(a);},load:function(){var a=this,b=new XMLHttpRequest;b.open("GET",this.url,!0);b.responseType="arraybuffer";b.onerror=function(c){a.onError(b.statusText)};b.onload=function(c){if(200!=b.status)a.onError(b.statusText);else a.onLoaded(N.ofData(b.response))};b.onprogress=function(b){a.onProgress(b.loaded||b.position|0,b.total||b.totalSize|0)};b.send()},__class__:Wi};var wi=function(a,
b){this.path=a;this.bytes=b};r["hxd.res._Any.SingleFileSystem"]=wi;wi.__name__="hxd.res._Any.SingleFileSystem";wi.__super__=ah;wi.prototype=J(ah.prototype,{getBytes:function(a){return a==this.path?this.bytes:null},__class__:wi});var kc=function(a){this.entry=a};r["hxd.res.Resource"]=kc;kc.__name__="hxd.res.Resource";kc.prototype={get_name:function(){return this.entry.name},toString:function(){return this.entry.get_path()},watch:function(a){kc.LIVE_UPDATE&&this.entry.watch(a)},__class__:kc};var Wd=
function(a,b){this.entry=b;this.loader=a};r["hxd.res.Any"]=Wd;Wd.__name__="hxd.res.Any";Wd.fromBytes=function(a,b){var c=new wi(a,b);return(new Pd(c)).load(a)};Wd.__super__=kc;Wd.prototype=J(kc.prototype,{toModel:function(){return this.loader.loadCache(this.entry.get_path(),xi)},toTexture:function(){return this.toImage().toTexture()},toTile:function(){return this.toImage().toTile()},toText:function(){return this.entry.getBytes().toString()},toImage:function(){return this.loader.loadCache(this.entry.get_path(),
Jc)},toSound:function(){return this.loader.loadCache(this.entry.get_path(),Ce)},toPrefab:function(){return this.loader.loadCache(this.entry.get_path(),kc)},to:function(a){return this.loader.loadCache(this.entry.get_path(),a)},iterator:function(){for(var a=[],b=this.entry.iterator();b.i<b.l;){var c=b.a[b.i++];a.push(new Wd(this.loader,c))}return new Zj(a)},__class__:Wd});var yi=function(a){this.entry=a;this.loader=Pd.currentInstance};r["hxd.res.BitmapFont"]=yi;yi.__name__="hxd.res.BitmapFont";yi.__super__=
kc;yi.prototype=J(kc.prototype,{toFont:function(){null==this.font&&(this.font=Lj.parse(this.entry.getBytes(),this.entry.get_path(),z(this,this.resolveTile)));return this.font},toSdfFont:function(a,b,c,d){null==d&&(d=0.03125);null==c&&(c=0.5);null==b&&(b=0);null==this.sdfFonts&&(this.sdfFonts=[]);null==a&&(a=this.toFont().size);for(var e=0,f=this.sdfFonts;e<f.length;){var g=f[e];++e;var h=g.type;if(1==h._hx_index){var k=h.smoothing,l=h.alphaCutoff,h=h.channel;if(g.size==a&&h==b&&l==c&&k==d)return g}}e=
Lj.parse(this.entry.getBytes(),this.entry.get_path(),z(this,this.resolveSdfTile));e.type=Bk.SignedDistanceField(b,c,d);e.resizeTo(a);this.sdfFonts.push(e);return e},resolveSdfTile:function(a){a=this.loader.load(a).toTexture();a.set_filter(Jd.Linear);return fa.fromTexture(a)},resolveTile:function(a){return this.loader.load(a).toTile()},__class__:yi});var th=function(){};r["hxd.res.DefaultFont"]=th;th.__name__="hxd.res.DefaultFont";th.get=function(){var a=X.CURRENT,b=a.resCache.h[th.__id__];if(null==
b){var b=Wd.fromBytes("hxd/res/defaultFont.png",Tb.run("s3176:iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAACPBJREFUeJztnelypDoMRp2p%:6v3PNjhrlCLX1aLIPBPlWppI03bCG0QOfn8:m0zbr8KupnS9FDqRKAzUOhAvBRfqO:tfrSZ86H:ET79o6Rhc%JzzNSD7Xn:XyEH9RPtP4X:6GDDj6ttR:Hb62d9pmX8b487StA4:DFlup5z5MSWS%tL:f6eG4BXDppGQdtApJEtPm0zkf427Oo1fAxtfO2hDIruGXCLgnAD:jNyzSsKxa18yBphyqQ1jqwBN1zHmgcU3V3jHui9xaArkS0%XzTohOX%jvGauzvjMrlUJXuqSeV07G0ekgTovWS1t61vr0CQAez7nkj7uFIELJqmdN7RWvzil7hnnXV5qLOzSMAmlcQub9ZRuEsaNoq0w5RZbN0rye1ASzplWyAiGEXQVK3kZOdRcgy9:FLoRogI02WNc7rRQw3jzsZAfWB7skR44%3jdo6Wv2qfr4rFuUCZlftrT1jjpezSih4b75ClQDMvrizz%82uA1wMCqsKvUv3YO045rxma2vjY3mpPUvuV1WKDzbLtqfNu9:AjA6tl69QM3Zn1Wfl1M8G:CUW4s6b%sWIEXWtM:omNeXrnaDRm:OyIsE1UOfQ1gCwMOLdFCqWnj8Grl5nsjVakRjHMj1DgnEcQvw%OV0AE0wGisfqTKrbBYrZ4BiB:T4ldE8dPsMxU2oEWgZZtoAyMCq2GxtLlWCFbEB%PGIYWv1kxECq0%TbDKITjpirVr9SW2zC:skqqKdUp%QwwbILKwlgZk2mkBlmUVgPPOI3IbL0GwASY2PiMdbPrfVF6:vVctIq5SoVqNdxtrvWXt1:EguYHVL:ZV4Q8F781%KVwD25r8UagTyYE4TjkllmfrU4udtI%XZdrRcm5c1T%3cPXjq9RqEYTewIrau1a%ODVSBomgeL4cLudedG%H2pah4KBQx8gSnWMC:8AvDKwS0fXU5n59Uf7gAXA1dfG1TtM1Bm2ZtKi%PCGaVlpXKrf67ngeI%uFXoW1WdvNH0ztuV3vNBvAOrC30wR0LG7kX0:p3MjoCqPYfiQNI3BK%BEhq31vfYtS5UkN5lCD%NGWMSBxAWyyeyKkAJYc2Z6JrfqpvGYF0IzxqNWoDoPrSeNJ8POMgtJg76rtSEyDNErGzUF5F3ZOq9wI2D%VtbuBsaFfkNGwBGMtUmy3BjUAtxs3x3LOk8mi7zWB6Xw7leCNlb%LRXkrk%wEOpESIlezxlvM%uSWuzQXNx1Ofjqd5Aah:qW5PGDfbjpZzRCGlbwZ5T0TqMHMVoLgCP56Nj0fqo7mhLOeMGoDPx4wE0sW64mRmXLSDaCZvxPjSeNnAGKx:hxcw8%a3Zkc7tTqjyWgbs:4d3w8wW:7AC42l3zF:dH9H9SGedwO9rmEEz4nMpCXuznFoSS5tf9x9e24ByFjqodKAQio6EjfP9C8duzLHoZ0r8oD%LzRyAZY1XN2umux8n0L3OkeygcdnDzMYTSvQvc47G7g4q3xL2EqE8jhbAN6H9YDJ6TaxBeCduJNy3AjkrghySay8QXOU84lZSQ8plj:ioYuIG%axvLUrcoRxHHGHXelgKzkTWSxtLK:7whM8UaGLzs3qJ7P5IxNI0axh%hbAgxhWMGJ01M%KVKIASXQcipVR7MEz524XboQNoKVwPZPNhkpRjD5yRdM53B0c0qKDvE4X9PVw78JYWPc7usEo9cm1TAa0%R:hh44n1UXz1sjaB0dbJATdGoB:R1Dv:c4DGktSez33TNqW96MZtVo:R53sPLQxvGseCWu7y2d7Kji70MgQRUIwM5nNb%1bc8HyK%MAHiMtq2q5ypaOS39rdTz9jMaac4kg87eDpSsp4%bx:iS3UZLOqMQPM44Y3jGuSoCVabERyaCsj:90qs7TG1soWePZbICViWharvnSgrfTwYsz0gjckvUApHcDOdwa9waDvIGjCFZ:2vwzfVeGj7W%qs4ns0ettbMASJvG:WfJ%JAGHOVvI6GSxtMEUfNENK%FH%NtNaz1qzif7B79mcC2AdbG8zVxyNqMtrGkTQqZWmHUqvJjDJg%BZ9Rf552I8qtY%a:jUMnEG3j9V1RvWgUryfqFyXql1etX2aP:vGER8JWCCLdxhME4OlMbWTdLQCRhA%qX1WegVrZEbtjCjQjsDnKM200Y8nLjDaAx%WdVgg8:zfQY%1620Q8grcxpRDcfQvwMN2ivYm7s4GSRkGZLuRvV5T3AP1tAe08q8qtY38KJo4Ejgglbxh3awCJQyL35l:AjAKwN:5CKozAqpRm7zibBBUCMDJFi:p5GlMKcJUbGAm4aIkdlPCpttK9xz1RxMhzAdVCkDmnE5H:GURPXLta7ypHcz248%GLWR6Q%cL7ZdHRVOddWHPt1VRWX6O1mERXuNt6HmBmooGXnlB178MX3vIr5nhCejkUbf7VhgyalyWwngcjqsorxxg5xy%oDeDZ:Du0Qub%2aP6M%XVfSFK90D6ihjranoC2pUgUVVe0VdUw2bmeEKyASx1OwvWfQ7dPqi1XlFe1Vd0nbu1C:%HEeEObuSH:LyRKzSW6QZKvjDXDNKxqvIsR19a:624vKKvW9Zy5nTw5swQO2zGbODmDNdmpWwBmJ%hNo7n7WAJ5L703FN4DD:Sr3RcK6uar0XVnHvHUbHeDqadawaLFA3jbTwW6tH2aC%5oqgfLXYRGcOab5SKOVvz8sY75AneZATyQd:qyt1ByFjkGoCrR6u8gXLtc2tn:51qD22s7Pwi5Z5jEryNtS6jy6U5qfS8HZwFTWp0ogWdj3Wu0nmPWJ8K3HO62gvoul:dhKbBPPWmp:fdwBXwXNGa8TY92ruBzVG%GpoqnUXtp9CeCdza4JvZLhDqyqb3hT8RRDtH5VmyavKKREn0XCW1f3WiDKWmpTpf7GTQc:F6OpCdC3guJdp5C8CzkTY9JAg8Ekh:bxaAPxVMf28WgP7XMMrWAovwhO8I2gxkC8DibAFYnC0Ai6OFgjeL4Pmm0M2L0dzAzSJY2cDNy:E8ELJ5MdsLWJwtAIuzBWBxtgAszhaAxdkCsDi:AYnqZwd25SoPAAAAAElFTkSuQmCC")),
c=Wd.fromBytes("hxd/res/defaultFont.fnt",Tb.run("s14030:PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPEZvbnQgc2l6ZT0iMTIiIGZhbWlseT0iUGl4ZWwgT3BlcmF0b3IiIGhlaWdodD0iMTYiIHN0eWxlPSJSZWd1bGFyIj4KIDxDaGFyIHdpZHRoPSI0IiBvZmZzZXQ9IjAgMTMiIHJlY3Q9IjEgMTIgMCAwIiBjb2RlPSIgIi8%CiA8Q2hhciB3aWR0aD0iMyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjIgMyAxIDkiIGNvZGU9IiEiLz4KIDxDaGFyIHdpZHRoPSI1IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNCAzIDMgMyIgY29kZT0iJnF1b3Q7Ii8%CiA8Q2hhciB3aWR0aD0iOCIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjggMyA2IDkiIGNvZGU9IiMiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgMiIgcmVjdD0iMTUgMSA1IDEzIiBjb2RlPSIkIi8%CiA8Q2hhciB3aWR0aD0iOSIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjIxIDMgNyA5IiBjb2RlPSIlIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjI5IDMgNSA5IiBjb2RlPSImYW1wOyIvPgogPENoYXIgd2lkdGg9IjMiIG9mZnNldD0iMSA0IiByZWN0PSIzNSAzIDEgMyIgY29kZT0iJyIvPgogPENoYXIgd2lkdGg9IjUiIG9mZnNldD0iMSA0IiByZWN0PSIzNyAzIDMgOSIgY29kZT0iKCIvPgogPENoYXIgd2lkdGg9IjUiIG9mZnNldD0iMSA0IiByZWN0PSI0MSAzIDMgOSIgY29kZT0iKSIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSI0NSAzIDUgNSIgY29kZT0iKiIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA2IiByZWN0PSI1MSA1IDUgNSIgY29kZT0iKyIvPgogPENoYXIgd2lkdGg9IjMiIG9mZnNldD0iMCAxMiIgcmVjdD0iNTcgMTEgMiAzIiBjb2RlPSIsIi8%CiA8Q2hhciB3aWR0aD0iNiIgb2Zmc2V0PSIxIDgiIHJlY3Q9IjYwIDcgNCAxIiBjb2RlPSItIi8%CiA8Q2hhciB3aWR0aD0iMyIgb2Zmc2V0PSIxIDEyIiByZWN0PSI2NSAxMSAxIDEiIGNvZGU9Ii4iLz4KIDxDaGFyIHdpZHRoPSI1IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNjcgMyAzIDkiIGNvZGU9Ii8iLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNzEgMyA1IDkiIGNvZGU9IjAiLz4KIDxDaGFyIHdpZHRoPSI1IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNzcgMyAzIDkiIGNvZGU9IjEiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iODEgMyA1IDkiIGNvZGU9IjIiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iODcgMyA1IDkiIGNvZGU9IjMiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iOTMgMyA1IDkiIGNvZGU9IjQiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iOTkgMyA1IDkiIGNvZGU9IjUiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMTA1IDMgNSA5IiBjb2RlPSI2Ii8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjExMSAzIDUgOSIgY29kZT0iNyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSIxMTcgMyA1IDkiIGNvZGU9IjgiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMSAxNSA1IDkiIGNvZGU9IjkiLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjEgNiIgcmVjdD0iNyAxNyAxIDciIGNvZGU9IjoiLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjAgNiIgcmVjdD0iOSAxNyAyIDkiIGNvZGU9IjsiLz4KIDxDaGFyIHdpZHRoPSI1IiBvZmZzZXQ9IjEgNiIgcmVjdD0iMTIgMTcgMyA1IiBjb2RlPSImbHQ7Ii8%CiA8Q2hhciB3aWR0aD0iNiIgb2Zmc2V0PSIxIDciIHJlY3Q9IjE2IDE4IDQgMyIgY29kZT0iPSIvPgogPENoYXIgd2lkdGg9IjUiIG9mZnNldD0iMSA2IiByZWN0PSIyMSAxNyAzIDUiIGNvZGU9Ij4iLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMjUgMTUgNSA5IiBjb2RlPSI:Ii8%CiA8Q2hhciB3aWR0aD0iOSIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjMxIDE1IDcgOSIgY29kZT0iQCIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSIzOSAxNSA1IDkiIGNvZGU9IkEiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNDUgMTUgNSA5IiBjb2RlPSJCIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjUxIDE1IDUgOSIgY29kZT0iQyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSI1NyAxNSA1IDkiIGNvZGU9IkQiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNjMgMTUgNSA5IiBjb2RlPSJFIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjY5IDE1IDUgOSIgY29kZT0iRiIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSI3NSAxNSA1IDkiIGNvZGU9IkciLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iODEgMTUgNSA5IiBjb2RlPSJIIi8%CiA8Q2hhciB3aWR0aD0iMyIgb2Zmc2V0PSIxIDQiIHJlY3Q9Ijg3IDE1IDEgOSIgY29kZT0iSSIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSI4OSAxNSA1IDkiIGNvZGU9IkoiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iOTUgMTUgNSA5IiBjb2RlPSJLIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjEwMSAxNSA1IDkiIGNvZGU9IkwiLz4KIDxDaGFyIHdpZHRoPSI5IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMTA3IDE1IDcgOSIgY29kZT0iTSIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSIxMTUgMTUgNSA5IiBjb2RlPSJOIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjEyMSAxNSA1IDkiIGNvZGU9Ik8iLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMSAyNyA1IDkiIGNvZGU9IlAiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNyAyNyA1IDkiIGNvZGU9IlEiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMTMgMjcgNSA5IiBjb2RlPSJSIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjE5IDI3IDUgOSIgY29kZT0iUyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSIyNSAyNyA1IDkiIGNvZGU9IlQiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMzEgMjcgNSA5IiBjb2RlPSJVIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjM3IDI3IDUgOSIgY29kZT0iViIvPgogPENoYXIgd2lkdGg9IjkiIG9mZnNldD0iMSA0IiByZWN0PSI0MyAyNyA3IDkiIGNvZGU9IlciLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNTEgMjcgNSA5IiBjb2RlPSJYIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjU3IDI3IDUgOSIgY29kZT0iWSIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSI2MyAyNyA1IDkiIGNvZGU9IloiLz4KIDxDaGFyIHdpZHRoPSI1IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNjkgMjcgMyA5IiBjb2RlPSJbIi8%CiA8Q2hhciB3aWR0aD0iNSIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjczIDI3IDMgOSIgY29kZT0iXCIvPgogPENoYXIgd2lkdGg9IjUiIG9mZnNldD0iMSA0IiByZWN0PSI3NyAyNyAzIDkiIGNvZGU9Il0iLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iODEgMjcgNSAzIiBjb2RlPSJeIi8%CiA8Q2hhciB3aWR0aD0iNSIgb2Zmc2V0PSIwIDE0IiByZWN0PSI4NyAzNyA1IDEiIGNvZGU9Il8iLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjAgNCIgcmVjdD0iOTMgMjcgMiAyIiBjb2RlPSJgIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDYiIHJlY3Q9Ijk2IDI5IDUgNyIgY29kZT0iYSIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSIxMDIgMjcgNSA5IiBjb2RlPSJiIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjEwOCAyOSA1IDciIGNvZGU9ImMiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMTE0IDI3IDUgOSIgY29kZT0iZCIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA2IiByZWN0PSIxMjAgMjkgNSA3IiBjb2RlPSJlIi8%CiA8Q2hhciB3aWR0aD0iNiIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjEgMzkgNSA5IiBjb2RlPSJmIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjcgNDEgNSA5IiBjb2RlPSJnIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjEzIDM5IDUgOSIgY29kZT0iaCIvPgogPENoYXIgd2lkdGg9IjMiIG9mZnNldD0iMSA0IiByZWN0PSIxOSAzOSAxIDkiIGNvZGU9ImkiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMjEgMzkgNSAxMSIgY29kZT0iaiIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSIyNyAzOSA1IDkiIGNvZGU9ImsiLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjEgNCIgcmVjdD0iMzMgMzkgMSA5IiBjb2RlPSJsIi8%CiA8Q2hhciB3aWR0aD0iOSIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjM1IDQxIDcgNyIgY29kZT0ibSIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA2IiByZWN0PSI0MyA0MSA1IDciIGNvZGU9Im4iLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNiIgcmVjdD0iNDkgNDEgNSA3IiBjb2RlPSJvIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjU1IDQxIDUgOSIgY29kZT0icCIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA2IiByZWN0PSI2MSA0MSA1IDkiIGNvZGU9InEiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNiIgcmVjdD0iNjcgNDEgNSA3IiBjb2RlPSJyIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjczIDQxIDUgNyIgY29kZT0icyIvPgogPENoYXIgd2lkdGg9IjYiIG9mZnNldD0iMSA1IiByZWN0PSI3OSA0MCA1IDgiIGNvZGU9InQiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNiIgcmVjdD0iODUgNDEgNSA3IiBjb2RlPSJ1Ii8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjkxIDQxIDUgNyIgY29kZT0idiIvPgogPENoYXIgd2lkdGg9IjkiIG9mZnNldD0iMSA2IiByZWN0PSI5NyA0MSA3IDciIGNvZGU9InciLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNiIgcmVjdD0iMTA1IDQxIDUgNyIgY29kZT0ieCIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA2IiByZWN0PSIxMTEgNDEgNSA5IiBjb2RlPSJ5Ii8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjExNyA0MSA1IDciIGNvZGU9InoiLz4KIDxDaGFyIHdpZHRoPSI2IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMSA1NCA0IDkiIGNvZGU9InsiLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjEgNCIgcmVjdD0iNiA1NCAxIDkiIGNvZGU9InwiLz4KIDxDaGFyIHdpZHRoPSI2IiBvZmZzZXQ9IjEgNCIgcmVjdD0iOCA1NCA0IDkiIGNvZGU9In0iLz4KIDxDaGFyIHdpZHRoPSI4IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMTMgNTQgNiAyIiBjb2RlPSJ%Ii8%CiA8Q2hhciB3aWR0aD0iMyIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjIwIDU2IDEgOSIgY29kZT0iwqEiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMjIgNTQgNSAxMSIgY29kZT0iwqIiLz4KIDxDaGFyIHdpZHRoPSI4IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMjggNTQgNiA5IiBjb2RlPSLCoyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSIzNSA1NCA1IDkiIGNvZGU9IsKlIi8%CiA8Q2hhciB3aWR0aD0iMyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjQxIDU0IDEgOSIgY29kZT0iwqYiLz4KIDxDaGFyIHdpZHRoPSI1IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNDMgNTQgMyAxIiBjb2RlPSLCqCIvPgogPENoYXIgd2lkdGg9IjkiIG9mZnNldD0iMSA0IiByZWN0PSI0NyA1NCA3IDkiIGNvZGU9IsKpIi8%CiA8Q2hhciB3aWR0aD0iOCIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjU1IDU2IDYgNSIgY29kZT0iwqsiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgOCIgcmVjdD0iNjIgNTggNSAzIiBjb2RlPSLCrCIvPgogPENoYXIgd2lkdGg9IjYiIG9mZnNldD0iMSA0IiByZWN0PSI2OCA1NCA0IDQiIGNvZGU9IsKwIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjczIDU2IDUgNyIgY29kZT0iwrEiLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjEgNCIgcmVjdD0iNzkgNTQgMiAyIiBjb2RlPSLCtCIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA2IiByZWN0PSI4MiA1NiA1IDkiIGNvZGU9IsK1Ii8%CiA8Q2hhciB3aWR0aD0iOCIgb2Zmc2V0PSIxIDQiIHJlY3Q9Ijg4IDU0IDcgOSIgY29kZT0iwrYiLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjEgOCIgcmVjdD0iOTYgNTggMSAxIiBjb2RlPSLCtyIvPgogPENoYXIgd2lkdGg9IjUiIG9mZnNldD0iMCAxMyIgcmVjdD0iOTggNjMgMyAyIiBjb2RlPSLCuCIvPgogPENoYXIgd2lkdGg9IjgiIG9mZnNldD0iMSA2IiByZWN0PSIxMDIgNTYgNiA1IiBjb2RlPSLCuyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA2IiByZWN0PSIxMDkgNTYgNSA5IiBjb2RlPSLCvyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAxIiByZWN0PSIxMTUgNTEgNSAxMiIgY29kZT0iw4AiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgMSIgcmVjdD0iMTIxIDUxIDUgMTIiIGNvZGU9IsOBIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDEiIHJlY3Q9IjEgNjcgNSAxMiIgY29kZT0iw4IiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgMSIgcmVjdD0iNyA2NyA2IDEyIiBjb2RlPSLDgyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAyIiByZWN0PSIxNCA2OCA1IDExIiBjb2RlPSLDhCIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAwIiByZWN0PSIyMCA2NiA1IDEzIiBjb2RlPSLDhSIvPgogPENoYXIgd2lkdGg9IjExIiBvZmZzZXQ9IjEgNCIgcmVjdD0iMjYgNzAgOSA5IiBjb2RlPSLDhiIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSIzNiA3MCA1IDExIiBjb2RlPSLDhyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAxIiByZWN0PSI0MiA2NyA1IDEyIiBjb2RlPSLDiCIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAxIiByZWN0PSI0OCA2NyA1IDEyIiBjb2RlPSLDiSIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAxIiByZWN0PSI1NCA2NyA1IDEyIiBjb2RlPSLDiiIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAyIiByZWN0PSI2MCA2OCA1IDExIiBjb2RlPSLDiyIvPgogPENoYXIgd2lkdGg9IjMiIG9mZnNldD0iMCAxIiByZWN0PSI2NiA2NyAyIDEyIiBjb2RlPSLDjCIvPgogPENoYXIgd2lkdGg9IjMiIG9mZnNldD0iMSAxIiByZWN0PSI2OSA2NyAyIDEyIiBjb2RlPSLDjSIvPgogPENoYXIgd2lkdGg9IjMiIG9mZnNldD0iMCAxIiByZWN0PSI3MiA2NyAzIDEyIiBjb2RlPSLDjiIvPgogPENoYXIgd2lkdGg9IjMiIG9mZnNldD0iMCAyIiByZWN0PSI3NiA2OCAzIDExIiBjb2RlPSLDjyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMCA0IiByZWN0PSI4MCA3MCA2IDkiIGNvZGU9IsOQIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDEiIHJlY3Q9Ijg3IDY3IDYgMTIiIGNvZGU9IsORIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDEiIHJlY3Q9Ijk0IDY3IDUgMTIiIGNvZGU9IsOSIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDEiIHJlY3Q9IjEwMCA2NyA1IDEyIiBjb2RlPSLDkyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAxIiByZWN0PSIxMDYgNjcgNSAxMiIgY29kZT0iw5QiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgMSIgcmVjdD0iMTEyIDY3IDYgMTIiIGNvZGU9IsOVIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDIiIHJlY3Q9IjExOSA2OCA1IDExIiBjb2RlPSLDliIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA2IiByZWN0PSIxIDg3IDUgNSIgY29kZT0iw5ciLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjAgNCIgcmVjdD0iNyA4NSA3IDkiIGNvZGU9IsOYIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDEiIHJlY3Q9IjE1IDgyIDUgMTIiIGNvZGU9IsOZIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDEiIHJlY3Q9IjIxIDgyIDUgMTIiIGNvZGU9IsOaIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDEiIHJlY3Q9IjI3IDgyIDUgMTIiIGNvZGU9IsObIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDIiIHJlY3Q9IjMzIDgzIDUgMTEiIGNvZGU9IsOcIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDEiIHJlY3Q9IjM5IDgyIDUgMTIiIGNvZGU9IsOdIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjQ1IDg1IDUgOSIgY29kZT0iw54iLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iNTEgODUgNSA5IiBjb2RlPSLDnyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAzIiByZWN0PSI1NyA4NCA1IDEwIiBjb2RlPSLDoCIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAzIiByZWN0PSI2MyA4NCA1IDEwIiBjb2RlPSLDoSIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAzIiByZWN0PSI2OSA4NCA1IDEwIiBjb2RlPSLDoiIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAzIiByZWN0PSI3NSA4NCA2IDEwIiBjb2RlPSLDoyIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSI4MiA4NSA1IDkiIGNvZGU9IsOkIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDIiIHJlY3Q9Ijg4IDgzIDUgMTEiIGNvZGU9IsOlIi8%CiA8Q2hhciB3aWR0aD0iMTEiIG9mZnNldD0iMSA2IiByZWN0PSI5NCA4NyA5IDciIGNvZGU9IsOmIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDYiIHJlY3Q9IjEwNCA4NyA1IDkiIGNvZGU9IsOnIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDMiIHJlY3Q9IjExMCA4NCA1IDEwIiBjb2RlPSLDqCIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSAzIiByZWN0PSIxMTYgODQgNSAxMCIgY29kZT0iw6kiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgMyIgcmVjdD0iMSA5NyA1IDEwIiBjb2RlPSLDqiIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSI3IDk4IDUgOSIgY29kZT0iw6siLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjAgMyIgcmVjdD0iMTMgOTcgMiAxMCIgY29kZT0iw6wiLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjEgMyIgcmVjdD0iMTYgOTcgMiAxMCIgY29kZT0iw60iLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjAgMyIgcmVjdD0iMTkgOTcgMyAxMCIgY29kZT0iw64iLz4KIDxDaGFyIHdpZHRoPSIzIiBvZmZzZXQ9IjAgNCIgcmVjdD0iMjMgOTggMyA5IiBjb2RlPSLDryIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSIyNyA5OCA2IDkiIGNvZGU9IsOwIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDMiIHJlY3Q9IjM0IDk3IDYgMTAiIGNvZGU9IsOxIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDMiIHJlY3Q9IjQxIDk3IDUgMTAiIGNvZGU9IsOyIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDMiIHJlY3Q9IjQ3IDk3IDUgMTAiIGNvZGU9IsOzIi8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDMiIHJlY3Q9IjUzIDk3IDUgMTAiIGNvZGU9IsO0Ii8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDMiIHJlY3Q9IjU5IDk3IDYgMTAiIGNvZGU9IsO1Ii8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjY2IDk4IDUgOSIgY29kZT0iw7YiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNiIgcmVjdD0iNzIgMTAwIDUgNSIgY29kZT0iw7ciLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjAgNiIgcmVjdD0iNzggMTAwIDcgNyIgY29kZT0iw7giLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgMyIgcmVjdD0iODYgOTcgNSAxMCIgY29kZT0iw7kiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgMyIgcmVjdD0iOTIgOTcgNSAxMCIgY29kZT0iw7oiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgMyIgcmVjdD0iOTggOTcgNSAxMCIgY29kZT0iw7siLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgNCIgcmVjdD0iMTA0IDk4IDUgOSIgY29kZT0iw7wiLz4KIDxDaGFyIHdpZHRoPSI3IiBvZmZzZXQ9IjEgMyIgcmVjdD0iMTEwIDk3IDUgMTIiIGNvZGU9IsO9Ii8%CiA8Q2hhciB3aWR0aD0iNyIgb2Zmc2V0PSIxIDQiIHJlY3Q9IjExNiA5OCA1IDExIiBjb2RlPSLDviIvPgogPENoYXIgd2lkdGg9IjciIG9mZnNldD0iMSA0IiByZWN0PSIxIDExMCA1IDExIiBjb2RlPSLDvyIvPgo8L0ZvbnQ%Cg")),
c=new yi(c.entry);c.loader=b.loader;b=c.toFont();a.resCache.set(th,b)}return b};var al=function(){};r["hxd.res.Embed"]=al;al.__name__="hxd.res.Embed";var df={};r["hxd.res._Image.ImageFormat_Impl_"]=df;df.__name__="hxd.res._Image.ImageFormat_Impl_";df.get_useAsyncDecode=function(a){return 0==a};df.toInt=function(a){return a};var Jc=function(a){this.entry=a};r["hxd.res.Image"]=Jc;Jc.__name__="hxd.res.Image";Jc.__super__=kc;Jc.prototype=J(kc.prototype,{getFormat:function(){this.getSize();return this.inf.format},
getSize:function(){if(null!=this.inf)return this.inf;var a=new bh(this.entry),b=0,c=0,d,e=0;try{d=a.readUInt16()}catch(f){if($.lastException=f,(f instanceof q?f.val:f)instanceof qd)d=0;else throw f;}switch(d){case 17476:d=4;a.skip(10);c=a.readInt32();b=a.readInt32();a.skip(64);var g=a.readInt32();switch(g&16777215){case 4805697:switch((g>>>24)-48){case 1:e=4;break;case 2:e=5;break;default:e=0}break;case 5527620:switch((g>>>24)-48){case 1:e=1;break;case 2:case 3:e=2;break;case 4:case 5:e=3;break;default:e=
0}break;default:if(808540228==g)switch(a.skip(40),e=a.readInt32(),e){case 95:e=6;break;case 98:e=7;break;default:throw new q(this.entry.get_path()+" has unsupported DXGI format "+e);}}if(0==e)throw new q(this.entry.get_path()+" has unsupported 4CC "+String.fromCodePoint(g&255)+String.fromCodePoint(g>>8&255)+String.fromCodePoint(g>>16&255)+String.fromCodePoint(g>>>24));break;case 18759:d=2;a.readInt32();b=a.readUInt16();c=a.readUInt16();break;case 20617:d=1;a.set_bigEndian(!0);for(a.skip(6);;){g=a.readInt32();
if(1229472850==a.readInt32()){b=a.readInt32();c=a.readInt32();break}a.skip(g+4)}break;case 55551:d=0;a.set_bigEndian(!0);a:for(;;)switch(a.readUInt16()){case 65472:case 65473:case 65474:a.readUInt16();a.readByte();c=a.readUInt16();b=a.readUInt16();break a;default:a.skip(a.readUInt16()-2)}break;default:if("tga"==this.entry.get_extension())d=3,a.skip(10),b=a.readUInt16(),c=a.readUInt16();else throw new q("Unsupported texture format "+this.entry.get_path());}a.close();return this.inf={width:b,height:c,
format:d,bc:e}},getPixels:function(a,b){this.getSize();var c;switch(this.inf.format){case 0:c=this.entry.getBytes();var d;try{d=La.decode(c)}catch(e){throw $.lastException=e,c=e instanceof q?e.val:e,new q("Failed to decode JPG "+this.entry.get_path()+" ("+n.string(c)+")");}c=new Ba(d.width,d.height,d.pixels,ha.BGRA);break;case 1:c=this.entry.getBytes();d=new aj(new Vb(c));d.checkCRC=!1;c=Ba.alloc(this.inf.width,this.inf.height,ha.BGRA);d=d.read();yc.extract32(d,c.bytes,b);b&&(c.flags|=1<<Ua.FlipY._hx_index);
break;case 2:c=this.entry.getBytes();c=(new Yi(new Vb(c))).read();c=new Ba(this.inf.width,this.inf.height,Jb.extractFullBGRA(c,0),ha.BGRA);break;case 3:c=this.entry.getBytes();d=(new fj(new Vb(c))).read();if(d.header.imageType!=Ec.UncompressedTrueColor||32!=d.header.bitsPerPixel)throw new q("Not supported "+n.string(d.header.imageType)+"/"+d.header.bitsPerPixel);var f=d.header.width,g=d.header.height;c=Ba.alloc(f,g,ha.ARGB);for(var h=ni.fromPixels(c),k=0;k<g;)for(var l=k++,m=0,p=f;m<p;){var r=m++,
s=d.imageData[r+l*f];h.bytes.setInt32((r+l*h.width<<2)+h.offset,s>>>24|s>>8&65280|s<<8&16711680|s<<24)}switch(d.header.imageOrigin._hx_index){case 0:c.flags|=1<<Ua.FlipY._hx_index;break;case 2:break;default:throw new q("Not supported "+n.string(d.header.imageOrigin));}break;case 4:c=this.entry.getBytes(),c=new Ba(this.inf.width,this.inf.height,c,ha.S3TC(this.inf.bc),128+(6<=this.inf.bc?20:0))}null!=a&&c.convert(a);null!=b&&c.setFlip(b);return c},toBitmap:function(){this.getSize();var a=new ud(this.inf.width,
this.inf.height),b=this.getPixels();a.setPixels(b);b.dispose();return a},watchCallb:function(){var a=this.inf.width,b=this.inf.height;this.inf=null;var c=this.getSize();(a!=c.width||b!=c.height)&&this.tex.resize(a,b);this.tex.realloc=null;this.loadTexture()},loadTexture:function(){var a=this;if(0!=this.getFormat()&&!Jc.DEFAULT_ASYNC){var b=function(){a.tex.alloc();var b=a.getPixels(a.tex.format);(b.width!=a.tex.width||b.height!=a.tex.height)&&b.makeSquare();a.tex.uploadPixels(b);b.dispose();a.tex.realloc=
z(a,a.loadTexture);Jc.ENABLE_AUTO_WATCH&&a.watch(z(a,a.watchCallb))};this.entry.get_isAvailable()?b():this.entry.load(b)}else this.tex.flags|=1<<V.Loading._hx_index,this.entry.loadBitmap(function(b){b=ui.toBitmap(b);a.tex.alloc();if(b.ctx.canvas.width!=a.tex.width||b.ctx.canvas.height!=a.tex.height){var d=b.getPixels();d.makeSquare();a.tex.uploadPixels(d);d.dispose()}else a.tex.uploadBitmap(b);b.ctx=null;b.pixel=null;a.tex.realloc=z(a,a.loadTexture);a.tex.flags&=-1-(1<<V.Loading._hx_index);if(null!=
a.tex.waitLoads){b=a.tex.waitLoads;a.tex.waitLoads=null;for(d=0;d<b.length;){var e=b[d];++d;e()}}Jc.ENABLE_AUTO_WATCH&&a.watch(z(a,a.watchCallb))})},toTexture:function(){if(null!=this.tex)return this.tex;this.getSize();var a=this.inf.width,b=this.inf.height;if(!Jc.ALLOW_NPOT){for(var c=1,d=1;c<a;)c<<=1;for(;d<b;)d<<=1;a=c;b=d}c=S.nativeFormat;4==this.inf.format&&(c=ha.S3TC(this.inf.bc));this.tex=new S(a,b,[V.NoAlloc],c);Jc.DEFAULT_FILTER!=Jd.Linear&&this.tex.set_filter(Jc.DEFAULT_FILTER);this.tex.setName(this.entry.get_path());
this.loadTexture();return this.tex},toTile:function(){var a=this.getSize();return fa.fromTexture(this.toTexture()).sub(0,0,a.width,a.height)},__class__:Jc});var Pd=function(a){this.fs=a;this.cache=new ga};r["hxd.res.Loader"]=Pd;Pd.__name__="hxd.res.Loader";Pd.prototype={cleanCache:function(){this.cache=new ga},dir:function(a){var b=[];a=this.fs.dir(a);for(var c=0;c<a.length;){var d=a[c];++c;b.push(new Wd(this,d))}return b},exists:function(a){return this.fs.exists(a)},load:function(a){return new Wd(this,
this.fs.get(a))},loadCache:function(a,b){var c=this.cache,c=null!=Q[a]?c.getReserved(a):c.h[a];if(null==c){var c=this.fs.get(a),d=Pd.currentInstance;Pd.currentInstance=this;c=Fa.createInstance(b,[c]);Pd.currentInstance=d;d=this.cache;null!=Q[a]?d.setReserved(a,c):d.h[a]=c}else if(null==(ia.__downcastCheck(c,b)?c:null))throw new q(a+" has been reintrepreted from "+n.string(ia.getClass(c))+" to "+n.string(b));return c},dispose:function(){this.cleanCache();this.fs.dispose()},__class__:Pd};var xi=function(a){this.entry=
a};r["hxd.res.Model"]=xi;xi.__name__="hxd.res.Model";xi.__super__=kc;xi.prototype=J(kc.prototype,{toHmd:function(){var a=new bh(this.entry),b=(new xd(a)).readHeader();a.close();return new Wj(this,b)},__class__:xi});var Kk=K["hxd.res.Filter"]={__ename__:!0,__constructs__:["Fast","Chromatic"],Fast:{_hx_index:0,__enum__:"hxd.res.Filter",toString:m},Chromatic:{_hx_index:1,__enum__:"hxd.res.Filter",toString:m}};Kk.__empty_constructs__=[Kk.Fast,Kk.Chromatic];var bk={};r["hxd.res._NanoJpeg.FastBytes_Impl_"]=
bk;bk.__name__="hxd.res._NanoJpeg.FastBytes_Impl_";bk._new=function(a){return a};bk.get=function(a,b){return a.b[b]};bk.set=function(a,b,c){a.b[b]=c};var ch=function(){};r["hxd.res._NanoJpeg.Component"]=ch;ch.__name__="hxd.res._NanoJpeg.Component";ch.prototype={__class__:ch};var La=function(){this.comps=[new ch,new ch,new ch].slice(0);this.qtab=[Array(64),Array(64),Array(64),Array(64)].slice(0);this.counts=Array(16);this.block=Array(64);this.njZZ=[0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,
33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63].slice(0);this.vlctab=[null,null,null,null,null,null,null,null].slice(0)};r["hxd.res.NanoJpeg"]=La;La.__name__="hxd.res.NanoJpeg";La.CF=function(a){a=a+64>>7;return 0>a?0:255<a?255:a};La.njClip=function(a){return 0>a?0:255<a?255:a};La.decode=function(a,b,c,d){null==d&&(d=-1);null==c&&(c=0);null==La.inst&&(La.inst=new La);La.inst.njInit(a,c,d,b);return La.inst.njDecode()};
La.prototype={alloc:function(a){return new N(new ArrayBuffer(a))},free:function(a){},njInit:function(a,b,c,d){this.bytes=a;this.pos=b;this.filter=null==d?Kk.Chromatic:d;0>c&&(c=a.length-b);null==this.vlctab[0]&&(this.vlctab[0]=new N(new ArrayBuffer(131072)));null==this.vlctab[1]&&(this.vlctab[1]=new N(new ArrayBuffer(131072)));null==this.vlctab[2]&&(this.vlctab[2]=new N(new ArrayBuffer(131072)));null==this.vlctab[3]&&(this.vlctab[3]=new N(new ArrayBuffer(131072)));this.size=c;this.bufbits=this.buf=
this.length=this.rstinterval=this.qtavail=this.qtused=0;this.progressive=!1;this.comps[0].dcpred=0;this.comps[1].dcpred=0;this.comps[2].dcpred=0},cleanup:function(){this.bytes=null;for(var a=0,b=this.comps;a<b.length;){var c=b[a];++a;null!=c.pixels&&(c.pixels=null)}null!=this.vlctab[0]&&(this.vlctab[0]=null);null!=this.vlctab[1]&&(this.vlctab[1]=null);null!=this.vlctab[2]&&(this.vlctab[2]=null);null!=this.vlctab[3]&&(this.vlctab[3]=null);null!=this.vlctab[4]&&(this.vlctab[4]=null);null!=this.vlctab[5]&&
(this.vlctab[5]=null);null!=this.vlctab[6]&&(this.vlctab[6]=null);null!=this.vlctab[7]&&(this.vlctab[7]=null)},njSkip:function(a){this.pos+=a;this.size-=a;this.length-=a},syntax:function(a){},get:function(a){return this.bytes.b[this.pos+a]},njDecode16:function(a){return this.bytes.b[this.pos+a]<<8|this.bytes.b[this.pos+(a+1)]},njByteAlign:function(){this.bufbits&=248},njShowBits:function(a){if(0==a)return 0;for(;this.bufbits<a;)if(0>=this.size)this.buf=this.buf<<8|255,this.bufbits+=8;else{var b=this.bytes.b[this.pos];
this.pos++;this.size--;this.bufbits+=8;this.buf=this.buf<<8|b;if(255==b)switch(b=this.bytes.b[this.pos],this.pos++,this.size--,b){case 217:this.size=0;break;case 0:case 255:break;default:this.buf=this.buf<<8|b,this.bufbits+=8}}return this.buf>>this.bufbits-a&(1<<a)-1},njSkipBits:function(a){this.bufbits<a&&this.njShowBits(a);this.bufbits-=a},njGetBits:function(a){var b=this.njShowBits(a);this.bufbits-=a;return b},njDecodeLength:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+
1];this.pos+=2;this.size-=2;this.length-=2},njSkipMarker:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];this.pos+=2;this.size-=2;var a=this.length-=2;this.pos+=a;this.size-=a;this.length-=a},njDecodeSOF:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];this.pos+=2;this.size-=2;this.length-=2;8!=this.bytes.b[this.pos]&&this.notSupported();this.height=this.bytes.b[this.pos+1]<<8|this.bytes.b[this.pos+2];this.width=this.bytes.b[this.pos+3]<<8|this.bytes.b[this.pos+
4];this.ncomp=this.bytes.b[this.pos+5];this.pos+=6;this.size-=6;this.length-=6;switch(this.ncomp){case 1:case 3:break;default:this.notSupported()}for(var a=0,b=0,c=0,d=this.ncomp;c<d;){var e=c++,e=this.comps[e];e.cid=this.bytes.b[this.pos];e.ssx=this.bytes.b[this.pos+1]>>4;0!=(e.ssx&e.ssx-1)&&this.notSupported();e.ssy=this.bytes.b[this.pos+1]&15;0!=(e.ssy&e.ssy-1)&&this.notSupported();e.qtsel=this.bytes.b[this.pos+2];this.pos+=3;this.size-=3;this.length-=3;this.qtused|=1<<e.qtsel;e.ssx>a&&(a=e.ssx);
e.ssy>b&&(b=e.ssy)}1==this.ncomp&&(c=this.comps[0],a=b=1,c.ssx=c.ssy=a);this.mbsizex=a<<3;this.mbsizey=b<<3;this.mbwidth=(this.width+this.mbsizex-1)/this.mbsizex|0;this.mbheight=(this.height+this.mbsizey-1)/this.mbsizey|0;c=0;for(d=this.ncomp;c<d;)e=c++,e=this.comps[e],e.width=(this.width*e.ssx+a-1)/a|0,e.stride=e.width+7&2147483640,e.height=(this.height*e.ssy+b-1)/b|0,e.stride=this.mbwidth*this.mbsizex*e.ssx/a|0,(3>e.width&&e.ssx!=a||3>e.height&&e.ssy!=b)&&this.notSupported(),e.pixels=new N(new ArrayBuffer(e.stride*
(this.mbheight*this.mbsizey*e.ssy/b|0)));a=this.length;this.pos+=a;this.size-=a;this.length-=a},njDecodeDQT:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];this.pos+=2;this.size-=2;for(this.length-=2;65<=this.length;){var a=this.bytes.b[this.pos];this.qtavail|=1<<a;for(var a=this.qtab[a],b=0;64>b;){var c=b++;a[c]=this.bytes.b[this.pos+(c+1)]}this.pos+=65;this.size-=65;this.length-=65}},njDecodeDHT:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];
this.pos+=2;this.size-=2;for(this.length-=2;17<=this.length;){var a=this.bytes.b[this.pos],a=a>>4&1|(a&3)<<1;this.counts[0]=this.bytes.b[this.pos+1];this.counts[1]=this.bytes.b[this.pos+2];this.counts[2]=this.bytes.b[this.pos+3];this.counts[3]=this.bytes.b[this.pos+4];this.counts[4]=this.bytes.b[this.pos+5];this.counts[5]=this.bytes.b[this.pos+6];this.counts[6]=this.bytes.b[this.pos+7];this.counts[7]=this.bytes.b[this.pos+8];this.counts[8]=this.bytes.b[this.pos+9];this.counts[9]=this.bytes.b[this.pos+
10];this.counts[10]=this.bytes.b[this.pos+11];this.counts[11]=this.bytes.b[this.pos+12];this.counts[12]=this.bytes.b[this.pos+13];this.counts[13]=this.bytes.b[this.pos+14];this.counts[14]=this.bytes.b[this.pos+15];this.counts[15]=this.bytes.b[this.pos+16];this.pos+=17;this.size-=17;this.length-=17;for(var a=this.vlctab[a],b=0,c=65536,d=65536,e=1;17>e;){var f=e++,d=d>>1,g=this.counts[f-1];if(0!=g){for(var c=c-(g<<16-f),h=0,k=g;h<k;)for(var l=h++,l=this.bytes.b[this.pos+l],m=0,n=d;m<n;)m++,a.b[b++]=
f,a.b[b++]=l;this.pos+=g;this.size-=g;this.length-=g}}for(;0!=c--;)a.b[b]=0,b+=2}},njDecodeDRI:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];this.pos+=2;this.size-=2;this.length-=2;this.rstinterval=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];var a=this.length;this.pos+=a;this.size-=a;this.length-=a},njGetVLC:function(a){var b=this.njShowBits(16),c=a.b[b<<1];this.bufbits<c&&this.njShowBits(c);this.bufbits-=c;this.vlcCode=b=a.b[b<<1|1];c=b&15;if(0==c)return 0;a=this.njShowBits(c);
this.bufbits-=c;b=a;b<1<<c-1&&(b+=(-1<<c)+1);return b},njRowIDCT:function(a){var b=this.block[a+4]<<11,c=this.block[a+6],d=this.block[a+2],e=this.block[a+1],f=this.block[a+7],g=this.block[a+5],h=this.block[a+3];if(0==(b|c|d|e|f|g|h))b=this.block[a+7]=this.block[a]<<3,b=this.block[a+6]=b,b=this.block[a+5]=b,b=this.block[a+4]=b,b=this.block[a+3]=b,b=this.block[a+2]=b,b=this.block[a+1]=b,this.block[a]=b;else{var k=(this.block[a]<<11)+128,l=565*(e+f),e=l+2276*e,f=l-3406*f,l=2408*(g+h),g=l-799*g,h=l-4017*
h,l=k+b,k=k-b,b=1108*(d+c),c=b-3784*c,d=b+1568*d,b=e+g,e=e-g,g=f+h,f=f-h,h=l+d,l=l-d,d=k+c,k=k-c,c=181*(e+f)+128>>8,e=181*(e-f)+128>>8;this.block[a]=h+b>>8;this.block[a+1]=d+c>>8;this.block[a+2]=k+e>>8;this.block[a+3]=l+g>>8;this.block[a+4]=l-g>>8;this.block[a+5]=k-e>>8;this.block[a+6]=d-c>>8;this.block[a+7]=h-b>>8}},njColIDCT:function(a,b,c,d){var e=this.block[a+32]<<8,f=this.block[a+48],g=this.block[a+16],h=this.block[a+8],k=this.block[a+56],l=this.block[a+40],m=this.block[a+24];if(0==(e|f|g|h|
k|l|m))e=(this.block[a]+32>>6)+128,e=0>e?0:255<e?255:e,b.b[c]=e,c+=d,b.b[c]=e,c+=d,b.b[c]=e,c+=d,b.b[c]=e,c+=d,b.b[c]=e,c+=d,b.b[c]=e,c+=d,b.b[c]=e,b.b[c+d]=e;else{a=(this.block[a]<<8)+8192;var n=565*(h+k)+4,h=n+2276*h>>3,k=n-3406*k>>3,n=2408*(l+m)+4,l=n-799*l>>3,m=n-4017*m>>3,n=a+e;a-=e;e=1108*(g+f)+4;f=e-3784*f>>3;g=e+1568*g>>3;e=h+l;h-=l;l=k+m;k-=m;m=n+g;n-=g;g=a+f;a-=f;f=181*(h+k)+128>>8;h=181*(h-k)+128>>8;k=(m+e>>14)+128;b.b[c]=0>k?0:255<k?255:k;c+=d;k=(g+f>>14)+128;b.b[c]=0>k?0:255<k?255:k;
c+=d;k=(a+h>>14)+128;b.b[c]=0>k?0:255<k?255:k;c+=d;k=(n+l>>14)+128;b.b[c]=0>k?0:255<k?255:k;c+=d;l=(n-l>>14)+128;b.b[c]=0>l?0:255<l?255:l;c+=d;h=(a-h>>14)+128;b.b[c]=0>h?0:255<h?255:h;c+=d;f=(g-f>>14)+128;b.b[c]=0>f?0:255<f?255:f;c+=d;d=(m-e>>14)+128;b.b[c]=0>d?0:255<d?255:d}},njDecodeBlock:function(a,b){for(var c=a.pixels,d,e=0,f=0;64>f;){var g=f++;this.block[g]=0}var h=a.dcpred,k=this.vlctab[a.dctabsel],l=this.njShowBits(16),m=k.b[l<<1];this.bufbits<m&&this.njShowBits(m);this.bufbits-=m;this.vlcCode=
l=k.b[l<<1|1];var m=l&15,n;if(0==m)n=0;else{var p=this.njShowBits(m);this.bufbits-=m;l=p;l<1<<m-1&&(l+=(-1<<m)+1);n=l}a.dcpred=h+n;var q=this.qtab[a.qtsel],r=this.vlctab[a.actabsel];for(this.block[0]=a.dcpred*q[0];;){var s=this.njShowBits(16),u=r.b[s<<1];this.bufbits<u&&this.njShowBits(u);this.bufbits-=u;this.vlcCode=s=r.b[s<<1|1];u=s&15;if(0==u)d=0;else{var w=this.njShowBits(u);this.bufbits-=u;s=w;s<1<<u-1&&(s+=(-1<<u)+1);d=s}if(0==this.vlcCode)break;e+=(this.vlcCode>>4)+1;this.block[this.njZZ[e]]=
d*q[e];if(!(63>e))break}var y,A,B=this.block[4]<<11,v=this.block[6],F=this.block[2],G=this.block[1],z=this.block[7],I=this.block[5],J=this.block[3];if(0==(B|v|F|G|z|I|J)){var K=this.block[7]=this.block[0]<<3,L=this.block[6]=K,Q=this.block[5]=L,N=this.block[4]=Q,O=this.block[3]=N,T=this.block[2]=O,V=this.block[1]=T;this.block[0]=V}else y=(this.block[0]<<11)+128,A=565*(G+z),G=A+2276*G,z=A-3406*z,A=2408*(I+J),I=A-799*I,J=A-4017*J,A=y+B,y-=B,B=1108*(F+v),v=B-3784*v,F=B+1568*F,B=G+I,G-=I,I=z+J,z-=J,J=
A+F,A-=F,F=y+v,y-=v,v=181*(G+z)+128>>8,G=181*(G-z)+128>>8,this.block[0]=J+B>>8,this.block[1]=F+v>>8,this.block[2]=y+G>>8,this.block[3]=A+I>>8,this.block[4]=A-I>>8,this.block[5]=y-G>>8,this.block[6]=F-v>>8,this.block[7]=J-B>>8;var S,R,P=this.block[12]<<11,X=this.block[14],Y=this.block[10],U=this.block[9],Z=this.block[15],W=this.block[13],aa=this.block[11];if(0==(P|X|Y|U|Z|W|aa)){var ca=this.block[15]=this.block[8]<<3,ba=this.block[14]=ca,ea=this.block[13]=ba,ja=this.block[12]=ea,ia=this.block[11]=
ja,ma=this.block[10]=ia,qa=this.block[9]=ma;this.block[8]=qa}else S=(this.block[8]<<11)+128,R=565*(U+Z),U=R+2276*U,Z=R-3406*Z,R=2408*(W+aa),W=R-799*W,aa=R-4017*aa,R=S+P,S-=P,P=1108*(Y+X),X=P-3784*X,Y=P+1568*Y,P=U+W,U-=W,W=Z+aa,Z-=aa,aa=R+Y,R-=Y,Y=S+X,S-=X,X=181*(U+Z)+128>>8,U=181*(U-Z)+128>>8,this.block[8]=aa+P>>8,this.block[9]=Y+X>>8,this.block[10]=S+U>>8,this.block[11]=R+W>>8,this.block[12]=R-W>>8,this.block[13]=S-U>>8,this.block[14]=Y-X>>8,this.block[15]=aa-P>>8;var ga,$,ka=this.block[20]<<11,
la=this.block[22],Xa=this.block[18],da=this.block[17],pa=this.block[23],na=this.block[21],ha=this.block[19];if(0==(ka|la|Xa|da|pa|na|ha)){var wa=this.block[23]=this.block[16]<<3,za=this.block[22]=wa,Ba=this.block[21]=za,ua=this.block[20]=Ba,D=this.block[19]=ua,Ha=this.block[18]=D,Fa=this.block[17]=Ha;this.block[16]=Fa}else ga=(this.block[16]<<11)+128,$=565*(da+pa),da=$+2276*da,pa=$-3406*pa,$=2408*(na+ha),na=$-799*na,ha=$-4017*ha,$=ga+ka,ga-=ka,ka=1108*(Xa+la),la=ka-3784*la,Xa=ka+1568*Xa,ka=da+na,
da-=na,na=pa+ha,pa-=ha,ha=$+Xa,$-=Xa,Xa=ga+la,ga-=la,la=181*(da+pa)+128>>8,da=181*(da-pa)+128>>8,this.block[16]=ha+ka>>8,this.block[17]=Xa+la>>8,this.block[18]=ga+da>>8,this.block[19]=$+na>>8,this.block[20]=$-na>>8,this.block[21]=ga-da>>8,this.block[22]=Xa-la>>8,this.block[23]=ha-ka>>8;var fa,ra,xa=this.block[28]<<11,ta=this.block[30],ya=this.block[26],sa=this.block[25],Ea=this.block[31],Ca=this.block[29],Da=this.block[27];if(0==(xa|ta|ya|sa|Ea|Ca|Da)){var Ma=this.block[31]=this.block[24]<<3,Pa=this.block[30]=
Ma,Sa=this.block[29]=Pa,Qa=this.block[28]=Sa,Oa=this.block[27]=Qa,Ga=this.block[26]=Oa,Ya=this.block[25]=Ga;this.block[24]=Ya}else fa=(this.block[24]<<11)+128,ra=565*(sa+Ea),sa=ra+2276*sa,Ea=ra-3406*Ea,ra=2408*(Ca+Da),Ca=ra-799*Ca,Da=ra-4017*Da,ra=fa+xa,fa-=xa,xa=1108*(ya+ta),ta=xa-3784*ta,ya=xa+1568*ya,xa=sa+Ca,sa-=Ca,Ca=Ea+Da,Ea-=Da,Da=ra+ya,ra-=ya,ya=fa+ta,fa-=ta,ta=181*(sa+Ea)+128>>8,sa=181*(sa-Ea)+128>>8,this.block[24]=Da+xa>>8,this.block[25]=ya+ta>>8,this.block[26]=fa+sa>>8,this.block[27]=ra+
Ca>>8,this.block[28]=ra-Ca>>8,this.block[29]=fa-sa>>8,this.block[30]=ya-ta>>8,this.block[31]=Da-xa>>8;var Ka,Aa,fb=this.block[36]<<11,La=this.block[38],Ra=this.block[34],Ja=this.block[33],Na=this.block[39],bb=this.block[37],Ua=this.block[35];if(0==(fb|La|Ra|Ja|Na|bb|Ua)){var pb=this.block[39]=this.block[32]<<3,va=this.block[38]=pb,oa=this.block[37]=va,Va=this.block[36]=oa,$a=this.block[35]=Va,ob=this.block[34]=$a,yb=this.block[33]=ob;this.block[32]=yb}else Ka=(this.block[32]<<11)+128,Aa=565*(Ja+Na),
Ja=Aa+2276*Ja,Na=Aa-3406*Na,Aa=2408*(bb+Ua),bb=Aa-799*bb,Ua=Aa-4017*Ua,Aa=Ka+fb,Ka-=fb,fb=1108*(Ra+La),La=fb-3784*La,Ra=fb+1568*Ra,fb=Ja+bb,Ja-=bb,bb=Na+Ua,Na-=Ua,Ua=Aa+Ra,Aa-=Ra,Ra=Ka+La,Ka-=La,La=181*(Ja+Na)+128>>8,Ja=181*(Ja-Na)+128>>8,this.block[32]=Ua+fb>>8,this.block[33]=Ra+La>>8,this.block[34]=Ka+Ja>>8,this.block[35]=Aa+bb>>8,this.block[36]=Aa-bb>>8,this.block[37]=Ka-Ja>>8,this.block[38]=Ra-La>>8,this.block[39]=Ua-fb>>8;var Wa,wb,Ta=this.block[44]<<11,xb=this.block[46],ab=this.block[42],Za=
this.block[41],db=this.block[47],hb=this.block[45],ib=this.block[43];if(0==(Ta|xb|ab|Za|db|hb|ib)){var Ab=this.block[47]=this.block[40]<<3,Eb=this.block[46]=Ab,Bb=this.block[45]=Eb,Db=this.block[44]=Bb,Gb=this.block[43]=Db,Hb=this.block[42]=Gb,Ib=this.block[41]=Hb;this.block[40]=Ib}else Wa=(this.block[40]<<11)+128,wb=565*(Za+db),Za=wb+2276*Za,db=wb-3406*db,wb=2408*(hb+ib),hb=wb-799*hb,ib=wb-4017*ib,wb=Wa+Ta,Wa-=Ta,Ta=1108*(ab+xb),xb=Ta-3784*xb,ab=Ta+1568*ab,Ta=Za+hb,Za-=hb,hb=db+ib,db-=ib,ib=wb+ab,
wb-=ab,ab=Wa+xb,Wa-=xb,xb=181*(Za+db)+128>>8,Za=181*(Za-db)+128>>8,this.block[40]=ib+Ta>>8,this.block[41]=ab+xb>>8,this.block[42]=Wa+Za>>8,this.block[43]=wb+hb>>8,this.block[44]=wb-hb>>8,this.block[45]=Wa-Za>>8,this.block[46]=ab-xb>>8,this.block[47]=ib-Ta>>8;var Zb,Kb,sb=this.block[52]<<11,Lb=this.block[54],qb=this.block[50],jb=this.block[49],ub=this.block[55],rb=this.block[53],tb=this.block[51];if(0==(sb|Lb|qb|jb|ub|rb|tb)){var Mb=this.block[55]=this.block[48]<<3,Ob=this.block[54]=Mb,Rb=this.block[53]=
Ob,Sb=this.block[52]=Rb,Tb=this.block[51]=Sb,dc=this.block[50]=Tb,Yb=this.block[49]=dc;this.block[48]=Yb}else Zb=(this.block[48]<<11)+128,Kb=565*(jb+ub),jb=Kb+2276*jb,ub=Kb-3406*ub,Kb=2408*(rb+tb),rb=Kb-799*rb,tb=Kb-4017*tb,Kb=Zb+sb,Zb-=sb,sb=1108*(qb+Lb),Lb=sb-3784*Lb,qb=sb+1568*qb,sb=jb+rb,jb-=rb,rb=ub+tb,ub-=tb,tb=Kb+qb,Kb-=qb,qb=Zb+Lb,Zb-=Lb,Lb=181*(jb+ub)+128>>8,jb=181*(jb-ub)+128>>8,this.block[48]=tb+sb>>8,this.block[49]=qb+Lb>>8,this.block[50]=Zb+jb>>8,this.block[51]=Kb+rb>>8,this.block[52]=
Kb-rb>>8,this.block[53]=Zb-jb>>8,this.block[54]=qb-Lb>>8,this.block[55]=tb-sb>>8;var kb,Wb,zb=this.block[60]<<11,Fb=this.block[62],Qb=this.block[58],Cc=this.block[57],Ub=this.block[63],Vb=this.block[61],Xb=this.block[59];if(0==(zb|Fb|Qb|Cc|Ub|Vb|Xb)){var vc=this.block[63]=this.block[56]<<3,kc=this.block[62]=vc,yc=this.block[61]=kc,Ec=this.block[60]=yc,Gc=this.block[59]=Ec,Jc=this.block[58]=Gc,Nc=this.block[57]=Jc;this.block[56]=Nc}else kb=(this.block[56]<<11)+128,Wb=565*(Cc+Ub),Cc=Wb+2276*Cc,Ub=Wb-
3406*Ub,Wb=2408*(Vb+Xb),Vb=Wb-799*Vb,Xb=Wb-4017*Xb,Wb=kb+zb,kb-=zb,zb=1108*(Qb+Fb),Fb=zb-3784*Fb,Qb=zb+1568*Qb,zb=Cc+Vb,Cc-=Vb,Vb=Ub+Xb,Ub-=Xb,Xb=Wb+Qb,Wb-=Qb,Qb=kb+Fb,kb-=Fb,Fb=181*(Cc+Ub)+128>>8,Cc=181*(Cc-Ub)+128>>8,this.block[56]=Xb+zb>>8,this.block[57]=Qb+Fb>>8,this.block[58]=kb+Cc>>8,this.block[59]=Wb+Vb>>8,this.block[60]=Wb-Vb>>8,this.block[61]=kb-Cc>>8,this.block[62]=Qb-Fb>>8,this.block[63]=Xb-zb>>8;var eb=b,Jb=a.stride,ac,Nb,qc=this.block[32]<<8,bc=this.block[48],Pb=this.block[16],ed=this.block[8],
cc=this.block[56],fc=this.block[40],ec=this.block[24];if(0==(qc|bc|Pb|ed|cc|fc|ec)){var Hc=(this.block[0]+32>>6)+128,qc=0>Hc?0:255<Hc?255:Hc;c.b[eb]=qc;eb+=Jb;c.b[eb]=qc;eb+=Jb;c.b[eb]=qc;eb+=Jb;c.b[eb]=qc;eb+=Jb;c.b[eb]=qc;eb+=Jb;c.b[eb]=qc;eb+=Jb;c.b[eb]=qc;eb+=Jb;c.b[eb]=qc;eb+=Jb}else{ac=(this.block[0]<<8)+8192;Nb=565*(ed+cc)+4;ed=Nb+2276*ed>>3;cc=Nb-3406*cc>>3;Nb=2408*(fc+ec)+4;fc=Nb-799*fc>>3;ec=Nb-4017*ec>>3;Nb=ac+qc;ac-=qc;qc=1108*(Pb+bc)+4;bc=qc-3784*bc>>3;Pb=qc+1568*Pb>>3;qc=ed+fc;ed-=fc;
fc=cc+ec;cc-=ec;ec=Nb+Pb;Nb-=Pb;Pb=ac+bc;ac-=bc;var bc=181*(ed+cc)+128>>8,ed=181*(ed-cc)+128>>8,Lc=(ec+qc>>14)+128;c.b[eb]=0>Lc?0:255<Lc?255:Lc;var eb=eb+Jb,nc=(Pb+bc>>14)+128;c.b[eb]=0>nc?0:255<nc?255:nc;var eb=eb+Jb,md=(ac+ed>>14)+128;c.b[eb]=0>md?0:255<md?255:md;var eb=eb+Jb,fd=(Nb+fc>>14)+128;c.b[eb]=0>fd?0:255<fd?255:fd;var eb=eb+Jb,wd=(Nb-fc>>14)+128;c.b[eb]=0>wd?0:255<wd?255:wd;var eb=eb+Jb,gd=(ac-ed>>14)+128;c.b[eb]=0>gd?0:255<gd?255:gd;var eb=eb+Jb,nd=(Pb-bc>>14)+128;c.b[eb]=0>nd?0:255<nd?
255:nd;var eb=eb+Jb,hd=(ec-qc>>14)+128;c.b[eb]=0>hd?0:255<hd?255:hd}var cb=1+b,lc=a.stride,jc,Oc,Pc=this.block[33]<<8,Me=this.block[49],mc=this.block[17],$c=this.block[9],rd=this.block[57],id=this.block[41],oc=this.block[25];if(0==(Pc|Me|mc|$c|rd|id|oc)){var Zc=(this.block[1]+32>>6)+128,Pc=0>Zc?0:255<Zc?255:Zc;c.b[cb]=Pc;cb+=lc;c.b[cb]=Pc;cb+=lc;c.b[cb]=Pc;cb+=lc;c.b[cb]=Pc;cb+=lc;c.b[cb]=Pc;cb+=lc;c.b[cb]=Pc;cb+=lc;c.b[cb]=Pc;cb+=lc;c.b[cb]=Pc;cb+=lc}else{jc=(this.block[1]<<8)+8192;Oc=565*($c+rd)+
4;$c=Oc+2276*$c>>3;rd=Oc-3406*rd>>3;Oc=2408*(id+oc)+4;id=Oc-799*id>>3;oc=Oc-4017*oc>>3;Oc=jc+Pc;jc-=Pc;Pc=1108*(mc+Me)+4;Me=Pc-3784*Me>>3;mc=Pc+1568*mc>>3;Pc=$c+id;$c-=id;id=rd+oc;rd-=oc;oc=Oc+mc;Oc-=mc;mc=jc+Me;jc-=Me;var Me=181*($c+rd)+128>>8,$c=181*($c-rd)+128>>8,pc=(oc+Pc>>14)+128;c.b[cb]=0>pc?0:255<pc?255:pc;var cb=cb+lc,qd=(mc+Me>>14)+128;c.b[cb]=0>qd?0:255<qd?255:qd;var cb=cb+lc,Dd=(jc+$c>>14)+128;c.b[cb]=0>Dd?0:255<Dd?255:Dd;var cb=cb+lc,sd=(Oc+id>>14)+128;c.b[cb]=0>sd?0:255<sd?255:sd;var cb=
cb+lc,td=(Oc-id>>14)+128;c.b[cb]=0>td?0:255<td?255:td;var cb=cb+lc,Ld=(jc-$c>>14)+128;c.b[cb]=0>Ld?0:255<Ld?255:Ld;var cb=cb+lc,ld=(mc-Me>>14)+128;c.b[cb]=0>ld?0:255<ld?255:ld;var cb=cb+lc,Md=(oc-Pc>>14)+128;c.b[cb]=0>Md?0:255<Md?255:Md}var Ia=2+b,rc=a.stride,tc,je,Qc=this.block[34]<<8,Gd=this.block[50],ic=this.block[18],ke=this.block[10],Ze=this.block[58],uc=this.block[42],Ne=this.block[26];if(0==(Qc|Gd|ic|ke|Ze|uc|Ne)){var ud=(this.block[2]+32>>6)+128,Qc=0>ud?0:255<ud?255:ud;c.b[Ia]=Qc;Ia+=rc;c.b[Ia]=
Qc;Ia+=rc;c.b[Ia]=Qc;Ia+=rc;c.b[Ia]=Qc;Ia+=rc;c.b[Ia]=Qc;Ia+=rc;c.b[Ia]=Qc;Ia+=rc;c.b[Ia]=Qc;Ia+=rc;c.b[Ia]=Qc;Ia+=rc}else{tc=(this.block[2]<<8)+8192;je=565*(ke+Ze)+4;ke=je+2276*ke>>3;Ze=je-3406*Ze>>3;je=2408*(uc+Ne)+4;uc=je-799*uc>>3;Ne=je-4017*Ne>>3;je=tc+Qc;tc-=Qc;Qc=1108*(ic+Gd)+4;Gd=Qc-3784*Gd>>3;ic=Qc+1568*ic>>3;Qc=ke+uc;ke-=uc;uc=Ze+Ne;Ze-=Ne;Ne=je+ic;je-=ic;ic=tc+Gd;tc-=Gd;var Gd=181*(ke+Ze)+128>>8,ke=181*(ke-Ze)+128>>8,vd=(Ne+Qc>>14)+128;c.b[Ia]=0>vd?0:255<vd?255:vd;var Ia=Ia+rc,od=(ic+Gd>>
14)+128;c.b[Ia]=0>od?0:255<od?255:od;var Ia=Ia+rc,Vd=(tc+ke>>14)+128;c.b[Ia]=0>Vd?0:255<Vd?255:Vd;var Ia=Ia+rc,xd=(je+uc>>14)+128;c.b[Ia]=0>xd?0:255<xd?255:xd;var Ia=Ia+rc,$b=(je-uc>>14)+128;c.b[Ia]=0>$b?0:255<$b?255:$b;var Ia=Ia+rc,ad=(tc-ke>>14)+128;c.b[Ia]=0>ad?0:255<ad?255:ad;var Ia=Ia+rc,$d=(ic-Gd>>14)+128;c.b[Ia]=0>$d?0:255<$d?255:$d;var Ia=Ia+rc,Mc=(Ne-Qc>>14)+128;c.b[Ia]=0>Mc?0:255<Mc?255:Mc}var gb=3+b,jd=a.stride,le,kd,hc=this.block[35]<<8,Se=this.block[51],ye=this.block[19],Dc=this.block[11],
sc=this.block[59],bd=this.block[43],ze=this.block[27];if(0==(hc|Se|ye|Dc|sc|bd|ze)){var Bd=(this.block[3]+32>>6)+128,hc=0>Bd?0:255<Bd?255:Bd;c.b[gb]=hc;gb+=jd;c.b[gb]=hc;gb+=jd;c.b[gb]=hc;gb+=jd;c.b[gb]=hc;gb+=jd;c.b[gb]=hc;gb+=jd;c.b[gb]=hc;gb+=jd;c.b[gb]=hc;gb+=jd;c.b[gb]=hc;gb+=jd}else{le=(this.block[3]<<8)+8192;kd=565*(Dc+sc)+4;Dc=kd+2276*Dc>>3;sc=kd-3406*sc>>3;kd=2408*(bd+ze)+4;bd=kd-799*bd>>3;ze=kd-4017*ze>>3;kd=le+hc;le-=hc;hc=1108*(ye+Se)+4;Se=hc-3784*Se>>3;ye=hc+1568*ye>>3;hc=Dc+bd;Dc-=bd;
bd=sc+ze;sc-=ze;ze=kd+ye;kd-=ye;ye=le+Se;le-=Se;var Se=181*(Dc+sc)+128>>8,Dc=181*(Dc-sc)+128>>8,ge=(ze+hc>>14)+128;c.b[gb]=0>ge?0:255<ge?255:ge;var gb=gb+jd,ie=(ye+Se>>14)+128;c.b[gb]=0>ie?0:255<ie?255:ie;var gb=gb+jd,me=(le+Dc>>14)+128;c.b[gb]=0>me?0:255<me?255:me;var gb=gb+jd,Hd=(kd+bd>>14)+128;c.b[gb]=0>Hd?0:255<Hd?255:Hd;var gb=gb+jd,Id=(kd-bd>>14)+128;c.b[gb]=0>Id?0:255<Id?255:Id;var gb=gb+jd,Jd=(le-Dc>>14)+128;c.b[gb]=0>Jd?0:255<Jd?255:Jd;var gb=gb+jd,Kd=(ye-Se>>14)+128;c.b[gb]=0>Kd?0:255<Kd?
255:Kd;var gb=gb+jd,oe=(ze-hc>>14)+128;c.b[gb]=0>oe?0:255<oe?255:oe}var lb=4+b,ue=a.stride,Fc,Xd,Kc=this.block[36]<<8,ef=this.block[52],ff=this.block[20],Te=this.block[12],gf=this.block[60],hf=this.block[44],jf=this.block[28];if(0==(Kc|ef|ff|Te|gf|hf|jf)){var re=(this.block[4]+32>>6)+128,Kc=0>re?0:255<re?255:re;c.b[lb]=Kc;lb+=ue;c.b[lb]=Kc;lb+=ue;c.b[lb]=Kc;lb+=ue;c.b[lb]=Kc;lb+=ue;c.b[lb]=Kc;lb+=ue;c.b[lb]=Kc;lb+=ue;c.b[lb]=Kc;lb+=ue;c.b[lb]=Kc;lb+=ue}else{Fc=(this.block[4]<<8)+8192;Xd=565*(Te+gf)+
4;Te=Xd+2276*Te>>3;gf=Xd-3406*gf>>3;Xd=2408*(hf+jf)+4;hf=Xd-799*hf>>3;jf=Xd-4017*jf>>3;Xd=Fc+Kc;Fc-=Kc;Kc=1108*(ff+ef)+4;ef=Kc-3784*ef>>3;ff=Kc+1568*ff>>3;Kc=Te+hf;Te-=hf;hf=gf+jf;gf-=jf;jf=Xd+ff;Xd-=ff;ff=Fc+ef;Fc-=ef;var ef=181*(Te+gf)+128>>8,Te=181*(Te-gf)+128>>8,Rd=(jf+Kc>>14)+128;c.b[lb]=0>Rd?0:255<Rd?255:Rd;var lb=lb+ue,te=(ff+ef>>14)+128;c.b[lb]=0>te?0:255<te?255:te;var lb=lb+ue,Sd=(Fc+Te>>14)+128;c.b[lb]=0>Sd?0:255<Sd?255:Sd;var lb=lb+ue,Td=(Xd+hf>>14)+128;c.b[lb]=0>Td?0:255<Td?255:Td;var lb=
lb+ue,Ud=(Xd-hf>>14)+128;c.b[lb]=0>Ud?0:255<Ud?255:Ud;var lb=lb+ue,Wd=(Fc-Te>>14)+128;c.b[lb]=0>Wd?0:255<Wd?255:Wd;var lb=lb+ue,zd=(ff-ef>>14)+128;c.b[lb]=0>zd?0:255<zd?255:zd;var lb=lb+ue,ae=(jf-Kc>>14)+128;c.b[lb]=0>ae?0:255<ae?255:ae}var mb=5+b,yd=a.stride,kf,Ue,cd=this.block[37]<<8,lf=this.block[53],mf=this.block[21],De=this.block[13],nf=this.block[61],of=this.block[45],pf=this.block[29];if(0==(cd|lf|mf|De|nf|of|pf)){var be=(this.block[5]+32>>6)+128,cd=0>be?0:255<be?255:be;c.b[mb]=cd;mb+=yd;c.b[mb]=
cd;mb+=yd;c.b[mb]=cd;mb+=yd;c.b[mb]=cd;mb+=yd;c.b[mb]=cd;mb+=yd;c.b[mb]=cd;mb+=yd;c.b[mb]=cd;mb+=yd;c.b[mb]=cd;mb+=yd}else{kf=(this.block[5]<<8)+8192;Ue=565*(De+nf)+4;De=Ue+2276*De>>3;nf=Ue-3406*nf>>3;Ue=2408*(of+pf)+4;of=Ue-799*of>>3;pf=Ue-4017*pf>>3;Ue=kf+cd;kf-=cd;cd=1108*(mf+lf)+4;lf=cd-3784*lf>>3;mf=cd+1568*mf>>3;cd=De+of;De-=of;of=nf+pf;nf-=pf;pf=Ue+mf;Ue-=mf;mf=kf+lf;kf-=lf;var lf=181*(De+nf)+128>>8,De=181*(De-nf)+128>>8,Ad=(pf+cd>>14)+128;c.b[mb]=0>Ad?0:255<Ad?255:Ad;var mb=mb+yd,xe=(mf+lf>>
14)+128;c.b[mb]=0>xe?0:255<xe?255:xe;var mb=mb+yd,de=(kf+De>>14)+128;c.b[mb]=0>de?0:255<de?255:de;var mb=mb+yd,ee=(Ue+of>>14)+128;c.b[mb]=0>ee?0:255<ee?255:ee;var mb=mb+yd,fe=(Ue-of>>14)+128;c.b[mb]=0>fe?0:255<fe?255:fe;var mb=mb+yd,pd=(kf-De>>14)+128;c.b[mb]=0>pd?0:255<pd?255:pd;var mb=mb+yd,Cd=(mf-lf>>14)+128;c.b[mb]=0>Cd?0:255<Cd?255:Cd;var mb=mb+yd,he=(pf-cd>>14)+128;c.b[mb]=0>he?0:255<he?255:he}var nb=6+b,ve=a.stride,qf,Ee,Yd=this.block[38]<<8,rf=this.block[54],Rc=this.block[22],Ve=this.block[14],
Sc=this.block[62],Tc=this.block[46],Uc=this.block[30];if(0==(Yd|rf|Rc|Ve|Sc|Tc|Uc)){var ne=(this.block[6]+32>>6)+128,Yd=0>ne?0:255<ne?255:ne;c.b[nb]=Yd;nb+=ve;c.b[nb]=Yd;nb+=ve;c.b[nb]=Yd;nb+=ve;c.b[nb]=Yd;nb+=ve;c.b[nb]=Yd;nb+=ve;c.b[nb]=Yd;nb+=ve;c.b[nb]=Yd;nb+=ve;c.b[nb]=Yd;nb+=ve}else{qf=(this.block[6]<<8)+8192;Ee=565*(Ve+Sc)+4;Ve=Ee+2276*Ve>>3;Sc=Ee-3406*Sc>>3;Ee=2408*(Tc+Uc)+4;Tc=Ee-799*Tc>>3;Uc=Ee-4017*Uc>>3;Ee=qf+Yd;qf-=Yd;Yd=1108*(Rc+rf)+4;rf=Yd-3784*rf>>3;Rc=Yd+1568*Rc>>3;Yd=Ve+Tc;Ve-=Tc;
Tc=Sc+Uc;Sc-=Uc;Uc=Ee+Rc;Ee-=Rc;Rc=qf+rf;qf-=rf;var rf=181*(Ve+Sc)+128>>8,Ve=181*(Ve-Sc)+128>>8,Be=(Uc+Yd>>14)+128;c.b[nb]=0>Be?0:255<Be?255:Be;var nb=nb+ve,Nd=(Rc+rf>>14)+128;c.b[nb]=0>Nd?0:255<Nd?255:Nd;var nb=nb+ve,pe=(qf+Ve>>14)+128;c.b[nb]=0>pe?0:255<pe?255:pe;var nb=nb+ve,qe=(Ee+Tc>>14)+128;c.b[nb]=0>qe?0:255<qe?255:qe;var nb=nb+ve,Od=(Ee-Tc>>14)+128;c.b[nb]=0>Od?0:255<Od?255:Od;var nb=nb+ve,Pd=(qf-Ve>>14)+128;c.b[nb]=0>Pd?0:255<Pd?255:Pd;var nb=nb+ve,Qd=(Rc-rf>>14)+128;c.b[nb]=0>Qd?0:255<Qd?
255:Qd;var nb=nb+ve,se=(Uc-Yd>>14)+128;c.b[nb]=0>se?0:255<se?255:se}var vb=7+b,Je=a.stride,Vc,We,Zd=this.block[39]<<8,Wc=this.block[55],Xc=this.block[23],Xe=this.block[15],wc=this.block[63],Yc=this.block[47],Ic=this.block[31];if(0==(Zd|Wc|Xc|Xe|wc|Yc|Ic)){var Ce=(this.block[7]+32>>6)+128,Zd=0>Ce?0:255<Ce?255:Ce;c.b[vb]=Zd;vb+=Je;c.b[vb]=Zd;vb+=Je;c.b[vb]=Zd;vb+=Je;c.b[vb]=Zd;vb+=Je;c.b[vb]=Zd;vb+=Je;c.b[vb]=Zd;vb+=Je;c.b[vb]=Zd;vb+=Je;c.b[vb]=Zd;vb+=Je}else{Vc=(this.block[7]<<8)+8192;We=565*(Xe+wc)+
4;Xe=We+2276*Xe>>3;wc=We-3406*wc>>3;We=2408*(Yc+Ic)+4;Yc=We-799*Yc>>3;Ic=We-4017*Ic>>3;We=Vc+Zd;Vc-=Zd;Zd=1108*(Xc+Wc)+4;Wc=Zd-3784*Wc>>3;Xc=Zd+1568*Xc>>3;Zd=Xe+Yc;Xe-=Yc;Yc=wc+Ic;wc-=Ic;Ic=We+Xc;We-=Xc;Xc=Vc+Wc;Vc-=Wc;var Wc=181*(Xe+wc)+128>>8,Xe=181*(Xe-wc)+128>>8,we=(Ic+Zd>>14)+128;c.b[vb]=0>we?0:255<we?255:we;var vb=vb+Je,ce=(Xc+Wc>>14)+128;c.b[vb]=0>ce?0:255<ce?255:ce;var vb=vb+Je,Fe=(Vc+Xe>>14)+128;c.b[vb]=0>Fe?0:255<Fe?255:Fe;var vb=vb+Je,Ge=(We+Yc>>14)+128;c.b[vb]=0>Ge?0:255<Ge?255:Ge;var vb=
vb+Je,He=(We-Yc>>14)+128;c.b[vb]=0>He?0:255<He?255:He;var vb=vb+Je,Ie=(Vc-Xe>>14)+128;c.b[vb]=0>Ie?0:255<Ie?255:Ie;var vb=vb+Je,Ae=(Xc-Wc>>14)+128;c.b[vb]=0>Ae?0:255<Ae?255:Ae;var vb=vb+Je,Oe=(Ic-Zd>>14)+128;c.b[vb]=0>Oe?0:255<Oe?255:Oe}},notSupported:function(){throw new q("This JPG file is not supported");},njDecodeScan:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];this.pos+=2;this.size-=2;this.length-=2;this.bytes.b[this.pos]!=this.ncomp&&this.notSupported();this.pos+=
1;this.size-=1;this.length-=1;for(var a=0,b=this.ncomp;a<b;){var c=a++,c=this.comps[c];c.dctabsel=this.bytes.b[this.pos+1]>>4<<1;c.actabsel=(this.bytes.b[this.pos+1]&3)<<1|1;this.pos+=2;this.size-=2;this.length-=2}a=this.bytes.b[this.pos];b=this.bytes.b[this.pos+1];c=this.bytes.b[this.pos+2];(!this.progressive&&0!=a||b!=63-a||0!=c)&&this.notSupported();a=this.length;this.pos+=a;this.size-=a;this.length-=a;b=a=0;for(c=this.rstinterval;;){for(var d=0,e=this.ncomp;d<e;)for(var f=d++,f=this.comps[f],
g=0,h=f.ssy;g<h;)for(var k=g++,l=0,m=f.ssx;l<m;){var n=l++;this.njDecodeBlock(f,(b*f.ssy+k)*f.stride+a*f.ssx+n<<3)}if(++a>=this.mbwidth&&(a=0,++b>=this.mbheight))break;0!=this.rstinterval&&0==--c&&(this.bufbits&=248,this.njShowBits(16),this.bufbits-=16,c=this.rstinterval,this.comps[0].dcpred=0,this.comps[1].dcpred=0,this.comps[2].dcpred=0)}},njUpsampleH:function(a){for(var b=a.width-3,c=new N(new ArrayBuffer(a.width*a.height<<1)),d=a.pixels,e=0,f=0,g=0,h=a.height;g<h;){g++;var k=139*d.b[e]+-11*d.b[e+
1]+64>>7;c.b[f]=0>k?0:255<k?255:k;k=104*d.b[e]+27*d.b[e+1]+-3*d.b[e+2]+64>>7;c.b[f+1]=0>k?0:255<k?255:k;k=28*d.b[e]+109*d.b[e+1]+-9*d.b[e+2]+64>>7;c.b[f+2]=0>k?0:255<k?255:k;for(var k=0,l=b;k<l;){var m=k++,n=-9*d.b[e+m]+111*d.b[e+m+1]+29*d.b[e+m+2]+-3*d.b[e+m+3]+64>>7;c.b[f+(m<<1)+3]=0>n?0:255<n?255:n;n=-3*d.b[e+m]+29*d.b[e+m+1]+111*d.b[e+m+2]+-9*d.b[e+m+3]+64>>7;c.b[f+(m<<1)+4]=0>n?0:255<n?255:n}e+=a.stride;f+=a.width<<1;k=28*d.b[e-1]+109*d.b[e-2]+-9*d.b[e-3]+64>>7;c.b[f-3]=0>k?0:255<k?255:k;k=104*
d.b[e-1]+27*d.b[e-2]+-3*d.b[e-3]+64>>7;c.b[f-2]=0>k?0:255<k?255:k;k=139*d.b[e-1]+-11*d.b[e-2]+64>>7;c.b[f-1]=0>k?0:255<k?255:k}a.width<<=1;a.stride=a.width;a.pixels=c},njUpsampleV:function(a){for(var b=a.width,c=a.stride,d=c+c,e=new N(new ArrayBuffer(a.width*a.height<<1)),f=0,g=0,h=a.pixels,k=0;k<b;){var f=g=k++,l=139*h.b[f]+-11*h.b[f+c]+64>>7;e.b[g]=0>l?0:255<l?255:l;g+=b;l=104*h.b[f]+27*h.b[f+c]+-3*h.b[f+d]+64>>7;e.b[g]=0>l?0:255<l?255:l;g+=b;l=28*h.b[f]+109*h.b[f+c]+-9*h.b[f+d]+64>>7;e.b[g]=0>
l?0:255<l?255:l;for(var g=g+b,f=f+c,l=0,m=a.height-2;l<m;){l++;var n=-9*h.b[f-c]+111*h.b[f]+29*h.b[f+c]+-3*h.b[f+d]+64>>7;e.b[g]=0>n?0:255<n?255:n;g+=b;n=-3*h.b[f-c]+29*h.b[f]+111*h.b[f+c]+-9*h.b[f+d]+64>>7;e.b[g]=0>n?0:255<n?255:n;g+=b;f+=c}f+=c;l=28*h.b[f]+109*h.b[f-c]+-9*h.b[f-d]+64>>7;e.b[g]=0>l?0:255<l?255:l;g+=b;l=104*h.b[f]+27*h.b[f-c]+-3*h.b[f-d]+64>>7;e.b[g]=0>l?0:255<l?255:l;g+=b;f=139*h.b[f]+-11*h.b[f-c]+64>>7;e.b[g]=0>f?0:255<f?255:f}a.height<<=1;a.stride=a.width;a.pixels=e},njUpsample:function(a){for(var b=
0,c=0;a.width<this.width;)a.width<<=1,++b;for(;a.height<this.height;)a.height<<=1,++c;for(var d=new N(new ArrayBuffer(a.width*a.height)),e=a.pixels,f=0,g=0,h=a.height;g<h;)for(var k=(g++>>c)*a.stride,l=0,m=a.width;l<m;){var n=l++;d.b[f++]=e.b[(n>>b)+k]}a.stride=a.width;a.pixels=d},njConvert:function(){for(var a=0,b=this.ncomp;a<b;){var c=a++,c=this.comps[c];switch(this.filter._hx_index){case 0:(c.width<this.width||c.height<this.height)&&this.njUpsample(c);break;case 1:for(;c.width<this.width||c.height<
this.height;)c.width<this.width&&this.njUpsampleH(c),c.height<this.height&&this.njUpsampleV(c)}if(c.width<this.width||c.height<this.height)throw new q("assert");}a=new N(new ArrayBuffer(4*this.width*this.height));if(3==this.ncomp)for(var b=this.comps[0].pixels,c=this.comps[1].pixels,d=this.comps[2].pixels,e=0,f=0,g=0,h=0,k=0,l=this.height;k<l;){k++;for(var m=0,n=this.width;m<n;){m++;var p=b.b[e++]<<8,r=c.b[f++]-128,s=d.b[g++]-128,u=p+359*s+128>>8,u=0>u?0:255<u?255:u,s=p-88*r-183*s+128>>8,s=0>s?0:
255<s?255:s,p=p+454*r+128>>8,p=0>p?0:255<p?255:p;a.b[h++]=p;a.b[h++]=s;a.b[h++]=u;a.b[h++]=255}e+=this.comps[0].stride-this.width;f+=this.comps[1].stride-this.width;g+=this.comps[2].stride-this.width}else throw new q("TODO");return a},njDecode:function(){if(2>this.size||255!=this.bytes.b[this.pos]||216!=this.bytes.b[this.pos+1])throw new q("This file is not a JPEG");this.pos+=2;this.size-=2;this.length-=2;a:for(;;)switch(this.pos+=2,this.size-=2,this.length-=2,this.bytes.b[this.pos+-1]){case 192:this.njDecodeSOF();
break;case 194:throw this.progressive=!0,new q("Unsupported progressive JPG");null==this.vlctab[4]&&(this.vlctab[4]=new N(new ArrayBuffer(131072)));null==this.vlctab[5]&&(this.vlctab[5]=new N(new ArrayBuffer(131072)));null==this.vlctab[6]&&(this.vlctab[6]=new N(new ArrayBuffer(131072)));null==this.vlctab[7]&&(this.vlctab[7]=new N(new ArrayBuffer(131072)));this.njDecodeSOF();break;case 195:throw new q("Unsupported lossless JPG");case 196:this.njDecodeDHT();break;case 218:this.njDecodeScan();break a;
case 219:this.njDecodeDQT();break;case 221:this.njDecodeDRI();break;case 254:this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];this.pos+=2;this.size-=2;var a=this.length-=2;this.pos+=a;this.size-=a;this.length-=a;break;default:switch(this.bytes.b[this.pos+-1]&240){case 192:throw new q("Unsupported jpeg type "+(this.bytes.b[this.pos+-1]&15));case 224:this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];this.pos+=2;this.size-=2;a=this.length-=2;this.pos+=a;this.size-=a;this.length-=
a;break;default:throw new q("Unsupported jpeg tag 0x"+Qa.hex(this.bytes.b[this.pos+-1],2));}}a=this.njConvert();this.cleanup();return{pixels:a,width:this.width,height:this.height}},__class__:La};var Lk=K["hxd.res.SoundFormat"]={__ename__:!0,__constructs__:["Wav","Mp3","OggVorbis"],Wav:{_hx_index:0,__enum__:"hxd.res.SoundFormat",toString:m},Mp3:{_hx_index:1,__enum__:"hxd.res.SoundFormat",toString:m},OggVorbis:{_hx_index:2,__enum__:"hxd.res.SoundFormat",toString:m}};Lk.__empty_constructs__=[Lk.Wav,
Lk.Mp3,Lk.OggVorbis];var Ce=function(a){this.lastPlay=0;this.entry=a};r["hxd.res.Sound"]=Ce;Ce.__name__="hxd.res.Sound";Ce.supportedFormat=function(a){switch(a._hx_index){case 0:case 1:return!0;case 2:return!1}};Ce.startWorker=function(){return!1};Ce.__super__=kc;Ce.prototype=J(kc.prototype,{getData:function(){if(null!=this.data)return this.data;var a=this.entry.getBytes();switch(a.b[0]){case 73:case 255:this.data=new zi(a);break;case 79:throw new q("OGG format requires -lib stb_ogg_sound (for "+
this.entry.get_path()+")");case 82:this.data=new dh(a)}if(null==this.data)throw new q("Unsupported sound format "+this.entry.get_path());Ce.ENABLE_AUTO_WATCH&&this.watch(z(this,this.watchCallb));return this.data},dispose:function(){this.stop();this.data=null},stop:function(){null!=this.channel&&(this.channel.stop(),this.channel=null)},play:function(a,b,c,d){null==b&&(b=1);null==a&&(a=!1);this.lastPlay=Date.now()/1E3;this.channel=Ha.get().play(this,c,d);this.channel.loop=a;this.channel.set_volume(b);
return this.channel},watchCallb:function(){var a=this.data;this.data=null;var b=this.getData();if(null!=a&&(a.channels!=b.channels||a.samples!=b.samples||a.sampleFormat!=b.sampleFormat||a.samplingRate!=b.samplingRate))for(a=Ha.get().getAll(this);a.hasNext();){var c=a.next();c.duration=b.get_duration();c.set_position(c.position)}},__class__:Ce});var zd=function(){this.volume=1;this.bindedEffects=[];this.effects=[];this.mute=!1;this.priority=0};r["hxd.snd.ChannelBase"]=zd;zd.__name__="hxd.snd.ChannelBase";
zd.prototype={getEffect:function(a){if(null==this.effects)return null;for(var b=0,c=this.effects;b<c.length;){var d=c[b];++b;d=ia.__downcastCheck(d,a)?d:null;if(null!=d)return d}return null},set_volume:function(a){this.currentFade=null;return this.volume=a},fadeTo:function(a,b,c){null==b&&(b=1);this.currentFade={start:Date.now()/1E3,duration:b,startVolume:this.volume,targetVolume:a,onEnd:c}},updateCurrentVolume:function(a){if(null!=this.currentFade){var b=this.currentFade;a-=b.start;if(a>=b.duration){if(this.set_volume(b.targetVolume),
null!=b.onEnd)b.onEnd()}else this.set_volume(b.startVolume+a/b.duration*(b.targetVolume-b.startVolume)),this.currentFade=b}this.currentVolume=this.volume},addEffect:function(a){if(null==a)throw new q("Can't add null effect");if(0<=this.effects.indexOf(a))throw new q("effect already added on this channel");this.effects.push(a);return a},removeEffect:function(a){v.remove(this.effects,a)},__class__:zd};var lg=function(){this.queue=[];this.isVirtual=this.isLoading=this.positionChanged=!1;this.lastStamp=
0;this.audibleVolume=1;this.allowVirtual=!0;this.pause=this.loop=!1;this.position=0;zd.call(this);this.id=lg.ID++};r["hxd.snd.Channel"]=lg;lg.__name__="hxd.snd.Channel";lg.__super__=zd;lg.prototype=J(zd.prototype,{onEnd:function(){},set_position:function(a){this.lastStamp=Date.now()/1E3;this.positionChanged=!0;a>this.duration?a=this.duration:0>a&&(a=0);return this.position=a},set_pause:function(a){a||(this.lastStamp=Date.now()/1E3);return this.pause=a},updateCurrentVolume:function(a){if(this.pause&&
null!=this.currentFade){var b=this.currentFade;this.currentFade=null;this.updateCurrentVolume(a);this.currentFade=b}zd.prototype.updateCurrentVolume.call(this,a);this.channelGroup.updateCurrentVolume(a);this.currentVolume*=this.channelGroup.currentVolume*this.soundGroup.volume;if(null!=this.manager){a=0;for(b=this.channelGroup.effects;a<b.length;){var c=b[a];++a;this.currentVolume*=c.getVolumeModifier()}a=0;for(b=this.effects;a<b.length;)c=b[a],++a,this.currentVolume*=c.getVolumeModifier()}},calcAudibleVolume:function(a){this.updateCurrentVolume(a);
this.audibleVolume=this.currentVolume;if(null!=this.manager){a=0;for(var b=this.channelGroup.effects;a<b.length;){var c=b[a];++a;this.audibleVolume=c.applyAudibleVolumeModifier(this.audibleVolume)}a=0;for(b=this.effects;a<b.length;)c=b[a],++a,this.audibleVolume=c.applyAudibleVolumeModifier(this.audibleVolume)}},queueSound:function(a){this.queue.push(a)},stop:function(){null!=this.manager&&this.manager.releaseChannel(this)},isReleased:function(){return null==this.manager},__class__:lg});var Ai=function(a){zd.call(this);
this.name=a};r["hxd.snd.ChannelGroup"]=Ai;Ai.__name__="hxd.snd.ChannelGroup";Ai.__super__=zd;Ai.prototype=J(zd.prototype,{__class__:Ai});var $d=K["hxd.snd.SampleFormat"]={__ename__:!0,__constructs__:["UI8","I16","F32"],UI8:{_hx_index:0,__enum__:"hxd.snd.SampleFormat",toString:m},I16:{_hx_index:1,__enum__:"hxd.snd.SampleFormat",toString:m},F32:{_hx_index:2,__enum__:"hxd.snd.SampleFormat",toString:m}};$d.__empty_constructs__=[$d.UI8,$d.I16,$d.F32];var sf=function(){};r["hxd.snd.Data"]=sf;sf.__name__=
"hxd.snd.Data";sf.formatBytes=function(a){switch(a._hx_index){case 0:return 1;case 1:return 2;case 2:return 4}};sf.prototype={isLoading:function(){return!1},decode:function(a,b,c,d){var e=this.getBytesPerSample();if(0>c||0>d||0>b||b+d*e>a.length)throw c="sampleStart = "+c+(" sampleCount = "+d),c+=" outPos = "+b,c+=" bpp = "+e,c+=" out.length = "+a.length,new q(c);if(c+d>=this.samples){var f=0;c<this.samples&&(f=this.samples-c,this.decodeBuffer(a,b,c,f));a.fill(b+f*e,(d-f)*e,0)}else this.decodeBuffer(a,
b,c,d)},resample:function(a,b,c){if(this.sampleFormat==b&&this.samplingRate==a&&this.channels==c)return this;var d=Math.ceil(this.samples*(a/this.samplingRate)),e=this.getBytesPerSample(),e=new N(new ArrayBuffer(e*this.samples));this.decodeBuffer(e,0,0,this.samples);var f;switch(b._hx_index){case 0:f=1;break;case 1:f=2;break;case 2:f=4}f=new N(new ArrayBuffer(c*d*f));this.resampleBuffer(f,0,e,0,a,b,c,this.samples);e=new dh(null);e.channels=c;e.samples=d;e.sampleFormat=b;e.samplingRate=a;e.rawData=
f;return e},resampleBuffer:function(a,b,c,d,e,f,g,h){var k=this.getBytesPerSample();e=Math.ceil(h*(e/this.samplingRate));var l=h!=e;if(!l&&this.sampleFormat==$d.I16&&f==$d.I16&&1==g&&2==this.channels)for(f=0;f<h;)f++,k=c.getUInt16(d),d+=2,e=c.getUInt16(d),d+=2,32768<=(k^e)?(0!=(k&32768)&&(k|=-65536),0!=(e&32768)&&(e|=-65536),k=k+e>>1&65535):k=k+e>>1,a.setUInt16(b,k),b+=2;else{var m=this.channels,m=g<m?g:m;g-=m;for(var n=0,p=0,q=0;q<e;){var r=q++/(e-1)*(h-1),s=r|0,r=r-s,u=d+s*k;s==h-1&&(l=!1);for(var s=
0,w=m;s<w;){s++;var y,n=0;switch(this.sampleFormat._hx_index){case 0:y=c.b[u]/255;l&&(n=c.b[u+k]/255);++u;break;case 1:y=c.getUInt16(u);y=(0==(y&32768)?y:y|-65536)/32768;l&&(n=c.getUInt16(u+k),n=(0==(n&32768)?n:n|-65536)/32768);u+=2;break;case 2:y=c.getFloat(u),l&&(n=c.getFloat(u+k)),u+=4}n=l?y+r*(n-y):y;switch(f._hx_index){case 0:p=128*(n+1)|0;255<p&&(p=255);a.b[b++]=p;break;case 1:p=32768*n|0;32767<p&&(p=32767);p&=65535;a.setUInt16(b,p);b+=2;break;case 2:a.setFloat(b,n),b+=4}}r=0;for(u=g;r<u;)switch(r++,
f._hx_index){case 0:a.b[b++]=p;break;case 1:a.setUInt16(b,p);b+=2;break;case 2:a.setFloat(b,n),b+=4}}}},decodeBuffer:function(a,b,c,d){throw new q("Not implemented");},getBytesPerSample:function(){var a;switch(this.sampleFormat._hx_index){case 0:a=1;break;case 1:a=2;break;case 2:a=4}return this.channels*a},load:function(a){a()},get_duration:function(){return this.samples/this.samplingRate},__class__:sf};var ae=function(){};r["hxd.snd.EffectDriver"]=ae;ae.__name__="hxd.snd.EffectDriver";ae.prototype=
{acquire:function(){},release:function(){},update:function(a){},bind:function(a,b){},apply:function(a,b){},unbind:function(a,b){},__class__:ae};var Vk=K["hxd.snd.DriverFeature"]={__ename__:!0,__constructs__:["MasterVolume"],MasterVolume:{_hx_index:0,__enum__:"hxd.snd.DriverFeature",toString:m}};Vk.__empty_constructs__=[Vk.MasterVolume];var Bi=function(){};r["hxd.snd.Driver"]=Bi;Bi.__name__="hxd.snd.Driver";Bi.__isInterface__=!0;Bi.prototype={__class__:Bi};var oc=function(a){this.lastStamp=this.retainTime=
this.priority=this.refs=0;var b=Ha.get().driver;null!=b&&(this.driver=b.getEffectDriver(a))};r["hxd.snd.Effect"]=oc;oc.__name__="hxd.snd.Effect";oc.prototype={applyAudibleVolumeModifier:function(a){return a},getVolumeModifier:function(){return 1},__class__:oc};var ck=function(){this.position=new B;this.velocity=new B;this.direction=new B(1,0,0);this.up=new B(0,0,1)};r["hxd.snd.Listener"]=ck;ck.__name__="hxd.snd.Listener";ck.prototype={syncCamera:function(a){var b=this.position,c=a.pos;b.x=c.x;b.y=
c.y;b.z=c.z;b.w=c.w;var b=this.direction,c=a.target.x-a.pos.x,d=a.target.y-a.pos.y,e=a.target.z-a.pos.z;null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);b.x=c;b.y=d;b.z=e;b.w=1;this.direction.normalize();b=this.up;a=a.up;b.x=a.x;b.y=a.y;b.z=a.z;b.w=a.w},__class__:ck};var eh=function(a){this.start=0;this.playing=!1;this.volume=-1;this.id=eh.ID++;this.handle=a.createSource();this.buffers=[]};r["hxd.snd.Source"]=eh;eh.__name__="hxd.snd.Source";eh.prototype={dispose:function(){Ha.get().driver.destroySource(this.handle)},
__class__:eh};var Ci=function(a){this.end=0;this.handle=a.createBuffer();this.refs=0;this.lastStop=Date.now()/1E3};r["hxd.snd.Buffer"]=Ci;Ci.__name__="hxd.snd.Buffer";Ci.prototype={dispose:function(){Ha.get().driver.destroyBuffer(this.handle)},__class__:Ci};var Ha=function(){this.suspended=!1;this.timeOffset=0;try{this.driver=new Di}catch(a){if($.lastException=a,"string"==typeof(a instanceof q?a.val:a))this.driver=null;else throw a;}this.masterVolume=1;this.hasMasterVolume=null==this.driver?!0:this.driver.hasFeature(Vk.MasterVolume);
this.masterSoundGroup=new dk("master");this.masterChannelGroup=new Ai("master");this.listener=new ck;this.soundBufferMap=new ga;this.soundBufferKeys=[];this.freeStreamBuffers=[];this.effectGC=[];this.soundBufferCount=0;if(null!=this.driver){this.sources=[];for(var b=0,c=Ha.MAX_SOURCES;b<c;)b++,this.sources.push(new eh(this.driver))}this.cachedBytes=new N(new ArrayBuffer(24));this.resampleBytes=new N(new ArrayBuffer(2*Ha.STREAM_BUFFER_SAMPLE_COUNT))};r["hxd.snd.Manager"]=Ha;Ha.__name__="hxd.snd.Manager";
Ha.get=function(){null==Ha.instance&&(Ha.instance=new Ha,Ha.instance.updateEvent=Sb.add((s=Ha.instance,z(s,s.update))),Ha.instance.updateEvent.isBlocking=!1);return Ha.instance};Ha.regEffect=function(a,b){for(var c=a;null!=c;){if(c==b)return a;c=c.next}b.next=a;return b};Ha.prototype={getTmpBytes:function(a){this.cachedBytes.length<a&&(this.cachedBytes=new N(new ArrayBuffer(a)));return this.cachedBytes},getResampleBytes:function(a){this.resampleBytes.length<a&&(this.resampleBytes=new N(new ArrayBuffer(a)));
return this.resampleBytes},stopAll:function(){for(;null!=this.channels;)this.channels.stop()},stopAllNotLooping:function(){for(var a=this.channels;null!=a;){var b=a.next;a.loop||a.stop();a=b}},stopByName:function(a){for(var b=this.channels;null!=b;){var c=b.next;null!=b.soundGroup&&b.soundGroup.name==a&&b.stop();b=c}},getAll:function(a){for(var b=this.channels,c=[];null!=b;)b.sound==a&&c.push(b),b=b.next;return new ak(c)},cleanCache:function(){for(var a=0;a<this.soundBufferKeys.length;){var b=this.soundBufferKeys[a],
c=this.soundBufferMap,c=null!=Q[b]?c.getReserved(b):c.h[b];++a;0<c.refs||(this.soundBufferMap.remove(b),v.remove(this.soundBufferKeys,b),--a,c.dispose(),--this.soundBufferCount)}},dispose:function(){this.stopAll();if(null!=this.driver){for(var a=0,b=this.sources;a<b.length;){var c=b[a];++a;c.dispose()}a=this.soundBufferMap;for(a=new Gj(a,a.arrayKeys());a.hasNext();)a.next().dispose();a=0;for(b=this.freeStreamBuffers;a<b.length;)c=b[a],++a,c.dispose();a=0;for(b=this.effectGC;a<b.length;)c=b[a],++a,
c.driver.release();this.driver.dispose()}this.effectGC=this.freeStreamBuffers=this.soundBufferKeys=this.soundBufferMap=this.sources=null;this.updateEvent.stop();Ha.instance=null},play:function(a,b,c){null==c&&(c=this.masterSoundGroup);null==b&&(b=this.masterChannelGroup);var d=a.getData();if(0==d.samples)throw new q(n.string(a)+" has no samples");var e=new lg;e.sound=a;e.duration=d.get_duration();e.manager=this;e.soundGroup=c;e.channelGroup=b;e.next=this.channels;e.isLoading=d.isLoading();e.isVirtual=
null==this.driver;return this.channels=e},updateVirtualChannels:function(a){for(var b=this.channels;null!=b;)if(b.pause||!b.isVirtual||b.isLoading)b=b.next;else{var c=b,d=a-b.lastStamp;c.set_position(c.position+(0>d?0:d));b.lastStamp=a;for(c=b.next;b.position>=b.duration;)if(d=b,d.set_position(d.position-b.duration),b.onEnd(),null!=c&&null==c.manager&&(c=null),0<b.queue.length)b.sound=b.queue.shift(),b.duration=b.sound.getData().get_duration();else if(!b.loop){this.releaseChannel(b);break}b=c}},update:function(){if(0!=
this.timeOffset){for(var a=this.channels;null!=a;)a.lastStamp+=this.timeOffset,null!=a.currentFade&&(a.currentFade.start+=this.timeOffset),a=a.next;for(var a=0,b=this.sources;a<b.length;){var c=b[a];++a;for(var d=0,c=c.buffers;d<c.length;){var e=c[d];++d;e.lastStop+=this.timeOffset}}this.timeOffset=0}this.now=Date.now()/1E3;if(null==this.driver)this.updateVirtualChannels(this.now);else{a=0;for(b=this.sources;a<b.length;)if(d=b[a],++a,c=d.channel,null!=c)if(c.positionChanged)this.releaseSource(d);
else{for(var e=null,f=0,g=this.driver.getProcessedBuffers(d.handle);f<g;){f++;var h=this.unqueueBuffer(d);null!=h&&(e=h,h.isEnd&&(c.sound=h.sound,c.duration=h.sound.getData().get_duration(),c.set_position(c.duration),c.positionChanged=!1,c.onEnd(),d.start=0))}0==d.buffers.length?e.isEnd?0<c.queue.length?(c.sound=c.queue[0],c.duration=c.sound.getData().get_duration(),c.set_position(0),this.releaseSource(d)):c.loop?(c.set_position(0),this.releaseSource(d)):this.releaseChannel(c):(c.set_position((e.start+
e.samples)/e.sampleRate),this.releaseSource(d)):(c.sound=d.buffers[0].sound,c.duration=c.sound.getData().get_duration(),e=this.driver.getPlayedSampleCount(d.handle),0>e&&(e=0),c.set_position((d.start+e)/d.buffers[0].sampleRate),c.positionChanged=!1,d.buffers.length<Ha.BUFFER_QUEUE_LENGTH&&(e=d.buffers[d.buffers.length-1],e.isEnd?0<c.queue.length?this.queueBuffer(d,c.queue[0],0)&&c.queue.shift():c.loop&&this.queueBuffer(d,e.sound,0):this.queueBuffer(d,e.sound,e.start+e.samples)))}for(a=this.channels;null!=
a;)a.calcAudibleVolume(this.now),a.isLoading&&!a.sound.getData().isLoading()&&(a.isLoading=!1),a.isVirtual=this.suspended||a.pause||a.mute||a.channelGroup.mute||a.allowVirtual&&a.audibleVolume<Ha.VIRTUAL_VOLUME_THRESHOLD||a.isLoading,a=a.next;a=this.channels;b=z(this,this.sortChannel);if(null==a)a=null;else for(var d=1,k=e=0,l;;){f=a;h=a=null;for(c=0;null!=f;){++c;g=f;k=e=0;for(l=d;k<l&&!(k++,++e,g=g.next,null==g););for(k=d;0<e||0<k&&null!=g;)0==e?(l=g,g=g.next,--k):0==k||null==g||0>=b(f,g)?(l=f,
f=f.next,--e):(l=g,g=g.next,--k),null!=h?h.next=l:a=l,h=l;f=g}h.next=null;if(1>=c)break;d*=2}this.channels=a;a=0;for(b=this.channels;null!=b&&!b.isVirtual;)++a>this.sources.length?b.isVirtual=!0:0<=b.soundGroup.maxAudible&&(b.soundGroup.lastUpdate!=this.now&&(b.soundGroup.lastUpdate=this.now,b.soundGroup.numAudible=0),++b.soundGroup.numAudible>b.soundGroup.maxAudible&&(b.isVirtual=!0,--a)),b=b.next;a=0;for(b=this.sources;a<b.length;)d=b[a],++a,null!=d.channel&&d.channel.isVirtual&&this.releaseSource(d);
for(a=this.channels;null!=a;){if(!(null!=a.source||a.isVirtual)){b=null;d=0;for(c=this.sources;d<c.length;)if(e=c[d],++d,null==e.channel){b=e;break}if(null==b)throw new q("could not get a source");b.channel=a;a.source=b;this.checkTargetFormat(a.sound.getData(),a.soundGroup.mono);b.start=Math.floor(a.position*this.targetRate);0>b.start&&(b.start=0);this.queueBuffer(b,a.sound,b.start);a.positionChanged=!1}a=a.next}a=null;b=this.hasMasterVolume?1:this.masterVolume;d=0;for(c=this.sources;d<c.length;)if(f=
c[d],++d,e=f.channel,null!=e){g=e.currentVolume*b;f.volume!=g&&(0>g&&(g=0),f.volume=g,this.driver.setSourceVolume(f.handle,g));f.playing||(this.driver.playSource(f.handle),f.playing=!0);for(g=e.bindedEffects.length;0<=--g;)h=e.bindedEffects[g],0>e.effects.indexOf(h)&&0>e.channelGroup.effects.indexOf(h)&&this.unbindEffect(e,f,h);g=0;for(h=e.channelGroup.effects;g<h.length;)k=h[g],++g,0>e.bindedEffects.indexOf(k)&&this.bindEffect(e,f,k);g=0;for(h=e.effects;g<h.length;)k=h[g],++g,0>e.bindedEffects.indexOf(k)&&
this.bindEffect(e,f,k);f=0;for(e=e.bindedEffects;f<e.length;)g=e[f],++f,a=Ha.regEffect(a,g)}b=z(this,this.sortEffect);if(null==a)a=null;else{d=1;for(k=e=0;;){f=a;h=a=null;for(c=0;null!=f;){++c;g=f;k=e=0;for(l=d;k<l&&!(k++,++e,g=g.next,null==g););for(k=d;0<e||0<k&&null!=g;)0==e?(l=g,g=g.next,--k):0==k||null==g||0>=b(f,g)?(l=f,f=f.next,--e):(l=g,g=g.next,--k),null!=h?h.next=l:a=l,h=l;f=g}h.next=null;if(1>=c)break;d*=2}}for(;null!=a;)a.driver.update(a),a=a.next;a=0;for(b=this.sources;a<b.length;)if(d=
b[a],++a,e=d.channel,null!=e){c=0;for(e=e.bindedEffects;c<e.length;)f=e[c],++c,f.driver.apply(f,d.handle)}a=0;for(b=this.effectGC;a<b.length;)if(d=b[a],++a,this.now-d.lastStamp>d.retainTime){d.driver.release();v.remove(this.effectGC,d);break}this.updateVirtualChannels(this.now);this.listener.direction.normalize();this.listener.up.normalize();this.hasMasterVolume&&this.driver.setMasterVolume(this.masterVolume);this.driver.setListenerParams(this.listener.position,this.listener.direction,this.listener.up,
this.listener.velocity);this.driver.update();if(this.soundBufferCount>=Ha.SOUND_BUFFER_CACHE_SIZE){a=Date.now()/1E3;for(b=0;b<this.soundBufferKeys.length;)d=this.soundBufferKeys[b],c=this.soundBufferMap,c=null!=Q[d]?c.getReserved(d):c.h[d],++b,0<c.refs||c.lastStop+60>a||(this.soundBufferMap.remove(d),v.remove(this.soundBufferKeys,d),--b,c.dispose(),--this.soundBufferCount)}}},progressiveDecodeBuffer:function(a,b,c){var d=b.getData(),e=Math.ceil(Ha.STREAM_BUFFER_SAMPLE_COUNT/Ha.BUFFER_STREAM_SPLIT);
if(a.streamStart!=c||a.streamSound!=b)a.streamSound=b,a.streamStart=c,a.streamPos=c;b=c+Ha.STREAM_BUFFER_SAMPLE_COUNT;if(a.streamPos==b)return!0;var f=d.getBytesPerSample(),g=Ha.STREAM_BUFFER_SAMPLE_COUNT*f;if(null==a.streamBuffer||a.streamBuffer.length<g)a.streamBuffer=new N(new ArrayBuffer(g)),a.streamPos=c;g=b-a.streamPos;g>e&&(g=e);d.decode(a.streamBuffer,(a.streamPos-c)*f,a.streamPos,g);a.streamPos+=g;return a.streamPos==b},queueBuffer:function(a,b,c){var d=b.getData(),e=a.channel.soundGroup,
f=null;if(d.get_duration()<=Ha.STREAM_DURATION)f=this.getSoundBuffer(b,e),this.driver.queueBuffer(a.handle,f.handle,c,!0);else{if(0<a.buffers.length&&1<Ha.BUFFER_STREAM_SPLIT&&!this.progressiveDecodeBuffer(a,b,c))return!1;f=this.getStreamBuffer(a,b,e,c);this.driver.queueBuffer(a.handle,f.handle,0,f.isEnd)}a.buffers.push(f);return!0},unqueueBuffer:function(a){var b=a.buffers.shift();if(null==b)return null;this.driver.unqueueBuffer(a.handle,b.handle);b.isStream?this.freeStreamBuffers.unshift(b):0==
--b.refs&&(b.lastStop=Date.now()/1E3);return b},bindEffect:function(a,b,c){0==c.refs&&!v.remove(this.effectGC,c)&&c.driver.acquire();++c.refs;c.driver.bind(c,b.handle);a.bindedEffects.push(c)},unbindEffect:function(a,b,c){c.driver.unbind(c,b.handle);v.remove(a.bindedEffects,c);0==--c.refs&&(c.lastStamp=this.now,this.effectGC.push(c))},releaseSource:function(a){if(null!=a.channel){for(var b=0,c=a.channel.bindedEffects.slice();b<c.length;){var d=c[b];++b;this.unbindEffect(a.channel,a,d)}a.channel.bindedEffects=
[];a.channel.source=null;a.channel=null}a.playing&&(a.playing=!1,this.driver.stopSource(a.handle),a.volume=-1);for(;0<a.buffers.length;)this.unqueueBuffer(a)},checkTargetFormat:function(a,b){null==b&&(b=!1);this.targetRate=a.samplingRate;this.targetChannels=b||1==a.channels?1:2;var c;switch(a.sampleFormat._hx_index){case 0:c=$d.UI8;break;case 1:c=$d.I16;break;case 2:c=$d.F32}this.targetFormat=c;return this.targetChannels==a.channels&&this.targetFormat==a.sampleFormat?this.targetRate==a.samplingRate:
!1},getSoundBuffer:function(a,b){var c=this,d=a.getData(),e=b.mono,f=a.entry.get_path();e&&1!=d.channels&&(f+="mono");var g=this.soundBufferMap,h=null!=Q[f]?g.getReserved(f):g.h[f];null==h&&(h=new Ci(this.driver),h.isStream=!1,h.isEnd=!0,h.sound=a,d.load(function(){c.fillSoundBuffer(h,d,e)}),g=this.soundBufferMap,null!=Q[f]?g.setReserved(f,h):g.h[f]=h,this.soundBufferKeys.push(f),++this.soundBufferCount);++h.refs;return h},fillSoundBuffer:function(a,b,c){null==c&&(c=!1);this.checkTargetFormat(b,c)||
(b=b.resample(this.targetRate,this.targetFormat,this.targetChannels));c=b.samples*b.getBytesPerSample();var d=this.getTmpBytes(c);b.decode(d,0,0,b.samples);this.driver.setBufferData(a.handle,d,c,this.targetFormat,this.targetChannels,this.targetRate);a.sampleRate=this.targetRate;a.samples=b.samples},getStreamBuffer:function(a,b,c,d){var e=b.getData(),f=this.freeStreamBuffers.shift();null==f&&(f=new Ci(this.driver),f.isStream=!0);var g=Ha.STREAM_BUFFER_SAMPLE_COUNT;d+g>=e.samples?(g=e.samples-d,f.isEnd=
!0):f.isEnd=!1;f.sound=b;f.samples=g;f.start=d;var h=g*e.getBytesPerSample();if(a.streamSound==b&&a.streamStart==d){for(;!this.progressiveDecodeBuffer(a,b,d););a=a.streamBuffer}else a=this.getTmpBytes(h),e.decode(a,0,d,g);if(!this.checkTargetFormat(e,c.mono)){var h=Math.ceil(g*(this.targetRate/e.samplingRate))*this.targetChannels,k;switch(this.targetFormat._hx_index){case 0:k=1;break;case 1:k=2;break;case 2:k=4}h*=k;k=this.getResampleBytes(h);e.resampleBuffer(k,0,a,0,this.targetRate,this.targetFormat,
this.targetChannels,g);a=k}this.driver.setBufferData(f.handle,a,h,this.targetFormat,this.targetChannels,this.targetRate);f.sampleRate=this.targetRate;return f},sortChannel:function(a,b){return a.isVirtual!=b.isVirtual?a.isVirtual?1:-1:a.channelGroup.priority!=b.channelGroup.priority?a.channelGroup.priority<b.channelGroup.priority?1:-1:a.priority!=b.priority?a.priority<b.priority?1:-1:a.audibleVolume!=b.audibleVolume?a.audibleVolume<b.audibleVolume?1:-1:a.id<b.id?1:-1},sortEffect:function(a,b){return b.priority-
a.priority},releaseChannel:function(a){if(null!=a.manager){if(this.channels==a)this.channels=a.next;else{for(var b=this.channels;b.next!=a;)b=b.next;b.next=a.next}for(var b=0,c=a.effects;b<c.length;){var d=c[b];++b;a.removeEffect(d)}null!=a.source&&this.releaseSource(a.source);a.next=null;a.manager=null;a.effects=null;a.bindedEffects=null;a.currentFade=null;b=a.sound;null!=b&&b.channel==a&&(b.channel=null)}},__class__:Ha};var zi=function(a){var b=(new $i(new Vb(a))).read();this.samples=b.sampleCount;
for(var c=b.frames[0].data,d=-1,e=0,f=c.length-24;e<f;){var g=e++;if(76==c.b[g]&&65==c.b[g+1]&&77==c.b[g+2]&&69==c.b[g+3]){d=g;break}}0<=d&&(c=c.b[d+21]<<16|c.b[d+22]<<8|c.b[d+23],this.samples-=(c>>12)+(c&4095)+1152);b=b.frames[0].header;this.sampleFormat=$d.F32;this.samplingRate=Ma.srEnum2Num(b.samplingRate);this.channels=b.channelMode==he.Mono?1:2;b=R.get();null!=b&&(b.decodeAudioData(a.b.bufferValue,z(this,this.processBuffer)),a=b.sampleRate|0,this.samples=Math.ceil(this.samples*a/this.samplingRate),
this.samplingRate=a)};r["hxd.snd.Mp3Data"]=zi;zi.__name__="hxd.snd.Mp3Data";zi.__super__=sf;zi.prototype=J(sf.prototype,{isLoading:function(){return null==this.buffer},load:function(a){null!=this.buffer?a():this.onEnd=a},processBuffer:function(a){var b=a.getChannelData(0);this.samples=a.length;if(1==this.channels)this.buffer=N.ofData(b.buffer);else{var c=2>a.numberOfChannels?b:a.getChannelData(1),d=new Float32Array(2*b.length),e=0,f=0;for(a=a.length;f<a;){var g=f++;d[e++]=b[g];d[e++]=c[g]}this.buffer=
N.ofData(d.buffer);null!=this.onEnd&&(this.onEnd(),this.onEnd=null)}},decodeBuffer:function(a,b,c,d){null==this.buffer?a.fill(b,4*d*this.channels,0):a.blit(b,this.buffer,4*c*this.channels,4*d*this.channels)},__class__:zi});var dk=function(a){this.name=a;this.maxAudible=-1;this.volume=1;this.mono=!1};r["hxd.snd.SoundGroup"]=dk;dk.__name__="hxd.snd.SoundGroup";dk.prototype={__class__:dk};var dh=function(a){null!=a&&this.init((new ij(new Vb(a))).read())};r["hxd.snd.WavData"]=dh;dh.__name__="hxd.snd.WavData";
dh.__super__=sf;dh.prototype=J(sf.prototype,{init:function(a){var b=a.header;this.samplingRate=b.samplingRate;this.channels=b.channels;switch(b.bitsPerSample){case 8:b=$d.UI8;break;case 16:b=$d.I16;break;default:throw new q("Unsupported WAV "+b.bitsPerSample+" bits");}this.sampleFormat=b;this.rawData=a.data;this.samples=this.rawData.length/this.getBytesPerSample()|0},decodeBuffer:function(a,b,c,d){var e=this.getBytesPerSample();a.blit(b,this.rawData,c*e,d*e)},__class__:dh});var ek=function(){oc.call(this,
"lowpass");this.priority=100;this.gainHF=1};r["hxd.snd.effect.LowPass"]=ek;ek.__name__="hxd.snd.effect.LowPass";ek.__super__=oc;ek.prototype=J(oc.prototype,{__class__:ek});var fk=function(a){null==a&&(a=1);oc.call(this,"pitch");this.value=a};r["hxd.snd.effect.Pitch"]=fk;fk.__name__="hxd.snd.effect.Pitch";fk.__super__=oc;fk.prototype=J(oc.prototype,{__class__:fk});var gk=function(){oc.call(this,"spatialization");this.position=new B;this.velocity=new B;this.direction=new B;this.rollOffFactor=this.referenceDistance=
1};r["hxd.snd.effect.Spatialization"]=gk;gk.__name__="hxd.snd.effect.Spatialization";gk.__super__=oc;gk.prototype=J(oc.prototype,{getVolumeModifier:function(){if(null==this.fadeDistance)return 1;var a=Ha.get().listener.position,b=this.position,c=b.x-a.x,d=b.y-a.y,a=b.z-a.z,c=Math.sqrt(c*c+d*d+a*a),c=null!=this.maxDistance?c-this.maxDistance:c-this.referenceDistance,c=1-c/this.fadeDistance;1<c&&(c=1);0>c&&(c=0);return c},applyAudibleVolumeModifier:function(a){var b=Ha.get().listener.position,c=this.position,
d=c.x-b.x,e=c.y-b.y,b=c.z-b.z,d=Math.sqrt(d*d+e*e+b*b),e=this.referenceDistance,d=d<e?e:d;null!=this.maxDistance&&(e=this.maxDistance,d=d>e?e:d);return a*(this.referenceDistance/(this.referenceDistance+this.rollOffFactor*(d-this.referenceDistance)))},__class__:gk});var hk=function(){};r["hxd.snd.webaudio.BufferHandle"]=hk;hk.__name__="hxd.snd.webaudio.BufferHandle";hk.prototype={__class__:hk};var ik=function(){this.buffers=[];this.sampleOffset=0;this.pitch=1;this.firstPlay=!0};r["hxd.snd.webaudio.SourceHandle"]=
ik;ik.__name__="hxd.snd.webaudio.SourceHandle";ik.prototype={updateDestination:function(){this.destination=this.gain;null!=this.lowPass&&(this.lowPass.connect(this.destination),this.destination=this.lowPass);null!=this.panner&&(this.panner.connect(this.destination),this.destination=this.panner);this.gain.connect(R.destination);for(var a=0,b=this.buffers;a<b.length;){var c=b[a];++a;null!=c.node&&c.restart(this)}},applyPitch:function(){for(var a=0,b=0,c=this.buffers;b<c.length;){var d=c[b];++b;a=d.readjust(a,
this)}},__class__:ik};var Ei=function(){};r["hxd.snd.webaudio.BufferPlayback"]=Ei;Ei.__name__="hxd.snd.webaudio.BufferPlayback";Ei.prototype={get_currentSample:function(){if(this.consumed)return this.buffer.samples;if(null==this.node||!this.dirty||this.node.context.currentTime<this.lastTime)return 0;this.lastSamples+=Math.floor((this.node.context.currentTime-this.lastTime)*this.buffer.inst.sampleRate*this.node.playbackRate.value);this.lastTime=this.node.context.currentTime;return this.lastSamples},
set:function(a,b){this.buffer=a;this.offset=isNaN(b)?0:b;this.consumed=this.dirty=!1;this.ends=this.starts=0},start:function(a,b,c){this.dirty=!0;this.consumed=!1;null!=this.node&&this.stop();if(b.firstPlay&&10<this.buffer.samples){b.firstPlay=!1;for(var d=[],e=0,f=this.buffer.inst.numberOfChannels;e<f;){var g=e++;d.push(this.buffer.inst.getChannelData(g))}for(f=e=0;10>e;){for(g=0;g<d.length;)d[g][e]*=f,++g;++e;f+=0.1;1<f&&(f=1)}}this.node=a.createBufferSource();this.node.buffer=this.buffer.inst;
this.node.addEventListener("ended",z(this,this.onBufferConsumed));this.node.connect(b.destination);this.node.playbackRate.value=b.pitch;this.node.start(c,this.offset);this.lastSamples=0;this.starts=this.lastTime=c;return this.ends=c+(this.buffer.inst.duration-this.offset)/b.pitch},readjust:function(a,b){if(this.consumed||null==this.node)return this.ends;var c=b.driver.ctx,d=c.currentTime;this.node.playbackRate.setValueAtTime(b.pitch,d);var e=d-this.starts;if(0>e)return this.start(c,b,0==a?d:a);this.starts=
d-e/b.pitch;return this.ends=this.starts+(this.buffer.inst.duration-this.offset)/b.pitch},restart:function(a){if(!(this.consumed||null==this.node)){var b=R.get();b.currentTime>this.starts?(this.offset+=(b.currentTime-this.starts)*a.pitch,this.start(b,a,b.currentTime)):this.start(b,a,this.starts)}},stop:function(a){null==a&&(a=!0);null!=this.node&&(this.node.removeEventListener("ended",z(this,this.onBufferConsumed)),a?this.node.disconnect():this.node.stop(),this.node=null)},onBufferConsumed:function(a){this.node.removeEventListener("ended",
z(this,this.onBufferConsumed));this.node.disconnect();this.node=null;this.consumed=!0},clear:function(){this.node=this.buffer=null},__class__:Ei};var R=function(){};r["hxd.snd.webaudio.Context"]=R;R.__name__="hxd.snd.webaudio.Context";R.get=function(){if(null==R.ctx){try{R.ctx=new AudioContext}catch(a){$.lastException=a;try{R.ctx=new window.webkitAudioContext}catch(b){$.lastException=b,R.ctx=null}}if(null==R.ctx)throw new q("WebAudio API not available in this browser!");"suspended"==R.ctx.state&&
R.waitForPageInput();R.ctx.addEventListener("statechange",function(a){"suspended"==R.ctx.state&&R.waitForPageInput()});R.bufferPool=[];R.gainPool=[];R.masterGain=R.ctx.createGain();R.masterGain.connect(R.ctx.destination);R.destination=R.masterGain}return R.ctx};R.getGain=function(){return 0!=R.gainPool.length?R.gainPool.pop():R.ctx.createGain()};R.putGain=function(a){R.gainPool.push(a);a.gain.value=1};R.waitForPageInput=function(){R.suspended||(window.document.addEventListener("click",R.resumeContext),
window.document.addEventListener("keydown",R.resumeContext),window.document.body.addEventListener("keydown",R.resumeContext),window.document.body.addEventListener("touchend",R.resumeContext),R.suspended=!0)};R.resumeContext=function(a){R.suspended&&(null!=R.ctx&&R.ctx.resume(),window.document.removeEventListener("click",R.resumeContext),window.document.removeEventListener("keydown",R.resumeContext),window.document.body.removeEventListener("keydown",R.resumeContext),window.document.body.removeEventListener("touchend",
R.resumeContext),R.suspended=!1)};R.getBuffer=function(a,b,c){for(var d=0,e=R.bufferPool;d<e.length;){var f=e[d];++d;if(f.channels==a&&f.samples==b&&f.rate==c)return 0!=f.pool.length?f.pool.pop():R.ctx.createBuffer(a,b,c)}d=new jk(a,b,c);R.bufferPool.push(d);return R.ctx.createBuffer(a,b,c)};R.putBuffer=function(a){for(var b=a.sampleRate|0,c=0,d=R.bufferPool;c<d.length;){var e=d[c];++c;if(e.channels==a.numberOfChannels&&e.samples==a.length&&e.rate==b){e.pool.push(a);break}}};var jk=function(a,b,c){this.pool=
[];this.channels=a;this.samples=b;this.rate=c};r["hxd.snd.webaudio._Context.BufferPool"]=jk;jk.__name__="hxd.snd.webaudio._Context.BufferPool";jk.prototype={__class__:jk};var Di=function(){this.playbackPool=[];this.ctx=R.get()};r["hxd.snd.webaudio.Driver"]=Di;Di.__name__="hxd.snd.webaudio.Driver";Di.__interfaces__=[Bi];Di.prototype={getBuffer:function(a,b,c){return R.getBuffer(a,b,c)},putBuffer:function(a){R.putBuffer(a)},getGain:function(){return 0!=R.gainPool.length?R.gainPool.pop():R.ctx.createGain()},
putGain:function(a){R.gainPool.push(a);a.gain.value=1},hasFeature:function(a){return!0},setMasterVolume:function(a){R.masterGain.gain.value=a},setListenerParams:function(a,b,c,d){this.ctx.listener.setPosition(-a.x,a.y,a.z);this.ctx.listener.setOrientation(-b.x,b.y,b.z,-c.x,c.y,c.z)},createSource:function(){var a=new ik;a.driver=this;a.gain=0!=R.gainPool.length?R.gainPool.pop():R.ctx.createGain();a.updateDestination();return a},playSource:function(a){if(!a.playing&&(a.playing=!0,0!=a.buffers.length))for(var b=
this.ctx.currentTime,c=0,d=a.buffers;c<d.length;){var e=d[c];++c;e.consumed||(b=e.start(this.ctx,a,b))}},stopSource:function(a){a.playing=!1;a.sampleOffset=0},setSourceVolume:function(a,b){a.gain.gain.value=b},destroySource:function(a){this.stopSource(a);a.gain.disconnect();a.driver=null;var b=a.gain;R.gainPool.push(b);b.gain.value=1;a.gain=null;for(var b=0,c=a.buffers;b<c.length;){var d=c[b];++b;d.stop();d.clear();this.playbackPool.push(d)}a.buffers=[]},createBuffer:function(){var a=new hk;a.samples=
0;return a},setBufferData:function(a,b,c,d,e,f){var g;switch(d._hx_index){case 0:g=1;break;case 1:g=2;break;case 2:g=4}c=c/g/e|0;a.samples=c;if(0!=c){if(null==a.inst)a.inst=R.getBuffer(e,c,f);else if(a.inst.sampleRate!=f||a.inst.numberOfChannels!=e||a.inst.length!=c)R.putBuffer(a.inst),a.inst=R.getBuffer(e,c,f);switch(d._hx_index){case 0:b=new Uint8Array(b.b.bufferValue);if(1==e){e=a.inst.getChannelData(0);for(a=0;a<c;)d=a++,e[d]=b[d]/255}else{d=a.inst.getChannelData(0);a=a.inst.getChannelData(1);
for(g=f=0;g<c;){var h=g++;d[h]=b[f]/255;a[h]=b[f+1]/255;f+=e}}break;case 1:b=new Int16Array(b.b.bufferValue);if(1==e){e=a.inst.getChannelData(0);for(a=0;a<c;)d=a++,e[d]=b[d]/32768}else{d=a.inst.getChannelData(0);a=a.inst.getChannelData(1);for(g=f=0;g<c;)h=g++,d[h]=b[f]/32768,a[h]=b[f+1]/32768,f+=e}break;case 2:if(b=new Float32Array(b.b.bufferValue),1==e){e=a.inst.getChannelData(0);for(a=0;a<c;)d=a++,e[d]=b[d]}else{d=a.inst.getChannelData(0);a=a.inst.getChannelData(1);for(g=f=0;g<c;)h=g++,d[h]=b[f],
a[h]=b[f+1],f+=e}}}},destroyBuffer:function(a){null!=a.inst&&R.putBuffer(a.inst);a.inst=null},queueBuffer:function(a,b,c,d){var e=0!=this.playbackPool.length?this.playbackPool.pop():new Ei;null!=b.inst&&(e.set(b,c/b.inst.length*b.inst.duration),b.isEnd=d,a.buffers.push(e),a.playing&&(1!=a.buffers.length?(c=a.buffers[a.buffers.length-2].ends,b=this.ctx,isFinite(c)?(d=this.ctx.currentTime,c=c<d?d:c):c=this.ctx.currentTime,e.start(b,a,c)):e.start(this.ctx,a,this.ctx.currentTime)))},unqueueBuffer:function(a,
b){for(;0<a.buffers.length;){var c=a.buffers[0];if(c.buffer==b){a.buffers.splice(0,1);c.stop(!b.isEnd);c.clear();this.playbackPool.push(c);break}}a.sampleOffset=b.isEnd||!a.playing?0:a.sampleOffset+b.samples},getProcessedBuffers:function(a){var b=0,c=0;for(a=a.buffers;c<a.length;){var d=a[c];++c;d.consumed&&++b}return b},getPlayedSampleCount:function(a){for(var b=0,c=null,d=0,e=a.buffers;d<e.length;){var f=e[d];++d;if(f.consumed)b+=f.buffer.samples;else if(f.dirty){c=f;break}}return null!=c?a.sampleOffset+
b+c.get_currentSample():a.sampleOffset+b},update:function(){},dispose:function(){},getEffectDriver:function(a){switch(a){case "lowpass":return new Fi;case "pitch":return new Gi;case "spatialization":return new Hi;default:return new ae}},get_masterGain:function(){return R.masterGain},set_destination:function(a){return R.destination=a},get_destination:function(){return R.destination},__class__:Di};var Fi=function(){this.pool=[]};r["hxd.snd.webaudio.LowPassDriver"]=Fi;Fi.__name__="hxd.snd.webaudio.LowPassDriver";
Fi.__super__=ae;Fi.prototype=J(ae.prototype,{get:function(a){if(0!=this.pool.length)return this.pool.pop();a=a.createBiquadFilter();a.type="lowpass";return a},bind:function(a,b){b.lowPass=this.get(b.driver.ctx);b.updateDestination();this.apply(a,b)},apply:function(a,b){var c=b.driver.ctx.sampleRate/2,d=Math.log(c/40)/Math.LN2;b.lowPass.frequency.value=c*Math.pow(2,d*(a.gainHF-1))},unbind:function(a,b){this.pool.push(b.lowPass);b.lowPass.disconnect();b.lowPass=null;null!=b.driver&&b.updateDestination()},
__class__:Fi});var Gi=function(){};r["hxd.snd.webaudio.PitchDriver"]=Gi;Gi.__name__="hxd.snd.webaudio.PitchDriver";Gi.__super__=ae;Gi.prototype=J(ae.prototype,{apply:function(a,b){b.pitch!=a.value&&(b.pitch=a.value,b.applyPitch())},unbind:function(a,b){b.pitch=1;b.applyPitch()},__class__:Gi});var Hi=function(){this.pool=[]};r["hxd.snd.webaudio.SpatializationDriver"]=Hi;Hi.__name__="hxd.snd.webaudio.SpatializationDriver";Hi.__super__=ae;Hi.prototype=J(ae.prototype,{get:function(a){return 0!=this.pool.length?
this.pool.pop():a.createPanner()},bind:function(a,b){b.panner=this.get(b.driver.ctx);b.updateDestination();this.apply(a,b)},apply:function(a,b){b.panner.setPosition(-a.position.x,a.position.y,a.position.z);b.panner.setOrientation(-a.direction.x,a.direction.y,a.direction.z);b.panner.rolloffFactor=a.rollOffFactor;b.panner.refDistance=a.referenceDistance;b.panner.maxDistance=null==a.maxDistance?3.40282347E38:a.maxDistance},unbind:function(a,b){this.pool.push(b.panner);b.panner.disconnect();b.panner=
null;null!=b.driver&&b.updateDestination()},__class__:Hi});var u=K["hxsl.Type"]={__ename__:!0,__constructs__:"TVoid TInt TBool TFloat TString TVec TMat3 TMat4 TMat3x4 TBytes TSampler2D TSampler2DArray TSamplerCube TStruct TFun TArray TBuffer TChannel".split(" "),TVoid:{_hx_index:0,__enum__:"hxsl.Type",toString:m},TInt:{_hx_index:1,__enum__:"hxsl.Type",toString:m},TBool:{_hx_index:2,__enum__:"hxsl.Type",toString:m},TFloat:{_hx_index:3,__enum__:"hxsl.Type",toString:m},TString:{_hx_index:4,__enum__:"hxsl.Type",
toString:m},TVec:(s=function(a,b){return{_hx_index:5,size:a,t:b,__enum__:"hxsl.Type",toString:m}},s.__params__=["size","t"],s),TMat3:{_hx_index:6,__enum__:"hxsl.Type",toString:m},TMat4:{_hx_index:7,__enum__:"hxsl.Type",toString:m},TMat3x4:{_hx_index:8,__enum__:"hxsl.Type",toString:m},TBytes:(s=function(a){return{_hx_index:9,size:a,__enum__:"hxsl.Type",toString:m}},s.__params__=["size"],s),TSampler2D:{_hx_index:10,__enum__:"hxsl.Type",toString:m},TSampler2DArray:{_hx_index:11,__enum__:"hxsl.Type",
toString:m},TSamplerCube:{_hx_index:12,__enum__:"hxsl.Type",toString:m},TStruct:(s=function(a){return{_hx_index:13,vl:a,__enum__:"hxsl.Type",toString:m}},s.__params__=["vl"],s),TFun:(s=function(a){return{_hx_index:14,variants:a,__enum__:"hxsl.Type",toString:m}},s.__params__=["variants"],s),TArray:(s=function(a,b){return{_hx_index:15,t:a,size:b,__enum__:"hxsl.Type",toString:m}},s.__params__=["t","size"],s),TBuffer:(s=function(a,b){return{_hx_index:16,t:a,size:b,__enum__:"hxsl.Type",toString:m}},s.__params__=
["t","size"],s),TChannel:(s=function(a){return{_hx_index:17,size:a,__enum__:"hxsl.Type",toString:m}},s.__params__=["size"],s)};u.__empty_constructs__=[u.TVoid,u.TInt,u.TBool,u.TFloat,u.TString,u.TMat3,u.TMat4,u.TMat3x4,u.TSampler2D,u.TSampler2DArray,u.TSamplerCube];var ab=K["hxsl.VecType"]={__ename__:!0,__constructs__:["VInt","VFloat","VBool"],VInt:{_hx_index:0,__enum__:"hxsl.VecType",toString:m},VFloat:{_hx_index:1,__enum__:"hxsl.VecType",toString:m},VBool:{_hx_index:2,__enum__:"hxsl.VecType",toString:m}};
ab.__empty_constructs__=[ab.VInt,ab.VFloat,ab.VBool];var tb=K["hxsl.SizeDecl"]={__ename__:!0,__constructs__:["SConst","SVar"],SConst:(s=function(a){return{_hx_index:0,v:a,__enum__:"hxsl.SizeDecl",toString:m}},s.__params__=["v"],s),SVar:(s=function(a){return{_hx_index:1,v:a,__enum__:"hxsl.SizeDecl",toString:m}},s.__params__=["v"],s)};tb.__empty_constructs__=[];var Za=function(a,b){this.msg=a;this.pos=b};r["hxsl.Error"]=Za;Za.__name__="hxsl.Error";Za.t=function(a,b){throw new q(new Za(a,b));};Za.prototype=
{toString:function(){return"Error("+this.msg+")@"+n.string(this.pos)},__class__:Za};var Y=K["hxsl.VarKind"]={__ename__:!0,__constructs__:"Global Input Param Var Local Output Function".split(" "),Global:{_hx_index:0,__enum__:"hxsl.VarKind",toString:m},Input:{_hx_index:1,__enum__:"hxsl.VarKind",toString:m},Param:{_hx_index:2,__enum__:"hxsl.VarKind",toString:m},Var:{_hx_index:3,__enum__:"hxsl.VarKind",toString:m},Local:{_hx_index:4,__enum__:"hxsl.VarKind",toString:m},Output:{_hx_index:5,__enum__:"hxsl.VarKind",
toString:m},Function:{_hx_index:6,__enum__:"hxsl.VarKind",toString:m}};Y.__empty_constructs__=[Y.Global,Y.Input,Y.Param,Y.Var,Y.Local,Y.Output,Y.Function];var jb=K["hxsl.VarQualifier"]={__ename__:!0,__constructs__:"Const Private Nullable PerObject Name Shared Precision Range Ignore PerInstance".split(" "),Const:(s=function(a){return{_hx_index:0,max:a,__enum__:"hxsl.VarQualifier",toString:m}},s.__params__=["max"],s),Private:{_hx_index:1,__enum__:"hxsl.VarQualifier",toString:m},Nullable:{_hx_index:2,
__enum__:"hxsl.VarQualifier",toString:m},PerObject:{_hx_index:3,__enum__:"hxsl.VarQualifier",toString:m},Name:(s=function(a){return{_hx_index:4,n:a,__enum__:"hxsl.VarQualifier",toString:m}},s.__params__=["n"],s),Shared:{_hx_index:5,__enum__:"hxsl.VarQualifier",toString:m},Precision:(s=function(a){return{_hx_index:6,p:a,__enum__:"hxsl.VarQualifier",toString:m}},s.__params__=["p"],s),Range:(s=function(a,b){return{_hx_index:7,min:a,max:b,__enum__:"hxsl.VarQualifier",toString:m}},s.__params__=["min",
"max"],s),Ignore:{_hx_index:8,__enum__:"hxsl.VarQualifier",toString:m},PerInstance:(s=function(a){return{_hx_index:9,v:a,__enum__:"hxsl.VarQualifier",toString:m}},s.__params__=["v"],s)};jb.__empty_constructs__=[jb.Private,jb.Nullable,jb.PerObject,jb.Shared,jb.Ignore];var kk=K["hxsl.Prec"]={__ename__:!0,__constructs__:["Low","Medium","High"],Low:{_hx_index:0,__enum__:"hxsl.Prec",toString:m},Medium:{_hx_index:1,__enum__:"hxsl.Prec",toString:m},High:{_hx_index:2,__enum__:"hxsl.Prec",toString:m}};kk.__empty_constructs__=
[kk.Low,kk.Medium,kk.High];var F=K["hxsl.Const"]={__ename__:!0,__constructs__:["CNull","CBool","CInt","CFloat","CString"],CNull:{_hx_index:0,__enum__:"hxsl.Const",toString:m},CBool:(s=function(a){return{_hx_index:1,b:a,__enum__:"hxsl.Const",toString:m}},s.__params__=["b"],s),CInt:(s=function(a){return{_hx_index:2,v:a,__enum__:"hxsl.Const",toString:m}},s.__params__=["v"],s),CFloat:(s=function(a){return{_hx_index:3,v:a,__enum__:"hxsl.Const",toString:m}},s.__params__=["v"],s),CString:(s=function(a){return{_hx_index:4,
v:a,__enum__:"hxsl.Const",toString:m}},s.__params__=["v"],s)};F.__empty_constructs__=[F.CNull];var Mk=K["hxsl.ExprDef"]={__ename__:!0,__constructs__:"EConst EIdent EParenthesis EField EBinop EUnop ECall EBlock EVars EFunction EIf EDiscard EFor EReturn EBreak EContinue EArray EArrayDecl ESwitch EWhile EMeta".split(" "),EConst:(s=function(a){return{_hx_index:0,c:a,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["c"],s),EIdent:(s=function(a){return{_hx_index:1,i:a,__enum__:"hxsl.ExprDef",toString:m}},
s.__params__=["i"],s),EParenthesis:(s=function(a){return{_hx_index:2,e:a,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["e"],s),EField:(s=function(a,b){return{_hx_index:3,e:a,f:b,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["e","f"],s),EBinop:(s=function(a,b,c){return{_hx_index:4,op:a,e1:b,e2:c,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["op","e1","e2"],s),EUnop:(s=function(a,b){return{_hx_index:5,op:a,e1:b,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["op","e1"],s),ECall:(s=
function(a,b){return{_hx_index:6,e:a,args:b,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["e","args"],s),EBlock:(s=function(a){return{_hx_index:7,el:a,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["el"],s),EVars:(s=function(a){return{_hx_index:8,v:a,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["v"],s),EFunction:(s=function(a){return{_hx_index:9,f:a,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["f"],s),EIf:(s=function(a,b,c){return{_hx_index:10,econd:a,eif:b,eelse:c,__enum__:"hxsl.ExprDef",
toString:m}},s.__params__=["econd","eif","eelse"],s),EDiscard:{_hx_index:11,__enum__:"hxsl.ExprDef",toString:m},EFor:(s=function(a,b,c){return{_hx_index:12,v:a,loop:b,block:c,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["v","loop","block"],s),EReturn:(s=function(a){return{_hx_index:13,e:a,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["e"],s),EBreak:{_hx_index:14,__enum__:"hxsl.ExprDef",toString:m},EContinue:{_hx_index:15,__enum__:"hxsl.ExprDef",toString:m},EArray:(s=function(a,b){return{_hx_index:16,
e:a,eindex:b,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["e","eindex"],s),EArrayDecl:(s=function(a){return{_hx_index:17,el:a,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["el"],s),ESwitch:(s=function(a,b,c){return{_hx_index:18,e:a,cases:b,def:c,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["e","cases","def"],s),EWhile:(s=function(a,b,c){return{_hx_index:19,cond:a,loop:b,normalWhile:c,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["cond","loop","normalWhile"],s),EMeta:(s=function(a,
b,c){return{_hx_index:20,name:a,args:b,e:c,__enum__:"hxsl.ExprDef",toString:m}},s.__params__=["name","args","e"],s)};Mk.__empty_constructs__=[Mk.EDiscard,Mk.EBreak,Mk.EContinue];var dc=K["hxsl.FunctionKind"]={__ename__:!0,__constructs__:["Vertex","Fragment","Init","Helper"],Vertex:{_hx_index:0,__enum__:"hxsl.FunctionKind",toString:m},Fragment:{_hx_index:1,__enum__:"hxsl.FunctionKind",toString:m},Init:{_hx_index:2,__enum__:"hxsl.FunctionKind",toString:m},Helper:{_hx_index:3,__enum__:"hxsl.FunctionKind",
toString:m}};dc.__empty_constructs__=[dc.Vertex,dc.Fragment,dc.Init,dc.Helper];var G=K["hxsl.TGlobal"]={__ename__:!0,__constructs__:"Radians Degrees Sin Cos Tan Asin Acos Atan Pow Exp Log Exp2 Log2 Sqrt Inversesqrt Abs Sign Floor Ceil Fract Mod Min Max Clamp Mix Step Smoothstep Length Distance Dot Cross Normalize LReflect Texture TextureLod Texel TexelLod ToInt ToFloat ToBool Vec2 Vec3 Vec4 IVec2 IVec3 IVec4 BVec2 BVec3 BVec4 Mat2 Mat3 Mat4 Mat3x4 Saturate Pack Unpack PackNormal UnpackNormal ScreenToUv UvToScreen DFdx DFdy Fwidth ChannelRead ChannelReadLod ChannelFetch ChannelFetchLod Trace VertexID InstanceID FragCoord".split(" "),
Radians:{_hx_index:0,__enum__:"hxsl.TGlobal",toString:m},Degrees:{_hx_index:1,__enum__:"hxsl.TGlobal",toString:m},Sin:{_hx_index:2,__enum__:"hxsl.TGlobal",toString:m},Cos:{_hx_index:3,__enum__:"hxsl.TGlobal",toString:m},Tan:{_hx_index:4,__enum__:"hxsl.TGlobal",toString:m},Asin:{_hx_index:5,__enum__:"hxsl.TGlobal",toString:m},Acos:{_hx_index:6,__enum__:"hxsl.TGlobal",toString:m},Atan:{_hx_index:7,__enum__:"hxsl.TGlobal",toString:m},Pow:{_hx_index:8,__enum__:"hxsl.TGlobal",toString:m},Exp:{_hx_index:9,
__enum__:"hxsl.TGlobal",toString:m},Log:{_hx_index:10,__enum__:"hxsl.TGlobal",toString:m},Exp2:{_hx_index:11,__enum__:"hxsl.TGlobal",toString:m},Log2:{_hx_index:12,__enum__:"hxsl.TGlobal",toString:m},Sqrt:{_hx_index:13,__enum__:"hxsl.TGlobal",toString:m},Inversesqrt:{_hx_index:14,__enum__:"hxsl.TGlobal",toString:m},Abs:{_hx_index:15,__enum__:"hxsl.TGlobal",toString:m},Sign:{_hx_index:16,__enum__:"hxsl.TGlobal",toString:m},Floor:{_hx_index:17,__enum__:"hxsl.TGlobal",toString:m},Ceil:{_hx_index:18,
__enum__:"hxsl.TGlobal",toString:m},Fract:{_hx_index:19,__enum__:"hxsl.TGlobal",toString:m},Mod:{_hx_index:20,__enum__:"hxsl.TGlobal",toString:m},Min:{_hx_index:21,__enum__:"hxsl.TGlobal",toString:m},Max:{_hx_index:22,__enum__:"hxsl.TGlobal",toString:m},Clamp:{_hx_index:23,__enum__:"hxsl.TGlobal",toString:m},Mix:{_hx_index:24,__enum__:"hxsl.TGlobal",toString:m},Step:{_hx_index:25,__enum__:"hxsl.TGlobal",toString:m},Smoothstep:{_hx_index:26,__enum__:"hxsl.TGlobal",toString:m},Length:{_hx_index:27,
__enum__:"hxsl.TGlobal",toString:m},Distance:{_hx_index:28,__enum__:"hxsl.TGlobal",toString:m},Dot:{_hx_index:29,__enum__:"hxsl.TGlobal",toString:m},Cross:{_hx_index:30,__enum__:"hxsl.TGlobal",toString:m},Normalize:{_hx_index:31,__enum__:"hxsl.TGlobal",toString:m},LReflect:{_hx_index:32,__enum__:"hxsl.TGlobal",toString:m},Texture:{_hx_index:33,__enum__:"hxsl.TGlobal",toString:m},TextureLod:{_hx_index:34,__enum__:"hxsl.TGlobal",toString:m},Texel:{_hx_index:35,__enum__:"hxsl.TGlobal",toString:m},TexelLod:{_hx_index:36,
__enum__:"hxsl.TGlobal",toString:m},ToInt:{_hx_index:37,__enum__:"hxsl.TGlobal",toString:m},ToFloat:{_hx_index:38,__enum__:"hxsl.TGlobal",toString:m},ToBool:{_hx_index:39,__enum__:"hxsl.TGlobal",toString:m},Vec2:{_hx_index:40,__enum__:"hxsl.TGlobal",toString:m},Vec3:{_hx_index:41,__enum__:"hxsl.TGlobal",toString:m},Vec4:{_hx_index:42,__enum__:"hxsl.TGlobal",toString:m},IVec2:{_hx_index:43,__enum__:"hxsl.TGlobal",toString:m},IVec3:{_hx_index:44,__enum__:"hxsl.TGlobal",toString:m},IVec4:{_hx_index:45,
__enum__:"hxsl.TGlobal",toString:m},BVec2:{_hx_index:46,__enum__:"hxsl.TGlobal",toString:m},BVec3:{_hx_index:47,__enum__:"hxsl.TGlobal",toString:m},BVec4:{_hx_index:48,__enum__:"hxsl.TGlobal",toString:m},Mat2:{_hx_index:49,__enum__:"hxsl.TGlobal",toString:m},Mat3:{_hx_index:50,__enum__:"hxsl.TGlobal",toString:m},Mat4:{_hx_index:51,__enum__:"hxsl.TGlobal",toString:m},Mat3x4:{_hx_index:52,__enum__:"hxsl.TGlobal",toString:m},Saturate:{_hx_index:53,__enum__:"hxsl.TGlobal",toString:m},Pack:{_hx_index:54,
__enum__:"hxsl.TGlobal",toString:m},Unpack:{_hx_index:55,__enum__:"hxsl.TGlobal",toString:m},PackNormal:{_hx_index:56,__enum__:"hxsl.TGlobal",toString:m},UnpackNormal:{_hx_index:57,__enum__:"hxsl.TGlobal",toString:m},ScreenToUv:{_hx_index:58,__enum__:"hxsl.TGlobal",toString:m},UvToScreen:{_hx_index:59,__enum__:"hxsl.TGlobal",toString:m},DFdx:{_hx_index:60,__enum__:"hxsl.TGlobal",toString:m},DFdy:{_hx_index:61,__enum__:"hxsl.TGlobal",toString:m},Fwidth:{_hx_index:62,__enum__:"hxsl.TGlobal",toString:m},
ChannelRead:{_hx_index:63,__enum__:"hxsl.TGlobal",toString:m},ChannelReadLod:{_hx_index:64,__enum__:"hxsl.TGlobal",toString:m},ChannelFetch:{_hx_index:65,__enum__:"hxsl.TGlobal",toString:m},ChannelFetchLod:{_hx_index:66,__enum__:"hxsl.TGlobal",toString:m},Trace:{_hx_index:67,__enum__:"hxsl.TGlobal",toString:m},VertexID:{_hx_index:68,__enum__:"hxsl.TGlobal",toString:m},InstanceID:{_hx_index:69,__enum__:"hxsl.TGlobal",toString:m},FragCoord:{_hx_index:70,__enum__:"hxsl.TGlobal",toString:m}};G.__empty_constructs__=
[G.Radians,G.Degrees,G.Sin,G.Cos,G.Tan,G.Asin,G.Acos,G.Atan,G.Pow,G.Exp,G.Log,G.Exp2,G.Log2,G.Sqrt,G.Inversesqrt,G.Abs,G.Sign,G.Floor,G.Ceil,G.Fract,G.Mod,G.Min,G.Max,G.Clamp,G.Mix,G.Step,G.Smoothstep,G.Length,G.Distance,G.Dot,G.Cross,G.Normalize,G.LReflect,G.Texture,G.TextureLod,G.Texel,G.TexelLod,G.ToInt,G.ToFloat,G.ToBool,G.Vec2,G.Vec3,G.Vec4,G.IVec2,G.IVec3,G.IVec4,G.BVec2,G.BVec3,G.BVec4,G.Mat2,G.Mat3,G.Mat4,G.Mat3x4,G.Saturate,G.Pack,G.Unpack,G.PackNormal,G.UnpackNormal,G.ScreenToUv,G.UvToScreen,
G.DFdx,G.DFdy,G.Fwidth,G.ChannelRead,G.ChannelReadLod,G.ChannelFetch,G.ChannelFetchLod,G.Trace,G.VertexID,G.InstanceID,G.FragCoord];var ca=K["hxsl.Component"]={__ename__:!0,__constructs__:["X","Y","Z","W"],X:{_hx_index:0,__enum__:"hxsl.Component",toString:m},Y:{_hx_index:1,__enum__:"hxsl.Component",toString:m},Z:{_hx_index:2,__enum__:"hxsl.Component",toString:m},W:{_hx_index:3,__enum__:"hxsl.Component",toString:m}};ca.__empty_constructs__=[ca.X,ca.Y,ca.Z,ca.W];var p=K["hxsl.TExprDef"]={__ename__:!0,
__constructs__:"TConst TVar TGlobal TParenthesis TBlock TBinop TUnop TVarDecl TCall TSwiz TIf TDiscard TReturn TFor TContinue TBreak TArray TArrayDecl TSwitch TWhile TMeta".split(" "),TConst:(s=function(a){return{_hx_index:0,c:a,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["c"],s),TVar:(s=function(a){return{_hx_index:1,v:a,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["v"],s),TGlobal:(s=function(a){return{_hx_index:2,g:a,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["g"],s),TParenthesis:(s=
function(a){return{_hx_index:3,e:a,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["e"],s),TBlock:(s=function(a){return{_hx_index:4,el:a,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["el"],s),TBinop:(s=function(a,b,c){return{_hx_index:5,op:a,e1:b,e2:c,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["op","e1","e2"],s),TUnop:(s=function(a,b){return{_hx_index:6,op:a,e1:b,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["op","e1"],s),TVarDecl:(s=function(a,b){return{_hx_index:7,v:a,init:b,
__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["v","init"],s),TCall:(s=function(a,b){return{_hx_index:8,e:a,args:b,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["e","args"],s),TSwiz:(s=function(a,b){return{_hx_index:9,e:a,regs:b,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["e","regs"],s),TIf:(s=function(a,b,c){return{_hx_index:10,econd:a,eif:b,eelse:c,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["econd","eif","eelse"],s),TDiscard:{_hx_index:11,__enum__:"hxsl.TExprDef",toString:m},
TReturn:(s=function(a){return{_hx_index:12,e:a,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["e"],s),TFor:(s=function(a,b,c){return{_hx_index:13,v:a,it:b,loop:c,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["v","it","loop"],s),TContinue:{_hx_index:14,__enum__:"hxsl.TExprDef",toString:m},TBreak:{_hx_index:15,__enum__:"hxsl.TExprDef",toString:m},TArray:(s=function(a,b){return{_hx_index:16,e:a,index:b,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["e","index"],s),TArrayDecl:(s=function(a){return{_hx_index:17,
el:a,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["el"],s),TSwitch:(s=function(a,b,c){return{_hx_index:18,e:a,cases:b,def:c,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["e","cases","def"],s),TWhile:(s=function(a,b,c){return{_hx_index:19,e:a,loop:b,normalWhile:c,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["e","loop","normalWhile"],s),TMeta:(s=function(a,b,c){return{_hx_index:20,m:a,args:b,e:c,__enum__:"hxsl.TExprDef",toString:m}},s.__params__=["m","args","e"],s)};p.__empty_constructs__=
[p.TDiscard,p.TContinue,p.TBreak];var w=function(){};r["hxsl.Tools"]=w;w.__name__="hxsl.Tools";w.allocVarId=function(){return++w.UID};w.getName=function(a){if(null==a.qualifiers)return a.name;for(var b=0,c=a.qualifiers;b<c.length;){var d=c[b];++b;if(4==d._hx_index)return d.n}return a.name};w.getConstBits=function(a){switch(a.type._hx_index){case 1:var b=0;for(a=a.qualifiers;b<a.length;){var c=a[b];++b;if(0==c._hx_index){b=c.max;if(null!=b){for(a=0;b>=1<<a;)++a;return a}return 8}}break;case 2:return 1;
case 17:return 3+w.MAX_CHANNELS_BITS}return 0};w.isConst=function(a){if(17==a.type._hx_index)return!0;if(null!=a.qualifiers){var b=0;for(a=a.qualifiers;b<a.length;){var c=a[b];++b;if(0==c._hx_index)return!0}}return!1};w.isStruct=function(a){return 13==a.type._hx_index?!0:!1};w.isArray=function(a){return 15==a.type._hx_index?!0:!1};w.hasQualifier=function(a,b){if(null!=a.qualifiers)for(var c=0,d=a.qualifiers;c<d.length;){var e=d[c];++c;if(e==b)return!0}return!1};w.isSampler=function(a){switch(a._hx_index){case 10:case 11:case 12:return!0;
case 17:return!0;default:return!1}};w.toString=function(a){switch(a._hx_index){case 5:var b=a.size,c;switch(a.t._hx_index){case 0:c="I";break;case 1:c="";break;case 2:c="B"}return c+"Vec"+b;case 9:return"Bytes"+a.size;case 13:a=a.vl;for(var b=[],d=0;d<a.length;)c=a[d],++d,b.push(c.name+" : "+w.toString(c.type));return"{"+b.join(",")+"}";case 15:d=a.size;a=w.toString(a.t)+"[";switch(d._hx_index){case 0:b=""+d.v;break;case 1:b=d.v.name}return a+b+"]";case 16:b=a.size;a="buffer "+w.toString(a.t)+"[";
switch(b._hx_index){case 0:d=""+b.v;break;case 1:d=b.v.name}return a+d+"]";default:return v.substr(K[a.__enum__].__constructs__[a._hx_index],1,null)}};w.toType=function(a){switch(a._hx_index){case 0:return u.TInt;case 1:return u.TFloat;case 2:return u.TBool}};w.hasSideEffect=function(a){a=a.e;switch(a._hx_index){case 0:return!1;case 1:return!1;case 2:return!1;case 3:return w.hasSideEffect(a.e);case 4:a=a.el;for(var b=0;b<a.length;){var c=a[b];++b;if(w.hasSideEffect(c))return!0}return!1;case 5:switch(a.op._hx_index){case 4:return!0;
case 20:return!0;default:return b=a.e2,w.hasSideEffect(a.e1)?!0:w.hasSideEffect(b)}case 6:return w.hasSideEffect(a.e1);case 7:return!0;case 8:return!0;case 9:return w.hasSideEffect(a.e);case 10:return b=a.eelse,c=a.eif,!w.hasSideEffect(a.econd)&&!w.hasSideEffect(c)?null!=b?w.hasSideEffect(b):!1:!0;case 12:return!0;case 13:return b=a.loop,w.hasSideEffect(a.it)?!0:w.hasSideEffect(b);case 11:case 14:case 15:return!0;case 16:return b=a.index,w.hasSideEffect(a.e)?!0:w.hasSideEffect(b);case 17:a=a.el;for(b=
0;b<a.length;)if(c=a[b],++b,w.hasSideEffect(c))return!0;return!1;case 18:b=a.def;c=a.cases;a=a.e;for(var d=0;d<c.length;){var e=c[d];++d;for(var f=0,g=e.values;f<g.length;){var h=g[f];++f;if(w.hasSideEffect(h))return!0}if(w.hasSideEffect(e.expr))return!0}return w.hasSideEffect(a)?!0:null!=b?w.hasSideEffect(b):!1;case 19:return b=a.loop,w.hasSideEffect(a.e)?!0:w.hasSideEffect(b);case 20:return w.hasSideEffect(a.e)}};w.iter=function(a,b){var c=a.e;switch(c._hx_index){case 3:b(c.e);break;case 4:for(var c=
c.el,d=0;d<c.length;){var e=c[d];++d;b(e)}break;case 5:d=c.e2;b(c.e1);b(d);break;case 6:b(c.e1);break;case 7:c=c.init;null!=c&&b(c);break;case 8:d=c.args;b(c.e);for(c=0;c<d.length;)e=d[c],++c,b(e);break;case 9:b(c.e);break;case 10:d=c.eelse;e=c.eif;b(c.econd);b(e);null!=d&&b(d);break;case 12:c=c.e;null!=c&&b(c);break;case 13:d=c.loop;b(c.it);b(d);break;case 16:d=c.index;b(c.e);b(d);break;case 17:c=c.el;for(d=0;d<c.length;)e=c[d],++d,b(e);break;case 18:d=c.def;e=c.cases;b(c.e);for(c=0;c<e.length;){var f=
e[c];++c;for(var g=0,h=f.values;g<h.length;){var k=h[g];++g;b(k)}b(f.expr)}null!=d&&b(d);break;case 19:d=c.loop;b(c.e);b(d);break;case 20:b(c.e)}};w.map=function(a,b){var c,d=a.e;switch(d._hx_index){case 0:c=a.e;break;case 1:c=a.e;break;case 2:c=a.e;break;case 3:c=p.TParenthesis(b(d.e));break;case 4:d=d.el;c=[];for(var e=0;e<d.length;){var f=d[e];++e;c.push(b(f))}c=p.TBlock(c);break;case 5:c=d.e2;c=p.TBinop(d.op,b(d.e1),b(c));break;case 6:c=p.TUnop(d.op,b(d.e1));break;case 7:c=d.init;c=p.TVarDecl(d.v,
null!=c?b(c):null);break;case 8:c=d.args;d=b(d.e);e=[];for(f=0;f<c.length;){var g=c[f];++f;e.push(b(g))}c=p.TCall(d,e);break;case 9:c=d.regs;c=p.TSwiz(b(d.e),c);break;case 10:c=d.eelse;e=d.eif;c=p.TIf(b(d.econd),b(e),null!=c?b(c):null);break;case 12:d=d.e;c=p.TReturn(null!=d?b(d):null);break;case 13:c=d.loop;c=p.TFor(d.v,b(d.it),b(c));break;case 11:case 14:case 15:c=a.e;break;case 16:c=d.index;c=p.TArray(b(d.e),b(c));break;case 17:d=d.el;c=[];for(e=0;e<d.length;)f=d[e],++e,c.push(b(f));c=p.TArrayDecl(c);
break;case 18:c=d.def;e=d.cases;d=b(d.e);f=[];for(g=0;g<e.length;){var h=e[g];++g;for(var k=[],l=0,m=h.values;l<m.length;){var n=m[l];++l;k.push(b(n))}f.push({values:k,expr:b(h.expr)})}c=p.TSwitch(d,f,null==c?null:b(c));break;case 19:c=d.normalWhile;e=d.loop;c=p.TWhile(b(d.e),b(e),c);break;case 20:c=p.TMeta(d.m,d.args,b(d.e))}return{e:c,t:a.t,p:a.p}};w.size=function(a){switch(a._hx_index){case 0:return 0;case 1:case 3:return 1;case 2:case 4:case 10:case 11:case 12:return 0;case 5:return a.size;case 6:return 9;
case 7:return 16;case 8:return 12;case 9:return a.size;case 13:a=a.vl;for(var b=0,c=0;c<a.length;){var d=a[c];++c;b+=w.size(d.type)}return b;case 14:return 0;case 15:b=a.size;a=a.t;switch(b._hx_index){case 0:return b=b.v,w.size(a)*b;case 1:return 0}break;case 16:return b=a.size,0==b._hx_index?(b=b.v,w.size(a.t)*b):0;case 17:return a.size}};w.evalConst=function(a){var b=a.e;switch(b._hx_index){case 0:var c=b.c;switch(c._hx_index){case 0:return null;case 1:return c.b;case 2:return c.v;case 3:return c.v;
case 4:return c.v}break;case 8:if(c=b.args,b=b.e.e,2==b._hx_index)switch(b.g._hx_index){case 40:case 41:case 42:a=[];for(b=0;b<c.length;){var d=c[b];++b;a.push(w.evalConst(d))}return 1==a.length?new B(a[0],a[0],a[0],a[0]):new B(a[0],a[1],a[2],a[3]);default:throw new q("Unhandled constant init "+aa.toString(a));}else throw new q("Unhandled constant init "+aa.toString(a));default:throw new q("Unhandled constant init "+aa.toString(a));}};var Nk=function(){};r["hxsl.Tools2"]=Nk;Nk.__name__="hxsl.Tools2";
Nk.toString=function(a){a=K[a.__enum__].__constructs__[a._hx_index];return a.charAt(0).toLowerCase()+v.substr(a,1,null)};var Wk=function(){};r["hxsl.Tools3"]=Wk;Wk.__name__="hxsl.Tools3";Wk.toString=function(a){return aa.shaderToString(a)};var Xk=function(){};r["hxsl.Tools4"]=Xk;Xk.__name__="hxsl.Tools4";Xk.toString=function(a){return aa.toString(a)};var mg=function(){this.Batch_Count__=0;T.call(this)};r["hxsl.BatchShader"]=mg;mg.__name__="hxsl.BatchShader";mg.__super__=T;mg.prototype=J(T.prototype,
{get_Batch_Count:function(){return this.Batch_Count__},set_Batch_Count:function(a){this.constModified=!0;return this.Batch_Count__=a},get_Batch_Buffer:function(){return this.Batch_Buffer__},set_Batch_Buffer:function(a){return this.Batch_Buffer__=a},updateConstants:function(a){this.constBits=0;var b=this.Batch_Count__;if(0!=b>>>17)throw new q("Batch_Count is out of range "+b+">131071");this.constBits|=b;this.updateConstantsFinal(a)},getParamValue:function(a){switch(a){case 0:return this.Batch_Count__;
case 1:return this.Batch_Buffer__}return null},getParamFloatValue:function(a){return 0},clone:function(){var a=Object.create(mg.prototype);a.shader=this.shader;a.Batch_Count__=this.Batch_Count__;a.Batch_Buffer__=this.Batch_Buffer__;return a},__class__:mg});var Ii=function(){};r["hxsl.SearchMap"]=Ii;Ii.__name__="hxsl.SearchMap";Ii.prototype={__class__:Ii};var wd=function(){this.constsToGlobal=!1;this.linkCache=new Ii;this.linkShaders=new ga;this.batchShaders=new na;this.byID=new ga};r["hxsl.Cache"]=
wd;wd.__name__="hxsl.Cache";wd.get=function(){var a=wd.INST;null==a&&(a=new wd,wd.INST=a);return a};wd.set=function(a){wd.INST=a};wd.clear=function(){wd.INST=null};wd.prototype={getLinkShader:function(a){for(var b=[],c=0;c<a.length;){var d=a[c];++c;b.push(n.string(d))}b=b.join(",");c=this.linkShaders;c=null!=Q[b]?c.getReserved(b):c.h[b];if(null!=c)return c;var e=new qe(""),c=v.substr(Td.encode(b),0,8);e.data={name:"shaderLinker_"+c,vars:[],funs:[]};var f=new ga,g=0,h=u.TVec(4,ab.VFloat),k=function(a,
b,c,d){for(var e=[],f=b,g=0,h=c.length;g<h;){var k=g++,k=d(c[c.length-1-k],f-(c.length-1-k)),f=f-w.size(k.t);e.unshift(k)}return{e:p.TCall({e:p.TGlobal(a),t:u.TVoid,p:null},e),t:u.TVec(b,ab.VFloat),p:null}},l=function(a,b,c){var d=null==c?a:w.getName(c)+"."+a,g=null!=Q[d]?f.getReserved(d):f.h[d];if(null!=g)return g;g={id:w.allocVarId(),name:a,type:b,kind:Y.Var,parent:c};if(null==c)e.data.vars.push(g);else if(a=c.type,13==a._hx_index)a.vl.push(g);else throw new q("assert");null!=Q[d]?f.setReserved(d,
g):f.h[d]=g;return g},m=null,m=function(a,b){switch(a._hx_index){case 0:return{e:p.TConst(F.CFloat(a.v)),t:u.TFloat,p:null};case 1:var c=a.size,d=a.v,e=null!=Q[d]?f.getReserved(d):f.h[d];if(null!=e)return{e:p.TVar(e),t:e.type,p:null};e=d.split(".");for(d=null;1<e.length;)var g=e.shift(),d=l(g,u.TStruct([]),d);null!=c&&(b=c);c=e.shift();e=l(c,1==b?u.TFloat:u.TVec(b,ab.VFloat),d);return{e:p.TVar(e),t:e.type,p:null};case 2:return c=a.v,{e:p.TCall({e:p.TGlobal(G.PackNormal),t:u.TVoid,p:null},[m(c,3)]),
t:h,p:null};case 3:return c=a.v,{e:p.TCall({e:p.TGlobal(G.Pack),t:u.TVoid,p:null},[m(c,1)]),t:h,p:null};case 4:return k(G.Vec2,2,a.a,m);case 5:return k(G.Vec3,3,a.a,m);case 6:return k(G.Vec4,4,a.a,m);case 7:return c=a.swiz,{e:p.TSwiz(m(a.a,4),c),t:u.TVec(c.length,ab.VFloat),p:null}}},t=function(a){g+=1;var b={id:w.allocVarId(),type:h,name:"OUTPUT"+(g-1),kind:Y.Output};e.data.vars.push(b);return{e:p.TBinop(ma.OpAssign,{e:p.TVar(b),t:h,p:null},m(a,4)),t:u.TVoid,p:null}},c=function(a,b){for(var c={id:w.allocVarId(),
type:u.TFun([]),name:(""+n.string(a)).toLowerCase(),kind:Y.Function},d=[],f=0;f<b.length;){var g=b[f];++f;d.push(t(g))}c={kind:a,ref:c,args:[],ret:u.TVoid,expr:{e:p.TBlock(d),p:null,t:u.TVoid}};e.data.funs.push(c)};c(dc.Vertex,[ec.Value("output.position")]);c(dc.Fragment,a);c=Object.create(T.prototype);c.shader=e;a=this.linkShaders;null!=Q[b]?a.setReserved(b,c):a.h[b]=c;c.updateConstantsFinal(null);return c},link:function(a,b){for(var c=this.linkCache,d=a;null!=d;){var e=d.s,d=d.next,e=e.instance;
null==c.next&&(c.next=new na);var f=c.next.h[e.id];null==f&&(f=new Ii,c.next.h[e.id]=f);c=f}null==c.linked&&(c.linked=this.compileRuntimeShader(a,b));return c.linked},compileRuntimeShader:function(a,b){for(var c=[],d=0,e=a;null!=e;){var f=e.s,e=e.next;c.push({inst:f.instance,p:f.priority,index:d++})}c.reverse();ib.sort(c,function(a,b){return b.p-a.p});var d=new lk(b),g;try{e=[];for(f=0;f<c.length;){var h=c[f];++f;e.push(h.inst.shader)}g=d.link(e)}catch(k){$.lastException=k;var l=k instanceof q?k.val:
k;if(l instanceof Za){g=[];for(h=0;h<c.length;)d=c[h],++h,g.push(aa.shaderToString(d.inst.shader));l.msg+="\n\nin\n\n"+g.join("\n-----\n");throw new q(l);}throw k;}h=new na;e=0;for(d=d.allVars;e<d.length;)if(f=d[e],++e,f.v.kind==Y.Param&&13!=f.v.type._hx_index){var m=c[f.instanceIndex];h.h[f.id]={instance:m.index,index:m.inst.params.h[f.merged[0].id]}}try{l=(new mk).split(g)}catch(n){$.lastException=n;c=n instanceof q?n.val:n;if(c instanceof Za)throw c.msg+="\n\nin\n\n"+aa.shaderToString(g),new q(c);
throw n;}if(b){g=0;for(d=l.vertex.vars;g<d.length;)e=d[g],++g,null!=e.qualifiers&&0<=e.qualifiers.indexOf(jb.PerObject)&&(e.kind=Y.Local)}l=(new nk).dce(l.vertex,l.fragment);l=this.buildRuntimeShader(l.vertex,l.fragment,h);g=[];for(h=a;null!=h;)d=h.s,h=h.next,g.push(new ok(d.shader,d.constBits));l.spec={instances:g,signature:null};g=0;for(h=c.length;g<h;)d=g++,l.spec.instances[c[c.length-1-d].index].index=d;c=[];g=0;for(h=l.spec.instances;g<h.length;)d=h[g],++g,c.push(d.shader.data.name+"_"+d.bits+
"_"+d.index);c=c.join(":");l.spec.signature=Td.encode(c);l.signature=Td.encode(aa.shaderToString(l.vertex.data)+aa.shaderToString(l.fragment.data));l.batchMode=b;c=l.signature;g=this.byID;c=null!=Q[c]?g.getReserved(c):g.h[c];null!=c?l.id=c.id:(c=l.signature,g=this.byID,null!=Q[c]?g.setReserved(c,l):g.h[c]=l);return l},buildRuntimeShader:function(a,b,c){var d=new fh;d.vertex=this.flattenShader(a,dc.Vertex,c);d.vertex.vertex=!0;d.fragment=this.flattenShader(b,dc.Fragment,c);d.globals=new na;this.initGlobals(d,
d.vertex);this.initGlobals(d,d.fragment);return d},initGlobals:function(a,b){for(var c=b.globals;null!=c;)a.globals.h[c.gid]=!0,c=c.next;for(c=b.params;null!=c;)null!=c.perObjectGlobal&&(a.globals.h[c.perObjectGlobal.gid]=!0),c=c.next},getPath:function(a){return null==a.parent?a.name:this.getPath(a.parent)+"."+a.name},flattenShader:function(a,b,c){var d=new pk,e=new qk;a=d.flatten(a,b,this.constsToGlobal);b=[];e.consts=d.consts;e.texturesCount=0;for(var f=d.allocData.keys();f.hasNext();){var g=f.next(),
h=d.allocData.h[g.__id__];switch(g.kind._hx_index){case 0:for(var k=[],l=0;l<h.length;){var m=h[l];++l;null!=m.v&&k.push(new gh(m.pos,this.getPath(m.v),m.v.type))}h=0;for(l=k.length-1;h<l;)m=h++,k[m].next=k[m+1];h=g.type;if(15==h._hx_index)if(g=h.size,h=h.t,5==h._hx_index)if(4==h.size)if(1==h.t._hx_index)if(0==g._hx_index)g=g.v,e.globals=k[0],e.globalsSize=g;else throw new q("assert");else throw new q("assert");else throw new q("assert");else throw new q("assert");else throw new q("assert");break;
case 2:k=[];for(l=0;l<h.length;)if(m=h[l],++l,null!=m.v){var n=c.h[m.v.id];null==n?(n=new hh(m.v.name,m.pos,-1,-1,m.v.type),n.perObjectGlobal=new gh(-1,this.getPath(m.v),m.v.type),k.push(n)):k.push(new hh(m.v.name,m.pos,n.instance,n.index,m.v.type))}h=0;for(l=k.length-1;h<l;)m=h++,k[m].next=k[m+1];h=g.type;if(15==h._hx_index)if(g=h.size,l=h=h.t,w.isSampler(l))b.push({t:l,all:k}),e.texturesCount+=k.length;else switch(h._hx_index){case 5:if(4==h.size)if(1==h.t._hx_index)if(0==g._hx_index)g=g.v,e.params=
k[0],e.paramsSize=g;else throw new q("assert");else throw new q("assert");else throw new q("assert");break;case 16:e.buffers=k[0];e.bufferCount=k.length;break;default:throw new q("assert");}else throw new q("assert");break;default:throw new q("assert");}}if(0<b.length){b.sort(function(a,b){return a.t._hx_index-b.t._hx_index});e.textures=b[0].all[0];c=1;for(d=b.length;c<d;)f=c++,g=b[f-1].all,g[g.length-1].next=b[f].all[0]}null==e.globals&&(e.globalsSize=0);null==e.params&&(e.paramsSize=0);null==e.buffers&&
(e.bufferCount=0);e.data=a;return e},makeBatchShader:function(a){var b=this.batchShaders.h[a.id];null==b&&(b=this.createBatchShader(a),this.batchShaders.h[a.id]=b);a=Object.create(mg.prototype);a.shader=b;return a},createBatchShader:function(a){var b=new qe(""),c=v.substr(a.spec.signature,0,8),d=function(a,b,c){return{id:w.allocVarId(),type:b,name:a,kind:c}},e=d("Batch_Count",u.TInt,Y.Param),f=d("Batch_Buffer",u.TBuffer(u.TVec(4,ab.VFloat),tb.SVar(e)),Y.Param),g=d("Batch_Offset",u.TInt,Y.Local),h=
{e:p.TVar(f),p:null,t:f.type},k={e:p.TVar(g),p:null,t:g.type},l=u.TVec(4,ab.VFloat);e.qualifiers=[jb.Const(65536)];b.data={name:"batchShader_"+c,vars:[e,f,g],funs:[]};for(var f=a.vertex.paramsSize+a.fragment.paramsSize,m=new zb,t=[[ca.X],[ca.Y],[ca.Z],[ca.W]],r=function(a){return{e:p.TArray(h,{e:p.TBinop(ma.OpAdd,k,{e:p.TConst(F.CInt(a)),t:u.TInt,p:null}),t:u.TInt,p:null}),t:l,p:null}},g=function(a,c){var e=d(a.name,a.type,Y.Local);if(null!=a.perObjectGlobal){var f=a.perObjectGlobal.path.split(".");
f.pop();for(var g=e;0<f.length;){f.join(".");var h=f.pop(),k=m.h[f.__id__];null==k&&(k=d(h,u.TStruct([]),Y.Local),m.set(f,k));h=k.type;13==h._hx_index&&h.vl.push(g);g=g.parent=k}}b.data.vars.push(e);f=(a.pos>>2)+c;g=a.type;switch(g._hx_index){case 3:g=a.type;f=r(f);f={p:null,t:g,e:p.TSwiz(f,t[a.pos&3])};break;case 5:k=g.t;switch(g.size){case 2:if(1==k._hx_index){switch(a.pos&3){case 0:k=[ca.X,ca.Y];break;case 1:k=[ca.Y,ca.Z];break;default:k=[ca.Z,ca.W]}g=a.type;f=p.TSwiz(r(f),k);f={p:null,t:g,e:f}}else throw new q("Unsupported batch var type "+
n.string(a.type));break;case 3:if(1==k._hx_index)g=a.type,f=r(f),f={p:null,t:g,e:p.TSwiz(f,0==(a.pos&3)?[ca.X,ca.Y,ca.Z]:[ca.Y,ca.Z,ca.W])};else throw new q("Unsupported batch var type "+n.string(a.type));break;case 4:if(1==k._hx_index)f=r(f);else throw new q("Unsupported batch var type "+n.string(a.type));break;default:throw new q("Unsupported batch var type "+n.string(a.type));}break;case 7:g=a.type;f=p.TCall({e:p.TGlobal(G.Mat4),t:u.TVoid,p:null},[r(f),r(f+1),r(f+2),r(f+3)]);f={p:null,t:g,e:f};
break;default:throw new q("Unsupported batch var type "+n.string(a.type));}return{p:null,e:p.TBinop(ma.OpAssign,{e:p.TVar(e),p:null,t:a.type},f),t:u.TVoid}},c=[],s=a.vertex.params;null!=s;)c.push(g(s,0)),s=s.next;for(s=a.fragment.params;null!=s;)c.push(g(s,a.vertex.paramsSize)),s=s.next;c.unshift({p:null,e:p.TBinop(ma.OpAssign,k,{p:null,t:u.TInt,e:p.TBinop(ma.OpMult,{e:p.TGlobal(G.InstanceID),t:u.TInt,p:null},{e:p.TConst(F.CInt(f)),p:null,t:u.TInt})}),t:u.TVoid});a=d("init",u.TFun([]),Y.Function);
a={kind:dc.Init,ref:a,args:[],ret:u.TVoid,expr:{e:p.TBlock(c),p:null,t:u.TVoid}};b.data.funs.push(a);b.consts=new Ji(e,0,16);b.consts.globalId=0;return b},__class__:wd};var rb=K["hxsl.Channel"]={__ename__:!0,__constructs__:"Unknown R G B A PackedFloat PackedNormal".split(" "),Unknown:{_hx_index:0,__enum__:"hxsl.Channel",toString:m},R:{_hx_index:1,__enum__:"hxsl.Channel",toString:m},G:{_hx_index:2,__enum__:"hxsl.Channel",toString:m},B:{_hx_index:3,__enum__:"hxsl.Channel",toString:m},A:{_hx_index:4,
__enum__:"hxsl.Channel",toString:m},PackedFloat:{_hx_index:5,__enum__:"hxsl.Channel",toString:m},PackedNormal:{_hx_index:6,__enum__:"hxsl.Channel",toString:m}};rb.__empty_constructs__=[rb.Unknown,rb.R,rb.G,rb.B,rb.A,rb.PackedFloat,rb.PackedNormal];var ih=function(){this.varMap=new na};r["hxsl.Clone"]=ih;ih.__name__="hxsl.Clone";ih.shaderData=function(a){return(new ih).shader(a)};ih.prototype={tvar:function(a){var b=this.varMap.h[a.id];if(null!=b)return b;b={id:w.allocVarId(),type:a.type,name:a.name,
kind:a.kind};this.varMap.h[a.id]=b;null!=a.parent&&(b.parent=this.tvar(a.parent));null!=a.qualifiers&&(b.qualifiers=a.qualifiers.slice());b.type=this.ttype(a.type);return b},tfun:function(a){for(var b=this.ttype(a.ret),c=a.kind,d=this.tvar(a.ref),e=[],f=0,g=a.args;f<g.length;){var h=g[f];++f;e.push(this.tvar(h))}return{ret:b,kind:c,ref:d,args:e,expr:this.texpr(a.expr)}},ttype:function(a){switch(a._hx_index){case 13:var b=a.vl,c=[];for(a=0;a<b.length;){var d=b[a];++a;c.push(this.tvar(d))}return u.TStruct(c);
case 14:return u.TFun(a.variants);case 15:b=a.size;a=this.ttype(a.t);switch(b._hx_index){case 0:c=b;break;case 1:c=tb.SVar(this.tvar(b.v))}return u.TArray(a,c);default:return a}},texpr:function(a){var b=w.map(a,z(this,this.texpr));b.t=this.ttype(a.t);a=b.e;switch(a._hx_index){case 1:a=p.TVar(this.tvar(a.v));break;case 7:var c=a.init;a=p.TVarDecl(this.tvar(a.v),c);break;case 13:var c=a.loop,d=a.it;a=p.TFor(this.tvar(a.v),d,c);break;default:a=b.e}b.e=a;return b},shader:function(a){for(var b=a.name,
c=[],d=0,e=a.vars;d<e.length;){var f=e[d];++d;c.push(this.tvar(f))}d=[];e=0;for(a=a.funs;e<a.length;)f=a[e],++e,d.push(this.tfun(f));return{name:b,vars:c,funs:d}},__class__:ih};var Ok=function(){};r["hxsl._Dce.Exit"]=Ok;Ok.__name__="hxsl._Dce.Exit";Ok.prototype={__class__:Ok};var rk=function(a){this.v=a;this.used=!1;this.deps=new na};r["hxsl._Dce.VarDeps"]=rk;rk.__name__="hxsl._Dce.VarDeps";rk.prototype={__class__:rk};var nk=function(){};r["hxsl.Dce"]=nk;nk.__name__="hxsl.Dce";nk.prototype={debug:function(a,
b){},dce:function(a,b){this.used=new na;this.channelVars=[];for(var c=[],d=0,e=a.vars;d<e.length;){var f=e[d];++d;var g=this.get(f);f.kind==Y.Input&&c.push(g);f.kind==Y.Output&&(g.keep=!0)}d=0;for(e=b.vars;d<e.length;)f=e[d],++d,g=this.get(f),f.kind==Y.Output&&(g.keep=!0);d=0;for(e=a.funs;d<e.length;)f=e[d],++d,this.check(f.expr,[],[]);d=0;for(e=b.funs;d<e.length;)f=e[d],++d,this.check(f.expr,[],[]);for(d=[];;){for(d=this.used.iterator();d.hasNext();)e=d.next(),e.keep&&this.markRec(e);for(;1<c.length&&
!c[c.length-1].used;)c.pop();for(d=0;d<c.length;)e=c[d],++d,this.markRec(e);d=[];e=0;for(f=a.funs;e<f.length;)g=f[e],++e,d.push(this.mapExpr(g.expr,!1));e=0;for(f=b.funs;e<f.length;)g=f[e],++e,d.push(this.mapExpr(g.expr,!1));this.markAsKeep=!1;for(e=0;e<d.length;)f=d[e],++e,this.checkBranches(f);if(!this.markAsKeep)break}c=0;for(e=a.funs;c<e.length;)f=e[c],++c,f.expr=d.shift();c=0;for(e=b.funs;c<e.length;)f=e[c],++c,f.expr=d.shift();for(c=this.used.iterator();c.hasNext();)d=c.next(),!d.used&&d.v.kind!=
Y.Input&&(v.remove(a.vars,d.v),v.remove(b.vars,d.v));return{fragment:b,vertex:a}},get:function(a){var b=this.used.h[a.id];null==b&&(b=new rk(a),this.used.h[a.id]=b);return b},markRec:function(a){if(!a.used){a.used=!0;for(a=a.deps.iterator();a.hasNext();){var b=a.next();this.markRec(b)}}},link:function(a,b){for(var c=this.get(a),d=0;d<b.length;){var e=b[d];++d;null==e?c.keep||(this.markAsKeep=c.keep=!0):e.deps.h[a.id]=c}},check:function(a,b,c){var d=a.e;switch(d._hx_index){case 1:this.link(d.v,b);
break;case 4:a=d.el;for(var e=[],d=0,f=a.length;d<f;){var g=d++;this.check(a[g],g<a.length-1?e:b,c)}break;case 5:e=d.e2;f=d.e1;switch(d.op._hx_index){case 4:d=f.e;switch(d._hx_index){case 1:a=this.get(d.v);b.push(a);this.check(e,b,c);b.pop();0>c.indexOf(a)&&c.push(a);break;case 9:d=d.e.e;if(1==d._hx_index)a=this.get(d.v),b.push(a),this.check(e,b,c),b.pop(),0>c.indexOf(a)&&c.push(a);else{var h=z(this,this.check);w.iter(a,function(a){h(a,b,c)})}break;default:var k=z(this,this.check);w.iter(a,function(a){k(a,
b,c)})}break;case 20:d=f.e;switch(d._hx_index){case 1:a=this.get(d.v);b.push(a);this.check(e,b,c);b.pop();0>c.indexOf(a)&&c.push(a);break;case 9:d=d.e.e;if(1==d._hx_index)a=this.get(d.v),b.push(a),this.check(e,b,c),b.pop(),0>c.indexOf(a)&&c.push(a);else{var l=z(this,this.check);w.iter(a,function(a){l(a,b,c)})}break;default:var m=z(this,this.check);w.iter(a,function(a){m(a,b,c)})}break;default:var n=z(this,this.check);w.iter(a,function(a){n(a,b,c)})}break;case 7:e=d.init;d=d.v;if(null!=e)b.push(this.get(d)),
this.check(e,b,c),b.pop();else{var p=z(this,this.check);w.iter(a,function(a){p(a,b,c)})}break;case 8:e=d.args;d=d.e.e;if(2==d._hx_index)switch(d.g._hx_index){case 63:if(3==e.length)if(f=e[2],d=e[0].e,1==d._hx_index)if(f=f.e,0==f._hx_index)if(f=f.c,2==f._hx_index)a=d.v,d=f.v,this.check(e[1],b,c),null==this.channelVars[d]?(this.channelVars[d]=a,this.link(a,b)):this.link(this.channelVars[d],b);else{var q=z(this,this.check);w.iter(a,function(a){q(a,b,c)})}else{var r=z(this,this.check);w.iter(a,function(a){r(a,
b,c)})}else{var s=z(this,this.check);w.iter(a,function(a){s(a,b,c)})}else{var u=z(this,this.check);w.iter(a,function(a){u(a,b,c)})}break;case 64:if(4==e.length)if(f=e[3],d=e[0].e,1==d._hx_index)if(f=f.e,0==f._hx_index)if(f=f.c,2==f._hx_index)a=d.v,d=e[2],f=f.v,this.check(e[1],b,c),this.check(d,b,c),null==this.channelVars[f]?(this.channelVars[f]=a,this.link(a,b)):this.link(this.channelVars[f],b);else{var y=z(this,this.check);w.iter(a,function(a){y(a,b,c)})}else{var A=z(this,this.check);w.iter(a,function(a){A(a,
b,c)})}else{var B=z(this,this.check);w.iter(a,function(a){B(a,b,c)})}else{var v=z(this,this.check);w.iter(a,function(a){v(a,b,c)})}break;default:var F=z(this,this.check);w.iter(a,function(a){F(a,b,c)})}else{var G=z(this,this.check);w.iter(a,function(a){G(a,b,c)})}break;case 10:e=d.eelse;f=d.econd;a=[];this.check(d.eif,b,a);null!=e&&this.check(e,b,a);e=a.length;for(d=0;d<b.length;)g=b[d],++d,0>a.indexOf(g)&&a.push(g);this.check(f,a,c);for(d=0;d<e;)f=d++,f=a[f],0>c.indexOf(f)&&c.push(f);break;case 13:e=
d.it;a=[];this.check(d.loop,b,a);this.check(e,a,c);for(e=0;e<a.length;)d=a[e],++e,0>c.indexOf(d)&&c.push(d);break;default:var I=z(this,this.check);w.iter(a,function(a){I(a,b,c)})}},checkBranches:function(a){var b=a.e;10==b._hx_index&&this.check(b.econd,[null],[]);w.iter(a,z(this,this.checkBranches))},mapExpr:function(a,b){var c=this,d=a.e;switch(d._hx_index){case 4:for(var e=d.el,d=[],f=0,g=0;g<e.length;){var h=e[g];++g;var k=b&&f==e.length-1,h=this.mapExpr(h,k);(w.hasSideEffect(h)||k)&&d.push(h);
++f}return{e:p.TBlock(d),p:a.p,t:a.t};case 5:switch(e=d.e1,d.op._hx_index){case 4:switch(e=e.e,e._hx_index){case 1:return this.get(e.v).used?w.map(a,function(a){return c.mapExpr(a,!0)}):{e:p.TConst(F.CNull),t:a.t,p:a.p};case 9:return e=e.e.e,1==e._hx_index?this.get(e.v).used?w.map(a,function(a){return c.mapExpr(a,!0)}):{e:p.TConst(F.CNull),t:a.t,p:a.p}:w.map(a,function(a){return c.mapExpr(a,!0)});default:return w.map(a,function(a){return c.mapExpr(a,!0)})}case 20:switch(e=e.e,e._hx_index){case 1:return this.get(e.v).used?
w.map(a,function(a){return c.mapExpr(a,!0)}):{e:p.TConst(F.CNull),t:a.t,p:a.p};case 9:return e=e.e.e,1==e._hx_index?this.get(e.v).used?w.map(a,function(a){return c.mapExpr(a,!0)}):{e:p.TConst(F.CNull),t:a.t,p:a.p}:w.map(a,function(a){return c.mapExpr(a,!0)});default:return w.map(a,function(a){return c.mapExpr(a,!0)})}default:return w.map(a,function(a){return c.mapExpr(a,!0)})}case 7:return this.get(d.v).used?w.map(a,function(a){return c.mapExpr(a,!0)}):{e:p.TConst(F.CNull),t:a.t,p:a.p};case 8:if(e=
d.args,d=d.e.e,2==d._hx_index)switch(d.g._hx_index){case 63:return 3==e.length&&(d=e[2].e,0==d._hx_index)?(d=d.c,2==d._hx_index?(e=e[1],d=this.channelVars[d.v],{e:p.TCall({e:p.TGlobal(G.Texture),p:a.p,t:u.TVoid},[{e:p.TVar(d),t:d.type,p:a.p},this.mapExpr(e,!0)]),t:u.TVoid,p:a.p}):w.map(a,function(a){return c.mapExpr(a,!0)})):w.map(a,function(a){return c.mapExpr(a,!0)});case 64:return 4==e.length&&(d=e[3].e,0==d._hx_index)?(f=d.c,2==f._hx_index?(d=e[1],e=e[2],f=this.channelVars[f.v],{e:p.TCall({e:p.TGlobal(G.TextureLod),
p:a.p,t:u.TVoid},[{e:p.TVar(f),t:f.type,p:a.p},this.mapExpr(d,!0),this.mapExpr(e,!0)]),t:u.TVoid,p:a.p}):w.map(a,function(a){return c.mapExpr(a,!0)})):w.map(a,function(a){return c.mapExpr(a,!0)});case 65:return 3==e.length&&(d=e[2].e,0==d._hx_index)?(d=d.c,2==d._hx_index?(e=e[1],d=this.channelVars[d.v],{e:p.TCall({e:p.TGlobal(G.Texel),p:a.p,t:u.TVoid},[{e:p.TVar(d),t:d.type,p:a.p},this.mapExpr(e,!0)]),t:u.TVoid,p:a.p}):w.map(a,function(a){return c.mapExpr(a,!0)})):w.map(a,function(a){return c.mapExpr(a,
!0)});case 66:return 4==e.length&&(d=e[3].e,0==d._hx_index)?(f=d.c,2==f._hx_index?(d=e[1],e=e[2],f=this.channelVars[f.v],{e:p.TCall({e:p.TGlobal(G.Texel),p:a.p,t:u.TVoid},[{e:p.TVar(f),t:f.type,p:a.p},this.mapExpr(d,!0),this.mapExpr(e,!0)]),t:u.TVoid,p:a.p}):w.map(a,function(a){return c.mapExpr(a,!0)})):w.map(a,function(a){return c.mapExpr(a,!0)});default:return w.map(a,function(a){return c.mapExpr(a,!0)})}else return w.map(a,function(a){return c.mapExpr(a,!0)});case 10:return e=d.eelse,f=d.eif,d=
this.mapExpr(d.econd,!0),f=this.mapExpr(f,b),e=null==e?null:this.mapExpr(e,b),!b&&!w.hasSideEffect(f)&&(null==e||!w.hasSideEffect(e))?{e:p.TConst(F.CNull),t:d.t,p:d.p}:{e:p.TIf(d,f,e),p:d.p,t:d.t};case 13:return f=d.loop,e=d.v,d=this.mapExpr(d.it,!0),f=this.mapExpr(f,!1),!w.hasSideEffect(f)?{e:p.TConst(F.CNull),t:a.t,p:a.p}:{e:p.TFor(e,d,f),p:a.p,t:a.t};default:return w.map(a,function(a){return c.mapExpr(a,!0)})}},__class__:nk};var sk=function(){this.varMap=new zb;this.funMap=new zb;this.constants=
new na};r["hxsl.Eval"]=sk;sk.__name__="hxsl.Eval";sk.prototype={setConstant:function(a,b){this.constants.h[a.id]=p.TConst(b)},mapVar:function(a){var b=this.varMap.h[a.__id__];if(null!=b||null!=a.parent&&(this.mapVar(a.parent),b=this.varMap.h[a.__id__],null!=b))return a==b?b:this.mapVar(b);b={id:17==a.type._hx_index?a.id:w.allocVarId(),name:a.name,type:a.type,kind:a.kind};null!=a.parent&&(b.parent=this.mapVar(a.parent));null!=a.qualifiers&&(b.qualifiers=a.qualifiers.slice());this.varMap.set(a,b);this.varMap.set(b,
b);a=b.type;switch(a._hx_index){case 13:a=a.vl;for(var c=[],d=0;d<a.length;){var e=a[d];++d;c.push(this.mapVar(e))}b.type=u.TStruct(c);break;case 15:c=a.size;1==c._hx_index&&(a=a.t,c=c.v,d=this.constants.h[c.id],null!=d?null==d?Za.t("Integer value expected for array size constant "+c.name,null):0==d._hx_index?(d=d.c,2==d._hx_index?(c=d.v,b.type=15==b.type._hx_index?u.TArray(a,tb.SConst(c)):u.TBuffer(a,tb.SConst(c))):Za.t("Integer value expected for array size constant "+c.name,null)):Za.t("Integer value expected for array size constant "+
c.name,null):(c=this.mapVar(c),b.type=15==b.type._hx_index?u.TArray(a,tb.SVar(c)):u.TBuffer(a,tb.SVar(c))));break;case 16:c=a.size,1==c._hx_index&&(a=a.t,c=c.v,d=this.constants.h[c.id],null!=d?null==d?Za.t("Integer value expected for array size constant "+c.name,null):0==d._hx_index?(d=d.c,2==d._hx_index?(c=d.v,b.type=15==b.type._hx_index?u.TArray(a,tb.SConst(c)):u.TBuffer(a,tb.SConst(c))):Za.t("Integer value expected for array size constant "+c.name,null)):Za.t("Integer value expected for array size constant "+
c.name,null):(c=this.mapVar(c),b.type=15==b.type._hx_index?u.TArray(a,tb.SVar(c)):u.TBuffer(a,tb.SVar(c))))}return b},eval:function(a){for(var b=[],c=0,d=a.funs;c<d.length;){var e=d[c];++c;for(var f=e.kind,g=this.mapVar(e.ref),h=[],k=0,l=e.args;k<l.length;){var m=l[k];++k;h.push(this.mapVar(m))}f={kind:f,ref:g,args:h,ret:e.ret,expr:e.expr};(!this.inlineCalls||e.kind!=dc.Helper)&&b.push(f);this.funMap.set(f.ref,e)}c=0;for(d=b.length;c<d;)e=c++,this.curFun=b[e],this.curFun.expr=this.evalExpr(this.curFun.expr,
!1);c=a.name;d=[];e=0;for(a=a.vars;e<a.length;)f=a[e],++e,d.push(this.mapVar(f));return{name:c,vars:d,funs:b}},hasReturn:function(a){this.markReturn=!1;this.hasReturnLoop(a);return this.markReturn},hasReturnLoop:function(a){12==a.e._hx_index?this.markReturn=!0:this.markReturn||w.iter(a,z(this,this.hasReturnLoop))},handleReturn:function(a,b){null==b&&(b=!1);var c=a.e;switch(c._hx_index){case 3:var d=this.handleReturn(c.e,b);return{e:p.TParenthesis(d),t:d.t,p:a.p};case 4:var e=c.el,c=0,f=e.length,d=
[];a:for(;c<f;){var g=e[c++];if(c==f)d.push(this.handleReturn(g,b));else{var h=g.e;switch(h._hx_index){case 10:if(null==h.eelse){var k=h.econd,h=h.eif;if(b&&this.hasReturn(h)){d.push(this.handleReturn({e:p.TIf(k,h,{e:p.TBlock(e.slice(c)),t:g.t,p:g.p}),t:g.t,p:g.p}));break a}else d.push(this.handleReturn(g))}else d.push(this.handleReturn(g));break;case 12:d.push(this.handleReturn(h.e,b));break a;default:d.push(this.handleReturn(g))}}}e=b?d[d.length-1].t:a.t;return{e:p.TBlock(d),t:e,p:a.p};case 10:return d=
c.eelse,e=c.eif,c=c.econd,null!=d&&b?(c=this.handleReturn(c),e=this.handleReturn(e,b),{e:p.TIf(c,e,this.handleReturn(d,b)),t:e.t,p:a.p}):w.map(a,z(this,this.handleReturnDef));case 12:return d=c.e,b||Za.t("Cannot inline not final return",a.p),null==d?{e:p.TBlock([]),t:u.TVoid,p:a.p}:this.handleReturn(d,!0);default:return w.map(a,z(this,this.handleReturnDef))}},handleReturnDef:function(a){return this.handleReturn(a)},evalCall:function(a,b,c,d){switch(a._hx_index){case 38:return 1==b.length&&(b=b[0].e,
0==b._hx_index)?(b=b.c,2==b._hx_index?p.TConst(F.CFloat(b.v)):null):null;case 63:case 64:var e;e=b[0].e;if(0==e._hx_index)if(e=e.c,2==e._hx_index)e=e.v;else throw Za.t("Cannot eval complex channel "+aa.toString(b[0],!0)+" "+this.constantsToString(),d),new q("assert");else throw Za.t("Cannot eval complex channel "+aa.toString(b[0],!0)+" "+this.constantsToString(),d),new q("assert");var f=c[0];c=f.e;if(1==c._hx_index)c=p.TVar(this.mapVar(c.v));else throw new q("assert");f={e:c,t:f.t,p:f.p};c=f.t;if(17==
c._hx_index)c=c.size;else throw new q("assert");for(var g=Fa.createEnumIndex(rb,e&7,null),f=[f],h=1,k=b.length;h<k;){var l=h++;f.push(b[l])}f.push({e:p.TConst(F.CInt(e>>3)),t:u.TInt,p:d});b={e:p.TCall({e:p.TGlobal(a),t:u.TVoid,p:d},f),t:u.TVoid,p:d};switch(g._hx_index){case 0:return b={e:p.TConst(F.CFloat(0)),t:u.TFloat,p:d},1==c?b.e:p.TCall({e:p.TGlobal([G.Vec2,G.Vec3,G.Vec4][c-2]),t:u.TVoid,p:d},[b]);case 1:case 2:case 3:case 4:switch(c){case 1:switch(g._hx_index){case 1:d=[ca.X];break;case 2:d=
[ca.Y];break;case 3:d=[ca.Z];break;case 4:d=[ca.W];break;default:throw new q("Invalid channel value "+n.string(g)+" for "+c+" channels");}break;case 2:switch(g._hx_index){case 1:d=[ca.X,ca.Y];break;case 2:d=[ca.Y,ca.Z];break;case 3:d=[ca.Z,ca.W];break;default:throw new q("Invalid channel value "+n.string(g)+" for "+c+" channels");}break;case 3:switch(g._hx_index){case 1:d=[ca.X,ca.Y,ca.Z];break;case 2:d=[ca.Y,ca.Z,ca.W];break;default:throw new q("Invalid channel value "+n.string(g)+" for "+c+" channels");
}break;default:throw new q("Invalid channel value "+n.string(g)+" for "+c+" channels");}return p.TSwiz(b,d);case 5:return p.TCall({e:p.TGlobal(G.Unpack),t:u.TVoid,p:d},[b]);case 6:return p.TCall({e:p.TGlobal(G.UnpackNormal),t:u.TVoid,p:d},[b])}break;case 67:for(d=0;d<b.length;)a=b[d],++d,Fb.trace(aa.toString(a),{fileName:a.p.file,lineNumber:0,className:null,methodName:null});return p.TBlock([]);default:return null}},constantsToString:function(){for(var a=[],b=this.constants.keys();b.hasNext();){var c=
b.next();a.push(c+" => "+aa.toString({e:this.constants.h[c],t:u.TVoid,p:null},!0))}return a.toString()},ifBlock:function(a){return(null!=a?10!=a.e._hx_index:1)?a:{e:p.TBlock([a]),t:a.t,p:a.p}},evalExpr:function(a,b){null==b&&(b=!0);var c=this,d,e=a.e;switch(e._hx_index){case 0:d=a.e;break;case 1:var f=e.v,g=this.constants.h[f.id];if(null!=g)d=g;else{var h=this.mapVar(f);d=p.TVar(h)}break;case 2:d=a.e;break;case 3:var k=this.evalExpr(e.e,b);d=0==k.e._hx_index?k.e:p.TParenthesis(k);break;case 4:for(var l=
e.el,m=[],t=l.length-1,r=0,s=l.length;r<s;){var w=r++,y=b&&w==t,A=this.evalExpr(l[w],y);switch(A.e._hx_index){case 0:y&&m.push(A);break;case 1:y&&m.push(A);break;default:m.push(A)}}d=1==m.length&&this.curFun.kind!=dc.Init?m[0].e:p.TBlock(m);break;case 5:var B=e.e2,v=e.op,H=this.evalExpr(e.e1),z=this.evalExpr(B);switch(v._hx_index){case 0:var I=z.e,J=H.e;if(0==J._hx_index){var K=J.c;switch(K._hx_index){case 2:if(0==I._hx_index){var L=I.c;d=2==L._hx_index?p.TConst(F.CInt(K.v+L.v|0)):p.TBinop(v,H,z)}else d=
p.TBinop(v,H,z);break;case 3:if(0==I._hx_index){var Q=I.c;d=3==Q._hx_index?p.TConst(F.CFloat(K.v+Q.v)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 1:var N=z.e,R=H.e;if(0==R._hx_index){var O=R.c;switch(O._hx_index){case 2:if(0==N._hx_index){var S=N.c;d=2==S._hx_index?p.TConst(F.CInt(O.v*S.v|0)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 3:if(0==N._hx_index){var P=N.c;d=3==P._hx_index?p.TConst(F.CFloat(O.v*P.v)):p.TBinop(v,H,z)}else d=
p.TBinop(v,H,z);break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 2:var T=z.e,V=H.e;if(0==V._hx_index){var X=V.c;switch(X._hx_index){case 2:if(0==T._hx_index){var U=T.c;d=2==U._hx_index?p.TConst(F.CInt(X.v/U.v|0)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 3:if(0==T._hx_index){var Y=T.c;d=3==Y._hx_index?p.TConst(F.CFloat(X.v/Y.v)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 3:var Z=z.e,W=H.e;if(0==W._hx_index){var ca=
W.c;switch(ca._hx_index){case 2:if(0==Z._hx_index){var ba=Z.c;d=2==ba._hx_index?p.TConst(F.CInt(ca.v-ba.v|0)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 3:if(0==Z._hx_index){var ea=Z.c;d=3==ea._hx_index?p.TConst(F.CFloat(ca.v-ea.v)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 4:case 21:d=p.TBinop(v,H,z);break;case 5:var $=z.e,ga=H.e;if(0==ga._hx_index){var da=ga.c;switch(da._hx_index){case 0:d=0==$._hx_index?0==$.c._hx_index?p.TConst(F.CBool(!0)):
p.TConst(F.CBool(!1)):p.TBinop(v,H,z);break;case 1:var ja=da.b;if(0==$._hx_index){var ia=$.c;switch(ia._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 1:d=p.TConst(F.CBool(0==(ja==ia.b?0:1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 2:var ma=da.v;if(0==$._hx_index){var ka=$.c;switch(ka._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 2:d=p.TConst(F.CBool(0==ma-ka.v));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 3:var la=da.v;if(0==$._hx_index){var pa=
$.c;switch(pa._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 3:var na=pa.v;d=p.TConst(F.CBool(0==(la>na?1:la==na?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 4:var qa=da.v;if(0==$._hx_index){var ha=$.c;switch(ha._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 4:var ra=ha.v;d=p.TConst(F.CBool(0==(qa>ra?1:qa==ra?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 6:var Xa=z.e,fa=H.e;if(0==fa._hx_index){var sa=fa.c;
switch(sa._hx_index){case 0:d=0==Xa._hx_index?0==Xa.c._hx_index?p.TConst(F.CBool(!1)):p.TConst(F.CBool(!0)):p.TBinop(v,H,z);break;case 1:var xa=sa.b;if(0==Xa._hx_index){var ta=Xa.c;switch(ta._hx_index){case 0:d=p.TConst(F.CBool(!0));break;case 1:d=p.TConst(F.CBool(0!=(xa==ta.b?0:1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 2:var wa=sa.v;if(0==Xa._hx_index){var ya=Xa.c;switch(ya._hx_index){case 0:d=p.TConst(F.CBool(!0));break;case 2:d=p.TConst(F.CBool(0!=wa-ya.v));break;
default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 3:var za=sa.v;if(0==Xa._hx_index){var Ea=Xa.c;switch(Ea._hx_index){case 0:d=p.TConst(F.CBool(!0));break;case 3:var D=Ea.v;d=p.TConst(F.CBool(0!=(za>D?1:za==D?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 4:var Ca=sa.v;if(0==Xa._hx_index){var Da=Xa.c;switch(Da._hx_index){case 0:d=p.TConst(F.CBool(!0));break;case 4:var Ba=Da.v;d=p.TConst(F.CBool(0!=(Ca>Ba?1:Ca==Ba?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=
p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 7:var ua=z.e,Ha=H.e;if(0==Ha._hx_index){var Fa=Ha.c;switch(Fa._hx_index){case 0:d=0==ua._hx_index?p.TConst(F.CBool(!1)):p.TBinop(v,H,z);break;case 1:var Ja=Fa.b;if(0==ua._hx_index){var Ka=ua.c;switch(Ka._hx_index){case 0:d=p.TConst(F.CBool(!0));break;case 1:d=p.TConst(F.CBool(0<(Ja==Ka.b?0:1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 2:var La=Fa.v;if(0==ua._hx_index){var Ma=ua.c;switch(Ma._hx_index){case 0:d=p.TConst(F.CBool(!0));
break;case 2:d=p.TConst(F.CBool(0<La-Ma.v));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 3:var Pa=Fa.v;if(0==ua._hx_index){var Na=ua.c;switch(Na._hx_index){case 0:d=p.TConst(F.CBool(!0));break;case 3:var Sa=Na.v;d=p.TConst(F.CBool(0<(Pa>Sa?1:Pa==Sa?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 4:var Ua=Fa.v;if(0==ua._hx_index){var Qa=ua.c;switch(Qa._hx_index){case 0:d=p.TConst(F.CBool(!0));break;case 4:var Oa=Qa.v;d=p.TConst(F.CBool(0<(Ua>Oa?1:Ua==
Oa?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 8:var Ga=z.e,Ya=H.e;if(0==Ya._hx_index){var Ta=Ya.c;switch(Ta._hx_index){case 0:d=0==Ga._hx_index?0==Ga.c._hx_index?p.TConst(F.CBool(!0)):p.TConst(F.CBool(!1)):p.TBinop(v,H,z);break;case 1:var Aa=Ta.b;if(0==Ga._hx_index){var fb=Ga.c;switch(fb._hx_index){case 0:d=p.TConst(F.CBool(!0));break;case 1:d=p.TConst(F.CBool(0<=(Aa==fb.b?0:1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;
case 2:var ab=Ta.v;if(0==Ga._hx_index){var Ra=Ga.c;switch(Ra._hx_index){case 0:d=p.TConst(F.CBool(!0));break;case 2:d=p.TConst(F.CBool(0<=ab-Ra.v));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 3:var db=Ta.v;if(0==Ga._hx_index){var hb=Ga.c;switch(hb._hx_index){case 0:d=p.TConst(F.CBool(!0));break;case 3:var bb=hb.v;d=p.TConst(F.CBool(0<=(db>bb?1:db==bb?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 4:var ib=Ta.v;if(0==Ga._hx_index){var jb=Ga.c;switch(jb._hx_index){case 0:d=
p.TConst(F.CBool(!0));break;case 4:var va=jb.v;d=p.TConst(F.CBool(0<=(ib>va?1:ib==va?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 9:var oa=z.e,Va=H.e;if(0==Va._hx_index){var $a=Va.c;switch($a._hx_index){case 0:d=0==oa._hx_index?0==oa.c._hx_index?p.TConst(F.CBool(!1)):p.TConst(F.CBool(!0)):p.TBinop(v,H,z);break;case 1:var pb=$a.b;if(0==oa._hx_index){var sb=oa.c;switch(sb._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 1:d=p.TConst(F.CBool(0>
(pb==sb.b?0:1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 2:var Wa=$a.v;if(0==oa._hx_index){var wb=oa.c;switch(wb._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 2:d=p.TConst(F.CBool(0>Wa-wb.v));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 3:var ub=$a.v;if(0==oa._hx_index){var xb=oa.c;switch(xb._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 3:var ob=xb.v;d=p.TConst(F.CBool(0>(ub>ob?1:ub==ob?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=
p.TBinop(v,H,z);break;case 4:var yb=$a.v;if(0==oa._hx_index){var rb=oa.c;switch(rb._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 4:var tb=rb.v;d=p.TConst(F.CBool(0>(yb>tb?1:yb==tb?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 10:var kb=z.e,Ab=H.e;if(0==Ab._hx_index){var zb=Ab.c;switch(zb._hx_index){case 0:d=0==kb._hx_index?p.TConst(F.CBool(!0)):p.TBinop(v,H,z);break;case 1:var Eb=zb.b;if(0==kb._hx_index){var Bb=kb.c;switch(Bb._hx_index){case 0:d=
p.TConst(F.CBool(!1));break;case 1:d=p.TConst(F.CBool(0>=(Eb==Bb.b?0:1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 2:var Fb=zb.v;if(0==kb._hx_index){var Db=kb.c;switch(Db._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 2:d=p.TConst(F.CBool(0>=Fb-Db.v));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 3:var Gb=zb.v;if(0==kb._hx_index){var Hb=kb.c;switch(Hb._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 3:var Kb=Hb.v;d=p.TConst(F.CBool(0>=(Gb>Kb?
1:Gb==Kb?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 4:var Ib=zb.v;if(0==kb._hx_index){var Lb=kb.c;switch(Lb._hx_index){case 0:d=p.TConst(F.CBool(!1));break;case 4:var qb=Lb.v;d=p.TConst(F.CBool(0>=(Ib>qb?1:Ib==qb?0:-1)));break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 11:var Jb=z.e,Mb=H.e;if(0==Mb._hx_index){var Nb=Mb.c;if(2==Nb._hx_index)if(0==Jb._hx_index){var Ob=Jb.c;d=2==Ob._hx_index?p.TConst(F.CInt(Nb.v&Ob.v)):p.TBinop(v,
H,z)}else d=p.TBinop(v,H,z);else d=p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 12:var Qb=z.e,Rb=H.e;if(0==Rb._hx_index){var Sb=Rb.c;if(2==Sb._hx_index)if(0==Qb._hx_index){var Tb=Qb.c;d=2==Tb._hx_index?p.TConst(F.CInt(Sb.v|Tb.v)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);else d=p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 13:var Ub=z.e,Vb=H.e;if(0==Vb._hx_index){var Xb=Vb.c;if(2==Xb._hx_index)if(0==Ub._hx_index){var Yb=Ub.c;d=2==Yb._hx_index?p.TConst(F.CInt(Xb.v^Yb.v)):p.TBinop(v,H,z)}else d=
p.TBinop(v,H,z);else d=p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 14:var Wb=z.e,ac=H.e;if(0==ac._hx_index){var bc=ac.c;if(1==bc._hx_index){var Pb=bc.b;if(0==Wb._hx_index){var cc=Wb.c;if(1==cc._hx_index){var fc=cc.b;d=p.TConst(F.CBool(Pb&&fc))}else d=!1==Pb?p.TConst(F.CBool(Pb)):z.e}else d=!1==Pb?p.TConst(F.CBool(Pb)):z.e}else if(0==Wb._hx_index){var ec=Wb.c;if(1==ec._hx_index){var mc=ec.b;d=!1==mc?p.TConst(F.CBool(mc)):H.e}else d=p.TBinop(v,H,z)}else d=p.TBinop(v,H,z)}else if(0==Wb._hx_index){var oc=
Wb.c;if(1==oc._hx_index){var tc=oc.b;d=!1==tc?p.TConst(F.CBool(tc)):H.e}else d=p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 15:var ic=z.e,uc=H.e;if(0==uc._hx_index){var vc=uc.c;if(1==vc._hx_index){var kc=vc.b;if(0==ic._hx_index){var yc=ic.c;if(1==yc._hx_index){var eb=yc.b;d=p.TConst(F.CBool(kc||eb))}else d=!0==kc?p.TConst(F.CBool(kc)):z.e}else d=!0==kc?p.TConst(F.CBool(kc)):z.e}else if(0==ic._hx_index){var Ec=ic.c;if(1==Ec._hx_index){var Fc=Ec.b;d=!0==Fc?p.TConst(F.CBool(Fc)):H.e}else d=p.TBinop(v,
H,z)}else d=p.TBinop(v,H,z)}else if(0==ic._hx_index){var Gc=ic.c;if(1==Gc._hx_index){var qc=Gc.b;d=!0==qc?p.TConst(F.CBool(qc)):H.e}else d=p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 16:var Hc=z.e,Jc=H.e;if(0==Jc._hx_index){var ed=Jc.c;if(2==ed._hx_index)if(0==Hc._hx_index){var Lc=Hc.c;d=2==Lc._hx_index?p.TConst(F.CInt(ed.v<<Lc.v)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);else d=p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 17:var Nc=z.e,Rc=H.e;if(0==Rc._hx_index){var Sc=Rc.c;if(2==Sc._hx_index)if(0==
Nc._hx_index){var Tc=Nc.c;d=2==Tc._hx_index?p.TConst(F.CInt(Sc.v>>Tc.v)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);else d=p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 18:var Uc=z.e,Vc=H.e;if(0==Vc._hx_index){var Wc=Vc.c;if(2==Wc._hx_index)if(0==Uc._hx_index){var Xc=Uc.c;d=2==Xc._hx_index?p.TConst(F.CInt(Wc.v>>>Xc.v)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);else d=p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 19:var wc=z.e,Yc=H.e;if(0==Yc._hx_index){var Ic=Yc.c;switch(Ic._hx_index){case 2:if(0==
wc._hx_index){var cb=wc.c;d=2==cb._hx_index?p.TConst(F.CInt(Ic.v%cb.v|0)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;case 3:if(0==wc._hx_index){var lc=wc.c;d=3==lc._hx_index?p.TConst(F.CFloat(Ic.v%lc.v)):p.TBinop(v,H,z)}else d=p.TBinop(v,H,z);break;default:d=p.TBinop(v,H,z)}}else d=p.TBinop(v,H,z);break;case 20:d=p.TBinop(v,H,z);break;case 22:throw new q("assert");case 23:throw new q("assert");}break;case 6:var jc=e.op,Oc=this.evalExpr(e.e1),Pc=Oc.e;if(0==Pc._hx_index){var nc=Pc.c;switch(jc._hx_index){case 2:d=
1==nc._hx_index?p.TConst(F.CBool(!nc.b)):p.TUnop(jc,Oc);break;case 3:switch(nc._hx_index){case 2:d=p.TConst(F.CInt(-nc.v));break;case 3:d=p.TConst(F.CFloat(-nc.v));break;default:d=p.TUnop(jc,Oc)}break;default:d=p.TUnop(jc,Oc)}}else d=p.TUnop(jc,Oc);break;case 7:var md=e.init;d=p.TVarDecl(this.mapVar(e.v),null==md?null:this.evalExpr(md));break;case 8:for(var $c=e.args,rd=this.evalExpr(e.e),id=[],fd=0;fd<$c.length;){var wd=$c[fd];++fd;id.push(this.evalExpr(wd))}var gd=rd.e;switch(gd._hx_index){case 1:if(this.inlineCalls){var nd=
gd.v;if(null!=this.funMap.h.__keys__[nd.__id__]){for(var hd=this.funMap.h[nd.__id__],Zc=[],pc=[],qd=0,Dd=hd.args.length;qd<Dd;){var sd=qd++,Ia=[hd.args[sd]],rc=id[sd],td=rc.e;switch(td._hx_index){case 0:pc.push(function(a,b){return function(){null==a[0]?c.constants.remove(b[0].id):c.constants.h[b[0].id]=a[0]}}([this.constants.h[Ia[0].id]],Ia));this.constants.h[Ia[0].id]=rc.e;break;case 1:switch(td.v.kind._hx_index){case 0:case 1:case 2:pc.push(function(a,b){return function(){null==a[0]?c.constants.remove(b[0].id):
c.constants.h[b[0].id]=a[0]}}([this.constants.h[Ia[0].id]],Ia));this.constants.h[Ia[0].id]=rc.e;break;default:var je=[this.varMap.h[Ia[0].__id__]];null==je[0]?pc.push(function(a){return function(){c.varMap.remove(a[0])}}(Ia)):(this.varMap.remove(Ia[0]),pc.push(function(a,b){return function(){c.varMap.set(b[0],a[0])}}(je,Ia)));var Qc=this.mapVar(Ia[0]);Zc.push({e:p.TVarDecl(Qc,rc),t:u.TVoid,p:rc.p})}break;default:var Gd=[this.varMap.h[Ia[0].__id__]];null==Gd[0]?pc.push(function(a){return function(){c.varMap.remove(a[0])}}(Ia)):
(this.varMap.remove(Ia[0]),pc.push(function(a,b){return function(){c.varMap.set(b[0],a[0])}}(Gd,Ia)));var Ld=this.mapVar(Ia[0]);Zc.push({e:p.TVarDecl(Ld,rc),t:u.TVoid,p:rc.p})}}for(var ke=this.handleReturn(this.evalExpr(hd.expr,!1),!0),ld=0;ld<pc.length;){var Md=pc[ld];++ld;Md()}var ud=ke.e;if(4==ud._hx_index)for(var vd=ud.el,od=0;od<vd.length;){var Vd=vd[od];++od;Zc.push(Vd)}else Zc.push(ke);d=p.TBlock(Zc)}else d=Za.t("Cannot eval non-static call expresssion '"+(new aa).exprString(rd)+"'",rd.p)}else d=
p.TCall(rd,id);break;case 2:var xd=this.evalCall(gd.g,id,$c,a.p);d=null!=xd?xd:p.TCall(rd,id);break;default:d=Za.t("Cannot eval non-static call expresssion '"+(new aa).exprString(rd)+"'",rd.p)}break;case 9:var $d=e.regs;d=p.TSwiz(this.evalExpr(e.e),$d.slice());break;case 10:var $b=e.eelse,ad=e.eif,Mc=this.evalExpr(e.econd),Bd=Mc.e;if(0==Bd._hx_index){var gb=Bd.c;if(1==gb._hx_index)d=gb.b?this.evalExpr(ad,b).e:null==$b?p.TConst(F.CNull):this.evalExpr($b,b).e;else if(b&&null!=$b&&this.eliminateConditionals)d=
p.TCall({e:p.TGlobal(G.Mix),t:a.t,p:a.p},[this.evalExpr($b,!0),this.evalExpr(ad,!0),{e:p.TCall({e:p.TGlobal(G.ToFloat),t:u.TFun([]),p:Mc.p},[Mc]),t:u.TFloat,p:a.p}]);else{ad=this.evalExpr(ad,b);if(null!=$b){var $b=this.evalExpr($b,b),jd=$b.e;0==jd._hx_index&&0==jd.c._hx_index&&($b=null)}ad=this.ifBlock(ad);$b=this.ifBlock($b);d=p.TIf(Mc,ad,$b)}}else if(b&&null!=$b&&this.eliminateConditionals)d=p.TCall({e:p.TGlobal(G.Mix),t:a.t,p:a.p},[this.evalExpr($b,!0),this.evalExpr(ad,!0),{e:p.TCall({e:p.TGlobal(G.ToFloat),
t:u.TFun([]),p:Mc.p},[Mc]),t:u.TFloat,p:a.p}]);else{ad=this.evalExpr(ad,b);if(null!=$b){var $b=this.evalExpr($b,b),le=$b.e;0==le._hx_index&&0==le.c._hx_index&&($b=null)}ad=this.ifBlock(ad);$b=this.ifBlock($b);d=p.TIf(Mc,ad,$b)}break;case 11:d=p.TDiscard;break;case 12:var kd=e.e;d=p.TReturn(null==kd?null:this.evalExpr(kd));break;case 13:var hc=e.loop,ge=e.it,ye=e.v,Dc=this.mapVar(ye),sc=this.evalExpr(ge),bd,ze=sc.e;if(5==ze._hx_index){var ie=ze.e2,me=ze.e1;if(21==ze.op._hx_index){var Hd=me.e;if(0==
Hd._hx_index){var Id=Hd.c;if(2==Id._hx_index){var Jd=ie.e;if(0==Jd._hx_index){var Kd=Jd.c;if(2==Kd._hx_index){var oe=Id.v,re=Kd.v;if(this.unrollLoops){for(var Rd=[],lb=oe;lb<re;){var ue=lb++;this.constants.h[ye.id]=p.TConst(F.CInt(ue));Rd.push(this.evalExpr(hc,!1))}this.constants.remove(ye.id);bd=p.TBlock(Rd)}else bd=p.TFor(Dc,sc,this.ifBlock(this.evalExpr(hc,!1)))}else bd=p.TFor(Dc,sc,this.ifBlock(this.evalExpr(hc,!1)))}else bd=p.TFor(Dc,sc,this.ifBlock(this.evalExpr(hc,!1)))}else bd=p.TFor(Dc,sc,
this.ifBlock(this.evalExpr(hc,!1)))}else bd=p.TFor(Dc,sc,this.ifBlock(this.evalExpr(hc,!1)))}else bd=p.TFor(Dc,sc,this.ifBlock(this.evalExpr(hc,!1)))}else bd=p.TFor(Dc,sc,this.ifBlock(this.evalExpr(hc,!1)));this.varMap.remove(ye);d=bd;break;case 14:d=p.TContinue;break;case 15:d=p.TBreak;break;case 16:var te=e.index,Xd=this.evalExpr(e.e),Kc=this.evalExpr(te),Sd=Kc.e,Td=Xd.e;if(17==Td._hx_index)if(0==Sd._hx_index){var Ud=Sd.c;if(2==Ud._hx_index){var Wd=Td.el,zd=Ud.v;d=0<=zd&&zd<Wd.length?Wd[zd].e:p.TArray(Xd,
Kc)}else d=p.TArray(Xd,Kc)}else d=p.TArray(Xd,Kc);else d=p.TArray(Xd,Kc);break;case 17:for(var ae=e.el,be=[],Ad=0;Ad<ae.length;){var xe=ae[Ad];++Ad;be.push(this.evalExpr(xe))}d=p.TArrayDecl(be);break;case 18:for(var de=e.def,ee=e.cases,fe=this.evalExpr(e.e),pd=[],Cd=0;Cd<ee.length;){var he=ee[Cd];++Cd;for(var mb=[],yd=0,ne=he.values;yd<ne.length;){var Be=ne[yd];++yd;mb.push(this.evalExpr(Be))}pd.push({values:mb,expr:this.evalExpr(he.expr,b)})}var cd=null==de?null:this.evalExpr(de,b),Nd=!1,pe=fe.e;
if(0==pe._hx_index){var De=pe.c;if(2==De._hx_index)for(var qe=De.v,Od=0;Od<pd.length;){var Pd=pd[Od];++Od;for(var Qd=0,se=Pd.values;Qd<se.length;){var Ce=se[Qd];++Qd;var we=Ce.e;if(0==we._hx_index){var ce=we.c;switch(ce._hx_index){case 2:if(ce.v==qe)return Pd.expr;break;case 3:if(ce.v==qe)return Pd.expr}}else Nd=!0}}else throw new q("Unsupported switch constant "+n.string(De));}else Nd=!0;d=Nd?p.TSwitch(fe,pd,cd):null==cd?p.TBlock([]):cd.e;break;case 19:var Fe=e.normalWhile,Ge=e.loop,He=this.evalExpr(e.e),
Ie=this.evalExpr(Ge,!1);d=p.TWhile(He,this.ifBlock(Ie),Fe);break;case 20:var nb=e.e,ve=e.args,Ae=e.m,Ee;"unroll"==Ae?(this.unrollLoops=!0,Ee=this.evalExpr(nb,b),this.unrollLoops=!1):Ee=this.evalExpr(nb,b);d=p.TMeta(Ae,ve,Ee)}return{e:d,t:a.t,p:a.p}},__class__:sk};var we=function(a,b,c,d){this.g=a;this.t=b;this.pos=c;this.size=d};r["hxsl._Flatten.Alloc"]=we;we.__name__="hxsl._Flatten.Alloc";we.prototype={__class__:we};var Pk=K["hxsl.ARead"]={__ename__:!0,__constructs__:["AIndex","AOffset"],AIndex:(s=
function(a){return{_hx_index:0,a:a,__enum__:"hxsl.ARead",toString:m}},s.__params__=["a"],s),AOffset:(s=function(a,b,c){return{_hx_index:1,a:a,stride:b,delta:c,__enum__:"hxsl.ARead",toString:m}},s.__params__=["a","stride","delta"],s)};Pk.__empty_constructs__=[];var pk=function(){};r["hxsl.Flatten"]=pk;pk.__name__="hxsl.Flatten";pk.prototype={flatten:function(a,b,c){this.globals=[];this.params=[];this.outVars=[];if(c){this.consts=[];c=a.funs[0].expr.p;var d={id:w.allocVarId(),name:"__consts__",kind:Y.Global,
type:null};this.econsts={e:p.TVar(d),t:null,p:c};var e=a.name,f=a.vars.slice(),g=[],h=0;for(a=a.funs;h<a.length;){var k=a[h];++h;g.push(this.mapFun(k,z(this,this.mapConsts)))}a={name:e,vars:f,funs:g};e=0;for(f=a.vars;e<f.length;)g=f[e],++e,9==g.type._hx_index&&this.allocConst(255,c);0<this.consts.length&&(d.type=this.econsts.t=u.TArray(u.TFloat,tb.SConst(this.consts.length)),a.vars.push(d))}this.varMap=new zb;this.allocData=new zb;c=0;for(d=a.vars;c<d.length;)e=d[c],++c,this.gatherVar(e);switch(b._hx_index){case 0:b=
"vertex";break;case 1:b="fragment";break;default:throw new q("assert");}this.pack(b+"Globals",Y.Global,this.globals,ab.VFloat);this.pack(b+"Params",Y.Param,this.params,ab.VFloat);c=this.globals.concat(this.params);b=this.packTextures(b+"Textures",c,u.TSampler2D).concat(this.packTextures(b+"TexturesCube",c,u.TSamplerCube)).concat(this.packTextures(b+"TexturesArray",c,u.TSampler2DArray));this.packBuffers(c);c=[];d=0;for(e=a.funs;d<e.length;)f=e[d],++d,c.push(this.mapFun(f,z(this,this.mapExpr)));for(d=
0;d<b.length;)e=b[d],++d,e.pos>>=2;return{name:a.name,vars:this.outVars,funs:c}},mapFun:function(a,b){return{kind:a.kind,ret:a.ret,args:a.args,ref:a.ref,expr:b(a.expr)}},mapExpr:function(a){var b=a.e;switch(b._hx_index){case 1:var b=b.v,c=this.varMap.h[b.__id__];a=null==c?a:this.access(c,b.type,a.p,Pk.AIndex(c));break;case 16:var c=b.e,d=c.e;if(1==d._hx_index){var b=b.index,c=c.p,e=d.v,d=b.e;if(0==d._hx_index&&2==d.c._hx_index)a=w.map(a,z(this,this.mapExpr));else if(d=this.varMap.h[e.__id__],null!=
d)if(e=e.type,15==e._hx_index){var e=e.t,f=this.varSize(e,d.t);if(0==f||0!=(f&3))throw new q(new Za("Dynamic access to an Array which size is not 4 components-aligned is not allowed",a.p));f>>=2;b=this.mapExpr(b);a={e:p.TCall({e:p.TGlobal(G.ToInt),t:u.TFun([]),p:c},[b]),t:u.TInt,p:c};a=this.access(d,e,c,Pk.AOffset(d,f,1==f?a:{e:p.TBinop(ma.OpMult,a,{e:p.TConst(F.CInt(f)),t:u.TInt,p:c}),t:u.TInt,p:c}))}else throw new q("assert");}else a=w.map(a,z(this,this.mapExpr));break;default:a=w.map(a,z(this,
this.mapExpr))}return this.optimize(a)},mapConsts:function(a){var b=a.e;switch(b._hx_index){case 0:switch(b=b.c,b._hx_index){case 2:return this.allocConst(b.v,a.p);case 3:return this.allocConst(b.v,a.p);default:return a}case 2:switch(b.g._hx_index){case 0:this.allocConst(Math.PI/180,a.p);break;case 1:this.allocConst(180/Math.PI,a.p);break;case 9:this.allocConst(1.4426950408889634,a.p);break;case 10:this.allocConst(0.6931471805599453,a.p);break;case 24:this.allocConst(1,a.p);break;case 26:this.allocConst(2,
a.p);this.allocConst(3,a.p);break;case 54:this.allocConsts([1,255,65025,16581375],a.p);this.allocConsts([0.00392156862745098,0.00392156862745098,0.00392156862745098,0],a.p);break;case 55:this.allocConsts([1,0.00392156862745098,1.5378700499807768E-5,6.030862941101084E-8],a.p);break;case 56:this.allocConst(1,a.p);this.allocConst(0.5,a.p);break;case 57:this.allocConst(0.5,a.p);break;case 58:this.allocConsts([0.5,0.5],a.p);this.allocConsts([0.5,-0.5],a.p);break;case 59:this.allocConsts([2,-2],a.p),this.allocConsts([-1,
1],a.p)}break;case 5:var c=b.e2;1==b.op._hx_index&&8==c.t._hx_index&&this.allocConst(1,a.p);break;case 8:c=b.args;b=b.e.e;if(2==b._hx_index&&42==b.g._hx_index&&2==c.length){var b=c[1],d=c[0],c=d.t,d=d.e;if(1==d._hx_index)switch(d.v.kind._hx_index){case 0:if(5==c._hx_index&&(3==c.size&&1==c.t._hx_index)&&(b=b.e,0==b._hx_index&&(b=b.c,2==b._hx_index&&1==b.v)))return a;break;case 1:if(5==c._hx_index&&(3==c.size&&1==c.t._hx_index)&&(b=b.e,0==b._hx_index&&(b=b.c,2==b._hx_index&&1==b.v)))return a;break;
case 2:if(5==c._hx_index&&(3==c.size&&1==c.t._hx_index)&&(b=b.e,0==b._hx_index&&(b=b.c,2==b._hx_index&&1==b.v)))return a;break;case 3:if(5==c._hx_index&&(3==c.size&&1==c.t._hx_index)&&(b=b.e,0==b._hx_index&&(b=b.c,2==b._hx_index&&1==b.v)))return a}}break;case 16:c=b.index;b=b.e;d=c.e;if(0==d._hx_index&&2==d.c._hx_index)return{e:p.TArray(this.mapConsts(b),c),t:a.t,p:a.p};b=b.t;15==b._hx_index&&(b=this.varSize(b.t,ab.VFloat)>>2,this.allocConst(b,a.p))}return w.map(a,z(this,this.mapConsts))},allocConst:function(a,
b){var c=this.consts.indexOf(a);0>c&&(c=this.consts.length,this.consts.push(a));return{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(c)),t:u.TInt,p:b}),t:u.TFloat,p:b}},allocConsts:function(a,b){for(var c=a.length-1&3,d=-1,e=0,f=this.consts.length-(a.length-1);e<f;){var g=e++;if(g>>2==g+c>>2){for(var h=!0,k=0,l=a.length;k<l;){var m=k++;if(this.consts[g+m]!=a[m]){h=!1;break}}if(h){d=g;break}}}if(0>d){for(;this.consts.length>>2!=this.consts.length+c>>2;)this.consts.push(0);d=this.consts.length;for(c=0;c<
a.length;)e=a[c],++c,this.consts.push(e)}switch(a.length){case 1:return{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(d)),t:u.TInt,p:b}),t:u.TFloat,p:b};case 2:return{e:p.TCall({e:p.TGlobal(G.Vec2),t:u.TVoid,p:b},[{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(d)),t:u.TInt,p:b}),t:u.TFloat,p:b},{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(d+1)),t:u.TInt,p:b}),t:u.TFloat,p:b}]),t:u.TVec(2,ab.VFloat),p:b};case 3:return{e:p.TCall({e:p.TGlobal(G.Vec3),t:u.TVoid,p:b},[{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(d)),
t:u.TInt,p:b}),t:u.TFloat,p:b},{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(d+1)),t:u.TInt,p:b}),t:u.TFloat,p:b},{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(d+2)),t:u.TInt,p:b}),t:u.TFloat,p:b}]),t:u.TVec(3,ab.VFloat),p:b};case 4:return{e:p.TCall({e:p.TGlobal(G.Vec4),t:u.TVoid,p:b},[{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(d)),t:u.TInt,p:b}),t:u.TFloat,p:b},{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(d+1)),t:u.TInt,p:b}),t:u.TFloat,p:b},{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(d+3)),t:u.TInt,
p:b}),t:u.TFloat,p:b},{e:p.TArray(this.econsts,{e:p.TConst(F.CInt(d+4)),t:u.TInt,p:b}),t:u.TFloat,p:b}]),t:u.TVec(4,ab.VFloat),p:b};default:throw new q("assert");}},mkInt:function(a,b){return{e:p.TConst(F.CInt(a)),t:u.TInt,p:b}},readIndex:function(a,b,c){return{e:p.TArray({e:p.TVar(a.g),t:a.g.type,p:c},{e:p.TConst(F.CInt((a.pos>>2)+b)),t:u.TInt,p:c}),t:u.TVec(4,a.t),p:c}},readOffset:function(a,b,c,d,e){b=(a.pos>>2)+d;c=0==b?c:{e:p.TBinop(ma.OpAdd,c,{e:p.TConst(F.CInt(b)),t:u.TInt,p:e}),t:u.TInt,p:e};
return{e:p.TArray({e:p.TVar(a.g),t:a.g.type,p:e},c),t:u.TVec(4,a.t),p:e}},access:function(a,b,c,d){switch(b._hx_index){case 6:return d=this.access(a,u.TMat3x4,c,d),{e:p.TCall({e:p.TGlobal(G.Mat3),t:u.TFun([]),p:c},[d]),t:u.TMat3,p:c};case 7:b=p.TGlobal(G.Mat4);a=u.TFun([]);var e;switch(d._hx_index){case 0:e=d.a;e={e:p.TArray({e:p.TVar(e.g),t:e.g.type,p:c},{e:p.TConst(F.CInt(e.pos>>2)),t:u.TInt,p:c}),t:u.TVec(4,e.t),p:c};break;case 1:var f=d.delta;e=d.a;var g=e.pos>>2,f=0==g?f:{e:p.TBinop(ma.OpAdd,
f,{e:p.TConst(F.CInt(g)),t:u.TInt,p:c}),t:u.TInt,p:c};e={e:p.TArray({e:p.TVar(e.g),t:e.g.type,p:c},f),t:u.TVec(4,e.t),p:c}}var h;switch(d._hx_index){case 0:h=d.a;h={e:p.TArray({e:p.TVar(h.g),t:h.g.type,p:c},{e:p.TConst(F.CInt((h.pos>>2)+1)),t:u.TInt,p:c}),t:u.TVec(4,h.t),p:c};break;case 1:f=d.delta,h=d.a,g=(h.pos>>2)+1,f=0==g?f:{e:p.TBinop(ma.OpAdd,f,{e:p.TConst(F.CInt(g)),t:u.TInt,p:c}),t:u.TInt,p:c},h={e:p.TArray({e:p.TVar(h.g),t:h.g.type,p:c},f),t:u.TVec(4,h.t),p:c}}var k;switch(d._hx_index){case 0:k=
d.a;k={e:p.TArray({e:p.TVar(k.g),t:k.g.type,p:c},{e:p.TConst(F.CInt((k.pos>>2)+2)),t:u.TInt,p:c}),t:u.TVec(4,k.t),p:c};break;case 1:f=d.delta,k=d.a,g=(k.pos>>2)+2,f=0==g?f:{e:p.TBinop(ma.OpAdd,f,{e:p.TConst(F.CInt(g)),t:u.TInt,p:c}),t:u.TInt,p:c},k={e:p.TArray({e:p.TVar(k.g),t:k.g.type,p:c},f),t:u.TVec(4,k.t),p:c}}var l;switch(d._hx_index){case 0:d=d.a;l={e:p.TArray({e:p.TVar(d.g),t:d.g.type,p:c},{e:p.TConst(F.CInt((d.pos>>2)+3)),t:u.TInt,p:c}),t:u.TVec(4,d.t),p:c};break;case 1:l=d.delta,d=d.a,f=
(d.pos>>2)+3,l=0==f?l:{e:p.TBinop(ma.OpAdd,l,{e:p.TConst(F.CInt(f)),t:u.TInt,p:c}),t:u.TInt,p:c},l={e:p.TArray({e:p.TVar(d.g),t:d.g.type,p:c},l),t:u.TVec(4,d.t),p:c}}return{e:p.TCall({e:b,t:a,p:c},[e,h,k,l]),t:u.TMat4,p:c};case 8:b=p.TGlobal(G.Mat3x4);a=u.TFun([]);switch(d._hx_index){case 0:e=d.a;f={e:p.TArray({e:p.TVar(e.g),t:e.g.type,p:c},{e:p.TConst(F.CInt(e.pos>>2)),t:u.TInt,p:c}),t:u.TVec(4,e.t),p:c};break;case 1:h=d.delta,e=d.a,k=e.pos>>2,h=0==k?h:{e:p.TBinop(ma.OpAdd,h,{e:p.TConst(F.CInt(k)),
t:u.TInt,p:c}),t:u.TInt,p:c},f={e:p.TArray({e:p.TVar(e.g),t:e.g.type,p:c},h),t:u.TVec(4,e.t),p:c}}switch(d._hx_index){case 0:e=d.a;g={e:p.TArray({e:p.TVar(e.g),t:e.g.type,p:c},{e:p.TConst(F.CInt((e.pos>>2)+1)),t:u.TInt,p:c}),t:u.TVec(4,e.t),p:c};break;case 1:h=d.delta,e=d.a,k=(e.pos>>2)+1,h=0==k?h:{e:p.TBinop(ma.OpAdd,h,{e:p.TConst(F.CInt(k)),t:u.TInt,p:c}),t:u.TInt,p:c},g={e:p.TArray({e:p.TVar(e.g),t:e.g.type,p:c},h),t:u.TVec(4,e.t),p:c}}var m;switch(d._hx_index){case 0:d=d.a;m={e:p.TArray({e:p.TVar(d.g),
t:d.g.type,p:c},{e:p.TConst(F.CInt((d.pos>>2)+2)),t:u.TInt,p:c}),t:u.TVec(4,d.t),p:c};break;case 1:e=d.delta,d=d.a,h=(d.pos>>2)+2,e=0==h?e:{e:p.TBinop(ma.OpAdd,e,{e:p.TConst(F.CInt(h)),t:u.TInt,p:c}),t:u.TInt,p:c},m={e:p.TArray({e:p.TVar(d.g),t:d.g.type,p:c},e),t:u.TVec(4,d.t),p:c}}return{e:p.TCall({e:b,t:a,p:c},[f,g,m]),t:u.TMat3x4,p:c};case 15:e=b.size;if(0==e._hx_index){d=b.t;b=e.v;e=a.size/b|0;h=[];for(k=0;k<b;)l=k++,l=new we(a.g,a.t,a.pos+e*l,e),h.push(this.access(l,d,c,Pk.AIndex(l)));return{e:p.TArrayDecl(h),
t:d,p:c}}if(w.isSampler(b)){var n;switch(d._hx_index){case 0:d=d.a;n={e:p.TArray({e:p.TVar(d.g),t:d.g.type,p:c},{e:p.TConst(F.CInt(d.pos>>2)),t:u.TInt,p:c}),t:u.TVec(4,d.t),p:c};break;case 1:a=d.delta,d=d.a,e=d.pos>>2,a=0==e?a:{e:p.TBinop(ma.OpAdd,a,{e:p.TConst(F.CInt(e)),t:u.TInt,p:c}),t:u.TInt,p:c},n={e:p.TArray({e:p.TVar(d.g),t:d.g.type,p:c},a),t:u.TVec(4,d.t),p:c}}n.t=b;return n}e=this.varSize(b,a.t);if(4<e)return Za.t("Access not supported for "+w.toString(b),null);var r;switch(d._hx_index){case 0:d=
d.a;r={e:p.TArray({e:p.TVar(d.g),t:d.g.type,p:c},{e:p.TConst(F.CInt(d.pos>>2)),t:u.TInt,p:c}),t:u.TVec(4,d.t),p:c};break;case 1:h=d.delta,d=d.a,k=d.pos>>2,h=0==k?h:{e:p.TBinop(ma.OpAdd,h,{e:p.TConst(F.CInt(k)),t:u.TInt,p:c}),t:u.TInt,p:c},r={e:p.TArray({e:p.TVar(d.g),t:d.g.type,p:c},h),t:u.TVec(4,d.t),p:c}}if(4==e){if(0!=(a.pos&3))throw new q("assert");}else{d=[];for(h=0;h<e;)k=h++,d.push(w.SWIZ[k+(a.pos&3)]);r={e:p.TSwiz(r,d),t:b,p:c}}switch(b._hx_index){case 1:r.t=u.TFloat;r={e:p.TCall({e:p.TGlobal(G.ToInt),
t:u.TFun([]),p:c},[r]),t:b,p:c};break;case 5:0==b.t._hx_index&&(d=b.size,r.t=u.TVec(d,ab.VFloat),r={e:p.TCall({e:p.TGlobal([G.IVec2,G.IVec3,G.IVec4][d-2]),t:u.TFun([]),p:c},[r]),t:b,p:c})}return r;default:if(w.isSampler(b)){var s;switch(d._hx_index){case 0:d=d.a;s={e:p.TArray({e:p.TVar(d.g),t:d.g.type,p:c},{e:p.TConst(F.CInt(d.pos>>2)),t:u.TInt,p:c}),t:u.TVec(4,d.t),p:c};break;case 1:a=d.delta,d=d.a,e=d.pos>>2,a=0==e?a:{e:p.TBinop(ma.OpAdd,a,{e:p.TConst(F.CInt(e)),t:u.TInt,p:c}),t:u.TInt,p:c},s={e:p.TArray({e:p.TVar(d.g),
t:d.g.type,p:c},a),t:u.TVec(4,d.t),p:c}}s.t=b;return s}e=this.varSize(b,a.t);if(4<e)return Za.t("Access not supported for "+w.toString(b),null);var v;switch(d._hx_index){case 0:d=d.a;v={e:p.TArray({e:p.TVar(d.g),t:d.g.type,p:c},{e:p.TConst(F.CInt(d.pos>>2)),t:u.TInt,p:c}),t:u.TVec(4,d.t),p:c};break;case 1:h=d.delta,d=d.a,k=d.pos>>2,h=0==k?h:{e:p.TBinop(ma.OpAdd,h,{e:p.TConst(F.CInt(k)),t:u.TInt,p:c}),t:u.TInt,p:c},v={e:p.TArray({e:p.TVar(d.g),t:d.g.type,p:c},h),t:u.TVec(4,d.t),p:c}}if(4==e){if(0!=
(a.pos&3))throw new q("assert");}else{d=[];for(h=0;h<e;)k=h++,d.push(w.SWIZ[k+(a.pos&3)]);v={e:p.TSwiz(v,d),t:b,p:c}}switch(b._hx_index){case 1:v.t=u.TFloat;v={e:p.TCall({e:p.TGlobal(G.ToInt),t:u.TFun([]),p:c},[v]),t:b,p:c};break;case 5:0==b.t._hx_index&&(d=b.size,v.t=u.TVec(d,ab.VFloat),v={e:p.TCall({e:p.TGlobal([G.IVec2,G.IVec3,G.IVec4][d-2]),t:u.TFun([]),p:c},[v]),t:b,p:c})}return v}},optimize:function(a){var b=a.e;switch(b._hx_index){case 8:var c=b.args,b=b.e.e;if(2==b._hx_index&&(52==b.g._hx_index&&
1==c.length)&&(b=c[0].e,8==b._hx_index&&(c=b.e.e,2==c._hx_index&&51==c.g._hx_index))){for(var b=b.args,d=c=0;4>d;)d+=this.varSize(b[b.length-1-c].t,ab.VFloat),++c;if(4==d){for(d=0;d<c;)d++,b.pop();c=a.e;if(8==c._hx_index)c=c.e;else throw new q("assert");return{e:p.TCall(c,b),t:a.t,p:a.p}}}break;case 16:if(c=b.index,b=b.e.e,17==b._hx_index&&(c=c.e,0==c._hx_index&&(c=c.c,2==c._hx_index))){b=b.el;c=c.v;if(0<=c&&c<b.length)return b[c];Za.t("Reading outside array bounds",a.p)}}return a},packTextures:function(a,
b,c){var d=[];a={id:w.allocVarId(),name:a,type:c,kind:Y.Param};for(var e=0;e<b.length;){var f=b[e];++e;if(f.type==c||c==u.TSampler2D&&17==f.type._hx_index){var g=new we(a,null,d.length<<2,1);g.v=f;this.varMap.set(f,g);d.push(g)}}a.type=u.TArray(c,tb.SConst(d.length));0<d.length&&(this.outVars.push(a),this.allocData.set(a,d));return d},packBuffers:function(a){for(var b=[],c={id:w.allocVarId(),name:"buffers",type:u.TVoid,kind:Y.Param},d=0;d<a.length;){var e=a[d];++d;if(16==e.type._hx_index){var f=new we(c,
null,b.length,1);f.v=e;b.push(f);this.outVars.push(e)}}c.type=u.TArray(u.TBuffer(u.TVoid,tb.SConst(0)),tb.SConst(b.length));this.allocData.set(c,b)},pack:function(a,b,c,d){var e=[],f=0;a={id:w.allocVarId(),name:a,type:u.TVec(0,d),kind:b};for(b=0;b<c.length;){var g=c[b];++b;if(!(w.isSampler(g.type)||16==g.type._hx_index)){for(var h=this.varSize(g.type,d),k=null,l=0;l<e.length;){var m=e[l];++l;if(null==m.v&&m.size>=h&&(null==k||k.size>m.size))k=m}null!=k?(m=k.size-h,0<m&&(l=e.indexOf(k),m=new we(a,
d,k.pos+h,m),e.splice(l+1,0,m),k.size=h),k.v=g,this.varMap.set(g,k)):(k=new we(a,d,f,h),f+=h,k.v=g,this.varMap.set(g,k),e.push(k),g=(4-h%4)%4,0<g&&(h=new we(a,d,f,g),f+=g,e.push(h)))}}a.type=u.TArray(u.TVec(4,d),tb.SConst(f>>2));0<f&&(this.outVars.push(a),this.allocData.set(a,e));return a},varSize:function(a,b){switch(a._hx_index){case 1:case 3:if(b==ab.VFloat)return 1;throw new q(w.toString(a)+" size unknown for type "+n.string(b));case 5:var c=a.size;if(b==a.t)return c;throw new q(w.toString(a)+
" size unknown for type "+n.string(b));case 7:if(b==ab.VFloat)return 16;throw new q(w.toString(a)+" size unknown for type "+n.string(b));case 6:case 8:if(b==ab.VFloat)return 12;throw new q(w.toString(a)+" size unknown for type "+n.string(b));case 15:c=a.size;if(0==c._hx_index)return c=c.v,this.varSize(a.t,b)*c;throw new q(w.toString(a)+" size unknown for type "+n.string(b));default:throw new q(w.toString(a)+" size unknown for type "+n.string(b));}},gatherVar:function(a){var b=a.type;if(13==b._hx_index){a=
b.vl;for(b=0;b<a.length;){var c=a[b];++b;this.gatherVar(c)}}else switch(a.kind._hx_index){case 0:w.hasQualifier(a,jb.PerObject)?this.params.push(a):this.globals.push(a);break;case 2:this.params.push(a);break;default:this.outVars.push(a)}},__class__:pk};var Ki={};r["hxsl._Globals.GlobalSlot_Impl_"]=Ki;Ki.__name__="hxsl._Globals.GlobalSlot_Impl_";Ki._new=function(a){return qa.allocID(a)};Ki.toInt=function(a){return a};Ki.set=function(a,b,c){b.map.h[a]=c};Ki.get=function(a,b){return b.map.h[a]};var qa=
function(){this.channels=[];this.map=new na};r["hxsl.Globals"]=qa;qa.__name__="hxsl.Globals";qa.allocID=function(a){null==qa.MAP&&(qa.MAP=new ga,qa.ALL=[]);var b=qa.MAP,b=null!=Q[a]?b.getReserved(a):b.h[a];if(null==b){b=qa.ALL.length;qa.ALL.push(a);var c=qa.MAP;null!=Q[a]?c.setReserved(a,b):c.h[a]=b}return b};qa.getIDName=function(a){return qa.ALL[a]};qa.prototype={set:function(a,b){var c=this.map,d=qa.allocID(a);c.h[d]=b},get:function(a){var b=this.map;a=qa.allocID(a);return b.h[a]},fastSet:function(a,
b){this.map.h[a]=b},fastGet:function(a){return this.map.h[a]},resetChannels:function(){this.maxChannels=0},allocChannelID:function(a){for(var b=0,c=this.maxChannels;b<c;){var d=b++;if(this.channels[d]==a)return d}if(this.maxChannels==1<<w.MAX_CHANNELS_BITS)throw new q("Too many unique channels");b=this.maxChannels++;this.channels[b]=a;return b},__class__:qa};var ia=function(){};r["js.Boot"]=ia;ia.__name__="js.Boot";ia.getClass=function(a){if(null==a)return null;if(a instanceof Array)return Array;
var b=a.__class__;if(null!=b)return b;a=ia.__nativeClassName(a);return null!=a?ia.__resolveNativeClass(a):null};ia.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;if("function"==c&&(a.__name__||a.__ename__))c="object";switch(c){case "function":return"<function>";case "object":if(a.__enum__){var d=K[a.__enum__],c=d.__constructs__[a._hx_index],e=d[c];if(e.__params__){b+="\t";for(var c=c+"(",d=[],f=0,e=e.__params__;f<e.length;){var g=e[f],f=f+1;d.push(ia.__string_rec(a[g],
b))}return c+d.join(",")+")"}return c}if(a instanceof Array){c="[";b+="\t";d=0;for(f=a.length;d<f;)e=d++,c+=(0<e?",":"")+ia.__string_rec(a[e],b);return c+"]"}try{d=a.toString}catch(h){return $.lastException=h,"???"}if(null!=d&&(d!=Object.toString&&"function"==typeof d)&&(c=a.toString(),"[object Object]"!=c))return c;c="{\n";b+="\t";d=null!=a.hasOwnProperty;f=null;for(f in a)if(!d||a.hasOwnProperty(f))"prototype"==f||("__class__"==f||"__super__"==f||"__interfaces__"==f||"__properties__"==f)||(2!=c.length&&
(c+=", \n"),c+=b+f+" : "+ia.__string_rec(a[f],b));b=b.substring(1);return c+("\n"+b+"}");case "string":return a;default:return String(a)}};ia.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;if(Object.prototype.hasOwnProperty.call(a,"__interfaces__"))for(var c=a.__interfaces__,d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||ia.__interfLoop(f,b))return!0}return ia.__interfLoop(a.__super__,b)};ia.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array;
case bl:return"boolean"==typeof a;case cl:return null!=a;case dl:return"number"==typeof a;case el:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==typeof b){if(ia.__downcastCheck(a,b))return!0}else{if("object"==typeof b&&ia.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==fl&&null!=a.__name__||b==gl&&null!=a.__ename__?!0:null!=a.__enum__?K[a.__enum__]==b:!1}};ia.__downcastCheck=function(a,b){return a instanceof b?!0:b.__isInterface__?
ia.__interfLoop(ia.getClass(a),b):!1};ia.__cast=function(a,b){if(null==a||ia.__instanceof(a,b))return a;throw new q("Cannot cast "+n.string(a)+" to "+n.string(b));};ia.__nativeClassName=function(a){a=ia.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};ia.__isNativeObj=function(a){return null!=ia.__nativeClassName(a)};ia.__resolveNativeClass=function(a){return kh[a]};var yb=function(){this.exprIds=this.uniformBuffer=this.outIndex=0;this.varNames=new na;this.allNames=
new ga};r["hxsl.GlslOut"]=yb;yb.__name__="hxsl.GlslOut";yb.compile=function(a){var b=new yb;b.glES=1;b.version=100;return b.run(a)};yb.prototype={get_isES:function(){return null!=this.glES},get_isES2:function(){return null!=this.glES?2>=this.glES:!1},add:function(a){this.buf.b+=n.string(a)},ident:function(a){a=this.varName(a);this.buf.b+=n.string(a)},decl:function(a){for(var b=0,c=this.decls;b<c.length;){var d=c[b];++b;if(d==a)return}35==v.cca(a,0)?this.decls.unshift(a):this.decls.push(a)},addType:function(a){switch(a._hx_index){case 0:this.buf.b+=
n.string("void");break;case 1:this.buf.b+=n.string("int");break;case 2:this.buf.b+=n.string("bool");break;case 3:this.buf.b+=n.string("float");break;case 4:this.buf.b+=n.string("string");break;case 5:var b=a.size;switch(a.t._hx_index){case 0:this.buf.b+=n.string("i");break;case 2:this.buf.b+=n.string("b")}this.buf.b+=n.string("vec");this.buf.b+=n.string(b);break;case 6:this.buf.b+=n.string("mat3");break;case 7:this.buf.b+=n.string("mat4");break;case 8:this.decl(yb.MAT34);this.buf.b+=n.string("_mat3x4");
break;case 9:a=a.size;this.buf.b+=n.string("vec");this.buf.b+=n.string(a);break;case 10:this.buf.b+=n.string("sampler2D");break;case 11:this.buf.b+=n.string("sampler2DArray");null!=this.glES&&this.decl("precision lowp sampler2DArray;");break;case 12:this.buf.b+=n.string("samplerCube");break;case 13:a=a.vl;this.buf.b+=n.string("struct { ");for(b=0;b<a.length;){var c=a[b];++b;this.addVar(c);this.buf.b+=n.string(";")}this.buf.b+=n.string(" }");break;case 14:this.buf.b+=n.string("function");break;case 15:b=
a.size;this.addType(a.t);this.buf.b+=n.string("[");switch(b._hx_index){case 0:a=b.v;this.buf.b=1==a?this.intelDriverFix?this.buf.b+n.string(2):this.buf.b+n.string(a):this.buf.b+n.string(a);break;case 1:a=this.varName(b.v),this.buf.b+=n.string(a)}this.buf.b+=n.string("]");break;case 16:throw new q("assert");case 17:this.buf.b+=n.string("channel"+a.size)}},addVar:function(a){var b=a.type;switch(b._hx_index){case 15:var c=b.size,d=a.type;a.type=b.t;this.addVar(a);a.type=d;this.buf.b+=n.string("[");switch(c._hx_index){case 0:a=
c.v;this.buf.b=1==a?this.intelDriverFix?this.buf.b+n.string(2):this.buf.b+n.string(a):this.buf.b+n.string(a);break;case 1:a=this.varName(c.v),this.buf.b+=n.string(a)}this.buf.b+=n.string("]");break;case 16:c=b.size;b=b.t;this.buf.b+=n.string("uniform_buffer"+this.uniformBuffer++);this.buf.b+=n.string(" { ");a.type=u.TArray(b,c);this.addVar(a);a.type=u.TBuffer(b,c);this.buf.b+=n.string("; }");break;default:this.addType(a.type),this.buf.b+=n.string(" "),a=this.varName(a),this.buf.b+=n.string(a)}},addValue:function(a,
b){var c=a.e;switch(c._hx_index){case 4:var c=c.el,d="val"+this.exprIds++,e=this.buf;this.buf=new Ib;this.addType(a.t);this.buf.b+=n.string(" ");this.buf.b+=n.string(d);this.buf.b+=n.string("(void)");var c=c.slice(),f=c[c.length-1];c[c.length-1]={e:p.TReturn(f),t:a.t,p:f.p};c={t:u.TVoid,e:p.TBlock(c),p:a.p};this.addExpr(c,"");this.exprValues.push(this.buf.b);this.buf=e;this.buf.b+=n.string(d);this.buf.b+=n.string("()");break;case 10:d=c.eelse;e=c.eif;c=c.econd;this.buf.b+=n.string("( ");this.addValue(c,
b);this.buf.b+=n.string(" ) ? ");this.addValue(e,b);this.buf.b+=n.string(" : ");this.addValue(d,b);break;case 20:this.addValue(c.e,b);break;default:this.addExpr(a,b)}},addBlock:function(a,b){this.addExpr(a,b)},getFunName:function(a,b,c){switch(a._hx_index){case 20:if(c==u.TInt&&null!=this.glES)return this.decl("int _imod( int x, int y ) { return int(mod(float(x),float(y))); }"),"_imod";break;case 33:switch(b[0].t._hx_index){case 10:case 11:if(null!=this.glES&&2>=this.glES)return"texture2D";break;
case 12:if(null!=this.glES&&2>=this.glES)return"textureCube";break;case 17:if(null!=this.glES&&2>=this.glES)return"texture2D"}break;case 34:switch(b[0].t._hx_index){case 10:case 11:if(null!=this.glES&&2>=this.glES)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"texture2DLodEXT";break;case 12:if(null!=this.glES&&2>=this.glES)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"textureCubeLodEXT";break;case 17:if(null!=this.glES&&2>=this.glES)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),
"texture2DLodEXT"}break;case 35:case 36:return"texelFetch";case 50:if(b[0].t==u.TMat3x4)return this.decl(yb.MAT34),this.decl("mat3 _mat3( _mat3x4 v ) { return mat3(v.a.xyz,v.b.xyz,v.c.xyz); }"),"_mat3";break;case 52:this.decl(yb.MAT34);if(1==b.length)return this.decl("_mat3x4 mat_to_34( mat4 m ) { return _mat3x4(m[0],m[1],m[2]); }"),"mat_to_34";break;case 54:this.decl("vec4 pack( float v ) { vec4 color = fract(v * vec4(1, 255, 255.*255., 255.*255.*255.)); return color - color.yzww * vec4(1. / 255., 1. / 255., 1. / 255., 0.); }");
break;case 55:this.decl("float unpack( vec4 color ) { return dot(color,vec4(1., 1. / 255., 1. / (255. * 255.), 1. / (255. * 255. * 255.))); }");break;case 56:this.decl("vec4 packNormal( vec3 v ) { return vec4((v + vec3(1.)) * vec3(0.5),1.); }");break;case 57:this.decl("vec3 unpackNormal( vec4 v ) { return normalize((v.xyz - vec3(0.5)) * vec3(2.)); }");break;case 58:this.decl("vec2 screenToUv( vec2 v ) { return v * vec2(0.5,-0.5) + vec2(0.5,0.5); }");break;case 59:this.decl("vec2 uvToScreen( vec2 v ) { return v * vec2(2.,-2.) + vec2(-1., 1.); }");
break;case 60:case 61:case 62:this.decl("#extension GL_OES_standard_derivatives:enable")}return yb.GLOBALS.get(a)},addExpr:function(a,b){var c=a.e;switch(c._hx_index){case 0:var d=c.c;switch(d._hx_index){case 0:this.buf.b+=n.string("null");break;case 1:this.buf.b+=n.string(d.b);break;case 2:this.buf.b+=n.string(d.v);break;case 3:var e=""+d.v;this.buf.b+=n.string(e);-1==e.indexOf(".")&&-1==e.indexOf("e")&&(this.buf.b+=n.string("."));break;case 4:this.buf.b+=n.string('"'+d.v+'"')}break;case 1:var f=
this.varName(c.v);this.buf.b+=n.string(f);break;case 2:var g=yb.GLOBALS.get(c.g);this.buf.b+=n.string(g);break;case 3:var h=c.e;this.buf.b+=n.string("(");this.addValue(h,b);this.buf.b+=n.string(")");break;case 4:var k=c.el;this.buf.b+=n.string("{\n");for(var l=b+"\t",m=0;m<k.length;){var r=k[m];++m;this.buf.b+=n.string(l);this.addExpr(r,l);this.newLine(r)}this.buf.b+=n.string(b);this.buf.b+=n.string("}");break;case 5:var s=c.e2,v=c.e1,w=c.op,y=s.t,z=v.t;switch(w._hx_index){case 1:if(5==z._hx_index)if(3==
z.size)if(1==z.t._hx_index)if(8==y._hx_index)this.decl(yb.MAT34),this.decl("vec3 m3x4mult( vec3 v, _mat3x4 m) { vec4 ve = vec4(v,1.0); return vec3(dot(m.a,ve),dot(m.b,ve),dot(m.c,ve)); }"),20==w._hx_index&&(this.addValue(v,b),this.buf.b+=n.string(" = ")),this.buf.b+=n.string("m3x4mult("),this.addValue(v,b),this.buf.b+=n.string(","),this.addValue(s,b),this.buf.b+=n.string(")");else{this.addValue(v,b);this.buf.b+=n.string(" ");var A=aa.opStr(w);this.buf.b+=n.string(A);this.buf.b+=n.string(" ");this.addValue(s,
b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");var B=aa.opStr(w);this.buf.b+=n.string(B);this.buf.b+=n.string(" ");this.addValue(s,b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");var F=aa.opStr(w);this.buf.b+=n.string(F);this.buf.b+=n.string(" ");this.addValue(s,b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");var I=aa.opStr(w);this.buf.b+=n.string(I);this.buf.b+=n.string(" ");this.addValue(s,b)}break;case 5:if(5==z._hx_index)if(5==y._hx_index){this.buf.b+=n.string("vec"+z.size+"(");
var J;switch(w._hx_index){case 5:J="equal";break;case 6:J="notEqual";break;case 7:J="greaterThan";break;case 8:J="greaterThanEqual";break;case 9:J="lessThan";break;case 10:J="lessThanEqual";break;default:throw new q("assert");}this.buf.b+=n.string(J);this.buf.b+=n.string("(");this.addValue(v,b);this.buf.b+=n.string(",");this.addValue(s,b);this.buf.b+=n.string("))")}else{this.addValue(v,b);this.buf.b+=n.string(" ");var K=aa.opStr(w);this.buf.b+=n.string(K);this.buf.b+=n.string(" ");this.addValue(s,
b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");var L=aa.opStr(w);this.buf.b+=n.string(L);this.buf.b+=n.string(" ");this.addValue(s,b)}break;case 6:if(5==z._hx_index)if(5==y._hx_index){this.buf.b+=n.string("vec"+z.size+"(");var N;switch(w._hx_index){case 5:N="equal";break;case 6:N="notEqual";break;case 7:N="greaterThan";break;case 8:N="greaterThanEqual";break;case 9:N="lessThan";break;case 10:N="lessThanEqual";break;default:throw new q("assert");}this.buf.b+=n.string(N);this.buf.b+=n.string("(");
this.addValue(v,b);this.buf.b+=n.string(",");this.addValue(s,b);this.buf.b+=n.string("))")}else{this.addValue(v,b);this.buf.b+=n.string(" ");var Q=aa.opStr(w);this.buf.b+=n.string(Q);this.buf.b+=n.string(" ");this.addValue(s,b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");var R=aa.opStr(w);this.buf.b+=n.string(R);this.buf.b+=n.string(" ");this.addValue(s,b)}break;case 7:if(5==z._hx_index)if(5==y._hx_index){this.buf.b+=n.string("vec"+z.size+"(");var O;switch(w._hx_index){case 5:O="equal";break;
case 6:O="notEqual";break;case 7:O="greaterThan";break;case 8:O="greaterThanEqual";break;case 9:O="lessThan";break;case 10:O="lessThanEqual";break;default:throw new q("assert");}this.buf.b+=n.string(O);this.buf.b+=n.string("(");this.addValue(v,b);this.buf.b+=n.string(",");this.addValue(s,b);this.buf.b+=n.string("))")}else{this.addValue(v,b);this.buf.b+=n.string(" ");var S=aa.opStr(w);this.buf.b+=n.string(S);this.buf.b+=n.string(" ");this.addValue(s,b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");
var T=aa.opStr(w);this.buf.b+=n.string(T);this.buf.b+=n.string(" ");this.addValue(s,b)}break;case 8:if(5==z._hx_index)if(5==y._hx_index){this.buf.b+=n.string("vec"+z.size+"(");var P;switch(w._hx_index){case 5:P="equal";break;case 6:P="notEqual";break;case 7:P="greaterThan";break;case 8:P="greaterThanEqual";break;case 9:P="lessThan";break;case 10:P="lessThanEqual";break;default:throw new q("assert");}this.buf.b+=n.string(P);this.buf.b+=n.string("(");this.addValue(v,b);this.buf.b+=n.string(",");this.addValue(s,
b);this.buf.b+=n.string("))")}else{this.addValue(v,b);this.buf.b+=n.string(" ");var V=aa.opStr(w);this.buf.b+=n.string(V);this.buf.b+=n.string(" ");this.addValue(s,b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");var X=aa.opStr(w);this.buf.b+=n.string(X);this.buf.b+=n.string(" ");this.addValue(s,b)}break;case 9:if(5==z._hx_index)if(5==y._hx_index){this.buf.b+=n.string("vec"+z.size+"(");var U;switch(w._hx_index){case 5:U="equal";break;case 6:U="notEqual";break;case 7:U="greaterThan";break;case 8:U=
"greaterThanEqual";break;case 9:U="lessThan";break;case 10:U="lessThanEqual";break;default:throw new q("assert");}this.buf.b+=n.string(U);this.buf.b+=n.string("(");this.addValue(v,b);this.buf.b+=n.string(",");this.addValue(s,b);this.buf.b+=n.string("))")}else{this.addValue(v,b);this.buf.b+=n.string(" ");var Y=aa.opStr(w);this.buf.b+=n.string(Y);this.buf.b+=n.string(" ");this.addValue(s,b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");var Z=aa.opStr(w);this.buf.b+=n.string(Z);this.buf.b+=n.string(" ");
this.addValue(s,b)}break;case 10:if(5==z._hx_index)if(5==y._hx_index){this.buf.b+=n.string("vec"+z.size+"(");var W;switch(w._hx_index){case 5:W="equal";break;case 6:W="notEqual";break;case 7:W="greaterThan";break;case 8:W="greaterThanEqual";break;case 9:W="lessThan";break;case 10:W="lessThanEqual";break;default:throw new q("assert");}this.buf.b+=n.string(W);this.buf.b+=n.string("(");this.addValue(v,b);this.buf.b+=n.string(",");this.addValue(s,b);this.buf.b+=n.string("))")}else{this.addValue(v,b);
this.buf.b+=n.string(" ");var $=aa.opStr(w);this.buf.b+=n.string($);this.buf.b+=n.string(" ");this.addValue(s,b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");var ba=aa.opStr(w);this.buf.b+=n.string(ba);this.buf.b+=n.string(" ");this.addValue(s,b)}break;case 18:this.decl("int _ushr( int i, int j ) { return int(uint(i) >> uint(j)); }");this.buf.b+=n.string("_ushr(");this.addValue(v,b);this.buf.b+=n.string(",");this.addValue(s,b);this.buf.b+=n.string(")");break;case 19:if(a.t!=u.TInt)20==w._hx_index&&
(this.addValue(v,b),this.buf.b+=n.string(" = ")),this.addExpr({e:p.TCall({e:p.TGlobal(G.Mod),t:u.TFun([]),p:a.p},[v,s]),t:a.t,p:a.p},b);else{this.addValue(v,b);this.buf.b+=n.string(" ");var da=aa.opStr(w);this.buf.b+=n.string(da);this.buf.b+=n.string(" ");this.addValue(s,b)}break;case 20:switch(w.op._hx_index){case 1:if(5==z._hx_index)if(3==z.size)if(1==z.t._hx_index)if(8==y._hx_index)this.decl(yb.MAT34),this.decl("vec3 m3x4mult( vec3 v, _mat3x4 m) { vec4 ve = vec4(v,1.0); return vec3(dot(m.a,ve),dot(m.b,ve),dot(m.c,ve)); }"),
20==w._hx_index&&(this.addValue(v,b),this.buf.b+=n.string(" = ")),this.buf.b+=n.string("m3x4mult("),this.addValue(v,b),this.buf.b+=n.string(","),this.addValue(s,b),this.buf.b+=n.string(")");else{this.addValue(v,b);this.buf.b+=n.string(" ");var ea=aa.opStr(w);this.buf.b+=n.string(ea);this.buf.b+=n.string(" ");this.addValue(s,b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");var ga=aa.opStr(w);this.buf.b+=n.string(ga);this.buf.b+=n.string(" ");this.addValue(s,b)}else{this.addValue(v,b);this.buf.b+=
n.string(" ");var ia=aa.opStr(w);this.buf.b+=n.string(ia);this.buf.b+=n.string(" ");this.addValue(s,b)}else{this.addValue(v,b);this.buf.b+=n.string(" ");var ja=aa.opStr(w);this.buf.b+=n.string(ja);this.buf.b+=n.string(" ");this.addValue(s,b)}break;case 19:if(a.t!=u.TInt)20==w._hx_index&&(this.addValue(v,b),this.buf.b+=n.string(" = ")),this.addExpr({e:p.TCall({e:p.TGlobal(G.Mod),t:u.TFun([]),p:a.p},[v,s]),t:a.t,p:a.p},b);else{this.addValue(v,b);this.buf.b+=n.string(" ");var ka=aa.opStr(w);this.buf.b+=
n.string(ka);this.buf.b+=n.string(" ");this.addValue(s,b)}break;default:this.addValue(v,b);this.buf.b+=n.string(" ");var la=aa.opStr(w);this.buf.b+=n.string(la);this.buf.b+=n.string(" ");this.addValue(s,b)}break;default:this.addValue(v,b);this.buf.b+=n.string(" ");var ma=aa.opStr(w);this.buf.b+=n.string(ma);this.buf.b+=n.string(" ");this.addValue(s,b)}break;case 6:var pa=c.e1,na=this.buf,qa=na.b,ha;switch(c.op._hx_index){case 0:ha="++";break;case 1:ha="--";break;case 2:ha="!";break;case 3:ha="-";
break;case 4:ha="~"}na.b=qa+n.string(ha);this.addValue(pa,b);break;case 7:var sa=c.init,ra=c.v;this.locals.h[ra.id]=ra;if(null!=sa){var ua=this.varName(ra);this.buf.b+=n.string(ua);this.buf.b+=n.string(" = ");this.addValue(sa,b)}else this.buf.b+=n.string("/*var*/");break;case 8:var fa=c.args,ta=c.e,xa=ta.e;if(2==xa._hx_index){var ya=xa.g;switch(ya._hx_index){case 35:var za=this.getFunName(ya,fa,a.t);this.buf.b+=n.string(za);this.buf.b+=n.string("(");for(var wa=0;wa<fa.length;){var Ea=fa[wa];++wa;
this.addValue(Ea,b);this.buf.b+=n.string(", ")}this.buf.b+=n.string("0)");break;case 53:if(1==fa.length){var Fa=fa[0];this.buf.b+=n.string("clamp(");this.addValue(Fa,b);this.buf.b+=n.string(", 0., 1.)")}else{var Ca=ta.e;if(2==Ca._hx_index){var D=this.getFunName(Ca.g,fa,a.t);this.buf.b+=n.string(D)}else this.addValue(ta,b);this.buf.b+=n.string("(");for(var Da=!0,Ba=0;Ba<fa.length;){var Ha=fa[Ba];++Ba;Da?Da=!1:this.buf.b+=n.string(", ");this.addValue(Ha,b)}this.buf.b+=n.string(")")}break;default:var Ja=
ta.e;if(2==Ja._hx_index){var Ka=this.getFunName(Ja.g,fa,a.t);this.buf.b+=n.string(Ka)}else this.addValue(ta,b);this.buf.b+=n.string("(");for(var La=!0,Ma=0;Ma<fa.length;){var Pa=fa[Ma];++Ma;La?La=!1:this.buf.b+=n.string(", ");this.addValue(Pa,b)}this.buf.b+=n.string(")")}}else{var Na=ta.e;if(2==Na._hx_index){var Sa=this.getFunName(Na.g,fa,a.t);this.buf.b+=n.string(Sa)}else this.addValue(ta,b);this.buf.b+=n.string("(");for(var Ua=!0,Qa=0;Qa<fa.length;){var Ya=fa[Qa];++Qa;Ua?Ua=!1:this.buf.b+=n.string(", ");
this.addValue(Ya,b)}this.buf.b+=n.string(")")}break;case 9:var Ta=c.regs,Za=c.e;if(3==Za.t._hx_index){for(var Oa=0;Oa<Ta.length;){var Ga=Ta[Oa];++Oa;if(Ga!=ca.X)throw new q("assert");}switch(Ta.length){case 1:this.addValue(Za,b);break;case 2:this.decl("vec2 _vec2( float v ) { return vec2(v,v); }");this.buf.b+=n.string("_vec2(");this.addValue(Za,b);this.buf.b+=n.string(")");break;case 3:this.decl("vec3 _vec3( float v ) { return vec3(v,v,v); }");this.buf.b+=n.string("_vec3(");this.addValue(Za,b);this.buf.b+=
n.string(")");break;case 4:this.decl("vec4 _vec4( float v ) { return vec4(v,v,v,v); }");this.buf.b+=n.string("_vec4(");this.addValue(Za,b);this.buf.b+=n.string(")");break;default:throw new q("assert");}}else{this.addValue(Za,b);this.buf.b+=n.string(".");for(var db=0;db<Ta.length;){var hb=Ta[db];++db;var Aa=this.buf,fb=Aa.b,ab;switch(hb._hx_index){case 0:ab="x";break;case 1:ab="y";break;case 2:ab="z";break;case 3:ab="w"}Aa.b=fb+n.string(ab)}}break;case 10:var Ra=c.eelse,ib=c.eif,jb=c.econd;this.buf.b+=
n.string("if( ");this.addValue(jb,b);this.buf.b+=n.string(") ");this.addExpr(ib,b);null!=Ra&&(this.isBlock(ib)||(this.buf.b+=n.string(";")),this.buf.b+=n.string(" else "),this.addExpr(Ra,b));break;case 11:this.buf.b+=n.string("discard");break;case 12:var bb=c.e;null==bb?this.buf.b+=n.string("return"):(this.buf.b+=n.string("return "),this.addValue(bb,b));break;case 13:var kb=c.loop,sb=c.it,va=c.v;this.locals.h[va.id]=va;var oa=sb.e;if(5==oa._hx_index)if(21==oa.op._hx_index){var Va=oa.e2,$a=oa.e1;this.buf.b+=
n.string("for(");this.buf.b+=n.string(va.name+"=");this.addValue($a,b);this.buf.b+=n.string(";"+va.name+"<");this.addValue(Va,b);this.buf.b+=n.string(";"+va.name+"++) ");this.addBlock(kb,b)}else throw new q("assert");else throw new q("assert");break;case 14:this.buf.b+=n.string("continue");break;case 15:this.buf.b+=n.string("break");break;case 16:var ub=c.index;this.addValue(c.e,b);this.buf.b+=n.string("[");this.addValue(ub,b);this.buf.b+=n.string("]");break;case 17:var ob=c.el,Wa=a.t;if(15==Wa._hx_index)this.addType(Wa.t);
else throw new q("assert");this.buf.b+=n.string("["+ob.length+"]");this.buf.b+=n.string("(");for(var wb=!0,pb=0;pb<ob.length;){var xb=ob[pb];++pb;wb?wb=!1:this.buf.b+=n.string(", ");this.addValue(xb,b)}this.buf.b+=n.string(")");break;case 18:this.buf.b+=n.string("switch(...)");break;case 19:var rb=c.loop,tb=c.e;!1==c.normalWhile?(b+="\t",this.buf.b+=n.string("do "),this.addBlock(rb,b),this.buf.b+=n.string(" while( "),this.addValue(tb,b),this.buf.b+=n.string(" )")):(this.buf.b+=n.string("while( "),
this.addValue(tb,b),this.buf.b+=n.string(" ) "),this.addBlock(rb,b));break;case 20:this.addExpr(c.e,b)}},varName:function(a){if(a.kind==Y.Output){if(this.isVertex)return"gl_Position";if(null!=this.glES&&2>=this.glES)return null==this.outIndexes?"gl_FragColor":"gl_FragData["+this.outIndexes.h[a.id]+"]"}var b=this.varNames.h[a.id];if(null!=b)return b;var b=a.name,c=yb.KWDS;if(null!=Q[b]?c.existsReserved(b):c.h.hasOwnProperty(b))b="_"+b;c=this.allNames;if(null!=Q[b]?c.existsReserved(b):c.h.hasOwnProperty(b)){c=
2;for(b+="_";;){var d=this.allNames,e=b+c;if(!(null!=Q[e]?d.existsReserved(e):d.h.hasOwnProperty(e)))break;++c}b+=c}this.varNames.h[a.id]=b;a=a.id;c=this.allNames;null!=Q[b]?c.setReserved(b,a):c.h[b]=a;return b},newLine:function(a){this.isBlock(a)?this.buf.b+=n.string("\n"):this.buf.b+=n.string(";\n")},isBlock:function(a){a=a.e;switch(a._hx_index){case 4:return!0;case 13:return this.isBlock(a.loop);case 19:return!0==a.normalWhile?this.isBlock(a.loop):!1;default:return!1}},initVar:function(a){switch(a.kind._hx_index){case 0:case 2:16==
a.type._hx_index&&(this.buf.b+=n.string("layout(std140) "));this.buf.b+=n.string("uniform ");break;case 1:this.buf.b+=n.string(null!=this.glES&&2>=this.glES?"attribute ":"in ");break;case 3:this.buf.b+=n.string(null!=this.glES&&2>=this.glES?"varying ":this.isVertex?"out ":"in ");break;case 5:if(null!=this.glES&&2>=this.glES){this.outIndexes.h[a.id]=this.outIndex++;return}if(this.isVertex)return;null!=this.glES&&(this.buf.b+=n.string("layout(location="+this.outIndex++ +") "));this.buf.b+=n.string("out ");
break;case 6:return}if(null!=a.qualifiers)for(var b=0,c=a.qualifiers;b<c.length;){var d=c[b];++b;if(6==d._hx_index)switch(d.p._hx_index){case 0:this.buf.b+=n.string("lowp ");break;case 1:this.buf.b+=n.string("mediump ");break;case 2:this.buf.b+=n.string("highp ")}}this.addVar(a);this.buf.b+=n.string(";\n")},initVars:function(a){this.uniformBuffer=this.outIndex=0;this.outIndexes=new na;var b=0;for(a=a.vars;b<a.length;){var c=a[b];++b;this.initVar(c)}this.buf.b+=n.string("\n");2>this.outIndex?this.outIndexes=
null:!this.isVertex&&(null!=this.glES&&2>=this.glES)&&this.decl("#extension GL_EXT_draw_buffers : enable")},run:function(a){this.locals=new na;this.decls=[];this.buf=new Ib;this.exprValues=[];this.decl("precision mediump float;");if(1!=a.funs.length)throw new q("assert");var b=a.funs[0];this.isVertex=b.kind==dc.Vertex;this.initVars(a);a=this.buf;this.buf=new Ib;this.buf.b+=n.string("void main(void) {\n");var c=b.expr.e;if(4==c._hx_index){b=c.el;for(c=0;c<b.length;){var d=b[c];++c;this.buf.b+=n.string("\t");
this.addExpr(d,"\t");this.newLine(d)}}else this.addExpr(b.expr,"");this.buf.b+=n.string("}");this.exprValues.push(this.buf.b);this.buf=a;a=Li.array(this.locals);a.sort(function(a,b){return ua.compare(a.name,b.name)});for(b=0;b<a.length;)c=a[b],++b,this.addVar(c),this.buf.b+=n.string(";\n");this.buf.b+=n.string("\n");a=0;for(b=this.exprValues;a<b.length;)c=b[a],++a,this.buf.b+=n.string(c),this.buf.b+=n.string("\n\n");null!=this.glES?this.decl("#version "+(100>this.version?100:this.version)+(150<this.version?
" es":"")):null!=this.version?this.decl("#version "+(150<this.version?150:this.version)):this.decl("#version 130");this.decls.push(this.buf.b);this.buf=null;return this.decls.join("\n")},__class__:yb};var tk=function(){};r["hxsl._Linker.AllocatedVar"]=tk;tk.__name__="hxsl._Linker.AllocatedVar";tk.prototype={__class__:tk};var ng=function(a,b){this.name=a;this.uid=ng.UID++;this.vertex=b;this.processed=new na;this.usedFunctions=[];this.read=new na;this.write=new na};r["hxsl._Linker.ShaderInfos"]=ng;
ng.__name__="hxsl._Linker.ShaderInfos";ng.prototype={__class__:ng};var lk=function(a){null==a&&(a=!1);this.debugDepth=0;this.batchMode=a};r["hxsl.Linker"]=lk;lk.__name__="hxsl.Linker";lk.prototype={debug:function(a,b){},error:function(a,b){return Za.t(a,b)},mergeVar:function(a,b,c,d){switch(b.kind._hx_index){case 2:case 6:throw new q("assert");}b.kind!=c.kind&&(b.kind!=Y.Local&&c.kind!=Y.Local)&&this.error("'"+a+"' kind does not match : "+n.string(b.kind)+" should be "+n.string(c.kind),d);var e=c.type,
f=b.type;if(13==f._hx_index)if(13==e._hx_index){b=f.vl;e=e.vl;for(c=0;c<b.length;){f=b[c];++c;for(var g=null,h=0;h<e.length;){var k=e[h];++h;if(f.name==k.name){g=k;break}}null==g?e.push(this.allocVar(f,d).v):this.mergeVar(a+"."+g.name,f,g,d)}}else Fa.enumEq(b.type,c.type)||this.error("'"+a+"' type does not match : "+w.toString(b.type)+" should be "+w.toString(c.type),d);else Fa.enumEq(b.type,c.type)||this.error("'"+a+"' type does not match : "+w.toString(b.type)+" should be "+w.toString(c.type),d)},
allocVar:function(a,b,c,d){if(null!=a.parent&&null==d){d=this.allocVar(a.parent,b);var e=d.v;c=e.name;for(e=e.parent;null!=e;)c=e.name+"."+c,e=e.parent}c=null==c?a.name:c+"."+a.name;if(null!=a.qualifiers)for(var e=0,f=a.qualifiers;e<f.length;){var g=f[e];++e;4==g._hx_index&&(c=g.n)}e=this.varMap;f=null!=Q[c]?e.getReserved(c):e.h[c];e=a.name;if(null!=f){for(var g=0,h=f.merged;g<h.length;){var k=h[g];++g;if(k==a)return f}a.kind==Y.Param&&!w.hasQualifier(a,jb.Shared)&&!this.isBatchShader||a.kind==Y.Function||
a.kind==Y.Var&&w.hasQualifier(a,jb.Private)?g=!0:(g=f.v,g=g.kind==Y.Param&&!w.hasQualifier(g,jb.Shared)&&!this.isBatchShader||g.kind==Y.Function||g.kind==Y.Var&&w.hasQualifier(g,jb.Private));if(g||a.kind==Y.Param&&f.v.kind==Y.Param){for(f=2;;){g=this.varMap;h=c+f;g=null!=Q[h]?g.getReserved(h):g.h[h];if(null==g)break;h=0;for(k=g.merged;h<k.length;){var l=k[h];++h;if(l==a)return g}++f}e+=f;c+=f}else return f.merged.push(a),this.mergeVar(c,a,f.v,b),this.varIdMap.h[a.id]=f.id,f}g=this.allVars.length+
1;e={id:g,name:e,type:a.type,kind:a.kind,qualifiers:a.qualifiers,parent:null==d?null:d.v};f=new tk;f.v=e;f.merged=[a];f.path=c;f.id=g;f.parent=d;f.instanceIndex=this.curInstance;this.allVars.push(f);a=this.varMap;null!=Q[c]?a.setReserved(c,f):a.h[c]=f;a=e.type;if(13==a._hx_index){a=a.vl;d=[];for(g=0;g<a.length;)h=a[g],++g,d.push(this.allocVar(h,b,c,f).v);e.type=u.TStruct(d)}return f},mapExprVar:function(a){var b=a.e;switch(b._hx_index){case 1:b=b.v;if(!this.locals.h.hasOwnProperty(b.id))return b=
this.allocVar(b,a.p),null!=this.curShader&&!this.curShader.write.h.hasOwnProperty(b.id)&&(this.curShader.read.h[b.id]=b,null==this.curShader.vertex&&b.v.kind==Y.Var&&(this.curShader.vertex=!1)),{e:p.TVar(b.v),t:b.v.type,p:a.p};break;case 5:var c=b.e2,d=b.e1,b=b.op,e=d.e;switch(b._hx_index){case 4:switch(e._hx_index){case 1:e=e.v;if(this.locals.h.hasOwnProperty(e.id)){if(!this.locals.h.hasOwnProperty(e.id))return d=this.mapExprVar(d),c=this.mapExprVar(c),e=this.allocVar(e,d.p),null!=this.curShader&&
(this.curShader.write.h[e.id]=e),{e:p.TBinop(b,d,c),t:a.t,p:a.p}}else return c=this.mapExprVar(c),d=this.allocVar(e,d.p),null!=this.curShader&&(this.curShader.write.h[d.id]=d),{e:p.TBinop(b,{e:p.TVar(d.v),t:d.v.type,p:a.p},c),t:a.t,p:a.p};break;case 9:if(e=e.e.e,1==e._hx_index&&(e=e.v,!this.locals.h.hasOwnProperty(e.id)))return d=this.mapExprVar(d),c=this.mapExprVar(c),e=this.allocVar(e,d.p),null!=this.curShader&&(this.curShader.write.h[e.id]=e),{e:p.TBinop(b,d,c),t:a.t,p:a.p}}break;case 20:switch(e._hx_index){case 1:e=
e.v;if(!this.locals.h.hasOwnProperty(e.id))return d=this.mapExprVar(d),c=this.mapExprVar(c),e=this.allocVar(e,d.p),null!=this.curShader&&(this.curShader.write.h[e.id]=e),{e:p.TBinop(b,d,c),t:a.t,p:a.p};break;case 9:if(e=e.e.e,1==e._hx_index&&(e=e.v,!this.locals.h.hasOwnProperty(e.id)))return d=this.mapExprVar(d),c=this.mapExprVar(c),e=this.allocVar(e,d.p),null!=this.curShader&&(this.curShader.write.h[e.id]=e),{e:p.TBinop(b,d,c),t:a.t,p:a.p}}}break;case 7:this.locals.h[b.v.id]=!0;break;case 11:null!=
this.curShader&&(this.curShader.vertex=!1,this.curShader.hasDiscard=!0);break;case 13:this.locals.h[b.v.id]=!0}return w.map(a,z(this,this.mapExprVar))},addShader:function(a,b,c,d){this.curShader=a=new ng(a,b);a.priority=d;a.body=this.mapExprVar(c);this.shaders.push(a);this.curShader=null;return a},sortByPriorityDesc:function(a,b){return a.priority==b.priority?a.uid-b.uid:b.priority-a.priority},buildDependency:function(a,b,c){c=!c;for(var d=0,e=this.shaders;d<e.length;){var f=e[d];++d;if(f==a)c=!0;
else if(c&&f.write.h.hasOwnProperty(b.id)){if(a.vertex){if(!1==f.vertex)continue;null==f.vertex&&(f.vertex=!0)}a.deps.set(f,!0);this.debugDepth++;this.initDependencies(f);this.debugDepth--;if(!f.read.h.hasOwnProperty(b.id))return}}b.v.kind==Y.Var&&this.error("Variable "+b.path+" required by "+a.name+" is missing initializer",null)},initDependencies:function(a){if(null==a.deps){a.deps=new zb;for(var b=a.read.iterator();b.hasNext();){var c=b.next();this.buildDependency(a,c,a.write.h.hasOwnProperty(c.id))}if(null==
a.vertex)for(b=a.deps.keys();b.hasNext();)if(!1==b.next().vertex){a.vertex=!1;break}if(a.vertex)for(a=a.deps.keys();a.hasNext();)b=a.next(),null==b.vertex&&(b.vertex=!0)}},collect:function(a,b,c){a.onStack&&this.error("Loop in shader dependencies ("+a.name+")",null);if(a.marked!=c){a.marked=c;a.onStack=!0;for(var d=[],e=a.deps.keys();e.hasNext();){var f=e.next();d.push(f)}d.sort(z(this,this.sortByPriorityDesc));for(e=0;e<d.length;)f=d[e],++e,this.collect(f,b,c);null==a.vertex&&(a.vertex=c);a.vertex==
c&&b.push(a);a.onStack=!1}},uniqueLocals:function(a,b){var c=a.e;switch(c._hx_index){case 4:for(var c=c.el,d=new ga,e=b.keys();e.hasNext();){var f=e.next();null!=Q[f]?d.setReserved(f,!0):d.h[f]=!0}for(e=0;e<c.length;)f=c[e],++e,this.uniqueLocals(f,d);break;case 7:c=c.v;d=c.name;if(null!=Q[d]?b.existsReserved(d):b.h.hasOwnProperty(d)){for(d=2;;){e=c.name+d;if(!(null!=Q[e]?b.existsReserved(e):b.h.hasOwnProperty(e)))break;++d}c.name+=d}c=c.name;null!=Q[c]?b.setReserved(c,!0):b.h[c]=!0;break;default:var g=
z(this,this.uniqueLocals);w.iter(a,function(a){g(a,b)})}},link:function(a){var b=this;this.varMap=new ga;this.varIdMap=new na;this.allVars=[];this.shaders=[];this.locals=new na;for(var c=new zb,d=[],e=0;e<a.length;){var f=a[e];++e;var g=f;null!=c.h.__keys__[f.__id__]&&(f=ih.shaderData(f));c.set(f,g);d.push(f)}a=d;this.curInstance=0;d=[];for(e=0;e<a.length;){f=a[e];++e;this.isBatchShader=this.batchMode&&Qa.startsWith(f.name,"batchShader_");for(var g=0,h=f.vars;g<h.length;){var k=h[g];++g;var l=this.allocVar(k,
null);this.isBatchShader&&(l.v.kind==Y.Param&&!Qa.startsWith(l.path,"Batch_"))&&(l.v.kind=Y.Local);k.kind==Y.Output&&d.push(k)}g=0;for(f=f.funs;g<f.length;)h=f[g],++g,this.allocVar(h.ref,h.expr.p).kind=h.kind;this.curInstance++}e=0;f=[-3E3];g=[-2E3];h=[-1E3];for(k=0;k<a.length;){l=a[k];++k;for(var m=0,n=l.funs;m<n.length;){var r=n[m];++m;var s=this.allocVar(r.ref,r.expr.p);if(null==s.kind)throw new q("assert");switch(s.kind._hx_index){case 0:case 1:this.addShader(l.name+"."+(s.kind==dc.Vertex?"vertex":
"fragment"),s.kind==dc.Vertex,r.expr,e);break;case 2:var v;switch(r.ref.name){case "__init__fragment":s=h;v=!1;break;case "__init__vertex":s=g;v=!0;break;default:s=f,v=null}var y=r.expr.e;if(4==y._hx_index)for(var y=y.el,A=0,B=0;B<y.length;){var F=y[B];++B;this.addShader(l.name+"."+r.ref.name+A++,v,F,s[0]++)}else this.addShader(l.name+"."+r.ref.name,v,r.expr,s[0]++);break;case 3:throw new q("Unexpected helper function in linker "+s.v.name);}}++e}this.shaders.sort(z(this,this.sortByPriorityDesc));
e=new ng("<entry>",!1);e.deps=new zb;for(a=0;a<d.length;)f=d[a],++a,this.buildDependency(e,this.allocVar(f,null),!1);a=0;for(d=this.shaders;a<d.length;)f=d[a],++a,f.hasDiscard&&(this.initDependencies(f),e.deps.set(f,!0));a=0;for(d=this.shaders;a<d.length;)if(f=d[a],++a,null==f.vertex){g=!0;for(h=f.read.iterator();h.hasNext();)if(h.next().v.kind!=Y.Param){g=!1;break}g&&(f.vertex=!1)}a=[];d=[];this.collect(e,a,!0);this.collect(e,d,!1);if(d.pop()!=e)throw new q("assert");e=0;for(f=this.shaders;e<f.length;)g=
f[e],++e,g.marked=null;e=0;for(f=a.concat(d);e<f.length;){g=f[e];++e;for(h=g.deps.keys();h.hasNext();)k=h.next(),null==k.marked&&this.error(k.name+" needed by "+g.name+" is unreachable",null);g.marked=!0}for(var G=[],I={},J=null,J=function(a){I.hasOwnProperty(a.id)||(I[a.id]=!0,null!=a.v.parent?J(a.parent):G.push(a.v))},e=0,f=a.concat(d);e<f.length;){g=f[e];++e;for(h=g.read.iterator();h.hasNext();)k=h.next(),J(k);for(g=g.write.iterator();g.hasNext();)h=g.next(),J(h)}for(var K=null,K=function(a){var b=
a.type;if(13==b._hx_index&&(b=b.vl,a.kind!=Y.Input)){for(var c=[],d=0;d<b.length;){var e=b[d];++d;I.hasOwnProperty(e.id)&&(K(e),c.push(e))}a.type=u.TStruct(c)}},e=0;e<G.length;)f=G[e],++e,K(f);e=function(a,c,d){c={id:w.allocVarId(),name:c,type:u.TFun([{ret:u.TVoid,args:[]}]),kind:Y.Function};G.push(c);for(var e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.body.e;if(4==h._hx_index){g=h.el;for(h=0;h<g.length;){var k=g[h];++h;e.push(k)}}else e.push(g.body)}d={e:p.TBlock(e),t:u.TVoid,p:0==e.length?null:
e[0].p};b.uniqueLocals(d,new ga);return{kind:a,ref:c,ret:u.TVoid,args:[],expr:d}};a=[e(dc.Vertex,"vertex",a),e(dc.Fragment,"fragment",d)];for(d=c.keys();d.hasNext();)if(e=d.next(),f=c.h[e.__id__],e!=f){g=0;for(h=e.vars.length;g<h;)k=g++,this.allocVar(e.vars[k],null).merged.unshift(f.vars[k])}return{name:"out",vars:G,funs:a}},__class__:lk};var ec=K["hxsl.Output"]={__ename__:!0,__constructs__:"Const Value PackNormal PackFloat Vec2 Vec3 Vec4 Swiz".split(" "),Const:(s=function(a){return{_hx_index:0,v:a,
__enum__:"hxsl.Output",toString:m}},s.__params__=["v"],s),Value:(s=function(a,b){return{_hx_index:1,v:a,size:b,__enum__:"hxsl.Output",toString:m}},s.__params__=["v","size"],s),PackNormal:(s=function(a){return{_hx_index:2,v:a,__enum__:"hxsl.Output",toString:m}},s.__params__=["v"],s),PackFloat:(s=function(a){return{_hx_index:3,v:a,__enum__:"hxsl.Output",toString:m}},s.__params__=["v"],s),Vec2:(s=function(a){return{_hx_index:4,a:a,__enum__:"hxsl.Output",toString:m}},s.__params__=["a"],s),Vec3:(s=function(a){return{_hx_index:5,
a:a,__enum__:"hxsl.Output",toString:m}},s.__params__=["a"],s),Vec4:(s=function(a){return{_hx_index:6,a:a,__enum__:"hxsl.Output",toString:m}},s.__params__=["a"],s),Swiz:(s=function(a,b){return{_hx_index:7,a:a,swiz:b,__enum__:"hxsl.Output",toString:m}},s.__params__=["a","swiz"],s)};ec.__empty_constructs__=[];var aa=function(a){null==a&&(a=!1);this.varId=a};r["hxsl.Printer"]=aa;aa.__name__="hxsl.Printer";aa.opStr=function(a){switch(a._hx_index){case 0:return"+";case 1:return"*";case 2:return"/";case 3:return"-";
case 4:return"=";case 5:return"==";case 6:return"!=";case 7:return">";case 8:return">=";case 9:return"<";case 10:return"<=";case 11:return"&";case 12:return"|";case 13:return"^";case 14:return"&&";case 15:return"||";case 16:return"<<";case 17:return">>";case 18:return">>>";case 19:return"%";case 20:return aa.opStr(a.op)+"=";case 21:return"...";case 22:return"=>";case 23:return" in "}};aa.toString=function(a,b){null==b&&(b=!1);return(new aa(b)).exprString(a)};aa.shaderToString=function(a,b){null==
b&&(b=!1);return(new aa(b)).shaderString(a)};aa.check=function(a,b){try{for(var c=new na,d=[],e=null,e=function(a,b){if(b){if(c.h.hasOwnProperty(a.id))throw new q("Duplicate var "+a.id);c.h[a.id]=a;d.push(a)}else c.remove(a.id);var f=a.type;if(13==f._hx_index)for(var f=f.vl,g=0;g<f.length;){var h=f[g];++g;e(h,b)}},f=null,f=function(a){var b=a.e;switch(b._hx_index){case 1:b=b.v;if(!c.h.hasOwnProperty(b.id))throw new q("Unbound var "+b.name+"@"+b.id);break;case 4:a=b.el;b=d;d=[];for(var g=0;g<a.length;){var h=
a[g];++g;f(h)}for(a=0;a<d.length;)g=d[a],++a,e(g,!1);d=b;break;case 7:a=b.init;b=b.v;null!=a&&f(a);e(b,!0);break;case 13:a=b.loop;g=b.v;f(b.it);e(g,!0);f(a);e(g,!1);break;default:w.iter(a,f)}},g=0,h=a.vars;g<h.length;){var k=h[g];++g;e(k,!0)}for(var g=0,l=a.funs;g<l.length;){var m=l[g];++g;for(var h=0,n=m.args;h<n.length;){var p=n[h];++h;e(p,!0)}f(m.expr);for(var h=0,r=m.args;h<r.length;){var s=r[h];++h;e(s,!1)}}}catch(u){$.lastException=u;l=u instanceof q?u.val:u;if("string"==typeof l){l=l+"\n    in\n"+
aa.shaderToString(a,!0);if(null!=b){m=[];for(n=0;n<b.length;)p=b[n],++n,m.push(aa.shaderToString(p,!0));l+="\n    from\n\n"+m.join("\n\n")}throw new q(l);}throw u;}};aa.prototype={add:function(a){this.buffer.b+=n.string(a)},shaderString:function(a){this.buffer=new Ib;for(var b=0,c=a.vars;b<c.length;){var d=c[b];++b;this.addVar(d,Y.Var);this.buffer.b+=n.string(";\n")}0<a.vars.length&&(this.buffer.b+=n.string("\n"));b=0;for(a=a.funs;b<a.length;)c=a[b],++b,this.addFun(c),this.buffer.b+=n.string("\n\n");
return this.buffer.b},varString:function(a){this.buffer=new Ib;this.addVar(a,null);return this.buffer.b},funString:function(a){this.buffer=new Ib;this.addFun(a);return this.buffer.b},exprString:function(a){this.buffer=new Ib;this.addExpr(a,"");return this.buffer.b},addVar:function(a,b,c,d){null==c&&(c="");if(null!=a.qualifiers)for(var e=0,f=a.qualifiers;e<f.length;){var g=f[e];++e;var h;switch(g._hx_index){case 0:g=g.max;h="const"+(null==g?"":"("+g+")");break;case 1:h="private";break;case 2:h="nullable";
break;case 3:h="perObject";break;case 4:h="name('"+g.n+"')";break;case 5:h="shared";break;case 6:g=g.p;h=K[g.__enum__].__constructs__[g._hx_index].toLowerCase()+"p";break;case 7:h="range("+g.min+","+g.max+")";break;case 8:h="ignore";break;case 9:h="perInstance("+g.v+")"}this.buffer.b+=n.string("@"+h+" ")}if(a.kind!=b)switch(a.kind._hx_index){case 0:this.buffer.b+=n.string("@global ");break;case 1:this.buffer.b+=n.string("@input ");break;case 2:this.buffer.b+=n.string("@param ");break;case 3:this.buffer.b+=
n.string("@var ");break;case 4:this.buffer.b+=n.string("@local ");break;case 5:this.buffer.b+=n.string("@output ");break;case 6:this.buffer.b+=n.string("@function ")}this.buffer.b+=n.string("var ");a.parent==d?this.buffer.b+=n.string(a.name+(this.varId?"@"+a.id:"")):this.addVarName(a);this.buffer.b+=n.string(" : ");b=a.type;if(13==b._hx_index){a=b.vl;this.buffer.b+=n.string("{");b=!0;for(d=0;d<a.length;)e=a[d],++d,b?b=!1:this.buffer.b+=n.string(", "),this.addVar(e,e.kind,c,e);this.buffer.b+=n.string("}")}else c=
w.toString(a.type),this.buffer.b+=n.string(c)},addFun:function(a){this.buffer.b+=n.string("function "+a.ref.name+"(");for(var b=!0,c=0,d=a.args;c<d.length;){var e=d[c];++c;b?(this.buffer.b+=n.string(" "),b=!1):this.buffer.b+=n.string(", ");this.addVar(e,Y.Local)}0<a.args.length&&(this.buffer.b+=n.string(" "));b=") : "+w.toString(a.ret)+" ";this.buffer.b+=n.string(b);this.addExpr(a.expr,"")},addVarName:function(a){null!=a.parent&&(this.addVarName(a.parent),this.buffer.b+=n.string("."));this.buffer.b+=
n.string(a.name);this.varId&&(this.buffer.b+=n.string("@"+a.id))},addConst:function(a){var b=this.buffer,c=b.b,d;switch(a._hx_index){case 0:d="null";break;case 1:d=a.b;break;case 2:d=a.v;break;case 3:d=a.v;break;case 4:d='"'+a.v+'"'}b.b=c+n.string(d)},addExpr:function(a,b){var c=a.e;switch(c._hx_index){case 0:this.addConst(c.c);break;case 1:this.addVarName(c.v);break;case 2:c=Nk.toString(c.g);this.buffer.b+=n.string(c);break;case 3:c=c.e;this.buffer.b+=n.string("(");this.addExpr(c,b);this.buffer.b+=
n.string(")");break;case 4:c=c.el;this.buffer.b+=n.string("{");b+="\t";for(var d=0;d<c.length;){var e=c[d];++d;this.buffer.b+=n.string("\n"+b);this.addExpr(e,b);this.buffer.b+=n.string(";")}b=v.substr(b,1,null);0<c.length&&(this.buffer.b+=n.string("\n"+b));this.buffer.b+=n.string("}");break;case 5:d=c.e2;e=c.op;this.addExpr(c.e1,b);c=" "+aa.opStr(e)+" ";this.buffer.b+=n.string(c);this.addExpr(d,b);break;case 6:var d=c.e1,e=this.buffer,f=e.b,g;switch(c.op._hx_index){case 0:g="++";break;case 1:g="--";
break;case 2:g="!";break;case 3:g="-";break;case 4:g="~"}e.b=f+n.string(g);this.addExpr(d,b);break;case 7:d=c.init;this.addVar(c.v,Y.Local,b);null!=d&&(this.buffer.b+=n.string(" = "),this.addExpr(d,b));break;case 8:d=c.args;this.addExpr(c.e,b);this.buffer.b+=n.string("(");c=!0;for(e=0;e<d.length;)f=d[e],++e,c?c=!1:this.buffer.b+=n.string(", "),this.addExpr(f,b);this.buffer.b+=n.string(")");break;case 9:d=c.regs;this.addExpr(c.e,b);this.buffer.b+=n.string(".");for(c=0;c<d.length;)e=d[c],++c,this.buffer.b+=
n.string(aa.SWIZ[e._hx_index]);break;case 10:d=c.eelse;e=c.eif;c=c.econd;this.buffer.b+=n.string("if( ");this.addExpr(c,b);this.buffer.b+=n.string(" ) ");this.addExpr(e,b);null!=d&&(this.buffer.b+=n.string(" else "),this.addExpr(d,b));break;case 11:this.buffer.b+=n.string("discard");break;case 12:c=c.e;this.buffer.b+=n.string("return");null!=c&&(this.buffer.b+=n.string(" "),this.addExpr(c,b));break;case 13:d=c.loop;e=c.it;c=c.v;this.buffer.b+=n.string("for( ");this.addVarName(c);this.buffer.b+=n.string(" in ");
this.addExpr(e,b);this.buffer.b+=n.string(" ) ");this.addExpr(d,b);break;case 14:this.buffer.b+=n.string("continue");break;case 15:this.buffer.b+=n.string("break");break;case 16:d=c.index;this.addExpr(c.e,b);this.buffer.b+=n.string("[");this.addExpr(d,b);this.buffer.b+=n.string("]");break;case 17:c=c.el;this.buffer.b+=n.string("[");d=!0;for(e=0;e<c.length;)f=c[e],++e,d?d=!1:this.buffer.b+=n.string(", "),this.addExpr(f,b);this.buffer.b+=n.string("]");break;case 18:d=c.def;e=c.cases;c=c.e;this.buffer.b+=
n.string("switch( ");this.addExpr(c,b);this.buffer.b+=n.string(") {");c=b;for(f=0;f<e.length;){g=e[f];++f;this.buffer.b+=n.string("\n"+b);this.buffer.b+=n.string("case ");for(var h=!0,k=0,l=g.values;k<l.length;){var m=l[k];++k;h?h=!1:this.buffer.b+=n.string(", ");this.addExpr(m,b)}b+="\t";this.buffer.b+=n.string(":\n"+b);this.addExpr(g.expr,b);b=c}null!=d&&(this.buffer.b+=n.string("\n"+b),b+="\t",this.buffer.b+=n.string("default:\n"+b),this.addExpr(d,b),b=c);this.buffer.b+=n.string("\n"+b+"}");break;
case 19:d=c.loop;e=c.e;!1==c.normalWhile?(c=b,b+="\t",this.buffer.b+=n.string("do {\n"+b),this.addExpr(d,b),b=c,this.buffer.b+=n.string("\n"+b+"} while( "),this.addExpr(e,b),this.buffer.b+=n.string(" )")):(this.buffer.b+=n.string("while( "),this.addExpr(e,b),c=b,b+="\t",this.buffer.b+=n.string(" ) {\n"+b),this.addExpr(d,b),this.buffer.b+=n.string("\n"+c+"}"));break;case 20:d=c.e;e=c.args;this.buffer.b+=n.string(c.m);if(0<e.length){this.buffer.b+=n.string("(");c=!0;for(f=0;f<e.length;)g=e[f],++f,c?
c=!1:this.buffer.b+=n.string(", "),this.addConst(g);this.buffer.b+=n.string(")")}this.buffer.b+=n.string(" ");this.addExpr(d,b)}},__class__:aa};var hh=function(a,b,c,d,e){this.name=a;this.pos=b;this.instance=c;this.index=d;this.type=e};r["hxsl.AllocParam"]=hh;hh.__name__="hxsl.AllocParam";hh.prototype={clone:function(a){null==a&&(a=!1);var b=new hh(this.name,this.pos,this.instance,this.index,this.type);null!=this.perObjectGlobal&&(b.perObjectGlobal=this.perObjectGlobal.clone(a));null!=this.next&&
(b.next=this.next.clone(a));return b},__class__:hh};var gh=function(a,b,c){this.pos=a;this.path=b;this.gid=qa.allocID(b);this.type=c};r["hxsl.AllocGlobal"]=gh;gh.__name__="hxsl.AllocGlobal";gh.prototype={clone:function(a){null==a&&(a=!1);var b=new gh(this.pos,this.path,this.type);null!=this.next&&(b.next=this.next.clone(a));a&&(b.gid=0);return b},__class__:gh};var qk=function(){};r["hxsl.RuntimeShaderData"]=qk;qk.__name__="hxsl.RuntimeShaderData";qk.prototype={__class__:qk};var ok=function(a,b){this.shader=
a;this.bits=b};r["hxsl.ShaderInstanceDesc"]=ok;ok.__name__="hxsl.ShaderInstanceDesc";ok.prototype={__class__:ok};var fh=function(){this.id=fh.UID++};r["hxsl.RuntimeShader"]=fh;fh.__name__="hxsl.RuntimeShader";fh.prototype={hasGlobal:function(a){return this.globals.h.hasOwnProperty(a)},__class__:fh};var Ea=function(){this.uid=this.tid=1};r["hxsl.Serializer"]=Ea;Ea.__name__="hxsl.Serializer";Ea.run=function(a){return(new Ea).serialize(a)};Ea.prototype={writeArr:function(a,b){this.writeVarInt(a.length);
for(var c=0;c<a.length;){var d=a[c];++c;b(d)}},readArr:function(a){for(var b=[],c=0,d=this.readVarInt();c<d;)c++,b.push(a());return b},readVarInt:function(){var a=this.input.readByte();return 128>a?a:255==a?this.input.readInt32():(a&127)<<8|this.input.readByte()},writeVarInt:function(a){if(128>a)this.out.addByte(a);else{var b=a>>8;127<=b?(this.out.addByte(255),this.out.addInt32(b)):(this.out.addByte(b|128),this.out.addByte(a&255))}},writeID:function(a){var b=this.idMap.h[a];null==b&&(b=this.uid++,
this.idMap.h[a]=b);this.writeVarInt(b)},readID:function(){return this.readVarInt()},writeTID:function(a){var b=this.typeIdMap.get(a);if(null!=b)return this.writeVarInt(b),!1;b=this.tid++;this.typeIdMap.set(a,b);this.writeVarInt(b);return!0},writeType:function(a){this.out.addByte(a._hx_index);switch(a._hx_index){case 5:this.out.addByte(a.size|a.t._hx_index<<3);break;case 9:this.out.addInt32(a.size);break;case 13:var b=a.vl;if(this.writeTID(a)){a=z(this,this.writeVar);this.writeVarInt(b.length);for(var c=
0;c<b.length;){var d=b[c];++c;a(d)}}break;case 15:b=a.size;this.writeType(a.t);switch(b._hx_index){case 0:b=b.v;this.out.addByte(0);this.writeVarInt(b);break;case 1:this.writeVar(b.v)}break;case 16:b=a.size;this.writeType(a.t);switch(b._hx_index){case 0:b=b.v;this.out.addByte(0);this.writeVarInt(b);break;case 1:this.writeVar(b.v)}break;case 17:this.out.addByte(a.size)}},readType:function(){switch(this.input.readByte()){case 0:return u.TVoid;case 1:return u.TInt;case 2:return u.TBool;case 3:return u.TFloat;
case 4:return u.TString;case 5:var a=this.input.readByte(),b=Ea.TVECS.h[a];null==b&&(b=u.TVec(a&7,Fa.createEnumIndex(ab,a>>3,null)),Ea.TVECS.h[a]=b);return b;case 6:return u.TMat3;case 7:return u.TMat4;case 8:return u.TMat3x4;case 9:return u.TBytes(this.input.readInt32());case 10:return u.TSampler2D;case 11:return u.TSampler2DArray;case 12:return u.TSamplerCube;case 13:a=this.readVarInt();b=this.types[a];if(null!=b)return b;for(var b=z(this,this.readVar),c=[],d=0,e=this.readVarInt();d<e;)d++,c.push(b());
b=u.TStruct(c);return this.types[a]=b;case 14:return u.TFun(null);case 15:return a=this.readType(),b=this.readVar(),u.TArray(a,null==b?tb.SConst(this.readVarInt()):tb.SVar(b));case 16:return a=this.readType(),b=this.readVar(),u.TBuffer(a,null==b?tb.SConst(this.readVarInt()):tb.SVar(b));case 17:return u.TChannel(this.input.readByte());default:throw new q("assert");}},writeString:function(a){a=N.ofString(a);this.writeVarInt(a.length);this.out.add(a)},readString:function(){var a=this.readVarInt();return this.input.read(a).getString(0,
a)},writeVar:function(a){if(null==a)this.out.addByte(0);else if(this.writeID(a.id),!this.varMap.h.hasOwnProperty(a.id))if(this.varMap.h[a.id]=a,this.writeString(a.name),this.writeType(a.type),this.out.addByte(a.kind._hx_index),this.writeVar(a.parent),null==a.qualifiers)this.out.addByte(0);else{this.out.addByte(a.qualifiers.length);var b=0;for(a=a.qualifiers;b<a.length;){var c=a[b];++b;this.out.addByte(c._hx_index);switch(c._hx_index){case 0:c=c.max;this.out.addInt32(null==c?0:c);break;case 4:this.writeString(c.n);
break;case 6:this.out.addByte(c.p._hx_index);break;case 7:var d=c.max;this.out.addDouble(c.min);this.out.addDouble(d);break;case 9:this.out.addInt32(c.v)}}}},writeFun:function(a){this.out.addByte(a.kind._hx_index);this.writeVar(a.ref);var b=a.args,c=z(this,this.writeVar);this.writeVarInt(b.length);for(var d=0;d<b.length;){var e=b[d];++d;c(e)}this.writeType(a.ret);this.writeExpr(a.expr)},writeConst:function(a){this.out.addByte(a._hx_index);switch(a._hx_index){case 1:this.out.addByte(a.b?1:0);break;
case 2:this.out.addInt32(a.v);break;case 3:this.out.addDouble(a.v);break;case 4:this.writeString(a.v)}},writeExpr:function(a){if(null==a)this.out.addByte(0);else{this.out.addByte(a.e._hx_index+1);var b=a.e;switch(b._hx_index){case 0:this.writeConst(b.c);break;case 1:this.writeVar(b.v);break;case 2:this.out.addByte(b.g._hx_index);break;case 3:this.writeExpr(b.e);break;case 4:var b=b.el,c=z(this,this.writeExpr);this.writeVarInt(b.length);for(var d=0;d<b.length;){var e=b[d];++d;c(e)}break;case 5:c=b.e2;
d=b.e1;b=b.op;20==b._hx_index?this.out.addByte(b.op._hx_index|128):this.out.addByte(b._hx_index);this.writeExpr(d);this.writeExpr(c);break;case 6:c=b.e1;this.out.addByte(b.op._hx_index);this.writeExpr(c);break;case 7:c=b.init;this.writeVar(b.v);this.writeExpr(c);break;case 8:c=b.args;this.writeExpr(b.e);b=z(this,this.writeExpr);this.writeVarInt(c.length);for(d=0;d<c.length;)e=c[d],++d,b(e);break;case 9:c=b.regs;this.writeExpr(b.e);if(0==c.length)throw new q("assert");b=c.length-1;d=2;for(e=0;e<c.length;){var f=
c[e];++e;b|=f._hx_index<<d;d+=2}this.out.addByte(b&255);this.out.addByte(b>>8);break;case 10:c=b.eelse;d=b.eif;this.writeExpr(b.econd);this.writeExpr(d);this.writeExpr(c);break;case 12:this.writeExpr(b.e);break;case 13:c=b.loop;d=b.it;this.writeVar(b.v);this.writeExpr(d);this.writeExpr(c);break;case 16:c=b.index;this.writeExpr(b.e);this.writeExpr(c);break;case 17:b=b.el;c=z(this,this.writeExpr);this.writeVarInt(b.length);for(d=0;d<b.length;)e=b[d],++d,c(e);break;case 18:c=b.def;d=b.cases;this.writeExpr(b.e);
this.writeVarInt(d.length);for(b=0;b<d.length;){e=d[b];++b;var f=e.values,g=z(this,this.writeExpr);this.writeVarInt(f.length);for(var h=0;h<f.length;){var k=f[h];++h;g(k)}this.writeExpr(e.expr)}this.writeExpr(c);break;case 19:c=b.normalWhile;d=b.loop;this.writeExpr(b.e);this.writeExpr(d);this.out.addByte(c?1:0);break;case 20:c=b.e;d=b.args;this.writeString(b.m);b=z(this,this.writeConst);this.writeVarInt(d.length);for(e=0;e<d.length;)f=d[e],++e,b(f);this.writeExpr(c)}this.writeType(a.t)}},readConst:function(){switch(this.input.readByte()){case 0:return F.CNull;
case 1:return F.CBool(0!=this.input.readByte());case 2:return F.CInt(this.input.readInt32());case 3:return F.CFloat(this.input.readDouble());case 4:return F.CString(this.readString());default:throw new q("assert");}},readExpr:function(){var a=this.input.readByte();if(0==a--)return null;switch(a){case 0:a=p.TConst(this.readConst());break;case 1:a=p.TVar(this.readVar());break;case 2:a=p.TGlobal(Ea.TGLOBALS[this.input.readByte()]);break;case 3:a=p.TParenthesis(this.readExpr());break;case 4:for(var a=
z(this,this.readExpr),b=[],c=0,d=this.readVarInt();c<d;)c++,b.push(a());a=p.TBlock(b);break;case 5:a=this.input.readByte();a=p.TBinop(128<=a?ma.OpAssignOp(Ea.BOPS[a&127]):Ea.BOPS[a],this.readExpr(),this.readExpr());break;case 6:a=p.TUnop(Ea.UNOPS[this.input.readByte()],this.readExpr());break;case 7:a=p.TVarDecl(this.readVar(),this.readExpr());break;case 8:for(var a=this.readExpr(),b=z(this,this.readExpr),c=[],d=0,e=this.readVarInt();d<e;)d++,c.push(b());a=p.TCall(a,c);break;case 9:a=this.readExpr();
b=this.input.readUInt16();c=Ea.TSWIZ.h[b];if(null==c){c=[];d=0;for(e=(b&3)+1;d<e;){var f=d++;c.push(Ea.REGS[b>>2*f+2&3])}Ea.TSWIZ.h[b]=c}a=p.TSwiz(a,c);break;case 10:a=p.TIf(this.readExpr(),this.readExpr(),this.readExpr());break;case 11:a=p.TDiscard;break;case 12:a=p.TReturn(this.readExpr());break;case 13:a=p.TFor(this.readVar(),this.readExpr(),this.readExpr());break;case 14:a=p.TContinue;break;case 15:a=p.TBreak;break;case 16:a=p.TArray(this.readExpr(),this.readExpr());break;case 17:a=z(this,this.readExpr);
b=[];c=0;for(d=this.readVarInt();c<d;)c++,b.push(a());a=p.TArrayDecl(b);break;case 18:a=this.readExpr();b=[];c=0;for(d=this.readVarInt();c<d;){c++;for(var e=z(this,this.readExpr),f=[],g=0,h=this.readVarInt();g<h;)g++,f.push(e());b.push({values:f,expr:this.readExpr()})}a=p.TSwitch(a,b,this.readExpr());break;case 19:a=p.TWhile(this.readExpr(),this.readExpr(),0!=this.input.readByte());break;case 20:a=this.readString();b=z(this,this.readConst);c=[];d=0;for(e=this.readVarInt();d<e;)d++,c.push(b());a=p.TMeta(a,
c,this.readExpr());break;default:throw new q("assert");}return{e:a,t:this.readType(),p:null}},readVar:function(){var a=this.readVarInt();if(0==a)return null;var b=this.varMap.h[a];if(null!=b)return b;b={id:w.allocVarId(),name:this.readString(),type:null,kind:null};this.varMap.h[a]=b;b.type=this.readType();b.kind=Ea.VKINDS[this.input.readByte()];b.parent=this.readVar();a=this.input.readByte();if(0<a){b.qualifiers=[];for(var c=0;c<a;){c++;var d;switch(this.input.readByte()){case 0:d=this.input.readInt32();
d=jb.Const(0==d?null:d);break;case 1:d=jb.Private;break;case 2:d=jb.Nullable;break;case 3:d=jb.PerObject;break;case 4:d=jb.Name(this.readString());break;case 5:d=jb.Shared;break;case 6:d=jb.Precision(Ea.PRECS[this.input.readByte()]);break;case 7:d=jb.Range(this.input.readDouble(),this.input.readDouble());break;case 8:d=jb.Ignore;break;case 9:d=jb.PerInstance(this.input.readInt32());break;default:throw new q("assert");}b.qualifiers.push(d)}}return b},readFun:function(){for(var a=Ea.FKIND[this.input.readByte()],
b=this.readVar(),c=z(this,this.readVar),d=[],e=0,f=this.readVarInt();e<f;)e++,d.push(c());return{kind:a,ref:b,args:d,ret:this.readType(),expr:this.readExpr()}},unserialize:function(a){this.input=new Vb(od.decode(a,!1));if(this.input.readByte()!=(Ea.SIGN&255)||this.input.readByte()!=(Ea.SIGN>>8&255)||this.input.readByte()!=(Ea.SIGN>>16&255))throw new q("Invalid HXSL data");this.varMap=new na;this.types=[];a=this.readString();for(var b=z(this,this.readVar),c=[],d=0,e=this.readVarInt();d<e;)d++,c.push(b());
for(var b=z(this,this.readFun),d=[],e=0,f=this.readVarInt();e<f;)e++,d.push(b());return{name:a,vars:c,funs:d}},serialize:function(a){this.varMap=new na;this.idMap=new na;this.typeIdMap=new af;this.out=new ie;this.out.addByte(Ea.SIGN&255);this.out.addByte(Ea.SIGN>>8&255);this.out.addByte(Ea.SIGN>>16&255);this.writeString(a.name);var b=a.vars,c=z(this,this.writeVar);this.writeVarInt(b.length);for(var d=0;d<b.length;){var e=b[d];++d;c(e)}a=a.funs;b=z(this,this.writeFun);this.writeVarInt(a.length);for(c=
0;c<a.length;)d=a[c],++c,b(d);return od.encode(this.out.getBytes(),!1)},__class__:Ea};var Gb=function(a,b){this.s=a;this.next=b};r["hxsl.ShaderList"]=Gb;Gb.__name__="hxsl.ShaderList";Gb.addSort=function(a,b){for(var c=null,d=b;null!=d&&d.s.priority<a.priority;)c=d,d=d.next;if(null==c)return new Gb(a,b);c.next=new Gb(a,c.next);return b};Gb.prototype={clone:function(){return new Gb(this.s.clone(),null==this.next?null:this.next.clone())},iterator:function(){return new Cf(this,null)},iterateTo:function(a){return new Cf(this,
a)},__class__:Gb};var Cf=function(a,b){this.l=a;this.last=b};r["hxsl._ShaderList.ShaderIterator"]=Cf;Cf.__name__="hxsl._ShaderList.ShaderIterator";Cf.prototype={hasNext:function(){return this.l!=this.last},next:function(){var a=this.l.s;this.l=this.l.next;return a},__class__:Cf};var uk=function(a){this.id=w.allocVarId();this.shader=a;this.params=new na};r["hxsl.ShaderInstance"]=uk;uk.__name__="hxsl.ShaderInstance";uk.prototype={__class__:uk};var vk=function(a,b){this.v=a;this.globalId=b};r["hxsl.ShaderGlobal"]=
vk;vk.__name__="hxsl.ShaderGlobal";vk.prototype={__class__:vk};var Ji=function(a,b,c){this.v=a;this.pos=b;this.bits=c};r["hxsl.ShaderConst"]=Ji;Ji.__name__="hxsl.ShaderConst";Ji.prototype={__class__:Ji};var qe=function(a){this.instanceCache=new na;this.consts=null;this.globals=[];""!=a&&(this.data=(new Ea).unserialize(a),this.initialize())};r["hxsl.SharedShader"]=qe;qe.__name__="hxsl.SharedShader";qe.prototype={initialize:function(){for(var a=0,b=this.data.vars;a<b.length;){var c=b[a];++a;this.browseVar(c)}},
getInstance:function(a){var b=this.instanceCache.h[a];return null==b?this.makeInstance(a):b},makeInstance:function(a){for(var b=new sk,c=this.consts;null!=c;){var d=c.v,e;switch(c.v.type._hx_index){case 1:e=F.CInt(a>>>c.pos&(1<<c.bits)-1);break;case 2:e=F.CBool(0!=(a>>>c.pos&1));break;case 17:e=F.CInt(a>>>c.pos&(1<<c.bits)-1);break;default:throw new q("assert");}b.setConstant(d,e);c=c.next}b.inlineCalls=!0;b.unrollLoops=qe.UNROLL_LOOPS;c=new uk(b.eval(this.data));d=this.paramsCount=0;for(e=this.data.vars;d<
e.length;){var f=e[d];++d;this.addParam(b,c,f)}return this.instanceCache.h[a]=c},addSelfParam:function(a,b){var c=b.type;if(13==c._hx_index)for(var c=c.vl,d=0;d<c.length;){var e=c[d];++d;this.addSelfParam(a,e)}else b.kind==Y.Param&&(a.params.h[b.id]=this.paramsCount,this.paramsCount++)},addParam:function(a,b,c){var d=c.type;if(13==d._hx_index){c=d.vl;for(d=0;d<c.length;){var e=c[d];++d;this.addParam(a,b,e)}}else c.kind==Y.Param&&(b.params.h[a.varMap.h[c.__id__].id]=this.paramsCount,this.paramsCount++)},
browseVar:function(a,b){a.id=w.allocVarId();b=null==b?w.getName(a):b+("."+a.name);var c=a.type;if(13==c._hx_index)for(var c=c.vl,d=0;d<c.length;){var e=c[d];++d;this.browseVar(e,b)}else c=0,a.kind==Y.Global&&(c=qa.allocID(b),this.globals.push(new vk(a,c))),w.isConst(a)&&(d=w.getConstBits(a),0<d&&(d=new Ji(a,null==this.consts?0:this.consts.pos+this.consts.bits,d),d.globalId=c,d.next=this.consts,this.consts=d))},__class__:qe};var tf=function(a){this.v=a;this.write=this.read=0};r["hxsl._Splitter.VarProps"]=
tf;tf.__name__="hxsl._Splitter.VarProps";tf.prototype={__class__:tf};var mk=function(){};r["hxsl.Splitter"]=mk;mk.__name__="hxsl.Splitter";mk.prototype={split:function(a){var b=null,c=new na,d=null,e=new na;this.varNames=new ga;this.varMap=new zb;var f=0;for(a=a.funs;f<a.length;){var g=a[f];++f;switch(g.kind._hx_index){case 0:this.vars=c;b=g;this.checkExpr(g.expr);break;case 1:this.vars=e;d=g;this.checkExpr(g.expr);break;default:throw new q("assert");}}b={ret:b.ret,ref:b.ref,kind:b.kind,args:b.args,
expr:this.mapVars(b.expr)};f=0;for(a=Li.array(c);f<a.length;){var h=a[f];++f;g=h.v;switch(g.kind._hx_index){case 3:case 4:g.kind=e.h.hasOwnProperty(g.id)?Y.Var:Y.Local}switch(g.kind._hx_index){case 3:case 5:if(0<h.read||1<h.write){h={id:w.allocVarId(),name:g.name,kind:g.kind,type:g.type};this.vars=c;this.get(h);g.kind=Y.Local;var k=b.expr.p,k={e:p.TBinop(ma.OpAssign,{e:p.TVar(h),t:h.type,p:k},{e:p.TVar(g),t:g.type,p:k}),t:h.type,p:k};this.addExpr(b,k);this.checkExpr(k);h.kind==Y.Var&&(k=e.h[g.id],
this.varMap.set(g,h),e.remove(g.id),g=new tf(h),g.read=k.read,g.write=k.write,e.h[h.id]=g)}}}f=[];a=[];for(g=e.iterator();g.hasNext();)switch(k=g.next(),h=k.v,h.kind._hx_index){case 1:var l={id:w.allocVarId(),name:h.name,kind:Y.Var,type:h.type};this.uniqueName(l);var m=c.h[h.id];null==m&&(m=new tf(h),c.h[h.id]=m);m.read++;m=new tf(l);m.write=1;c.h[l.id]=m;m=new tf(l);m.read=1;a.push(m);this.addExpr(b,{e:p.TBinop(ma.OpAssign,{e:p.TVar(l),t:h.type,p:b.expr.p},{e:p.TVar(h),t:h.type,p:b.expr.p}),t:h.type,
p:b.expr.p});this.varMap.set(h,l);k.local=!0;break;case 3:0<k.write&&(k={id:w.allocVarId(),name:h.name,kind:Y.Local,type:h.type},this.uniqueName(k),f.push({e:p.TVarDecl(k,{e:p.TVar(h),t:h.type,p:d.expr.p}),t:u.TVoid,p:d.expr.p}),this.varMap.set(h,k))}for(g=0;g<a.length;)h=a[g],++g,e.h[h.v.id]=h;for(a=c.iterator();a.hasNext();)g=a.next(),this.checkVar(g,!0,c,b.expr.p);for(a=e.iterator();a.hasNext();)g=a.next(),this.checkVar(g,!1,c,d.expr.p);for(a=this.varMap.keys();a.hasNext();)g=a.next(),h=this.varMap.h[this.varMap.h[g.__id__].__id__],
null!=h&&this.varMap.set(g,h);d={ret:d.ret,ref:d.ref,kind:d.kind,args:d.args,expr:this.mapVars(d.expr)};a=d.expr.e;if(4==a._hx_index){a=a.el;for(g=0;g<f.length;)h=f[g],++g,a.unshift(h)}else f.push(d.expr),d.expr={e:p.TBlock(f),t:u.TVoid,p:d.expr.p};f=[];for(c=c.iterator();c.hasNext();)a=c.next(),a.local||f.push(a.v);c=[];for(e=e.iterator();e.hasNext();)a=e.next(),a.local||c.push(a.v);f.sort(function(a,b){return a.id-b.id});c.sort(function(a,b){return a.id-b.id});return{vertex:{name:"vertex",vars:f,
funs:[b]},fragment:{name:"fragment",vars:c,funs:[d]}}},addExpr:function(a,b){var c=a.expr.e;4==c._hx_index?c.el.push(b):a.expr={e:p.TBlock([a.expr,b]),t:u.TVoid,p:a.expr.p}},checkVar:function(a,b,c,d){switch(a.v.kind._hx_index){case 3:if(!b&&(b=c.h[a.v.id],null==b||0==b.write))throw new q(new Za("Varying "+a.v.name+" is not written by vertex shader",d));break;case 4:if(a.requireInit)throw new q(new Za("Variable "+a.v.name+" is used without being initialized",d));}},mapVars:function(a){var b=a.e;switch(b._hx_index){case 1:return b=
this.varMap.h[b.v.__id__],null==b?a:{e:p.TVar(b),t:a.t,p:a.p};case 7:var c=b.init,b=this.varMap.h[b.v.__id__];return null==b?w.map(a,z(this,this.mapVars)):{e:p.TVarDecl(b,this.mapVars(c)),t:a.t,p:a.p};case 13:var c=b.loop,d=b.it,b=this.varMap.h[b.v.__id__];return null==b?w.map(a,z(this,this.mapVars)):{e:p.TFor(b,this.mapVars(d),this.mapVars(c)),t:a.t,p:a.p};default:return w.map(a,z(this,this.mapVars))}},get:function(a){var b=this.vars.h[a.id];if(null==b){b=this.varMap.h[a.__id__];if(null!=b)return this.get(b);
b=a.name;this.uniqueName(a);if(a.kind==Y.Local&&b!=a.name){var c={id:w.allocVarId(),name:a.name,kind:a.kind,type:a.type};this.varMap.set(a,c);a.name=b;a=c}b=new tf(a);this.vars.h[a.id]=b}return b},uniqueName:function(a){if(!(a.kind==Y.Global||a.kind==Y.Output||a.kind==Y.Input)){a.parent=null;var b=a.name,c=this.varNames,b=null!=Q[b]?c.getReserved(b):c.h[b];if(null!=b&&b!=a){for(b=a.name;48<=v.cca(b,b.length-1)&&57>=v.cca(b,b.length-1);)b=v.substr(b,0,-1);for(c=b==a.name?2:n.parseInt(v.substr(a.name,
b.length,null));;){var d=this.varNames,e=b+c;if(!(null!=Q[e]?d.existsReserved(e):d.h.hasOwnProperty(e)))break;++c}a.name=b+c}b=a.name;c=this.varNames;null!=Q[b]?c.setReserved(b,a):c.h[b]=a}},checkExpr:function(a){var b=a.e;switch(b._hx_index){case 1:var c=this.get(b.v);0==c.write&&(c.requireInit=!0);c.read++;break;case 5:var c=b.e2,d=b.e1;switch(b.op._hx_index){case 4:b=d.e;switch(b._hx_index){case 1:this.get(b.v).write++;this.checkExpr(c);break;case 9:b=b.e.e;1==b._hx_index?(this.get(b.v).write++,
this.checkExpr(c)):w.iter(a,z(this,this.checkExpr));break;default:w.iter(a,z(this,this.checkExpr))}break;case 20:b=d.e;switch(b._hx_index){case 1:a=this.get(b.v);0==a.write&&(a.requireInit=!0);a.read++;a.write++;this.checkExpr(c);break;case 9:b=b.e.e;1==b._hx_index?(a=this.get(b.v),0==a.write&&(a.requireInit=!0),a.read++,a.write++,this.checkExpr(c)):w.iter(a,z(this,this.checkExpr));break;default:w.iter(a,z(this,this.checkExpr))}break;default:w.iter(a,z(this,this.checkExpr))}break;case 7:c=b.init;
a=this.get(b.v);a.local=!0;null!=c&&(this.checkExpr(c),a.write++);break;case 13:c=b.loop;a=b.v;this.checkExpr(b.it);a=this.get(a);a.local=!0;a.write++;this.checkExpr(c);break;default:w.iter(a,z(this,this.checkExpr))}},__class__:mk};var Yk=function(){};r["hxsl.ChannelTools"]=Yk;Yk.__name__="hxsl.ChannelTools";Yk.isPackedFormat=function(a){return a.format==S.nativeFormat};var q=function(a){Error.call(this);this.val=a;Error.captureStackTrace&&Error.captureStackTrace(this,q)};r["js._Boot.HaxeError"]=
q;q.__name__="js._Boot.HaxeError";q.wrap=function(a){return a instanceof Error?a:new q(a)};q.__super__=Error;q.prototype=J(Error.prototype,{__class__:q});var Fk=function(){};r["js.html._CanvasElement.CanvasUtil"]=Fk;Fk.__name__="js.html._CanvasElement.CanvasUtil";Fk.getContextWebGL=function(a,b){var c=a.getContext("webgl",b);if(null!=c)return c;c=a.getContext("experimental-webgl",b);return null!=c?c:null};Math.__name__="Math";var jh=function(a,b){hd.call(this,a,b)};r["safety.SafetyException"]=jh;
jh.__name__="safety.SafetyException";jh.__super__=hd;jh.prototype=J(hd.prototype,{__class__:jh});var lh=function(a,b){hd.call(this,a,b)};r["safety.NullPointerException"]=lh;lh.__name__="safety.NullPointerException";lh.__super__=jh;lh.prototype=J(jh.prototype,{__class__:lh});kh.$haxeUID|=0;r.Math=Math;null==String.fromCodePoint&&(String.fromCodePoint=function(a){return 65536>a?String.fromCharCode(a):String.fromCharCode((a>>10)+55232)+String.fromCharCode((a&1023)+56320)});String.prototype.__class__=
r.String=String;String.__name__="String";r.Array=Array;Array.__name__="Array";Date.prototype.__class__=r.Date=Date;Date.__name__="Date";var el={},cl={},dl=Number,bl=Boolean,fl={},gl={};zb.count=0;var Q={};Sb.add(U.updateCursor,-1);ia.__toStr={}.toString;Object.defineProperty(q.prototype,"message",{get:function(){return String(this.val)}});I.Element=0;I.PCData=1;I.CData=2;I.Comment=3;I.DocType=4;I.ProcessingInstruction=5;I.Document=6;Jb.LN2=Math.log(2);Ma.V1=3;Ma.V2=2;Ma.V25=0;Ma.Reserved=1;Ma.V1_Bitrates=
[[A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad],[A.BR_Free,A.BR_32,A.BR_40,A.BR_48,A.BR_56,A.BR_64,A.BR_80,A.BR_96,A.BR_112,A.BR_128,A.BR_160,A.BR_192,A.BR_224,A.BR_256,A.BR_320,A.BR_Bad],[A.BR_Free,A.BR_32,A.BR_48,A.BR_56,A.BR_64,A.BR_80,A.BR_96,A.BR_112,A.BR_128,A.BR_160,A.BR_192,A.BR_224,A.BR_256,A.BR_320,A.BR_384,A.BR_Bad],[A.BR_Free,A.BR_32,A.BR_64,A.BR_96,A.BR_128,A.BR_160,A.BR_192,A.BR_224,A.BR_256,
A.BR_288,A.BR_320,A.BR_352,A.BR_384,A.BR_416,A.BR_448,A.BR_Bad]];Ma.V2_Bitrates=[[A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad,A.BR_Bad],[A.BR_Free,A.BR_8,A.BR_16,A.BR_24,A.BR_32,A.BR_40,A.BR_48,A.BR_56,A.BR_64,A.BR_80,A.BR_96,A.BR_112,A.BR_128,A.BR_144,A.BR_160,A.BR_Bad],[A.BR_Free,A.BR_8,A.BR_16,A.BR_24,A.BR_32,A.BR_40,A.BR_48,A.BR_56,A.BR_64,A.BR_80,A.BR_96,A.BR_112,A.BR_128,A.BR_144,A.BR_160,A.BR_Bad],[A.BR_Free,
A.BR_32,A.BR_48,A.BR_56,A.BR_64,A.BR_80,A.BR_96,A.BR_112,A.BR_128,A.BR_144,A.BR_160,A.BR_176,A.BR_192,A.BR_224,A.BR_256,A.BR_Bad]];Ma.SamplingRates=[[za.SR_11025,za.SR_12000,za.SR_8000,za.SR_Bad],[za.SR_Bad,za.SR_Bad,za.SR_Bad,za.SR_Bad],[za.SR_22050,za.SR_24000,za.SR_12000,za.SR_Bad],[za.SR_44100,za.SR_48000,za.SR_32000,za.SR_Bad]];ac.LReserved=0;ac.LLayer3=1;ac.LLayer2=2;ac.LLayer1=3;Fe.CStereo=0;Fe.CJointStereo=1;Fe.CDualChannel=2;Fe.CMono=3;Ge.ENone=0;Ge.EMs50_15=1;Ge.EReserved=2;Ge.ECCIT_J17=
3;Eg.BUFFERING=!1;Rc.tmp=new Rc;hb.GUID=0;X.SOFTWARE_DRIVER=!1;X.ANTIALIASING=0;P.tmp=new P;P.lumR=0.212671;P.lumG=0.71516;P.lumB=0.072169;P.SQ13=0.5773502691896257;Qb.EPSILON=1E-6;fd.TMP_RAY=new ld;fd.TMP_MAT=new P;ic.UID=0;ic.CACHE=new ga;W.UID=0;W.ALLOW_WEBGL2=!0;W.outOfMemoryCheck=!1;W.STREAM_POS=1;W.TFILTERS=[[[9728,9728],[9729,9729]],[[9728,9984],[9729,9985]],[[9728,9986],[9729,9987]]];W.TWRAP=[33071,10497];W.FACES=[0,1028,1029,1032];W.BLEND=[1,0,770,768,772,774,771,769,773,775,32769,32771,
32770,32772,776];W.COMPARE=[519,512,514,517,516,518,513,515];W.STENCIL_OP=[7680,0,7681,7682,34055,7683,34056,5386];W.OP=[32774,32778,32779,32775,32776];W.CUBE_FACES=[34069,34070,34071,34072,34073,34074];W.CBUFFERS=function(a){a=[];for(var b=0;32>b;){for(var c=[],d=0,e=b++;d<e;){var f=d++;c.push(36064+f)}a.push(c)}return a}(this);oe.MAX_MEMORY=4294967296;oe.MAX_BUFFERS=65536;oe.SIZE=65533;oe.ALL_FLAGS=ba.__empty_constructs__.slice();Xb.defaultKillAlphaThreshold=0.5;Xb.loadingTextureColor=-65281;uc.current=
new uc("Default");O.enableLights_bits=1;O.enableLights_offset=0;O.enableLights_mask=1;O.dynamicParameters_bits=1;O.dynamicParameters_offset=1;O.dynamicParameters_mask=2;O.isStatic_bits=1;O.isStatic_offset=2;O.isStatic_mask=4;O.batchMode_bits=1;O.batchMode_offset=3;O.batchMode_mask=8;O.culling_bits=2;O.culling_offset=0;O.culling_mask=3;O.depthWrite_bits=1;O.depthWrite_offset=2;O.depthWrite_mask=4;O.depthTest_bits=3;O.depthTest_offset=3;O.depthTest_mask=56;O.blendSrc_bits=4;O.blendSrc_offset=6;O.blendSrc_mask=
960;O.blendDst_bits=4;O.blendDst_offset=10;O.blendDst_mask=15360;O.blendAlphaSrc_bits=4;O.blendAlphaSrc_offset=14;O.blendAlphaSrc_mask=245760;O.blendAlphaDst_bits=4;O.blendAlphaDst_offset=18;O.blendAlphaDst_mask=3932160;O.blendOp_bits=3;O.blendOp_offset=22;O.blendOp_mask=29360128;O.blendAlphaOp_bits=3;O.blendAlphaOp_offset=25;O.blendAlphaOp_mask=234881024;O.wireframe_bits=1;O.wireframe_offset=28;O.wireframe_mask=268435456;O.reserved_bits=1;O.reserved_offset=29;O.reserved_mask=536870912;ja.readMask_bits=
8;ja.readMask_offset=0;ja.readMask_mask=255;ja.writeMask_bits=8;ja.writeMask_offset=8;ja.writeMask_mask=65280;ja.reference_bits=8;ja.reference_offset=16;ja.reference_mask=16711680;ja.frontTest_bits=3;ja.frontTest_offset=0;ja.frontTest_mask=7;ja.frontPass_bits=3;ja.frontPass_offset=3;ja.frontPass_mask=56;ja.frontSTfail_bits=3;ja.frontSTfail_offset=6;ja.frontSTfail_mask=448;ja.frontDPfail_bits=3;ja.frontDPfail_offset=9;ja.frontDPfail_mask=3584;ja.backTest_bits=3;ja.backTest_offset=12;ja.backTest_mask=
28672;ja.backPass_bits=3;ja.backPass_offset=15;ja.backPass_mask=229376;ja.backSTfail_bits=3;ja.backSTfail_offset=18;ja.backSTfail_mask=1835008;ja.backDPfail_bits=3;ja.backDPfail_offset=21;ja.backDPfail_mask=14680064;S.UID=0;S.PREVENT_AUTO_DISPOSE=2147483647;S.nativeFormat=ha.RGBA;S.checkerTextureKeys=new na;S.noiseTextureKeys=new na;S.genTextureKeys=new ga;Rg.__meta__={obj:{ignore:["shader"]}};Pa.SRC="HXSLF2gzZC5zaGFkZXIuU2NyZWVuU2hhZGVyBwEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACghfX2luaXRfXw4GAAALBnZlcnRleA4GAAACAgoAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAALAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAA";
Tf.SRC="HXSLHWgzZC5wYXNzLl9Cb3JkZXIuQm9yZGVyU2hhZGVyCQEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACgVjb2xvcgUMAgAACwhfX2luaXRfXw4GAAAMBnZlcnRleA4GAAANCGZyYWdtZW50DgYAAAMCCwAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAAwAAAUBBgQCBgUMCQMqDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ0AAAUBBgQCCAUMAgoFDAUMAA";Uf.SRC="HXSLHmgzZC5wYXNzLl9Db3B5LkFycmF5Q29weVNoYWRlcgoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoHdGV4dHVyZQsCAAALBWxheWVyAQIAAAwIX19pbml0X18OBgAADQZ2ZXJ0ZXgOBgAADghmcmFnbWVudA4GAAADAgwAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAANAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEOAAAFAQYEAggFDAkDIQ4CAgoLCQMpDgICCQUKCQMmDgECCwEDBQsFDAUMAA";
Vf.SRC="HXSLGWgzZC5wYXNzLl9Db3B5LkNvcHlTaGFkZXIJAQVpbnB1dA0BAgIIcG9zaXRpb24FCgEBAAMCdXYFCgEBAAEAAAQFZmxpcFkDAgAABQZvdXRwdXQNAgIGCHBvc2l0aW9uBQwEBQAHBWNvbG9yBQwEBQAEAAAICnBpeGVsQ29sb3IFDAQAAAkMY2FsY3VsYXRlZFVWBQoEAAAKB3RleHR1cmUKAgAACwhfX2luaXRfXw4GAAAMBnZlcnRleA4GAAANCGZyYWdtZW50DgYAAAMCCwAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAAwAAAUBBgQCBgUMCQMqDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ0AAAUBBgQCCAUMCQMhDgICCgoCCQUKBQwFDAA";Wf.SRC="HXSLIWgzZC5wYXNzLl9DdWJlQ29weS5DdWJlQ29weVNoYWRlcgoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoHdGV4dHVyZQwCAAALA21hdAYCAAAMCF9faW5pdF9fDgYAAA0GdmVydGV4DgYAAA4IZnJhZ21lbnQOBgAAAwIMAAAFAgYEAgcFDAIIBQwFDAYEAgkFCgIDBQoFCgAADQAABQEGBAIGBQwJAyoOBAoCAgUKAAADBgEKAgIFCgQAAwIEAwMBAwAAAAAAAAAAAwEDAAAAAAAA8D8DBQwFDAABDgAABQIIDwJ1dgUKBAAABgMGAQIJBQoBAwAAAAAAAABAAwUKAQMAAAAAAADwPwMFCgAGBAIIBQwJAyEOAgIKDAkDHw4BBgEJAykOAgIPBQoBAwAAAAAAAPA/AwULAgsGBQsFCwUMBQwA";
Ta.__meta__={fields:{cameraView:{global:["camera.view"]},cameraNear:{global:["camera.zNear"]},cameraFar:{global:["camera.zFar"]},cameraProj:{global:["camera.proj"]},cameraPos:{global:["camera.position"]},cameraProjDiag:{global:["camera.projDiag"]},cameraProjFlip:{global:["camera.projFlip"]},cameraViewProj:{global:["camera.viewProj"]},cameraInverseViewProj:{global:["camera.inverseViewProj"]},globalTime:{global:["global.time"]},pixelSize:{global:["global.pixelSize"]},globalModelView:{global:["global.modelView"]},
globalModelViewInverse:{global:["global.modelViewInverse"]}}};$f.SRC="HXSLIWgzZC5wYXNzLl9IYXJkd2FyZVBpY2suRml4ZWRDb2xvcgUBB2NvbG9ySUQFDAIAAAIIdmlld3BvcnQFDAIAAAMGb3V0cHV0DQECBAhwb3NpdGlvbgUMBAMABQdjb2xvcklEBQwEAwAEAAAGBnZlcnRleA4GAAAHCGZyYWdtZW50DgYAAAIABgAABQEGBAIEBQwGAQQGAAIEBQwGAQkDKg4DCgICBQwRAAUKAQMAAAAAAAAAAAMBAwAAAAAAAAAAAwUMCgIEBQwMAAMFDAUMBQwJAyoOAwoCAgUMOQAFCgEDAAAAAAAA8D8DAQMAAAAAAADwPwMFDAUMBQwAAQcAAAUBBgQCBQUMAgEFDAUMAA";td.STRICT=!0;ya.ROT2RAD=-0.017453292519943295;ya.tmpMat=new P;ya.tmpVec=
new B;Rb.FPosChanged=1;Rb.FVisible=2;Rb.FCulled=4;Rb.FFollowPositionOnly=8;Rb.FLightCameraCenter=16;Rb.FAllocated=32;Rb.FAlwaysSync=64;Rb.FInheritCulled=128;Rb.FNoSerialize=256;Rb.FIgnoreBounds=512;Rb.FIgnoreCollide=1024;Rb.FIgnoreParentTransform=2048;Rb.FCullingColliderInherited=4096;Wc.SRC="HXSLF2gzZC5zaGFkZXIuQW1iaWVudExpZ2h0CgEGZ2xvYmFsDQECAgxhbWJpZW50TGlnaHQFCwABAAMQcGVyUGl4ZWxMaWdodGluZwIAAQEAAAAAAAAAAAQKcGl4ZWxDb2xvcgUMBAAABQ9saWdodFBpeGVsQ29sb3IFCwQAAAYKbGlnaHRDb2xvcgULBAAABwhhZGRpdGl2ZQICAAEAAAAAAAgIX19pbml0X18OBgAACRBfX2luaXRfX2ZyYWdtZW50DgYAAAoJY2FsY0xpZ2h0DgYAAAsGdmVydGV4DgYAAAwIZnJhZ21lbnQOBgAABQIIAAAFAQYEAgYFCwsCBwICAgULCQMpDgEBAwAAAAAAAAAAAwULBQsFCwACCQAABQEGBAIFBQsLAgcCAgIFCwkDKQ4BAQMAAAAAAAAAAAMFCwULBQsAAwoBDQpsaWdodENvbG9yBQsEAAAFCwUBDQsCBwICDQULBAYAAgIFCwYBCQMWDgIEBgMBAwAAAAAAAPA/AwICBQsFCwULAQMAAAAAAAAAAAMFCwINBQsFCwULBQsFCwAAAAsAAAUBCwcCAgMCAgaBCgIEBQySAAULCQIKDgECBgULBQsFCwAAAAEMAAAFAQsCAwIGgQoCBAUMkgAFCwkCCg4BAgUFCwULBQsAAAA";
Df.SRC="HXSLEWgzZC5zaGFkZXIuQmFzZTJkGgEFaW5wdXQNAQMCCHBvc2l0aW9uBQoBAQADAnV2BQoBAQAEBWNvbG9yBQwBAQABAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgEdGltZQMAAAAJBnpWYWx1ZQMCAAAKB3RleHR1cmUKAgAACw5zcHJpdGVQb3NpdGlvbgUMBAAADBBhYnNvbHV0ZVBvc2l0aW9uBQwEAAANCnBpeGVsQ29sb3IFDAQAAA4MdGV4dHVyZUNvbG9yBQwEAAAPDGNhbGN1bGF0ZWRVVgUKAwAAEAppc1JlbGF0aXZlAgIAAQAAAAAAEQVjb2xvcgUMAgAAEg9hYnNvbHV0ZU1hdHJpeEEFCwIAABMPYWJzb2x1dGVNYXRyaXhCBQsCAAAUDWZpbHRlck1hdHJpeEEFCwIAABUNZmlsdGVyTWF0cml4QgULAgAAFghoYXNVVlBvcwICAAEAAAAAABcFdXZQb3MFDAIAABgJa2lsbEFscGhhAgIAAQAAAAAAGQpwaXhlbEFsaWduAgIAAQAAAAAAGhBoYWxmUGl4ZWxJbnZlcnNlBQoCAAAbCHZpZXdwb3J0BQwCAAAcDm91dHB1dFBvc2l0aW9uBQwEAAAdCF9faW5pdF9fDgYAAB4GdmVydGV4DgYAAB8IZnJhZ21lbnQOBgAAAwIdAAAFBgYEAgsFDAkDKg4DAgIFCgIJAwEDAAAAAAAA8D8DBQwFDAsCEAIFAwYECgIMBQwAAAMJAx0OAgkDKQ4CCgILBQwRAAUKAQMAAAAAAADwPwMFCwISBQsDAwYECgIMBQwEAAMJAx0OAgkDKQ4CCgILBQwRAAUKAQMAAAAAAADwPwMFCwITBQsDAwYECgIMBQw5AAUKCgILBQw5AAUKBQoABgQCDAUMAgsFDAUMAAYEAg8FCgsCFgIGAAYBAgMFCgoCFwUMOQAFCgUKCgIXBQwRAAUKBQoCAwUKBQoFCgYEAg0FDAsCEAIGAQIRBQwCBAUMBQwCBAUMBQwFDAYEAg4FDAkDIQ4CAgoKAg8FCgUMBQwGgQINBQwCDgUMBQwAAB4AAAUFCCADdG1wBQsEAAAJAykOAgoCDAUMEQAFCgEDAAAAAAAA8D8DBQsABgQCHAUMCQMqDgMJAx0OAgIgBQsCFAULAwkDHQ4CAiAFCwIVBQsDCgIMBQw5AAUKBQwFDAYECgIcBQwRAAUKBgEEBgAKAhwFDBEABQoKAhsFDBEABQoFCgUKCgIbBQw5AAUKBQoFCgsCGQIGgwoCHAUMEQAFCgIaBQoFCgAABgQCBgUMAhwFDAUMAAEfAAAFAgsGDgIYAgYJCgINBQwMAAMBA/yp8dJNYlA/AwICDAAAAAYEAgcFDAINBQwFDAA";
Mf.SRC="HXSLE2gzZC5zaGFkZXIuQmFzZU1lc2gXAQZjYW1lcmENAQoCBHZpZXcHAAEAAwRwcm9qBwABAAQIcG9zaXRpb24FCwABAAUIcHJvakZsaXADAAEABghwcm9qRGlhZwULAAEABwh2aWV3UHJvagcAAQAID2ludmVyc2VWaWV3UHJvagcAAQAJBXpOZWFyAwABAAoEekZhcgMAAQALA2RpcgULAwEAAAAADAZnbG9iYWwNAgQNBHRpbWUDAAwADglwaXhlbFNpemUFCgAMAA8JbW9kZWxWaWV3BwAMAQMQEG1vZGVsVmlld0ludmVyc2UHAAwBAwAAABEFaW5wdXQNAwISCHBvc2l0aW9uBQsBEQATBm5vcm1hbAULAREAAQAAFAZvdXRwdXQNBAUVCHBvc2l0aW9uBQwEFAAWBWNvbG9yBQwEFAAXBWRlcHRoAwQUABgGbm9ybWFsBQsEFAAZCXdvcmxkRGlzdAMEFAAEAAAaEHJlbGF0aXZlUG9zaXRpb24FCwQAABsTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAHBhwaXhlbFRyYW5zZm9ybWVkUG9zaXRpb24FCwQAAB0RdHJhbnNmb3JtZWROb3JtYWwFCwQAAB4RcHJvamVjdGVkUG9zaXRpb24FDAQAAB8KcGl4ZWxDb2xvcgUMBAAAIAVkZXB0aAMEAAAhCHNjcmVlblVWBQoEAAAiCXNwZWNQb3dlcgMEAAAjCXNwZWNDb2xvcgULBAAAJAl3b3JsZERpc3QDBAAAJQVjb2xvcgUMAgAAJg1zcGVjdWxhclBvd2VyAwIAAQcAAAAAAAAAAAAAAAAAAFlAJw5zcGVjdWxhckFtb3VudAMCAAEHAAAAAAAAAAAAAAAAAAAkQCgNc3BlY3VsYXJDb2xvcgULAgAAKQhfX2luaXRfXw4GAAAqEF9faW5pdF9fZnJhZ21lbnQOBgAAKwZ2ZXJ0ZXgOBgAALAhmcmFnbWVudA4GAAAEAikAAAULBgQCGgULAhIFCwULBgQCGwULBgECGgULCQM0DgECDwcIBQsFCwYEAh4FDAYBCQMqDgICGwULAQMAAAAAAADwPwMFDAIHBwUMBQwGBAIdBQsJAx8OAQQGAQITBQsJAzIOAQIPBwYFCwULBQsFCwYEAgsFCwkDHw4BBAYDAgQFCwIbBQsFCwULBQsFCwYEAh8FDAIlBQwFDAYEAiIDAiYDAwYEAiMFCwYBAigFCwInAwULBQsGBAIhBQoJAzoOAQYCCgIeBQwRAAUKCgIeBQwMAAMFCgUKBQoGBAIgAwYCCgIeBQwIAAMKAh4FDAwAAwMDBgQCJAMGAgkDGw4BBgMCGwULAgQFCwULAwIKAwMDAAIqAAAFBQYEAh0FCwkDHw4BAh0FCwULBQsGBAIhBQoJAzoOAQYCCgIeBQwRAAUKCgIeBQwMAAMFCgUKBQoGBAIgAwYCCgIeBQwIAAMKAh4FDAwAAwMDBgQCIgMCJgMDBgQCIwULBgECKAULAicDBQsFCwAAKwAABQIGBAIVBQwGAQIeBQwJAyoOBAEDAAAAAAAA8D8DAgUDAQMAAAAAAADwPwMBAwAAAAAAAPA/AwUMBQwFDAYEAhwFCwIbBQsFCwABLAAABQQGBAIWBQwCHwUMBQwGBAIXAwIgAwMGBAIYBQsCHQULBQsGBAIZAwIkAwMA";
Sf.SRC="HXSLD2gzZC5zaGFkZXIuQmx1choBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoVY2FtZXJhSW52ZXJzZVZpZXdQcm9qBwIAAAsHdGV4dHVyZQoCAAAMDGRlcHRoVGV4dHVyZQoCAAANB1F1YWxpdHkBAgABAAAAAAAOB2lzRGVwdGgCAgABAAAAAAAPBnZhbHVlcw8DDQIAABAHb2Zmc2V0cw8DDQIAABEFcGl4ZWwFCgIAABINaGFzRml4ZWRDb2xvcgICAAEAAAAAABMQc21vb3RoRml4ZWRDb2xvcgICAAEAAAAAABQKZml4ZWRDb2xvcgUMAgAAFRBpc0RlcHRoRGVwZW5kYW50AgIAAQAAAAAAFgloYXNOb3JtYWwCAgABAAAAAAAXDW5vcm1hbFRleHR1cmUKAgAAGAZpc0N1YmUCAgABAAAAAAAZC2N1YmVUZXh0dXJlDAIAABoHY3ViZURpcgYCAAAbCF9faW5pdF9fDgYAABwGdmVydGV4DgYAAB0IZnJhZ21lbnQOBgAAHgtnZXRQb3NpdGlvbg4GAAAEAhsAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAAcAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEdAAAFAgsCFQIFBggfBHBjdXIFCwQAAAkCHg4BAgMFCgULAAggBGNjdXIFDAQAAAkDIQ4CAgsKAgMFCgUMAAghBWNvbG9yBQwEAAAJAyoOBAEDAAAAAAAAAAADAQMAAAAAAAAAAAMBAwAAAAAAAAAAAwEDAAAAAAAAAAADBQwACCIEbmN1cgULBAAACQM5DgEJAyEOAgIXCgIDBQoFDAULABUGdW5yb2xsAA4jAWkBBAAABhUGAAcDAg0BAQECAQAAAAEBAg0BDwEAAAUICCQCdXYFCgQAAAYAAgMFCgYBAhEFChECEA8DDQsGCQIjAQECAAAAAAECBwMCIwEBAiMBAQMFCgUKAAglAWMFDAQAAAkDIQ4CAgsKAiQFCgUMAAgmAXAFCwQAAAkCHg4BAiQFCgULAAgnAWQDBAAACQMdDgIEBgMCJgULAh8FCwULBQsGAwImBQsCHwULBQsDAAgoAW4FCwQAAAkDOQ4BCQMhDgICFwoCJAUKBQwFCwAGBAIlBQwJAxgOAwIgBQwCJQUMCQMdDgICIgULAigFCwMFDAUMBgQCJQUMCQMYDgMCJQUMAiAFDAkDFQ4CBAYBCQMWDgIEBgMCJwMBA/yp8dJNYlA/AwMDAQMAAAAAAAAAAAMDAQMAAAAAAGr4QAMDAwEDAAAAAAAA8D8DAwUMBQwGgAIhBQwGAQIlBQwRAg8PAw0LBgkCIwEBAgAAAAABAgcDAiMBAQIjAQEDBQwFDAAAAAYEAggFDAIhBQwFDAALAg4CBQMIKQN2YWwDBAAAAQMAAAAAAAAAAAMAFQZ1bnJvbGwADioBaQEEAAAGFQYABwMCDQEBAQIBAAAAAQECDQEPAQAABQELAhgCBoACKQMGAQkDNw4BCQMhDgICGQwGAQkDKQ4CBgMGAQQGAAIDBQoGAQYBAhEFChECEA8DDQsGCQIqAQECAAAAAAECBwMCKgEBAioBAQMFCgkDJg4BAioBAwUKBQoFCgEDAAAAAAAAAEADBQoBAwAAAAAAAPA/AwUKAQMAAAAAAADwPwMFCwIaBgULBQwDEQIPDwMNCwYJAioBAQIAAAAAAQIHAwIqAQECKgEBAwMDBoACKQMGAQkDNw4BCQMhDgICCwoGAAIDBQoGAQYBAhEFChECEA8DDQsGCQIqAQECAAAAAAECBwMCKgEBAioBAQMFCgkDJg4BAioBAwUKBQoFDAMRAg8PAw0LBgkCKgEBAgAAAAABAgcDAioBAQIqAQEDAwMAAAAABgQCCAUMCQM2DgEJAxUOAgIpAwEDyxpQyv//7z8DAwUMBQwABQMIKwVjb2xvcgUMBAAACQMqDgQBAwAAAAAAAAAAAwEDAAAAAAAAAAADAQMAAAAAAAAAAAMBAwAAAAAAAAAAAwUMABUGdW5yb2xsAA4sAWkBBAAABhUGAAcDAg0BAQECAQAAAAEBAg0BDwEAAAUBCwIYAgaAAisFDAYBCQMhDgICGQwGAQkDKQ4CBgMGAQQGAAIDBQoGAQYBAhEFChECEA8DDQsGCQIsAQECAAAAAAECBwMCLAEBAiwBAQMFCgkDJg4BAiwBAwUKBQoFCgEDAAAAAAAAAEADBQoBAwAAAAAAAPA/AwUKAQMAAAAAAADwPwMFCwIaBgULBQwRAg8PAw0LBgkCLAEBAgAAAAABAgcDAiwBAQIsAQEDBQwFDAaAAisFDAYBCQMhDgICCwoGAAIDBQoGAQYBAhEFChECEA8DDQsGCQIsAQECAAAAAAECBwMCLAEBAiwBAQMFCgkDJg4BAiwBAwUKBQoFDBECDw8DDQsGCQIsAQECAAAAAAECBwMCLAEBAiwBAQMFDAUMAAAAAAYEAggFDAIrBQwFDAAAAAsCEgIFAgsCEwIGgQoCCAUMDAADCgIUBQwMAAMDBgQKAggFDAwAAwYBCgIUBQwMAAMJAyYOAQYHCgIIBQwMAAMBAwAAAAAAAAAAAwIDAwMABgQKAggFDJIABQsGAQoCFAUMkgAFCwoCCAUMDAADBQsFCwAAAAADHgEtAnV2BQoEAAAFCwUECC4FZGVwdGgDBAAACQM3DgEJAyEOAgIMCgItBQoFDAMACC8EdGVtcAUMBAAABgEJAyoOAwkDOw4BAi0FCgUKAi4DAQMAAAAAAADwPwMFDAIKBwUMAAgwCG9yaWdpbldTBQsEAAAGAgoCLwUMkgAFCwoCLwUMDAADBQsADQIwBQsAAA";
Sc.SRC="HXSLE2gzZC5zaGFkZXIuQ29sb3JBZGQDAQpwaXhlbENvbG9yBQwEAAACBWNvbG9yBQsCAAADCGZyYWdtZW50DgYAAAEBAwAABQEGgAoCAQUMkgAFCwICBQsFCwA";Ae.SRC="HXSLE2gzZC5zaGFkZXIuQ29sb3JLZXkDAQhjb2xvcktleQUMAgAAAgx0ZXh0dXJlQ29sb3IFDAQAAAMIZnJhZ21lbnQOBgAAAQEDAAAFAggEBWNkaWZmBQwEAAAGAwICBQwCAQUMBQwACwYJCQMdDgICBAUMAgQFDAMBA/Fo44i1+OQ+AwIMAAAAAA";Tc.SRC="HXSLFmgzZC5zaGFkZXIuQ29sb3JNYXRyaXgDAQpwaXhlbENvbG9yBQwEAAACBm1hdHJpeAcCAAADCGZyYWdtZW50DgYAAAEBAwAABQEGBAIBBQwJAyoOAgoEBgEJAyoOAgoCAQUMkgAFCwEDAAAAAAAA8D8DBQwCAgcFDAUMkgAFCwoEBgECAQUMAgIHBQwFDAwAAwUMBQwA";
Zf.SRC="HXSLFGgzZC5zaGFkZXIuRGlyU2hhZG93EgEGZW5hYmxlAgIAAQAAAAAAAgdVU0VfRVNNAgIAAQAAAAAAAwtzaGFkb3dQb3dlcgMCAAAEB1VTRV9QQ0YCAgABAAAAAAAFCnBjZlF1YWxpdHkBAgABAAAAAAAGCHBjZlNjYWxlAwIAAAcJc2hhZG93UmVzBQoCAAAICXNoYWRvd01hcBEBAgAACQpzaGFkb3dQcm9qCAIAAAoKc2hhZG93QmlhcwMCAAALE3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAwGc2hhZG93AwQAAA0JZGlyU2hhZG93AwQAAA4OcG9pc3NvbkRpc2tMb3cPBQwABAIAAA8PcG9pc3NvbkRpc2tIaWdoDwUMAAwCAAAQE3BvaXNzb25EaXNrVmVyeUhpZ2gPBQwAQAIAABEEcmFuZA4GAAASCGZyYWdtZW50DgYAAAIDEQETAXYDBAAAAwUCCBQCZHADBAAACQMdDgIJAyoOAQITAwUMCQMqDgQBA18pyxDH+ilAAwED9P3UeOmOU0ADAQOiRbbz/ZRGQAMBA1CNl24Sq1dAAwUMAwANCQMTDgEGAQkDAg4BAhQDAwEDUPwYc9Fd5UADAwMAAAESAAAFAgsCAQIFAQsCBAIFBwYEAgwDAQMAAAAAAADwPwMDCBUJdGV4ZWxTaXplBQoEAAAGAgEDAAAAAAAA8D8DAgcFCgUKAAgWCXNoYWRvd1BvcwULBAAABgECCwULAgkIBQsACBcIc2hhZG93VXYFCgQAAAkDOg4BCgIWBQsRAAUKBQoACBgEek1heAMEAAAJAzUOAQoCFgULCAADAwAIGQNyb3QDBAAABgEGAQkCEQ4BBgAGAAoCCwULAAADCgILBQsEAAMDCgILBQsIAAMDAwEDH4XrUbgeCUADAwEDAAAAAAAAAEADAwATBAIFAQEDAQECAQAAAAEFAggaDnNhbXBsZVN0cmVuZ3RoAwQAAAYCAQMAAAAAAADwPwMBAwAAAAAAABBAAwMADhsBaQEEAAAGFQECAAAAAAEBAgQAAAABDwEAAAUECBwGb2Zmc2V0BQoEAAAGAQYBChECDg8FDAAEAhsBBQwRAAUKAhUFCgUKAgYDBQoABgQCHAUKCQMoDgIGAwYBCQMDDgECGQMDCgIcBQoAAAMDBgEJAwIOAQIZAwMKAhwFCgQAAwMDBgAGAQkDAw4BAhkDAwoCHAUKBAADAwYBCQMCDgECGQMDCgIcBQoAAAMDAwUKBQoIHQVkZXB0aAMEAAAJA0AOAwIIEQEGAAIXBQoCHAUKBQoBAwAAAAAAAAAAAwMACwYHBgMCGAMCCgMDAh0DAgaDAgwDAhoDAwAAAAAAAQECAgAAAAEFAggeDnNhbXBsZVN0cmVuZ3RoAwQAAAYCAQMAAAAAAADwPwMBAwAAAAAAAChAAwMADh8BaQEEAAAGFQECAAAAAAEBAgwAAAABDwEAAAUECCAGb2Zmc2V0BQoEAAAGAQYBChECDw8FDAAMAh8BBQwRAAUKAhUFCgUKAgYDBQoABgQCIAUKCQMoDgIGAwYBCQMDDgECGQMDCgIgBQoAAAMDBgEJAwIOAQIZAwMKAiAFCgQAAwMDBgAGAQkDAw4BAhkDAwoCIAUKBAADAwYBCQMCDgECGQMDCgIgBQoAAAMDAwUKBQoIIQVkZXB0aAMEAAAJA0AOAwIIEQEGAAIXBQoCIAUKBQoBAwAAAAAAAAAAAwMACwYHBgMCGAMCCgMDAiEDAgaDAgwDAh4DAwAAAAAAAQECAwAAAAEFAggiDnNhbXBsZVN0cmVuZ3RoAwQAAAYCAQMAAAAAAADwPwMBAwAAAAAAAFBAAwMADiMBaQEEAAAGFQECAAAAAAEBAkAAAAABDwEAAAUECCQGb2Zmc2V0BQoEAAAGAQYBChECEA8FDABAAiMBBQwRAAUKAhUFCgUKAgYDBQoABgQCJAUKCQMoDgIGAwYBCQMDDgECGQMDCgIkBQoAAAMDBgEJAwIOAQIZAwMKAiQFCgQAAwMDBgAGAQkDAw4BAhkDAwoCJAUKBAADAwYBCQMCDgECGQMDCgIkBQoAAAMDAwUKBQoIJQVkZXB0aAMEAAAJA0AOAwIIEQEGAAIXBQoCJAUKBQoBAwAAAAAAAAAAAwMACwYHBgMCGAMCCgMDAiUDAgaDAgwDAiIDAwAAAAAAAAAACwICAgUFCCYJc2hhZG93UG9zBQsEAAAGAQILBQsCCQgFCwAIJwVkZXB0aAMEAAAJAz8OAgIIEQEJAzoOAQoCJgULEQAFCgUKAwAIKAR6TWF4AwQAAAkDNQ4BCgImBQsIAAMDAAgpBWRlbHRhAwQAAAYDCQMVDgIEBgACJwMCCgMDAwIoAwMCKAMDAAYEAgwDCQM1DgEJAwkOAQYBAgMDAikDAwMDAwAFBAgqCXNoYWRvd1BvcwULBAAABgECCwULAgkIBQsACCsIc2hhZG93VXYFCgQAAAkDOg4BCgIqBQsRAAUKBQoACCwFZGVwdGgDBAAACQM/DgICCBEBCgIrBQoRAAUKAwAGBAIMAwsGBwYDCgIqBQsIAAMCCgMDAiwDAgEDAAAAAAAAAAADAQMAAAAAAADwPwMDAwAAAAAAAAYEAg0DAgwDAwA";
Rf.SRC="HXSLFWgzZC5zaGFkZXIuR2VuVGV4dHVyZQoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoEbW9kZQECAAEAAAAAAAsFY29sb3IFDAIAAAwIX19pbml0X18OBgAADQZ2ZXJ0ZXgOBgAADghmcmFnbWVudA4GAAADAgwAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAANAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEOAAAFARMEAgoBAQEBAQIAAAAAAQUBBgQCCAUMCwYHCQMbDgEKAgYFDBEABQoDAQMAAAAAAADwPwMCCQMqDgEBAwAAAAAAAAAAAwUMAgsFDAUMBQwAAAAA";
bg.SRC="HXSLFWgzZC5zaGFkZXIuTGluZVNoYWRlcgwBBmNhbWVyYQ0BAwIEdmlldwcAAQADBHByb2oHAAEABAh2aWV3UHJvagcAAQAAAAAFBmdsb2JhbA0CAgYJcGl4ZWxTaXplBQoABQAHCW1vZGVsVmlldwcABQEDAAAACAVpbnB1dA0DAwkIcG9zaXRpb24FCwEIAAoGbm9ybWFsBQsBCAALAnV2BQoBCAABAAAMBm91dHB1dA0EAQ0IcG9zaXRpb24FDAQMAAQAAA4RdHJhbnNmb3JtZWROb3JtYWwFCwQAAA8TdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAEBFwcm9qZWN0ZWRQb3NpdGlvbgUMBAAAEQtsZW5ndGhTY2FsZQMCAAASBXdpZHRoAwIAABMEcGRpcgUMBAAAFAhfX2luaXRfXw4GAAAVBnZlcnRleA4GAAACAhQAAAUBBQUIFgNkaXIFCwQAAAYBAgoFCwkDMg4BAgcHBgULAAYEAhMFDAYBCQMqDgIGAQIWBQsJAzIOAQICBwYFCwEDAAAAAAAA8D8DBQwCAwcFDAUMBoEKAhMFDBEABQoGAgEDAAAAAAAA8D8DCQMNDgEGAAYBCgITBQwAAAMKAhMFDAAAAwMGAQoCEwUMBAADCgITBQwEAAMDAwMDBQoGgAIPBQsGAQYBAhYFCwoCCwUKAAADBQsCEQMFCwULBgQCDgULCQMfDgECFgULBQsFCwAAABUAAAUBBoAKAhAFDBEABQoGAQYBBgEGAQQGAQoCEwUMBQAFCgkDKA4CAQMAAAAAAADwPwMBAwAAAAAAAPC/AwUKBQoFCgQGAwoCCwUKBAADAQMAAAAAAADgPwMDAwUKCgIQBQwIAAMFCgIGBQoFCgISAwUKBQoA";
Yf.SRC="HXSLF2gzZC5zaGFkZXIuTWluTWF4U2hhZGVyCwEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACgR0ZXhBCgIAAAsEdGV4QgoCAAAMBWlzTWF4AgIAAQAAAAAADQhfX2luaXRfXw4GAAAOBnZlcnRleA4GAAAPCGZyYWdtZW50DgYAAAMCDQAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAA4AAAUBBgQCBgUMCQMqDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ8AAAUDCBABYQUMBAAACQMhDgICCgoCCQUKBQwACBEBYgUMBAAACQMhDgICCwoCCQUKBQwABgQCCAUMCwIMAgkDFg4CAhAFDAIRBQwFDAkDFQ4CAhAFDAIRBQwFDAUMBQwA";
Wg.SRC="HXSLG2gzZC5zaGFkZXIuQ3ViZU1pbk1heFNoYWRlcgwBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoEdGV4QQwCAAALBHRleEIMAgAADAVpc01heAICAAEAAAAAAA0DbWF0BgIAAA4IX19pbml0X18OBgAADwZ2ZXJ0ZXgOBgAAEAhmcmFnbWVudA4GAAADAg4AAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAAPAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEQAAAFBQgRAnV2BQoEAAAGAwYBAgkFCgEDAAAAAAAAAEADBQoBAwAAAAAAAPA/AwUKAAgSA2RpcgULBAAABgEJAykOAgIRBQoBAwAAAAAAAPA/AwULAg0GBQsACBMBYQUMBAAACQMhDgICCgwCEgULBQwACBQBYgUMBAAACQMhDgICCwwCEgULBQwABgQCCAUMCwIMAgkDFg4CAhMFDAIUBQwFDAkDFQ4CAhMFDAIUBQwFDAUMBQwA";
Pf.SRC="HXSLFGgzZC5zaGFkZXIuTm9ybWFsTWFwCgEGY2FtZXJhDQECAghwb3NpdGlvbgULAAEAAwNkaXIFCwMBAAAAAAQGZ2xvYmFsDQIBBQltb2RlbFZpZXcHAAQBAwAAAAYFaW5wdXQNAwIHBm5vcm1hbAULAQYACAd0YW5nZW50BQsBBgABAAAJB3RleHR1cmUKAgAACgxjYWxjdWxhdGVkVVYFCgQAAAsTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAADBF0cmFuc2Zvcm1lZE5vcm1hbAULBAAADRJ0cmFuc2Zvcm1lZFRhbmdlbnQFDAMAAA4OX19pbml0X192ZXJ0ZXgOBgAADwhmcmFnbWVudA4GAAACAg4AAAUBBgQCDQUMCQMqDgIGAQIIBQsJAzIOAQIFBwYFCwsGBwkDHQ4CAggFCwIIBQsDAQMAAAAAAADgPwMCAQMAAAAAAADwPwMBAwAAAAAAAPC/AwMFDAUMAAEPAAAFBQgQAW4FCwQAAAIMBQsACBECbmYFCwQAAAkDOQ4BCQMhDgICCQoCCgUKBQwFCwAIEgR0YW5YBQsEAAAJAx8OAQoCDQUMkgAFCwULAAgTBHRhblkFCwQAAAYBCQMeDgICEAULAhIFCwULBwMKAg0FDAwAAwMFCwAGBAIMBQsJAx8OAQQGAAYABgEKAhEFCwAAAwISBQsFCwYBCgIRBQsEAAMCEwULBQsFCwYBCgIRBQsIAAMCEAULBQsFCwULBQsFCwA";
Qg.SRC="HXSLEWgzZC5zaGFkZXIuU2hhZG93BgEGc2hhZG93DQEFAgNtYXARAQABAAMEcHJvaggAAQAEBWNvbG9yBQsAAQAFBXBvd2VyAwABAAYEYmlhcwMAAQAAAAAHCnBpeGVsQ29sb3IFDAQAAAgTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAACRhwaXhlbFRyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAoJc2hhZG93UG9zBQsDAAEBCwhmcmFnbWVudA4GAAABAQsAAAUGCAwJc2hhZG93UG9zBQsEAAAGAQIJBQsCAwgFCwAIDQVkZXB0aAMEAAAJAz8OAgICEQEJAzoOAQoCDAULEQAFCgUKAwAIDgR6TWF4AwQAAAkDNQ4BCgIMBQsIAAMDAAgPBWRlbHRhAwQAAAYDCQMVDgIEBgACDQMCBgMDAwIOAwMCDgMDAAgQBXNoYWRlAwQAAAkDNQ4BCQMJDgEGAQIFAwIPAwMDAwAGgQoCBwUMkgAFCwYABgEEBgMBAwAAAAAAAPA/AwIQAwMDCgIEBQuSAAULBQsCEAMFCwULAA";
Ff.SRC="HXSLHmgzZC5zaGFkZXIuU2lnbmVkRGlzdGFuY2VGaWVsZA4BBWlucHV0DQEDAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEABAVjb2xvcgUMAQEAAQAABQZvdXRwdXQNAgIGCHBvc2l0aW9uBQwEBQAHBWNvbG9yBQwEBQAEAAAIBHRpbWUDAAAACQ5zcHJpdGVQb3NpdGlvbgUMBAAAChBhYnNvbHV0ZVBvc2l0aW9uBQwEAAALCnBpeGVsQ29sb3IFDAQAAAwMdGV4dHVyZUNvbG9yBQwEAAANDGNhbGN1bGF0ZWRVVgUKAwAADg5vdXRwdXRQb3NpdGlvbgUMBAAADwdjaGFubmVsAQIAAQAAAAAAEAthbHBoYUN1dG9mZgMCAAARCXNtb290aGluZwMCAAASBm1lZGlhbg4GAAATCGZyYWdtZW50DgYAAAIDEgMUAXIDBAAAFQFnAwQAABYBYgMEAAADBQENCQMWDgIJAxUOAgIUAwIVAwMJAxUOAgkDFg4CAhQDAhUDAwIWAwMDAAABEwAABQQIFw10ZXh0dXJlU2FtcGxlBQwEAAACDAUMAAgYCGRpc3RhbmNlAwQAAAAABgQCGAMLBgUCDwEBAgAAAAABAgoCFwUMAAADCwYFAg8BAQIBAAAAAQIKAhcFDAQAAwsGBQIPAQECAgAAAAECCgIXBQwIAAMLBgUCDwEBAgMAAAABAgoCFwUMDAADCQISDgMKAhcFDAAAAwoCFwUMBAADCgIXBQwIAAMDAwMDAwMGBAIMBQwJAyoOBAEDAAAAAAAA8D8DAQMAAAAAAADwPwMBAwAAAAAAAPA/AwkDGg4DBgMCEAMCEQMDBgACEAMCEQMDAhgDAwUMBQwA";
nd.SRC="HXSLE2gzZC5zaGFkZXIuU2tpbkJhc2UFARByZWxhdGl2ZVBvc2l0aW9uBQsEAAACE3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAMRdHJhbnNmb3JtZWROb3JtYWwFCwQAAAQITWF4Qm9uZXMBAgABAAAAAAAFDWJvbmVzTWF0cml4ZXMPCAQCAAEIAA";fg.SRC="HXSLD2gzZC5zaGFkZXIuU2tpbggBEHJlbGF0aXZlUG9zaXRpb24FCwQAAAITdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAAxF0cmFuc2Zvcm1lZE5vcm1hbAULBAAABAhNYXhCb25lcwECAAEAAAAAAAUNYm9uZXNNYXRyaXhlcw8IBAIAAQgGBWlucHV0DQEEBwhwb3NpdGlvbgULAQYACAZub3JtYWwFCwEGAAkHd2VpZ2h0cwULAQYACgdpbmRleGVzCQQAAAABBgABAAALEnRyYW5zZm9ybWVkVGFuZ2VudAUMBAAADAZ2ZXJ0ZXgOBgAAAQAMAAAFAgYEAgIFCwYABgAGAQQGAQIBBQsRAgUPCAQKAgoJBAAAAAAAAQgFCwULCgIJBQsAAAMFCwYBBAYBAgEFCxECBQ8IBAoCCgkEAAAABAABCAULBQsKAgkFCwQAAwULBQsGAQQGAQIBBQsRAgUPCAQKAgoJBAAAAAgAAQgFCwULCgIJBQsIAAMFCwULBQsGBAIDBQsJAx8OAQYABgAGAQQGAQIIBQsJAzIOARECBQ8IBAoCCgkEAAAAAAABCAYFCwULCgIJBQsAAAMFCwYBBAYBAggFCwkDMg4BEQIFDwgECgIKCQQAAAAEAAEIBgULBQsKAgkFCwQAAwULBQsGAQQGAQIIBQsJAzIOARECBQ8IBAoCCgkEAAAACAABCAYFCwULCgIJBQsIAAMFCwULBQsFCwA";
eg.SRC="HXSLFmgzZC5zaGFkZXIuU2tpblRhbmdlbnQIARByZWxhdGl2ZVBvc2l0aW9uBQsEAAACE3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAMRdHJhbnNmb3JtZWROb3JtYWwFCwQAAAQITWF4Qm9uZXMBAgABAAAAAAAFDWJvbmVzTWF0cml4ZXMPCAQCAAEIBgVpbnB1dA0BBQcIcG9zaXRpb24FCwEGAAgGbm9ybWFsBQsBBgAJB3RhbmdlbnQFCwEGAAoHd2VpZ2h0cwULAQYACwdpbmRleGVzCQQAAAABBgABAAAMEnRyYW5zZm9ybWVkVGFuZ2VudAUMBAAADQZ2ZXJ0ZXgOBgAAAQANAAAFAwYEAgIFCwYABgAGAQQGAQIBBQsRAgUPCAQKAgsJBAAAAAAAAQgFCwULCgIKBQsAAAMFCwYBBAYBAgEFCxECBQ8IBAoCCwkEAAAABAABCAULBQsKAgoFCwQAAwULBQsGAQQGAQIBBQsRAgUPCAQKAgsJBAAAAAgAAQgFCwULCgIKBQsIAAMFCwULBQsGBAIDBQsJAx8OAQYABgAGAQQGAQIIBQsJAzIOARECBQ8IBAoCCwkEAAAAAAABCAYFCwULCgIKBQsAAAMFCwYBBAYBAggFCwkDMg4BEQIFDwgECgILCQQAAAAEAAEIBgULBQsKAgoFCwQAAwULBQsGAQQGAQIIBQsJAzIOARECBQ8IBAoCCwkEAAAACAABCAYFCwULCgIKBQsIAAMFCwULBQsFCwYEAgwFDAkDKg4CCQMfDgEGAAYABgEEBgEKAgkFC5IABQsJAzIOARECBQ8IBAoCCwkEAAAAAAABCAYFCwULCgIKBQsAAAMFCwYBBAYBCgIJBQuSAAULCQMyDgERAgUPCAQKAgsJBAAAAAQAAQgGBQsFCwoCCgULBAADBQsFCwYBBAYBCgIJBQuSAAULCQMyDgERAgUPCAQKAgsJBAAAAAgAAQgGBQsFCwoCCgULCAADBQsFCwULCgIMBQwMAAMFDAUMAA";
Qf.SRC="HXSLGmgzZC5zaGFkZXIuU3BlY3VsYXJUZXh0dXJlBAEHdGV4dHVyZQoCAAACDGNhbGN1bGF0ZWRVVgUKBAAAAwlzcGVjQ29sb3IFCwQAAAQIZnJhZ21lbnQOBgAAAQEEAAAFAQaBAgMFCwoJAyEOAgIBCgICBQoFDJIABQsFCwA";Of.SRC="HXSLEmgzZC5zaGFkZXIuVGV4dHVyZQsBBWlucHV0DQEBAgJ1dgUKAQEAAQAAAwhhZGRpdGl2ZQICAAEAAAAAAAQJa2lsbEFscGhhAgIAAQAAAAAABQ1zcGVjdWxhckFscGhhAgIAAQAAAAAABhJraWxsQWxwaGFUaHJlc2hvbGQDAgABBwAAAAAAAAAAAAAAAAAA8D8HB3RleHR1cmUKAgAACAxjYWxjdWxhdGVkVVYFCgQAAAkKcGl4ZWxDb2xvcgUMBAAACglzcGVjQ29sb3IFCwQAAAsGdmVydGV4DgYAAAwIZnJhZ21lbnQOBgAAAgALAAAFAQYEAggFCgICBQoFCgABDAAABQQIDQFjBQwEAAAJAyEOAgIHCgIIBQoFDAALBg4CBAIGCQYDCgINBQwMAAMCBgMDAQMAAAAAAAAAAAMCAgwAAAALAgMCBoACCQUMAg0FDAUMBoECCQUMAg0FDAUMAAsCBQIGgQIKBQsKAg0FDP4ABQsFCwAAAA";
Fc.SRC="HXSLEmgzZC5zaGFkZXIuVVZEZWx0YQQBB3V2RGVsdGEFCgIAAAIHdXZTY2FsZQUKAgAAAwxjYWxjdWxhdGVkVVYFCgQAAAQGdmVydGV4DgYAAAEABAAABQEGBAIDBQoGAAYBAgMFCgICBQoFCgIBBQoFCgUKAA";cg.SRC="HXSLG2gzZC5zaGFkZXIuVmVydGV4Q29sb3JBbHBoYQQBBWlucHV0DQEBAgVjb2xvcgUMAQEAAQAAAwpwaXhlbENvbG9yBQwEAAAECGFkZGl0aXZlAgIAAQAAAAAABQhmcmFnbWVudA4GAAABAQUAAAUBCwIEAgaAAgMFDAICBQwFDAaBAgMFDAICBQwFDAAA";Lf.SRC="HXSLFmgzZC5zaGFkZXIuVm9sdW1lRGVjYWwYAQZjYW1lcmENAQoCBHZpZXcHAAEAAwRwcm9qBwABAAQIcG9zaXRpb24FCwABAAUIcHJvakZsaXADAAEABghwcm9qRGlhZwULAAEABwh2aWV3UHJvagcAAQAID2ludmVyc2VWaWV3UHJvagcAAQAJBXpOZWFyAwABAAoEekZhcgMAAQALA2RpcgULAwEAAAAADAZnbG9iYWwNAgQNBHRpbWUDAAwADglwaXhlbFNpemUFCgAMAA8JbW9kZWxWaWV3BwAMAQMQEG1vZGVsVmlld0ludmVyc2UHAAwBAwAAABEFaW5wdXQNAwISCHBvc2l0aW9uBQsBEQATBm5vcm1hbAULAREAAQAAFAZvdXRwdXQNBAUVCHBvc2l0aW9uBQwEFAAWBWNvbG9yBQwEFAAXBWRlcHRoAwQUABgGbm9ybWFsBQsEFAAZCXdvcmxkRGlzdAMEFAAEAAAaEHJlbGF0aXZlUG9zaXRpb24FCwQAABsTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAHBhwaXhlbFRyYW5zZm9ybWVkUG9zaXRpb24FCwQAAB0RdHJhbnNmb3JtZWROb3JtYWwFCwQAAB4RcHJvamVjdGVkUG9zaXRpb24FDAQAAB8KcGl4ZWxDb2xvcgUMBAAAIAVkZXB0aAMEAAAhCHNjcmVlblVWBQoEAAAiCXNwZWNQb3dlcgMEAAAjCXNwZWNDb2xvcgULBAAAJAl3b3JsZERpc3QDBAAAJQhkZXB0aE1hcBEBAAAAJgVzY2FsZQUKAgAAJwZub3JtYWwFCwIAACgHdGFuZ2VudAULAgAAKQppc0NlbnRlcmVkAgIAAQAAAAAAKgxjYWxjdWxhdGVkVVYFCgQAACsSdHJhbnNmb3JtZWRUYW5nZW50BQwEAAAsDl9faW5pdF9fdmVydGV4DgYAAC0IZnJhZ21lbnQOBgAAAgIsAAAFAgYEAh0FCwkDHw4BBAYBAicFCwkDMg4BAg8HBgULBQsFCwULBgQCKwUMCQMqDgIJAx8OAQQGAQIoBQsJAzIOAQIPBwYFCwULBQsBAwAAAAAAAPA/AwUMBQwAAS0AAAUJCC4GbWF0cml4BwQAAAYBAggHAhAHBwAILwlzY3JlZW5Qb3MFCgQAAAYCCgIeBQwRAAUKCgIeBQwMAAMFCgAIMANydXYFDAQAAAkDKg4DAi8FCgkDPw4CAiURAQkDOg4BAi8FCgUKAwEDAAAAAAAA8D8DBQwACDEEd3BvcwUMBAAABgECMAUMAi4HBQwACDIEcHBvcwUMBAAABgECMAUMAggHBQwABgQCHAULBgIKAjIFDJIABQsKAjIFDAwAAwULBQsGBAIqBQoGAQImBQoEBgIKAjEFDBEABQoKAjEFDAwAAwUKBQoFCgUKCwIpAgaAAioFCgEDAAAAAAAA4D8DBQoAAAsGCQkDFQ4CCQMVDgIKAioFCgAAAwoCKgUKBAADAwkDFQ4CBgMBAwAAAAAAAPA/AwoCKgUKAAADAwYDAQMAAAAAAADwPwMKAioFCgQAAwMDAwEDAAAAAAAAAAADAgwAAAAA";
te.pending=[];te.threadCount=0;Tb.DEFAULT_RESOLVER=new ii;Tb.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";od.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";od.BYTES=N.ofString(od.CHARS);mc.helper=new DataView(new ArrayBuffer(8));Ad.escapes=function(a){a=new ga;null!=Q.lt?a.setReserved("lt","<"):a.h.lt="<";null!=Q.gt?a.setReserved("gt",">"):a.h.gt=">";null!=Q.amp?a.setReserved("amp","&"):a.h.amp="&";null!=Q.quot?a.setReserved("quot",'"'):a.h.quot=
'"';null!=Q.apos?a.setReserved("apos","'"):a.h.apos="'";return a}(this);Bb.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1];Bb.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258];Bb.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1];Bb.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];
Bb.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];Mb.ASCII=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";Mb.LATIN1="\u00a1\u00a2\u00a3\u00a4\u00a5\u00a6\u00a7\u00a8\u00a9\u00aa\u00ab\u00ac-\u00ae\u00af\u00b0\u00b1\u00b2\u00b3\u00b4\u00b5\u00b6\u00b7\u00b8\u00b9\u00ba\u00bb\u00bc\u00bd\u00be\u00bf\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u00c6\u00c7\u00c8\u00c9\u00ca\u00cb\u00cc\u00cd\u00ce\u00cf\u00d0\u00d1\u00d2\u00d3\u00d4\u00d5\u00d6\u00d7\u00d8\u00d9\u00da\u00db\u00dc\u00dd\u00de\u00df\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u00e6\u00e7\u00e8\u00e9\u00ea\u00eb\u00ec\u00ed\u00ee\u00ef\u00f0\u00f1\u00f2\u00f3\u00f4\u00f5\u00f6\u00f7\u00f8\u00f9\u00fa\u00fb\u00fc\u00fd\u00fe\u00ff\u0153\u00e6\u0152\u00c6\u20ac";
Mb.CYRILLIC="\u0410\u0411\u0412\u0413\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u0427\u0428\u0429\u042a\u042b\u042c\u042d\u042e\u042f\u0430\u0431\u0432\u0433\u0434\u0435\u0436\u0437\u0438\u0439\u043a\u043b\u043c\u043d\u043e\u043f\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044a\u044b\u044c\u044d\u044e\u044f\u2014";Mb.POLISH="\u0104\u0106\u0118\u0141\u0143\u00d3\u015a\u0179\u017b\u0105\u0107\u0119\u0142\u0144\u00f3\u015b\u017a\u017c";
Mb.TURKISH="\u00c2\u00c7\u011eI\u0130\u00ce\u00d6\u015e\u00dc\u00db\u00e2\u00e7\u011f\u0131\u0130\u00ee\u00f6\u015f\u00fc\u00fb";Mb.JP_KANA="\u3000\u3042\u3044\u3046\u3048\u304a\u304b\u304d\u304f\u3051\u3053\u3055\u3057\u3059\u305b\u305d\u305f\u3061\u3064\u3066\u3068\u306a\u306b\u306c\u306d\u306e\u306f\u3072\u3075\u3078\u307b\u307e\u307f\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308a\u308b\u308c\u308d\u308f\u3090\u3091\u3092\u3093\u304c\u304e\u3050\u3052\u3054\u3056\u3058\u305a\u305c\u305e\u3060\u3062\u3065\u3067\u3069\u3070\u3073\u3076\u3079\u307c\u3071\u3074\u3077\u307a\u307d\u3083\u3085\u3087\u30a2\u30a4\u30a6\u30a8\u30aa\u30ab\u30ad\u30af\u30b1\u30b3\u30b5\u30b7\u30b9\u30bb\u30bd\u30bf\u30c1\u30c4\u30c6\u30c8\u30ca\u30cb\u30cc\u30cd\u30ce\u30cf\u30d2\u30d5\u30d8\u30db\u30de\u30df\u30e0\u30e1\u30e2\u30e4\u30e6\u30e8\u30e9\u30ea\u30eb\u30ec\u30ed\u30ef\u30f0\u30f1\u30f2\u30f3\u30ac\u30ae\u30b0\u30b2\u30b4\u30b6\u30b8\u30ba\u30bc\u30be\u30c0\u30c2\u30c5\u30c7\u30c9\u30d0\u30d3\u30d6\u30d9\u30dc\u30d1\u30d4\u30d7\u30da\u30dd\u30f4\u30e3\u3047\u3063\u30c3\u30e5\u30e7\u30a1\u30a3\u30a5\u30a7\u30a9\u30fb\u30fc\u300c\u300d\u3001\u3002\u300e\u300f\u201c\u201d\uff01\uff1a\uff1f\uff05\uff06\uff08\uff09\uff0d\uff10\uff11\uff12\uff13\uff14\uff15\uff16\uff17\uff18\uff19";
Mb.UNICODE_SPECIALS="\ufffd\u25a1";Mb.DEFAULT_CHARS=Mb.ASCII+Mb.LATIN1;y.BACKSPACE=8;y.TAB=9;y.ENTER=13;y.SHIFT=16;y.CTRL=17;y.ALT=18;y.ESCAPE=27;y.SPACE=32;y.PGUP=33;y.PGDOWN=34;y.END=35;y.HOME=36;y.LEFT=37;y.UP=38;y.RIGHT=39;y.DOWN=40;y.INSERT=45;y.DELETE=46;y.QWERTY_EQUALS=187;y.QWERTY_MINUS=189;y.QWERTY_TILDE=192;y.QWERTY_BRACKET_LEFT=219;y.QWERTY_BRACKET_RIGHT=221;y.QWERTY_SEMICOLON=186;y.QWERTY_QUOTE=222;y.QWERTY_BACKSLASH=220;y.QWERTY_COMMA=188;y.QWERTY_PERIOD=190;y.QWERTY_SLASH=191;y.INTL_BACKSLASH=
226;y.LEFT_WINDOW_KEY=91;y.RIGHT_WINDOW_KEY=92;y.CONTEXT_MENU=93;y.PAUSE_BREAK=19;y.CAPS_LOCK=20;y.NUM_LOCK=144;y.SCROLL_LOCK=145;y.NUMBER_0=48;y.NUMBER_1=49;y.NUMBER_2=50;y.NUMBER_3=51;y.NUMBER_4=52;y.NUMBER_5=53;y.NUMBER_6=54;y.NUMBER_7=55;y.NUMBER_8=56;y.NUMBER_9=57;y.NUMPAD_0=96;y.NUMPAD_1=97;y.NUMPAD_2=98;y.NUMPAD_3=99;y.NUMPAD_4=100;y.NUMPAD_5=101;y.NUMPAD_6=102;y.NUMPAD_7=103;y.NUMPAD_8=104;y.NUMPAD_9=105;y.A=65;y.B=66;y.C=67;y.D=68;y.E=69;y.F=70;y.G=71;y.H=72;y.I=73;y.J=74;y.K=75;y.L=76;y.M=
77;y.N=78;y.O=79;y.P=80;y.Q=81;y.R=82;y.S=83;y.T=84;y.U=85;y.V=86;y.W=87;y.X=88;y.Y=89;y.Z=90;y.F1=112;y.F2=113;y.F3=114;y.F4=115;y.F5=116;y.F6=117;y.F7=118;y.F8=119;y.F9=120;y.F10=121;y.F11=122;y.F12=123;y.F13=124;y.F14=125;y.F15=126;y.F16=127;y.F17=128;y.F18=129;y.F19=130;y.F20=131;y.F21=132;y.F22=133;y.F23=134;y.F24=135;y.NUMPAD_MULT=106;y.NUMPAD_ADD=107;y.NUMPAD_ENTER=108;y.NUMPAD_SUB=109;y.NUMPAD_DOT=110;y.NUMPAD_DIV=111;y.MOUSE_LEFT=0;y.MOUSE_RIGHT=1;y.MOUSE_MIDDLE=2;y.MOUSE_BACK=3;y.MOUSE_FORWARD=
4;y.MOUSE_WHEEL_UP=5;y.MOUSE_WHEEL_DOWN=6;y.LOC_LEFT=256;y.LOC_RIGHT=512;y.LSHIFT=272;y.RSHIFT=528;y.LCTRL=273;y.RCTRL=529;y.LALT=274;y.RALT=530;y.initDone=!1;y.keyPressed=[];y.ALLOW_KEY_REPEAT=!1;L.PI=3.141592653589793;L.EPSILON=1E-10;kg.R=0;kg.G=1;kg.B=2;kg.A=3;Ba.S3TC_SIZES=[0,-1,1,1,-1,1,1,1];ea.wantedFPS=60;ea.maxDeltaTime=0.5;ea.smoothFactor=0.95;ea.lastTimeStamp=Date.now()/1E3;ea.elapsedTime=0;ea.frameCount=0;ea.dt=1/ea.wantedFPS;ea.currentDT=1/ea.wantedFPS;U.setCursor=U.setNativeCursor;U.loopInit=
!1;Vd.DFloat=1;Vd.DVec2=2;Vd.DVec3=3;Vd.DVec4=4;Vd.DBytes4=9;$g.QTMP=new Oe;pi.CURRENT_VERSION=3;xd.BLEND=ra.__empty_constructs__.slice();xd.CULLING=Nb.__empty_constructs__.slice();Yj.Dynamic=0;Yj.UniformDynamic=1;kc.LIVE_UPDATE=!1;df.Jpg=0;df.Png=1;df.Gif=2;df.Tga=3;df.Dds=4;Jc.ALLOW_NPOT=!0;Jc.DEFAULT_FILTER=Jd.Linear;Jc.DEFAULT_ASYNC=!1;Jc.ENABLE_AUTO_WATCH=!0;La.BLOCKSIZE=64;La.W1=2841;La.W2=2676;La.W3=2408;La.W5=1609;La.W6=1108;La.W7=565;La.CF4A=-9;La.CF4B=111;La.CF4C=29;La.CF4D=-3;La.CF3A=28;
La.CF3B=109;La.CF3C=-9;La.CF3X=104;La.CF3Y=27;La.CF3Z=-3;La.CF2A=139;La.CF2B=-11;Ce.ENABLE_AUTO_WATCH=!0;lg.ID=0;eh.ID=0;Ha.STREAM_DURATION=5;Ha.STREAM_BUFFER_SAMPLE_COUNT=44100;Ha.BUFFER_QUEUE_LENGTH=2;Ha.MAX_SOURCES=16;Ha.SOUND_BUFFER_CACHE_SIZE=256;Ha.VIRTUAL_VOLUME_THRESHOLD=1E-5;Ha.BUFFER_STREAM_SPLIT=16;Ei.FADE_SAMPLES=10;w.UID=0;w.SWIZ=ca.__empty_constructs__.slice();w.MAX_CHANNELS_BITS=3;mg.SRC="HXSLEGh4c2wuQmF0Y2hTaGFkZXICAQtCYXRjaF9Db3VudAECAAEAAAABAAIMQmF0Y2hfQnVmZmVyEAUMAQIAAAA";yb.KWD_LIST=
"input output discard dvec2 dvec3 dvec4 hvec2 hvec3 hvec4 fvec2 fvec3 fvec4 int float bool long short double half fixed unsigned superp lowp mediump highp precision invariant discard struct asm union template this packed goto sizeof namespace noline volatile external flat input output out attribute const uniform varying inout void".split(" ");yb.KWDS=function(a){a=new ga;for(var b=0,c=yb.KWD_LIST;b<c.length;){var d=c[b];++b;null!=Q[d]?a.setReserved(d,!0):a.h[d]=!0}return a}(this);yb.GLOBALS=function(a){a=
new af;for(var b=0,c=G.__empty_constructs__.slice();b<c.length;){var d=c[b];++b;var e=""+n.string(d),e=e.charAt(0).toLowerCase()+v.substr(e,1,null);a.set(d,e)}a.set(G.ToInt,"int");a.set(G.ToFloat,"float");a.set(G.ToBool,"bool");a.set(G.LReflect,"reflect");a.set(G.Mat3x4,"_mat3x4");a.set(G.VertexID,"gl_VertexID");a.set(G.InstanceID,"gl_InstanceID");a.set(G.IVec2,"ivec2");a.set(G.IVec3,"ivec3");a.set(G.IVec4,"ivec4");a.set(G.BVec2,"bvec2");a.set(G.BVec3,"bvec3");a.set(G.BVec4,"bvec4");a.set(G.FragCoord,
"gl_FragCoord");for(b=a.iterator();b.hasNext();)c=b.next(),d=yb.KWDS,null!=Q[c]?d.setReserved(c,!0):d.h[c]=!0;return a}(this);yb.MAT34="struct _mat3x4 { vec4 a; vec4 b; vec4 c; };";ng.UID=0;aa.SWIZ=["x","y","z","w"];fh.UID=0;Ea.TVECS=new na;Ea.BOPS=function(a){a=ma.__empty_constructs__.slice();a.splice(ma.OpAssignOp(null)._hx_index,0,null);return a}(this);Ea.UNOPS=Yg.__empty_constructs__.slice();Ea.TGLOBALS=G.__empty_constructs__.slice();Ea.TSWIZ=new na;Ea.REGS=[ca.X,ca.Y,ca.Z,ca.W];Ea.VKINDS=Y.__empty_constructs__.slice();
Ea.PRECS=kk.__empty_constructs__.slice();Ea.FKIND=dc.__empty_constructs__.slice();Ea.SIGN=9139229;qe.UNROLL_LOOPS=!1;xf.main();te.run()})("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
